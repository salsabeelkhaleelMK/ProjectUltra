import{a2 as Pa,aE as Vo,c as se,ao as Be,aF as Qe,aG as ge,r as vt,l as Do,aH as Oa,Q as me,aI as De,d as H,o as w,e as Z,g as W,O as Ge,x as A,B as v,s as _,E as $a,y as k,aJ as Fa,k as re,t as U,F as K,i as ue,q as On,n as rt,w as Ea,T as Va,ap as Da,G as La,aK as Ta,aL as ja,a8 as qa,V as Ve,aM as Na,aN as Lo,Y as Gt}from"./index-Db_3peLd.js";import{l as At,i as Zs,m as To,n as Ae,S as jo,B as Ba,q as Ha,$ as qo,T as No,D as nn,x as za,I as Ua,p as Bo,r as Ga,s as $n,u as Wa,v as Xa,w as eo,E as Fn,M as Ka,W as Ja,U as Qa,H as Ya,j as Za,G as ei,N as ti,O as Ft,P as ni,_ as si,a0 as oi,a1 as ri,a2 as ai,a3 as ii,a4 as li,a5 as ui,a6 as ci,a7 as di,a8 as sn,a9 as on,aa as rn,ab as an,ac as ln,ad as un,ae as Rt,af as It,ag as cn,ah as hi,ai as pi,aj as fi,ak as gi,al as mi,am as Zn,an as yi,ao as to,ap as Et,aq as bi,ar as wi,y as vi,as as _i}from"./toggle-group-item.vue_vue_type_script_setup_true_lang-Csij51_o-BDHqZScF.js";const Si={production:"https://auth-proxy.k.motork.io/litellm",staging:"https://auth-proxy.beta.motork.io/litellm"};function xi(e){return Si[e]}const Ci=Symbol.for("motork-ui.ai-config");function Ri(){return Pa(Vo(Ci,void 0))}const Ii=Symbol.for("motork-ui.app-env");function ki(){return Vo(Ii,se(()=>"production"))}var En={};const Ai=De("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),Mi=De("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),Pi=De("arrow-up-right",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),Oi=De("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),$i=De("box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),Fi=De("chevrons-up-down",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]),Ei=De("columns-3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),Vi=De("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),no=De("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);function Di(){return{accessor:(e,t)=>typeof e=="function"?{...t,accessorFn:e}:{...t,accessorKey:e},display:e=>e,group:e=>e}}function qe(e,t){return typeof e=="function"?e(t):e}function ve(e,t){return n=>{t.setState(s=>({...s,[e]:qe(n,s[e])}))}}function vn(e){return e instanceof Function}function Li(e){return Array.isArray(e)&&e.every(t=>typeof t=="number")}function Ti(e,t){const n=[],s=o=>{o.forEach(r=>{n.push(r);const a=t(r);a!=null&&a.length&&s(a)})};return s(e),n}function D(e,t,n){let s=[],o;return r=>{let a;n.key&&n.debug&&(a=Date.now());const i=e(r);if(!(i.length!==s.length||i.some((c,f)=>s[f]!==c)))return o;s=i;let l;if(n.key&&n.debug&&(l=Date.now()),o=t(...i),n==null||n.onChange==null||n.onChange(o),n.key&&n.debug&&n!=null&&n.debug()){const c=Math.round((Date.now()-a)*100)/100,f=Math.round((Date.now()-l)*100)/100,p=f/16,h=(u,d)=>{for(u=String(u);u.length<d;)u=" "+u;return u};console.info(`%câ± ${h(f,5)} /${h(c,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*p,120))}deg 100% 31%);`,n==null?void 0:n.key)}return o}}function L(e,t,n,s){return{debug:()=>{var o;return(o=e==null?void 0:e.debugAll)!=null?o:e[t]},key:!1,onChange:s}}function ji(e,t,n,s){const o=()=>{var a;return(a=r.getValue())!=null?a:e.options.renderFallbackValue},r={id:`${t.id}_${n.id}`,row:t,column:n,getValue:()=>t.getValue(s),renderValue:o,getContext:D(()=>[e,n,t,r],(a,i,l,c)=>({table:a,column:i,row:l,cell:c,getValue:c.getValue,renderValue:c.renderValue}),L(e.options,"debugCells"))};return e._features.forEach(a=>{a.createCell==null||a.createCell(r,n,t,e)},{}),r}function qi(e,t,n,s){var o,r;const a={...e._getDefaultColumnDef(),...t},i=a.accessorKey;let l=(o=(r=a.id)!=null?r:i?typeof String.prototype.replaceAll=="function"?i.replaceAll(".","_"):i.replace(/\./g,"_"):void 0)!=null?o:typeof a.header=="string"?a.header:void 0,c;if(a.accessorFn?c=a.accessorFn:i&&(i.includes(".")?c=p=>{let h=p;for(const d of i.split(".")){var u;h=(u=h)==null?void 0:u[d]}return h}:c=p=>p[a.accessorKey]),!l)throw new Error;let f={id:`${String(l)}`,accessorFn:c,parent:s,depth:n,columnDef:a,columns:[],getFlatColumns:D(()=>[!0],()=>{var p;return[f,...(p=f.columns)==null?void 0:p.flatMap(h=>h.getFlatColumns())]},L(e.options,"debugColumns")),getLeafColumns:D(()=>[e._getOrderColumnsFn()],p=>{var h;if((h=f.columns)!=null&&h.length){let u=f.columns.flatMap(d=>d.getLeafColumns());return p(u)}return[f]},L(e.options,"debugColumns"))};for(const p of e._features)p.createColumn==null||p.createColumn(f,e);return f}const he="debugHeaders";function so(e,t,n){var s;let o={id:(s=n.id)!=null?s:t.id,column:t,index:n.index,isPlaceholder:!!n.isPlaceholder,placeholderId:n.placeholderId,depth:n.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const r=[],a=i=>{i.subHeaders&&i.subHeaders.length&&i.subHeaders.map(a),r.push(i)};return a(o),r},getContext:()=>({table:e,header:o,column:t})};return e._features.forEach(r=>{r.createHeader==null||r.createHeader(o,e)}),o}const Ni={createTable:e=>{e.getHeaderGroups=D(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,n,s,o)=>{var r,a;const i=(r=s==null?void 0:s.map(f=>n.find(p=>p.id===f)).filter(Boolean))!=null?r:[],l=(a=o==null?void 0:o.map(f=>n.find(p=>p.id===f)).filter(Boolean))!=null?a:[],c=n.filter(f=>!(s!=null&&s.includes(f.id))&&!(o!=null&&o.includes(f.id)));return Vt(t,[...i,...c,...l],e)},L(e.options,he)),e.getCenterHeaderGroups=D(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,n,s,o)=>(n=n.filter(r=>!(s!=null&&s.includes(r.id))&&!(o!=null&&o.includes(r.id))),Vt(t,n,e,"center")),L(e.options,he)),e.getLeftHeaderGroups=D(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left],(t,n,s)=>{var o;const r=(o=s==null?void 0:s.map(a=>n.find(i=>i.id===a)).filter(Boolean))!=null?o:[];return Vt(t,r,e,"left")},L(e.options,he)),e.getRightHeaderGroups=D(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.right],(t,n,s)=>{var o;const r=(o=s==null?void 0:s.map(a=>n.find(i=>i.id===a)).filter(Boolean))!=null?o:[];return Vt(t,r,e,"right")},L(e.options,he)),e.getFooterGroups=D(()=>[e.getHeaderGroups()],t=>[...t].reverse(),L(e.options,he)),e.getLeftFooterGroups=D(()=>[e.getLeftHeaderGroups()],t=>[...t].reverse(),L(e.options,he)),e.getCenterFooterGroups=D(()=>[e.getCenterHeaderGroups()],t=>[...t].reverse(),L(e.options,he)),e.getRightFooterGroups=D(()=>[e.getRightHeaderGroups()],t=>[...t].reverse(),L(e.options,he)),e.getFlatHeaders=D(()=>[e.getHeaderGroups()],t=>t.map(n=>n.headers).flat(),L(e.options,he)),e.getLeftFlatHeaders=D(()=>[e.getLeftHeaderGroups()],t=>t.map(n=>n.headers).flat(),L(e.options,he)),e.getCenterFlatHeaders=D(()=>[e.getCenterHeaderGroups()],t=>t.map(n=>n.headers).flat(),L(e.options,he)),e.getRightFlatHeaders=D(()=>[e.getRightHeaderGroups()],t=>t.map(n=>n.headers).flat(),L(e.options,he)),e.getCenterLeafHeaders=D(()=>[e.getCenterFlatHeaders()],t=>t.filter(n=>{var s;return!((s=n.subHeaders)!=null&&s.length)}),L(e.options,he)),e.getLeftLeafHeaders=D(()=>[e.getLeftFlatHeaders()],t=>t.filter(n=>{var s;return!((s=n.subHeaders)!=null&&s.length)}),L(e.options,he)),e.getRightLeafHeaders=D(()=>[e.getRightFlatHeaders()],t=>t.filter(n=>{var s;return!((s=n.subHeaders)!=null&&s.length)}),L(e.options,he)),e.getLeafHeaders=D(()=>[e.getLeftHeaderGroups(),e.getCenterHeaderGroups(),e.getRightHeaderGroups()],(t,n,s)=>{var o,r,a,i,l,c;return[...(o=(r=t[0])==null?void 0:r.headers)!=null?o:[],...(a=(i=n[0])==null?void 0:i.headers)!=null?a:[],...(l=(c=s[0])==null?void 0:c.headers)!=null?l:[]].map(f=>f.getLeafHeaders()).flat()},L(e.options,he))}};function Vt(e,t,n,s){var o,r;let a=0;const i=function(h,u){u===void 0&&(u=1),a=Math.max(a,u),h.filter(d=>d.getIsVisible()).forEach(d=>{var m;(m=d.columns)!=null&&m.length&&i(d.columns,u+1)},0)};i(e);let l=[];const c=(h,u)=>{const d={depth:u,id:[s,`${u}`].filter(Boolean).join("_"),headers:[]},m=[];h.forEach(y=>{const x=[...m].reverse()[0],S=y.column.depth===d.depth;let C,F=!1;if(S&&y.column.parent?C=y.column.parent:(C=y.column,F=!0),x&&(x==null?void 0:x.column)===C)x.subHeaders.push(y);else{const z=so(n,C,{id:[s,u,C.id,y==null?void 0:y.id].filter(Boolean).join("_"),isPlaceholder:F,placeholderId:F?`${m.filter(B=>B.column===C).length}`:void 0,depth:u,index:m.length});z.subHeaders.push(y),m.push(z)}d.headers.push(y),y.headerGroup=d}),l.push(d),u>0&&c(m,u-1)},f=t.map((h,u)=>so(n,h,{depth:a,index:u}));c(f,a-1),l.reverse();const p=h=>h.filter(u=>u.column.getIsVisible()).map(u=>{let d=0,m=0,y=[0];u.subHeaders&&u.subHeaders.length?(y=[],p(u.subHeaders).forEach(S=>{let{colSpan:C,rowSpan:F}=S;d+=C,y.push(F)})):d=1;const x=Math.min(...y);return m=m+x,u.colSpan=d,u.rowSpan=m,{colSpan:d,rowSpan:m}});return p((o=(r=l[0])==null?void 0:r.headers)!=null?o:[]),l}const Bi=(e,t,n,s,o,r,a)=>{let i={id:t,index:s,original:n,depth:o,parentId:a,_valuesCache:{},_uniqueValuesCache:{},getValue:l=>{if(i._valuesCache.hasOwnProperty(l))return i._valuesCache[l];const c=e.getColumn(l);if(c!=null&&c.accessorFn)return i._valuesCache[l]=c.accessorFn(i.original,s),i._valuesCache[l]},getUniqueValues:l=>{if(i._uniqueValuesCache.hasOwnProperty(l))return i._uniqueValuesCache[l];const c=e.getColumn(l);if(c!=null&&c.accessorFn)return c.columnDef.getUniqueValues?(i._uniqueValuesCache[l]=c.columnDef.getUniqueValues(i.original,s),i._uniqueValuesCache[l]):(i._uniqueValuesCache[l]=[i.getValue(l)],i._uniqueValuesCache[l])},renderValue:l=>{var c;return(c=i.getValue(l))!=null?c:e.options.renderFallbackValue},subRows:[],getLeafRows:()=>Ti(i.subRows,l=>l.subRows),getParentRow:()=>i.parentId?e.getRow(i.parentId,!0):void 0,getParentRows:()=>{let l=[],c=i;for(;;){const f=c.getParentRow();if(!f)break;l.push(f),c=f}return l.reverse()},getAllCells:D(()=>[e.getAllLeafColumns()],l=>l.map(c=>ji(e,i,c,c.id)),L(e.options,"debugRows")),_getAllCellsByColumnId:D(()=>[i.getAllCells()],l=>l.reduce((c,f)=>(c[f.column.id]=f,c),{}),L(e.options,"debugRows"))};for(let l=0;l<e._features.length;l++){const c=e._features[l];c==null||c.createRow==null||c.createRow(i,e)}return i},Hi={createColumn:(e,t)=>{e._getFacetedRowModel=t.options.getFacetedRowModel&&t.options.getFacetedRowModel(t,e.id),e.getFacetedRowModel=()=>e._getFacetedRowModel?e._getFacetedRowModel():t.getPreFilteredRowModel(),e._getFacetedUniqueValues=t.options.getFacetedUniqueValues&&t.options.getFacetedUniqueValues(t,e.id),e.getFacetedUniqueValues=()=>e._getFacetedUniqueValues?e._getFacetedUniqueValues():new Map,e._getFacetedMinMaxValues=t.options.getFacetedMinMaxValues&&t.options.getFacetedMinMaxValues(t,e.id),e.getFacetedMinMaxValues=()=>{if(e._getFacetedMinMaxValues)return e._getFacetedMinMaxValues()}}},Ho=(e,t,n)=>{var s,o;const r=n==null||(s=n.toString())==null?void 0:s.toLowerCase();return!!(!((o=e.getValue(t))==null||(o=o.toString())==null||(o=o.toLowerCase())==null)&&o.includes(r))};Ho.autoRemove=e=>Ce(e);const zo=(e,t,n)=>{var s;return!!(!((s=e.getValue(t))==null||(s=s.toString())==null)&&s.includes(n))};zo.autoRemove=e=>Ce(e);const Uo=(e,t,n)=>{var s;return((s=e.getValue(t))==null||(s=s.toString())==null?void 0:s.toLowerCase())===(n==null?void 0:n.toLowerCase())};Uo.autoRemove=e=>Ce(e);const Go=(e,t,n)=>{var s;return(s=e.getValue(t))==null?void 0:s.includes(n)};Go.autoRemove=e=>Ce(e);const Wo=(e,t,n)=>!n.some(s=>{var o;return!((o=e.getValue(t))!=null&&o.includes(s))});Wo.autoRemove=e=>Ce(e)||!(e!=null&&e.length);const Xo=(e,t,n)=>n.some(s=>{var o;return(o=e.getValue(t))==null?void 0:o.includes(s)});Xo.autoRemove=e=>Ce(e)||!(e!=null&&e.length);const Ko=(e,t,n)=>e.getValue(t)===n;Ko.autoRemove=e=>Ce(e);const Jo=(e,t,n)=>e.getValue(t)==n;Jo.autoRemove=e=>Ce(e);const ws=(e,t,n)=>{let[s,o]=n;const r=e.getValue(t);return r>=s&&r<=o};ws.resolveFilterValue=e=>{let[t,n]=e,s=typeof t!="number"?parseFloat(t):t,o=typeof n!="number"?parseFloat(n):n,r=t===null||Number.isNaN(s)?-1/0:s,a=n===null||Number.isNaN(o)?1/0:o;if(r>a){const i=r;r=a,a=i}return[r,a]};ws.autoRemove=e=>Ce(e)||Ce(e[0])&&Ce(e[1]);const je={includesString:Ho,includesStringSensitive:zo,equalsString:Uo,arrIncludes:Go,arrIncludesAll:Wo,arrIncludesSome:Xo,equals:Ko,weakEquals:Jo,inNumberRange:ws};function Ce(e){return e==null||e===""}const zi={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:e=>({columnFilters:[],...e}),getDefaultOptions:e=>({onColumnFiltersChange:ve("columnFilters",e),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(e,t)=>{e.getAutoFilterFn=()=>{const n=t.getCoreRowModel().flatRows[0],s=n==null?void 0:n.getValue(e.id);return typeof s=="string"?je.includesString:typeof s=="number"?je.inNumberRange:typeof s=="boolean"||s!==null&&typeof s=="object"?je.equals:Array.isArray(s)?je.arrIncludes:je.weakEquals},e.getFilterFn=()=>{var n,s;return vn(e.columnDef.filterFn)?e.columnDef.filterFn:e.columnDef.filterFn==="auto"?e.getAutoFilterFn():(n=(s=t.options.filterFns)==null?void 0:s[e.columnDef.filterFn])!=null?n:je[e.columnDef.filterFn]},e.getCanFilter=()=>{var n,s,o;return((n=e.columnDef.enableColumnFilter)!=null?n:!0)&&((s=t.options.enableColumnFilters)!=null?s:!0)&&((o=t.options.enableFilters)!=null?o:!0)&&!!e.accessorFn},e.getIsFiltered=()=>e.getFilterIndex()>-1,e.getFilterValue=()=>{var n;return(n=t.getState().columnFilters)==null||(n=n.find(s=>s.id===e.id))==null?void 0:n.value},e.getFilterIndex=()=>{var n,s;return(n=(s=t.getState().columnFilters)==null?void 0:s.findIndex(o=>o.id===e.id))!=null?n:-1},e.setFilterValue=n=>{t.setColumnFilters(s=>{const o=e.getFilterFn(),r=s==null?void 0:s.find(f=>f.id===e.id),a=qe(n,r?r.value:void 0);if(oo(o,a,e)){var i;return(i=s==null?void 0:s.filter(f=>f.id!==e.id))!=null?i:[]}const l={id:e.id,value:a};if(r){var c;return(c=s==null?void 0:s.map(f=>f.id===e.id?l:f))!=null?c:[]}return s!=null&&s.length?[...s,l]:[l]})}},createRow:(e,t)=>{e.columnFilters={},e.columnFiltersMeta={}},createTable:e=>{e.setColumnFilters=t=>{const n=e.getAllLeafColumns(),s=o=>{var r;return(r=qe(t,o))==null?void 0:r.filter(a=>{const i=n.find(l=>l.id===a.id);if(i){const l=i.getFilterFn();if(oo(l,a.value,i))return!1}return!0})};e.options.onColumnFiltersChange==null||e.options.onColumnFiltersChange(s)},e.resetColumnFilters=t=>{var n,s;e.setColumnFilters(t?[]:(n=(s=e.initialState)==null?void 0:s.columnFilters)!=null?n:[])},e.getPreFilteredRowModel=()=>e.getCoreRowModel(),e.getFilteredRowModel=()=>(!e._getFilteredRowModel&&e.options.getFilteredRowModel&&(e._getFilteredRowModel=e.options.getFilteredRowModel(e)),e.options.manualFiltering||!e._getFilteredRowModel?e.getPreFilteredRowModel():e._getFilteredRowModel())}};function oo(e,t,n){return(e&&e.autoRemove?e.autoRemove(t,n):!1)||typeof t>"u"||typeof t=="string"&&!t}const Ui=(e,t,n)=>n.reduce((s,o)=>{const r=o.getValue(e);return s+(typeof r=="number"?r:0)},0),Gi=(e,t,n)=>{let s;return n.forEach(o=>{const r=o.getValue(e);r!=null&&(s>r||s===void 0&&r>=r)&&(s=r)}),s},Wi=(e,t,n)=>{let s;return n.forEach(o=>{const r=o.getValue(e);r!=null&&(s<r||s===void 0&&r>=r)&&(s=r)}),s},Xi=(e,t,n)=>{let s,o;return n.forEach(r=>{const a=r.getValue(e);a!=null&&(s===void 0?a>=a&&(s=o=a):(s>a&&(s=a),o<a&&(o=a)))}),[s,o]},Ki=(e,t)=>{let n=0,s=0;if(t.forEach(o=>{let r=o.getValue(e);r!=null&&(r=+r)>=r&&(++n,s+=r)}),n)return s/n},Ji=(e,t)=>{if(!t.length)return;const n=t.map(r=>r.getValue(e));if(!Li(n))return;if(n.length===1)return n[0];const s=Math.floor(n.length/2),o=n.sort((r,a)=>r-a);return n.length%2!==0?o[s]:(o[s-1]+o[s])/2},Qi=(e,t)=>Array.from(new Set(t.map(n=>n.getValue(e))).values()),Yi=(e,t)=>new Set(t.map(n=>n.getValue(e))).size,Zi=(e,t)=>t.length,Vn={sum:Ui,min:Gi,max:Wi,extent:Xi,mean:Ki,median:Ji,unique:Qi,uniqueCount:Yi,count:Zi},el={getDefaultColumnDef:()=>({aggregatedCell:e=>{var t,n;return(t=(n=e.getValue())==null||n.toString==null?void 0:n.toString())!=null?t:null},aggregationFn:"auto"}),getInitialState:e=>({grouping:[],...e}),getDefaultOptions:e=>({onGroupingChange:ve("grouping",e),groupedColumnMode:"reorder"}),createColumn:(e,t)=>{e.toggleGrouping=()=>{t.setGrouping(n=>n!=null&&n.includes(e.id)?n.filter(s=>s!==e.id):[...n??[],e.id])},e.getCanGroup=()=>{var n,s;return((n=e.columnDef.enableGrouping)!=null?n:!0)&&((s=t.options.enableGrouping)!=null?s:!0)&&(!!e.accessorFn||!!e.columnDef.getGroupingValue)},e.getIsGrouped=()=>{var n;return(n=t.getState().grouping)==null?void 0:n.includes(e.id)},e.getGroupedIndex=()=>{var n;return(n=t.getState().grouping)==null?void 0:n.indexOf(e.id)},e.getToggleGroupingHandler=()=>{const n=e.getCanGroup();return()=>{n&&e.toggleGrouping()}},e.getAutoAggregationFn=()=>{const n=t.getCoreRowModel().flatRows[0],s=n==null?void 0:n.getValue(e.id);if(typeof s=="number")return Vn.sum;if(Object.prototype.toString.call(s)==="[object Date]")return Vn.extent},e.getAggregationFn=()=>{var n,s;if(!e)throw new Error;return vn(e.columnDef.aggregationFn)?e.columnDef.aggregationFn:e.columnDef.aggregationFn==="auto"?e.getAutoAggregationFn():(n=(s=t.options.aggregationFns)==null?void 0:s[e.columnDef.aggregationFn])!=null?n:Vn[e.columnDef.aggregationFn]}},createTable:e=>{e.setGrouping=t=>e.options.onGroupingChange==null?void 0:e.options.onGroupingChange(t),e.resetGrouping=t=>{var n,s;e.setGrouping(t?[]:(n=(s=e.initialState)==null?void 0:s.grouping)!=null?n:[])},e.getPreGroupedRowModel=()=>e.getFilteredRowModel(),e.getGroupedRowModel=()=>(!e._getGroupedRowModel&&e.options.getGroupedRowModel&&(e._getGroupedRowModel=e.options.getGroupedRowModel(e)),e.options.manualGrouping||!e._getGroupedRowModel?e.getPreGroupedRowModel():e._getGroupedRowModel())},createRow:(e,t)=>{e.getIsGrouped=()=>!!e.groupingColumnId,e.getGroupingValue=n=>{if(e._groupingValuesCache.hasOwnProperty(n))return e._groupingValuesCache[n];const s=t.getColumn(n);return s!=null&&s.columnDef.getGroupingValue?(e._groupingValuesCache[n]=s.columnDef.getGroupingValue(e.original),e._groupingValuesCache[n]):e.getValue(n)},e._groupingValuesCache={}},createCell:(e,t,n,s)=>{e.getIsGrouped=()=>t.getIsGrouped()&&t.id===n.groupingColumnId,e.getIsPlaceholder=()=>!e.getIsGrouped()&&t.getIsGrouped(),e.getIsAggregated=()=>{var o;return!e.getIsGrouped()&&!e.getIsPlaceholder()&&!!((o=n.subRows)!=null&&o.length)}}};function tl(e,t,n){if(!(t!=null&&t.length)||!n)return e;const s=e.filter(o=>!t.includes(o.id));return n==="remove"?s:[...t.map(o=>e.find(r=>r.id===o)).filter(Boolean),...s]}const nl={getInitialState:e=>({columnOrder:[],...e}),getDefaultOptions:e=>({onColumnOrderChange:ve("columnOrder",e)}),createColumn:(e,t)=>{e.getIndex=D(n=>[_t(t,n)],n=>n.findIndex(s=>s.id===e.id),L(t.options,"debugColumns")),e.getIsFirstColumn=n=>{var s;return((s=_t(t,n)[0])==null?void 0:s.id)===e.id},e.getIsLastColumn=n=>{var s;const o=_t(t,n);return((s=o[o.length-1])==null?void 0:s.id)===e.id}},createTable:e=>{e.setColumnOrder=t=>e.options.onColumnOrderChange==null?void 0:e.options.onColumnOrderChange(t),e.resetColumnOrder=t=>{var n;e.setColumnOrder(t?[]:(n=e.initialState.columnOrder)!=null?n:[])},e._getOrderColumnsFn=D(()=>[e.getState().columnOrder,e.getState().grouping,e.options.groupedColumnMode],(t,n,s)=>o=>{let r=[];if(!(t!=null&&t.length))r=o;else{const a=[...t],i=[...o];for(;i.length&&a.length;){const l=a.shift(),c=i.findIndex(f=>f.id===l);c>-1&&r.push(i.splice(c,1)[0])}r=[...r,...i]}return tl(r,n,s)},L(e.options,"debugTable"))}},Dn=()=>({left:[],right:[]}),sl={getInitialState:e=>({columnPinning:Dn(),...e}),getDefaultOptions:e=>({onColumnPinningChange:ve("columnPinning",e)}),createColumn:(e,t)=>{e.pin=n=>{const s=e.getLeafColumns().map(o=>o.id).filter(Boolean);t.setColumnPinning(o=>{var r,a;if(n==="right"){var i,l;return{left:((i=o==null?void 0:o.left)!=null?i:[]).filter(p=>!(s!=null&&s.includes(p))),right:[...((l=o==null?void 0:o.right)!=null?l:[]).filter(p=>!(s!=null&&s.includes(p))),...s]}}if(n==="left"){var c,f;return{left:[...((c=o==null?void 0:o.left)!=null?c:[]).filter(p=>!(s!=null&&s.includes(p))),...s],right:((f=o==null?void 0:o.right)!=null?f:[]).filter(p=>!(s!=null&&s.includes(p)))}}return{left:((r=o==null?void 0:o.left)!=null?r:[]).filter(p=>!(s!=null&&s.includes(p))),right:((a=o==null?void 0:o.right)!=null?a:[]).filter(p=>!(s!=null&&s.includes(p)))}})},e.getCanPin=()=>e.getLeafColumns().some(n=>{var s,o,r;return((s=n.columnDef.enablePinning)!=null?s:!0)&&((o=(r=t.options.enableColumnPinning)!=null?r:t.options.enablePinning)!=null?o:!0)}),e.getIsPinned=()=>{const n=e.getLeafColumns().map(i=>i.id),{left:s,right:o}=t.getState().columnPinning,r=n.some(i=>s==null?void 0:s.includes(i)),a=n.some(i=>o==null?void 0:o.includes(i));return r?"left":a?"right":!1},e.getPinnedIndex=()=>{var n,s;const o=e.getIsPinned();return o?(n=(s=t.getState().columnPinning)==null||(s=s[o])==null?void 0:s.indexOf(e.id))!=null?n:-1:0}},createRow:(e,t)=>{e.getCenterVisibleCells=D(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left,t.getState().columnPinning.right],(n,s,o)=>{const r=[...s??[],...o??[]];return n.filter(a=>!r.includes(a.column.id))},L(t.options,"debugRows")),e.getLeftVisibleCells=D(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left],(n,s)=>(s??[]).map(o=>n.find(r=>r.column.id===o)).filter(Boolean).map(o=>({...o,position:"left"})),L(t.options,"debugRows")),e.getRightVisibleCells=D(()=>[e._getAllVisibleCells(),t.getState().columnPinning.right],(n,s)=>(s??[]).map(o=>n.find(r=>r.column.id===o)).filter(Boolean).map(o=>({...o,position:"right"})),L(t.options,"debugRows"))},createTable:e=>{e.setColumnPinning=t=>e.options.onColumnPinningChange==null?void 0:e.options.onColumnPinningChange(t),e.resetColumnPinning=t=>{var n,s;return e.setColumnPinning(t?Dn():(n=(s=e.initialState)==null?void 0:s.columnPinning)!=null?n:Dn())},e.getIsSomeColumnsPinned=t=>{var n;const s=e.getState().columnPinning;if(!t){var o,r;return!!((o=s.left)!=null&&o.length||(r=s.right)!=null&&r.length)}return!!((n=s[t])!=null&&n.length)},e.getLeftLeafColumns=D(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left],(t,n)=>(n??[]).map(s=>t.find(o=>o.id===s)).filter(Boolean),L(e.options,"debugColumns")),e.getRightLeafColumns=D(()=>[e.getAllLeafColumns(),e.getState().columnPinning.right],(t,n)=>(n??[]).map(s=>t.find(o=>o.id===s)).filter(Boolean),L(e.options,"debugColumns")),e.getCenterLeafColumns=D(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,n,s)=>{const o=[...n??[],...s??[]];return t.filter(r=>!o.includes(r.id))},L(e.options,"debugColumns"))}};function ol(e){return e||(typeof document<"u"?document:null)}const Dt={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},Ln=()=>({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),rl={getDefaultColumnDef:()=>Dt,getInitialState:e=>({columnSizing:{},columnSizingInfo:Ln(),...e}),getDefaultOptions:e=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:ve("columnSizing",e),onColumnSizingInfoChange:ve("columnSizingInfo",e)}),createColumn:(e,t)=>{e.getSize=()=>{var n,s,o;const r=t.getState().columnSizing[e.id];return Math.min(Math.max((n=e.columnDef.minSize)!=null?n:Dt.minSize,(s=r??e.columnDef.size)!=null?s:Dt.size),(o=e.columnDef.maxSize)!=null?o:Dt.maxSize)},e.getStart=D(n=>[n,_t(t,n),t.getState().columnSizing],(n,s)=>s.slice(0,e.getIndex(n)).reduce((o,r)=>o+r.getSize(),0),L(t.options,"debugColumns")),e.getAfter=D(n=>[n,_t(t,n),t.getState().columnSizing],(n,s)=>s.slice(e.getIndex(n)+1).reduce((o,r)=>o+r.getSize(),0),L(t.options,"debugColumns")),e.resetSize=()=>{t.setColumnSizing(n=>{let{[e.id]:s,...o}=n;return o})},e.getCanResize=()=>{var n,s;return((n=e.columnDef.enableResizing)!=null?n:!0)&&((s=t.options.enableColumnResizing)!=null?s:!0)},e.getIsResizing=()=>t.getState().columnSizingInfo.isResizingColumn===e.id},createHeader:(e,t)=>{e.getSize=()=>{let n=0;const s=o=>{if(o.subHeaders.length)o.subHeaders.forEach(s);else{var r;n+=(r=o.column.getSize())!=null?r:0}};return s(e),n},e.getStart=()=>{if(e.index>0){const n=e.headerGroup.headers[e.index-1];return n.getStart()+n.getSize()}return 0},e.getResizeHandler=n=>{const s=t.getColumn(e.column.id),o=s==null?void 0:s.getCanResize();return r=>{if(!s||!o||(r.persist==null||r.persist(),Tn(r)&&r.touches&&r.touches.length>1))return;const a=e.getSize(),i=e?e.getLeafHeaders().map(x=>[x.column.id,x.column.getSize()]):[[s.id,s.getSize()]],l=Tn(r)?Math.round(r.touches[0].clientX):r.clientX,c={},f=(x,S)=>{typeof S=="number"&&(t.setColumnSizingInfo(C=>{var F,z;const B=t.options.columnResizeDirection==="rtl"?-1:1,X=(S-((F=C==null?void 0:C.startOffset)!=null?F:0))*B,G=Math.max(X/((z=C==null?void 0:C.startSize)!=null?z:0),-.999999);return C.columnSizingStart.forEach(de=>{let[q,ae]=de;c[q]=Math.round(Math.max(ae+ae*G,0)*100)/100}),{...C,deltaOffset:X,deltaPercentage:G}}),(t.options.columnResizeMode==="onChange"||x==="end")&&t.setColumnSizing(C=>({...C,...c})))},p=x=>f("move",x),h=x=>{f("end",x),t.setColumnSizingInfo(S=>({...S,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},u=ol(n),d={moveHandler:x=>p(x.clientX),upHandler:x=>{u==null||u.removeEventListener("mousemove",d.moveHandler),u==null||u.removeEventListener("mouseup",d.upHandler),h(x.clientX)}},m={moveHandler:x=>(x.cancelable&&(x.preventDefault(),x.stopPropagation()),p(x.touches[0].clientX),!1),upHandler:x=>{var S;u==null||u.removeEventListener("touchmove",m.moveHandler),u==null||u.removeEventListener("touchend",m.upHandler),x.cancelable&&(x.preventDefault(),x.stopPropagation()),h((S=x.touches[0])==null?void 0:S.clientX)}},y=al()?{passive:!1}:!1;Tn(r)?(u==null||u.addEventListener("touchmove",m.moveHandler,y),u==null||u.addEventListener("touchend",m.upHandler,y)):(u==null||u.addEventListener("mousemove",d.moveHandler,y),u==null||u.addEventListener("mouseup",d.upHandler,y)),t.setColumnSizingInfo(x=>({...x,startOffset:l,startSize:a,deltaOffset:0,deltaPercentage:0,columnSizingStart:i,isResizingColumn:s.id}))}}},createTable:e=>{e.setColumnSizing=t=>e.options.onColumnSizingChange==null?void 0:e.options.onColumnSizingChange(t),e.setColumnSizingInfo=t=>e.options.onColumnSizingInfoChange==null?void 0:e.options.onColumnSizingInfoChange(t),e.resetColumnSizing=t=>{var n;e.setColumnSizing(t?{}:(n=e.initialState.columnSizing)!=null?n:{})},e.resetHeaderSizeInfo=t=>{var n;e.setColumnSizingInfo(t?Ln():(n=e.initialState.columnSizingInfo)!=null?n:Ln())},e.getTotalSize=()=>{var t,n;return(t=(n=e.getHeaderGroups()[0])==null?void 0:n.headers.reduce((s,o)=>s+o.getSize(),0))!=null?t:0},e.getLeftTotalSize=()=>{var t,n;return(t=(n=e.getLeftHeaderGroups()[0])==null?void 0:n.headers.reduce((s,o)=>s+o.getSize(),0))!=null?t:0},e.getCenterTotalSize=()=>{var t,n;return(t=(n=e.getCenterHeaderGroups()[0])==null?void 0:n.headers.reduce((s,o)=>s+o.getSize(),0))!=null?t:0},e.getRightTotalSize=()=>{var t,n;return(t=(n=e.getRightHeaderGroups()[0])==null?void 0:n.headers.reduce((s,o)=>s+o.getSize(),0))!=null?t:0}}};let Lt=null;function al(){if(typeof Lt=="boolean")return Lt;let e=!1;try{const t={get passive(){return e=!0,!1}},n=()=>{};window.addEventListener("test",n,t),window.removeEventListener("test",n)}catch{e=!1}return Lt=e,Lt}function Tn(e){return e.type==="touchstart"}const il={getInitialState:e=>({columnVisibility:{},...e}),getDefaultOptions:e=>({onColumnVisibilityChange:ve("columnVisibility",e)}),createColumn:(e,t)=>{e.toggleVisibility=n=>{e.getCanHide()&&t.setColumnVisibility(s=>({...s,[e.id]:n??!e.getIsVisible()}))},e.getIsVisible=()=>{var n,s;const o=e.columns;return(n=o.length?o.some(r=>r.getIsVisible()):(s=t.getState().columnVisibility)==null?void 0:s[e.id])!=null?n:!0},e.getCanHide=()=>{var n,s;return((n=e.columnDef.enableHiding)!=null?n:!0)&&((s=t.options.enableHiding)!=null?s:!0)},e.getToggleVisibilityHandler=()=>n=>{e.toggleVisibility==null||e.toggleVisibility(n.target.checked)}},createRow:(e,t)=>{e._getAllVisibleCells=D(()=>[e.getAllCells(),t.getState().columnVisibility],n=>n.filter(s=>s.column.getIsVisible()),L(t.options,"debugRows")),e.getVisibleCells=D(()=>[e.getLeftVisibleCells(),e.getCenterVisibleCells(),e.getRightVisibleCells()],(n,s,o)=>[...n,...s,...o],L(t.options,"debugRows"))},createTable:e=>{const t=(n,s)=>D(()=>[s(),s().filter(o=>o.getIsVisible()).map(o=>o.id).join("_")],o=>o.filter(r=>r.getIsVisible==null?void 0:r.getIsVisible()),L(e.options,"debugColumns"));e.getVisibleFlatColumns=t("getVisibleFlatColumns",()=>e.getAllFlatColumns()),e.getVisibleLeafColumns=t("getVisibleLeafColumns",()=>e.getAllLeafColumns()),e.getLeftVisibleLeafColumns=t("getLeftVisibleLeafColumns",()=>e.getLeftLeafColumns()),e.getRightVisibleLeafColumns=t("getRightVisibleLeafColumns",()=>e.getRightLeafColumns()),e.getCenterVisibleLeafColumns=t("getCenterVisibleLeafColumns",()=>e.getCenterLeafColumns()),e.setColumnVisibility=n=>e.options.onColumnVisibilityChange==null?void 0:e.options.onColumnVisibilityChange(n),e.resetColumnVisibility=n=>{var s;e.setColumnVisibility(n?{}:(s=e.initialState.columnVisibility)!=null?s:{})},e.toggleAllColumnsVisible=n=>{var s;n=(s=n)!=null?s:!e.getIsAllColumnsVisible(),e.setColumnVisibility(e.getAllLeafColumns().reduce((o,r)=>({...o,[r.id]:n||!(r.getCanHide!=null&&r.getCanHide())}),{}))},e.getIsAllColumnsVisible=()=>!e.getAllLeafColumns().some(n=>!(n.getIsVisible!=null&&n.getIsVisible())),e.getIsSomeColumnsVisible=()=>e.getAllLeafColumns().some(n=>n.getIsVisible==null?void 0:n.getIsVisible()),e.getToggleAllColumnsVisibilityHandler=()=>n=>{var s;e.toggleAllColumnsVisible((s=n.target)==null?void 0:s.checked)}}};function _t(e,t){return t?t==="center"?e.getCenterVisibleLeafColumns():t==="left"?e.getLeftVisibleLeafColumns():e.getRightVisibleLeafColumns():e.getVisibleLeafColumns()}const ll={createTable:e=>{e._getGlobalFacetedRowModel=e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,"__global__"),e.getGlobalFacetedRowModel=()=>e.options.manualFiltering||!e._getGlobalFacetedRowModel?e.getPreFilteredRowModel():e._getGlobalFacetedRowModel(),e._getGlobalFacetedUniqueValues=e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,"__global__"),e.getGlobalFacetedUniqueValues=()=>e._getGlobalFacetedUniqueValues?e._getGlobalFacetedUniqueValues():new Map,e._getGlobalFacetedMinMaxValues=e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,"__global__"),e.getGlobalFacetedMinMaxValues=()=>{if(e._getGlobalFacetedMinMaxValues)return e._getGlobalFacetedMinMaxValues()}}},ul={getInitialState:e=>({globalFilter:void 0,...e}),getDefaultOptions:e=>({onGlobalFilterChange:ve("globalFilter",e),globalFilterFn:"auto",getColumnCanGlobalFilter:t=>{var n;const s=(n=e.getCoreRowModel().flatRows[0])==null||(n=n._getAllCellsByColumnId()[t.id])==null?void 0:n.getValue();return typeof s=="string"||typeof s=="number"}}),createColumn:(e,t)=>{e.getCanGlobalFilter=()=>{var n,s,o,r;return((n=e.columnDef.enableGlobalFilter)!=null?n:!0)&&((s=t.options.enableGlobalFilter)!=null?s:!0)&&((o=t.options.enableFilters)!=null?o:!0)&&((r=t.options.getColumnCanGlobalFilter==null?void 0:t.options.getColumnCanGlobalFilter(e))!=null?r:!0)&&!!e.accessorFn}},createTable:e=>{e.getGlobalAutoFilterFn=()=>je.includesString,e.getGlobalFilterFn=()=>{var t,n;const{globalFilterFn:s}=e.options;return vn(s)?s:s==="auto"?e.getGlobalAutoFilterFn():(t=(n=e.options.filterFns)==null?void 0:n[s])!=null?t:je[s]},e.setGlobalFilter=t=>{e.options.onGlobalFilterChange==null||e.options.onGlobalFilterChange(t)},e.resetGlobalFilter=t=>{e.setGlobalFilter(t?void 0:e.initialState.globalFilter)}}},cl={getInitialState:e=>({expanded:{},...e}),getDefaultOptions:e=>({onExpandedChange:ve("expanded",e),paginateExpandedRows:!0}),createTable:e=>{let t=!1,n=!1;e._autoResetExpanded=()=>{var s,o;if(!t){e._queue(()=>{t=!0});return}if((s=(o=e.options.autoResetAll)!=null?o:e.options.autoResetExpanded)!=null?s:!e.options.manualExpanding){if(n)return;n=!0,e._queue(()=>{e.resetExpanded(),n=!1})}},e.setExpanded=s=>e.options.onExpandedChange==null?void 0:e.options.onExpandedChange(s),e.toggleAllRowsExpanded=s=>{s??!e.getIsAllRowsExpanded()?e.setExpanded(!0):e.setExpanded({})},e.resetExpanded=s=>{var o,r;e.setExpanded(s?{}:(o=(r=e.initialState)==null?void 0:r.expanded)!=null?o:{})},e.getCanSomeRowsExpand=()=>e.getPrePaginationRowModel().flatRows.some(s=>s.getCanExpand()),e.getToggleAllRowsExpandedHandler=()=>s=>{s.persist==null||s.persist(),e.toggleAllRowsExpanded()},e.getIsSomeRowsExpanded=()=>{const s=e.getState().expanded;return s===!0||Object.values(s).some(Boolean)},e.getIsAllRowsExpanded=()=>{const s=e.getState().expanded;return typeof s=="boolean"?s===!0:!(!Object.keys(s).length||e.getRowModel().flatRows.some(o=>!o.getIsExpanded()))},e.getExpandedDepth=()=>{let s=0;return(e.getState().expanded===!0?Object.keys(e.getRowModel().rowsById):Object.keys(e.getState().expanded)).forEach(o=>{const r=o.split(".");s=Math.max(s,r.length)}),s},e.getPreExpandedRowModel=()=>e.getSortedRowModel(),e.getExpandedRowModel=()=>(!e._getExpandedRowModel&&e.options.getExpandedRowModel&&(e._getExpandedRowModel=e.options.getExpandedRowModel(e)),e.options.manualExpanding||!e._getExpandedRowModel?e.getPreExpandedRowModel():e._getExpandedRowModel())},createRow:(e,t)=>{e.toggleExpanded=n=>{t.setExpanded(s=>{var o;const r=s===!0?!0:!!(s!=null&&s[e.id]);let a={};if(s===!0?Object.keys(t.getRowModel().rowsById).forEach(i=>{a[i]=!0}):a=s,n=(o=n)!=null?o:!r,!r&&n)return{...a,[e.id]:!0};if(r&&!n){const{[e.id]:i,...l}=a;return l}return s})},e.getIsExpanded=()=>{var n;const s=t.getState().expanded;return!!((n=t.options.getIsRowExpanded==null?void 0:t.options.getIsRowExpanded(e))!=null?n:s===!0||s!=null&&s[e.id])},e.getCanExpand=()=>{var n,s,o;return(n=t.options.getRowCanExpand==null?void 0:t.options.getRowCanExpand(e))!=null?n:((s=t.options.enableExpanding)!=null?s:!0)&&!!((o=e.subRows)!=null&&o.length)},e.getIsAllParentsExpanded=()=>{let n=!0,s=e;for(;n&&s.parentId;)s=t.getRow(s.parentId,!0),n=s.getIsExpanded();return n},e.getToggleExpandedHandler=()=>{const n=e.getCanExpand();return()=>{n&&e.toggleExpanded()}}}},es=0,ts=10,jn=()=>({pageIndex:es,pageSize:ts}),dl={getInitialState:e=>({...e,pagination:{...jn(),...e==null?void 0:e.pagination}}),getDefaultOptions:e=>({onPaginationChange:ve("pagination",e)}),createTable:e=>{let t=!1,n=!1;e._autoResetPageIndex=()=>{var s,o;if(!t){e._queue(()=>{t=!0});return}if((s=(o=e.options.autoResetAll)!=null?o:e.options.autoResetPageIndex)!=null?s:!e.options.manualPagination){if(n)return;n=!0,e._queue(()=>{e.resetPageIndex(),n=!1})}},e.setPagination=s=>{const o=r=>qe(s,r);return e.options.onPaginationChange==null?void 0:e.options.onPaginationChange(o)},e.resetPagination=s=>{var o;e.setPagination(s?jn():(o=e.initialState.pagination)!=null?o:jn())},e.setPageIndex=s=>{e.setPagination(o=>{let r=qe(s,o.pageIndex);const a=typeof e.options.pageCount>"u"||e.options.pageCount===-1?Number.MAX_SAFE_INTEGER:e.options.pageCount-1;return r=Math.max(0,Math.min(r,a)),{...o,pageIndex:r}})},e.resetPageIndex=s=>{var o,r;e.setPageIndex(s?es:(o=(r=e.initialState)==null||(r=r.pagination)==null?void 0:r.pageIndex)!=null?o:es)},e.resetPageSize=s=>{var o,r;e.setPageSize(s?ts:(o=(r=e.initialState)==null||(r=r.pagination)==null?void 0:r.pageSize)!=null?o:ts)},e.setPageSize=s=>{e.setPagination(o=>{const r=Math.max(1,qe(s,o.pageSize)),a=o.pageSize*o.pageIndex,i=Math.floor(a/r);return{...o,pageIndex:i,pageSize:r}})},e.setPageCount=s=>e.setPagination(o=>{var r;let a=qe(s,(r=e.options.pageCount)!=null?r:-1);return typeof a=="number"&&(a=Math.max(-1,a)),{...o,pageCount:a}}),e.getPageOptions=D(()=>[e.getPageCount()],s=>{let o=[];return s&&s>0&&(o=[...new Array(s)].fill(null).map((r,a)=>a)),o},L(e.options,"debugTable")),e.getCanPreviousPage=()=>e.getState().pagination.pageIndex>0,e.getCanNextPage=()=>{const{pageIndex:s}=e.getState().pagination,o=e.getPageCount();return o===-1?!0:o===0?!1:s<o-1},e.previousPage=()=>e.setPageIndex(s=>s-1),e.nextPage=()=>e.setPageIndex(s=>s+1),e.firstPage=()=>e.setPageIndex(0),e.lastPage=()=>e.setPageIndex(e.getPageCount()-1),e.getPrePaginationRowModel=()=>e.getExpandedRowModel(),e.getPaginationRowModel=()=>(!e._getPaginationRowModel&&e.options.getPaginationRowModel&&(e._getPaginationRowModel=e.options.getPaginationRowModel(e)),e.options.manualPagination||!e._getPaginationRowModel?e.getPrePaginationRowModel():e._getPaginationRowModel()),e.getPageCount=()=>{var s;return(s=e.options.pageCount)!=null?s:Math.ceil(e.getRowCount()/e.getState().pagination.pageSize)},e.getRowCount=()=>{var s;return(s=e.options.rowCount)!=null?s:e.getPrePaginationRowModel().rows.length}}},qn=()=>({top:[],bottom:[]}),hl={getInitialState:e=>({rowPinning:qn(),...e}),getDefaultOptions:e=>({onRowPinningChange:ve("rowPinning",e)}),createRow:(e,t)=>{e.pin=(n,s,o)=>{const r=s?e.getLeafRows().map(l=>{let{id:c}=l;return c}):[],a=o?e.getParentRows().map(l=>{let{id:c}=l;return c}):[],i=new Set([...a,e.id,...r]);t.setRowPinning(l=>{var c,f;if(n==="bottom"){var p,h;return{top:((p=l==null?void 0:l.top)!=null?p:[]).filter(m=>!(i!=null&&i.has(m))),bottom:[...((h=l==null?void 0:l.bottom)!=null?h:[]).filter(m=>!(i!=null&&i.has(m))),...Array.from(i)]}}if(n==="top"){var u,d;return{top:[...((u=l==null?void 0:l.top)!=null?u:[]).filter(m=>!(i!=null&&i.has(m))),...Array.from(i)],bottom:((d=l==null?void 0:l.bottom)!=null?d:[]).filter(m=>!(i!=null&&i.has(m)))}}return{top:((c=l==null?void 0:l.top)!=null?c:[]).filter(m=>!(i!=null&&i.has(m))),bottom:((f=l==null?void 0:l.bottom)!=null?f:[]).filter(m=>!(i!=null&&i.has(m)))}})},e.getCanPin=()=>{var n;const{enableRowPinning:s,enablePinning:o}=t.options;return typeof s=="function"?s(e):(n=s??o)!=null?n:!0},e.getIsPinned=()=>{const n=[e.id],{top:s,bottom:o}=t.getState().rowPinning,r=n.some(i=>s==null?void 0:s.includes(i)),a=n.some(i=>o==null?void 0:o.includes(i));return r?"top":a?"bottom":!1},e.getPinnedIndex=()=>{var n,s;const o=e.getIsPinned();if(!o)return-1;const r=(n=o==="top"?t.getTopRows():t.getBottomRows())==null?void 0:n.map(a=>{let{id:i}=a;return i});return(s=r==null?void 0:r.indexOf(e.id))!=null?s:-1}},createTable:e=>{e.setRowPinning=t=>e.options.onRowPinningChange==null?void 0:e.options.onRowPinningChange(t),e.resetRowPinning=t=>{var n,s;return e.setRowPinning(t?qn():(n=(s=e.initialState)==null?void 0:s.rowPinning)!=null?n:qn())},e.getIsSomeRowsPinned=t=>{var n;const s=e.getState().rowPinning;if(!t){var o,r;return!!((o=s.top)!=null&&o.length||(r=s.bottom)!=null&&r.length)}return!!((n=s[t])!=null&&n.length)},e._getPinnedRows=(t,n,s)=>{var o;return((o=e.options.keepPinnedRows)==null||o?(n??[]).map(r=>{const a=e.getRow(r,!0);return a.getIsAllParentsExpanded()?a:null}):(n??[]).map(r=>t.find(a=>a.id===r))).filter(Boolean).map(r=>({...r,position:s}))},e.getTopRows=D(()=>[e.getRowModel().rows,e.getState().rowPinning.top],(t,n)=>e._getPinnedRows(t,n,"top"),L(e.options,"debugRows")),e.getBottomRows=D(()=>[e.getRowModel().rows,e.getState().rowPinning.bottom],(t,n)=>e._getPinnedRows(t,n,"bottom"),L(e.options,"debugRows")),e.getCenterRows=D(()=>[e.getRowModel().rows,e.getState().rowPinning.top,e.getState().rowPinning.bottom],(t,n,s)=>{const o=new Set([...n??[],...s??[]]);return t.filter(r=>!o.has(r.id))},L(e.options,"debugRows"))}},pl={getInitialState:e=>({rowSelection:{},...e}),getDefaultOptions:e=>({onRowSelectionChange:ve("rowSelection",e),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:e=>{e.setRowSelection=t=>e.options.onRowSelectionChange==null?void 0:e.options.onRowSelectionChange(t),e.resetRowSelection=t=>{var n;return e.setRowSelection(t?{}:(n=e.initialState.rowSelection)!=null?n:{})},e.toggleAllRowsSelected=t=>{e.setRowSelection(n=>{t=typeof t<"u"?t:!e.getIsAllRowsSelected();const s={...n},o=e.getPreGroupedRowModel().flatRows;return t?o.forEach(r=>{r.getCanSelect()&&(s[r.id]=!0)}):o.forEach(r=>{delete s[r.id]}),s})},e.toggleAllPageRowsSelected=t=>e.setRowSelection(n=>{const s=typeof t<"u"?t:!e.getIsAllPageRowsSelected(),o={...n};return e.getRowModel().rows.forEach(r=>{ns(o,r.id,s,!0,e)}),o}),e.getPreSelectedRowModel=()=>e.getCoreRowModel(),e.getSelectedRowModel=D(()=>[e.getState().rowSelection,e.getCoreRowModel()],(t,n)=>Object.keys(t).length?Nn(e,n):{rows:[],flatRows:[],rowsById:{}},L(e.options,"debugTable")),e.getFilteredSelectedRowModel=D(()=>[e.getState().rowSelection,e.getFilteredRowModel()],(t,n)=>Object.keys(t).length?Nn(e,n):{rows:[],flatRows:[],rowsById:{}},L(e.options,"debugTable")),e.getGroupedSelectedRowModel=D(()=>[e.getState().rowSelection,e.getSortedRowModel()],(t,n)=>Object.keys(t).length?Nn(e,n):{rows:[],flatRows:[],rowsById:{}},L(e.options,"debugTable")),e.getIsAllRowsSelected=()=>{const t=e.getFilteredRowModel().flatRows,{rowSelection:n}=e.getState();let s=!!(t.length&&Object.keys(n).length);return s&&t.some(o=>o.getCanSelect()&&!n[o.id])&&(s=!1),s},e.getIsAllPageRowsSelected=()=>{const t=e.getPaginationRowModel().flatRows.filter(o=>o.getCanSelect()),{rowSelection:n}=e.getState();let s=!!t.length;return s&&t.some(o=>!n[o.id])&&(s=!1),s},e.getIsSomeRowsSelected=()=>{var t;const n=Object.keys((t=e.getState().rowSelection)!=null?t:{}).length;return n>0&&n<e.getFilteredRowModel().flatRows.length},e.getIsSomePageRowsSelected=()=>{const t=e.getPaginationRowModel().flatRows;return e.getIsAllPageRowsSelected()?!1:t.filter(n=>n.getCanSelect()).some(n=>n.getIsSelected()||n.getIsSomeSelected())},e.getToggleAllRowsSelectedHandler=()=>t=>{e.toggleAllRowsSelected(t.target.checked)},e.getToggleAllPageRowsSelectedHandler=()=>t=>{e.toggleAllPageRowsSelected(t.target.checked)}},createRow:(e,t)=>{e.toggleSelected=(n,s)=>{const o=e.getIsSelected();t.setRowSelection(r=>{var a;if(n=typeof n<"u"?n:!o,e.getCanSelect()&&o===n)return r;const i={...r};return ns(i,e.id,n,(a=s==null?void 0:s.selectChildren)!=null?a:!0,t),i})},e.getIsSelected=()=>{const{rowSelection:n}=t.getState();return vs(e,n)},e.getIsSomeSelected=()=>{const{rowSelection:n}=t.getState();return ss(e,n)==="some"},e.getIsAllSubRowsSelected=()=>{const{rowSelection:n}=t.getState();return ss(e,n)==="all"},e.getCanSelect=()=>{var n;return typeof t.options.enableRowSelection=="function"?t.options.enableRowSelection(e):(n=t.options.enableRowSelection)!=null?n:!0},e.getCanSelectSubRows=()=>{var n;return typeof t.options.enableSubRowSelection=="function"?t.options.enableSubRowSelection(e):(n=t.options.enableSubRowSelection)!=null?n:!0},e.getCanMultiSelect=()=>{var n;return typeof t.options.enableMultiRowSelection=="function"?t.options.enableMultiRowSelection(e):(n=t.options.enableMultiRowSelection)!=null?n:!0},e.getToggleSelectedHandler=()=>{const n=e.getCanSelect();return s=>{var o;n&&e.toggleSelected((o=s.target)==null?void 0:o.checked)}}}},ns=(e,t,n,s,o)=>{var r;const a=o.getRow(t,!0);n?(a.getCanMultiSelect()||Object.keys(e).forEach(i=>delete e[i]),a.getCanSelect()&&(e[t]=!0)):delete e[t],s&&(r=a.subRows)!=null&&r.length&&a.getCanSelectSubRows()&&a.subRows.forEach(i=>ns(e,i.id,n,s,o))};function Nn(e,t){const n=e.getState().rowSelection,s=[],o={},r=function(a,i){return a.map(l=>{var c;const f=vs(l,n);if(f&&(s.push(l),o[l.id]=l),(c=l.subRows)!=null&&c.length&&(l={...l,subRows:r(l.subRows)}),f)return l}).filter(Boolean)};return{rows:r(t.rows),flatRows:s,rowsById:o}}function vs(e,t){var n;return(n=t[e.id])!=null?n:!1}function ss(e,t,n){var s;if(!((s=e.subRows)!=null&&s.length))return!1;let o=!0,r=!1;return e.subRows.forEach(a=>{if(!(r&&!o)&&(a.getCanSelect()&&(vs(a,t)?r=!0:o=!1),a.subRows&&a.subRows.length)){const i=ss(a,t);i==="all"?r=!0:(i==="some"&&(r=!0),o=!1)}}),o?"all":r?"some":!1}const os=/([0-9]+)/gm,fl=(e,t,n)=>Qo(Ne(e.getValue(n)).toLowerCase(),Ne(t.getValue(n)).toLowerCase()),gl=(e,t,n)=>Qo(Ne(e.getValue(n)),Ne(t.getValue(n))),ml=(e,t,n)=>_s(Ne(e.getValue(n)).toLowerCase(),Ne(t.getValue(n)).toLowerCase()),yl=(e,t,n)=>_s(Ne(e.getValue(n)),Ne(t.getValue(n))),bl=(e,t,n)=>{const s=e.getValue(n),o=t.getValue(n);return s>o?1:s<o?-1:0},wl=(e,t,n)=>_s(e.getValue(n),t.getValue(n));function _s(e,t){return e===t?0:e>t?1:-1}function Ne(e){return typeof e=="number"?isNaN(e)||e===1/0||e===-1/0?"":String(e):typeof e=="string"?e:""}function Qo(e,t){const n=e.split(os).filter(Boolean),s=t.split(os).filter(Boolean);for(;n.length&&s.length;){const o=n.shift(),r=s.shift(),a=parseInt(o,10),i=parseInt(r,10),l=[a,i].sort();if(isNaN(l[0])){if(o>r)return 1;if(r>o)return-1;continue}if(isNaN(l[1]))return isNaN(a)?-1:1;if(a>i)return 1;if(i>a)return-1}return n.length-s.length}const lt={alphanumeric:fl,alphanumericCaseSensitive:gl,text:ml,textCaseSensitive:yl,datetime:bl,basic:wl},vl={getInitialState:e=>({sorting:[],...e}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:e=>({onSortingChange:ve("sorting",e),isMultiSortEvent:t=>t.shiftKey}),createColumn:(e,t)=>{e.getAutoSortingFn=()=>{const n=t.getFilteredRowModel().flatRows.slice(10);let s=!1;for(const o of n){const r=o==null?void 0:o.getValue(e.id);if(Object.prototype.toString.call(r)==="[object Date]")return lt.datetime;if(typeof r=="string"&&(s=!0,r.split(os).length>1))return lt.alphanumeric}return s?lt.text:lt.basic},e.getAutoSortDir=()=>{const n=t.getFilteredRowModel().flatRows[0];return typeof(n==null?void 0:n.getValue(e.id))=="string"?"asc":"desc"},e.getSortingFn=()=>{var n,s;if(!e)throw new Error;return vn(e.columnDef.sortingFn)?e.columnDef.sortingFn:e.columnDef.sortingFn==="auto"?e.getAutoSortingFn():(n=(s=t.options.sortingFns)==null?void 0:s[e.columnDef.sortingFn])!=null?n:lt[e.columnDef.sortingFn]},e.toggleSorting=(n,s)=>{const o=e.getNextSortingOrder(),r=typeof n<"u"&&n!==null;t.setSorting(a=>{const i=a==null?void 0:a.find(u=>u.id===e.id),l=a==null?void 0:a.findIndex(u=>u.id===e.id);let c=[],f,p=r?n:o==="desc";if(a!=null&&a.length&&e.getCanMultiSort()&&s?i?f="toggle":f="add":a!=null&&a.length&&l!==a.length-1?f="replace":i?f="toggle":f="replace",f==="toggle"&&(r||o||(f="remove")),f==="add"){var h;c=[...a,{id:e.id,desc:p}],c.splice(0,c.length-((h=t.options.maxMultiSortColCount)!=null?h:Number.MAX_SAFE_INTEGER))}else f==="toggle"?c=a.map(u=>u.id===e.id?{...u,desc:p}:u):f==="remove"?c=a.filter(u=>u.id!==e.id):c=[{id:e.id,desc:p}];return c})},e.getFirstSortDir=()=>{var n,s;return((n=(s=e.columnDef.sortDescFirst)!=null?s:t.options.sortDescFirst)!=null?n:e.getAutoSortDir()==="desc")?"desc":"asc"},e.getNextSortingOrder=n=>{var s,o;const r=e.getFirstSortDir(),a=e.getIsSorted();return a?a!==r&&((s=t.options.enableSortingRemoval)==null||s)&&(!(n&&(o=t.options.enableMultiRemove)!=null)||o)?!1:a==="desc"?"asc":"desc":r},e.getCanSort=()=>{var n,s;return((n=e.columnDef.enableSorting)!=null?n:!0)&&((s=t.options.enableSorting)!=null?s:!0)&&!!e.accessorFn},e.getCanMultiSort=()=>{var n,s;return(n=(s=e.columnDef.enableMultiSort)!=null?s:t.options.enableMultiSort)!=null?n:!!e.accessorFn},e.getIsSorted=()=>{var n;const s=(n=t.getState().sorting)==null?void 0:n.find(o=>o.id===e.id);return s?s.desc?"desc":"asc":!1},e.getSortIndex=()=>{var n,s;return(n=(s=t.getState().sorting)==null?void 0:s.findIndex(o=>o.id===e.id))!=null?n:-1},e.clearSorting=()=>{t.setSorting(n=>n!=null&&n.length?n.filter(s=>s.id!==e.id):[])},e.getToggleSortingHandler=()=>{const n=e.getCanSort();return s=>{n&&(s.persist==null||s.persist(),e.toggleSorting==null||e.toggleSorting(void 0,e.getCanMultiSort()?t.options.isMultiSortEvent==null?void 0:t.options.isMultiSortEvent(s):!1))}}},createTable:e=>{e.setSorting=t=>e.options.onSortingChange==null?void 0:e.options.onSortingChange(t),e.resetSorting=t=>{var n,s;e.setSorting(t?[]:(n=(s=e.initialState)==null?void 0:s.sorting)!=null?n:[])},e.getPreSortedRowModel=()=>e.getGroupedRowModel(),e.getSortedRowModel=()=>(!e._getSortedRowModel&&e.options.getSortedRowModel&&(e._getSortedRowModel=e.options.getSortedRowModel(e)),e.options.manualSorting||!e._getSortedRowModel?e.getPreSortedRowModel():e._getSortedRowModel())}},_l=[Ni,il,nl,sl,Hi,zi,ll,ul,vl,el,cl,dl,hl,pl,rl];function Sl(e){var t,n;const s=[..._l,...(t=e._features)!=null?t:[]];let o={_features:s};const r=o._features.reduce((p,h)=>Object.assign(p,h.getDefaultOptions==null?void 0:h.getDefaultOptions(o)),{}),a=p=>o.options.mergeOptions?o.options.mergeOptions(r,p):{...r,...p};let i={...(n=e.initialState)!=null?n:{}};o._features.forEach(p=>{var h;i=(h=p.getInitialState==null?void 0:p.getInitialState(i))!=null?h:i});const l=[];let c=!1;const f={_features:s,options:{...r,...e},initialState:i,_queue:p=>{l.push(p),c||(c=!0,Promise.resolve().then(()=>{for(;l.length;)l.shift()();c=!1}).catch(h=>setTimeout(()=>{throw h})))},reset:()=>{o.setState(o.initialState)},setOptions:p=>{const h=qe(p,o.options);o.options=a(h)},getState:()=>o.options.state,setState:p=>{o.options.onStateChange==null||o.options.onStateChange(p)},_getRowId:(p,h,u)=>{var d;return(d=o.options.getRowId==null?void 0:o.options.getRowId(p,h,u))!=null?d:`${u?[u.id,h].join("."):h}`},getCoreRowModel:()=>(o._getCoreRowModel||(o._getCoreRowModel=o.options.getCoreRowModel(o)),o._getCoreRowModel()),getRowModel:()=>o.getPaginationRowModel(),getRow:(p,h)=>{let u=(h?o.getPrePaginationRowModel():o.getRowModel()).rowsById[p];if(!u&&(u=o.getCoreRowModel().rowsById[p],!u))throw new Error;return u},_getDefaultColumnDef:D(()=>[o.options.defaultColumn],p=>{var h;return p=(h=p)!=null?h:{},{header:u=>{const d=u.header.column.columnDef;return d.accessorKey?d.accessorKey:d.accessorFn?d.id:null},cell:u=>{var d,m;return(d=(m=u.renderValue())==null||m.toString==null?void 0:m.toString())!=null?d:null},...o._features.reduce((u,d)=>Object.assign(u,d.getDefaultColumnDef==null?void 0:d.getDefaultColumnDef()),{}),...p}},L(e,"debugColumns")),_getColumnDefs:()=>o.options.columns,getAllColumns:D(()=>[o._getColumnDefs()],p=>{const h=function(u,d,m){return m===void 0&&(m=0),u.map(y=>{const x=qi(o,y,m,d),S=y;return x.columns=S.columns?h(S.columns,x,m+1):[],x})};return h(p)},L(e,"debugColumns")),getAllFlatColumns:D(()=>[o.getAllColumns()],p=>p.flatMap(h=>h.getFlatColumns()),L(e,"debugColumns")),_getAllFlatColumnsById:D(()=>[o.getAllFlatColumns()],p=>p.reduce((h,u)=>(h[u.id]=u,h),{}),L(e,"debugColumns")),getAllLeafColumns:D(()=>[o.getAllColumns(),o._getOrderColumnsFn()],(p,h)=>{let u=p.flatMap(d=>d.getLeafColumns());return h(u)},L(e,"debugColumns")),getColumn:p=>o._getAllFlatColumnsById()[p]};Object.assign(o,f);for(let p=0;p<o._features.length;p++){const h=o._features[p];h==null||h.createTable==null||h.createTable(o)}return o}function xl(){return e=>D(()=>[e.options.data],t=>{const n={rows:[],flatRows:[],rowsById:{}},s=function(o,r,a){r===void 0&&(r=0);const i=[];for(let c=0;c<o.length;c++){const f=Bi(e,e._getRowId(o[c],c,a),o[c],c,r,void 0,a==null?void 0:a.id);if(n.flatRows.push(f),n.rowsById[f.id]=f,i.push(f),e.options.getSubRows){var l;f.originalSubRows=e.options.getSubRows(o[c],c),(l=f.originalSubRows)!=null&&l.length&&(f.subRows=s(f.originalSubRows,r+1,f))}}return i};return n.rows=s(t),n},L(e.options,"debugTable","getRowModel",()=>e._autoResetPageIndex()))}function Tt(){return!0}const Cl=Symbol("merge-proxy"),Rl={get(e,t,n){return t===Cl?n:e.get(t)},has(e,t){return e.has(t)},set:Tt,deleteProperty:Tt,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:Tt,deleteProperty:Tt}},ownKeys(e){return e.keys()}};function Bn(e){return"value"in e?e.value:e}function ct(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Proxy({get(s){for(let o=t.length-1;o>=0;o--){const r=Bn(t[o])[s];if(r!==void 0)return r}},has(s){for(let o=t.length-1;o>=0;o--)if(s in Bn(t[o]))return!0;return!1},keys(){const s=[];for(let o=0;o<t.length;o++)s.push(...Object.keys(Bn(t[o])));return[...Array.from(new Set(s))]}},Rl)}const Hn=Be({props:["render","props"],setup:e=>()=>typeof e.render=="function"||typeof e.render=="object"?me(e.render,e.props):e.render});function ro(e){return ct(e,{data:k(e.data)})}function Il(e){const t=La(e.data),n=ct({state:{},onStateChange:()=>{},renderFallbackValue:null,mergeOptions(r,a){return t?{...r,...a}:ct(r,a)}},t?ro(e):e),s=Sl(n);if(t){const r=Ta(e.data);Do(r,()=>{s.setState(a=>({...a,data:r.value}))},{immediate:!0})}const o=vt(s.initialState);return ja(()=>{s.setOptions(r=>{var a;const i=new Proxy({},{get:(l,c)=>o.value[c]});return ct(r,t?ro(e):e,{state:ct(i,(a=e.state)!=null?a:{}),onStateChange:l=>{l instanceof Function?o.value=l(o.value):o.value=l,e.onStateChange==null||e.onStateChange(l)}})})}),s}function V(e,t,n,s,o){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,n),n}function g(e,t,n,s){if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?s:n==="a"?s.call(e):s?s.value:t.get(e)}let Yo=function(){const{crypto:e}=globalThis;if(e!=null&&e.randomUUID)return Yo=e.randomUUID.bind(e),e.randomUUID();const t=new Uint8Array(1),n=e?()=>e.getRandomValues(t)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,s=>(+s^n()&15>>+s/4).toString(16))};function rs(e){return typeof e=="object"&&e!==null&&("name"in e&&e.name==="AbortError"||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}const as=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null){try{if(Object.prototype.toString.call(e)==="[object Error]"){const t=new Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch{}try{return new Error(JSON.stringify(e))}catch{}}return new Error(e)};class P extends Error{}class ce extends P{constructor(t,n,s,o){super(`${ce.makeMessage(t,n,s)}`),this.status=t,this.headers=o,this.requestID=o==null?void 0:o.get("x-request-id"),this.error=n;const r=n;this.code=r==null?void 0:r.code,this.param=r==null?void 0:r.param,this.type=r==null?void 0:r.type}static makeMessage(t,n,s){const o=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):s;return t&&o?`${t} ${o}`:t?`${t} status code (no body)`:o||"(no status code or body)"}static generate(t,n,s,o){if(!t||!o)return new _n({message:s,cause:as(n)});const r=n==null?void 0:n.error;return t===400?new Zo(t,r,s,o):t===401?new er(t,r,s,o):t===403?new tr(t,r,s,o):t===404?new nr(t,r,s,o):t===409?new sr(t,r,s,o):t===422?new or(t,r,s,o):t===429?new rr(t,r,s,o):t>=500?new ar(t,r,s,o):new ce(t,r,s,o)}}class _e extends ce{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class _n extends ce{constructor({message:t,cause:n}){super(void 0,void 0,t||"Connection error.",void 0),n&&(this.cause=n)}}class Ss extends _n{constructor({message:t}={}){super({message:t??"Request timed out."})}}class Zo extends ce{}class er extends ce{}class tr extends ce{}class nr extends ce{}class sr extends ce{}class or extends ce{}class rr extends ce{}class ar extends ce{}class ir extends P{constructor(){super("Could not parse response content as the length limit was reached")}}class lr extends P{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class dt extends Error{constructor(t){super(t)}}const kl=/^[a-z][a-z0-9+.-]*:/i,Al=e=>kl.test(e);let fe=e=>(fe=Array.isArray,fe(e)),ao=fe;function ur(e){return typeof e!="object"?{}:e??{}}function Ml(e){if(!e)return!0;for(const t in e)return!1;return!0}function Pl(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function zn(e){return e!=null&&typeof e=="object"&&!Array.isArray(e)}const Ol=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new P(`${e} must be an integer`);if(t<0)throw new P(`${e} must be a positive integer`);return t},$l=e=>{try{return JSON.parse(e)}catch{return}},Mt=e=>new Promise(t=>setTimeout(t,e)),tt="6.9.1",Fl=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function El(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const Vl=()=>{var n;const e=El();if(e==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":tt,"X-Stainless-OS":lo(Deno.build.os),"X-Stainless-Arch":io(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((n=Deno.version)==null?void 0:n.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":tt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(e==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":tt,"X-Stainless-OS":lo(globalThis.process.platform??"unknown"),"X-Stainless-Arch":io(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const t=Dl();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":tt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":tt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Dl(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const s=n.exec(navigator.userAgent);if(s){const o=s[1]||0,r=s[2]||0,a=s[3]||0;return{browser:t,version:`${o}.${r}.${a}`}}}return null}const io=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",lo=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let uo;const Ll=()=>uo??(uo=Vl());function Tl(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function cr(...e){const t=globalThis.ReadableStream;if(typeof t>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e)}function dr(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return cr({start(){},async pull(n){const{done:s,value:o}=await t.next();s?n.close():n.enqueue(o)},async cancel(){var n;await((n=t.return)==null?void 0:n.call(t))}})}function hr(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const n=await t.read();return n!=null&&n.done&&t.releaseLock(),n}catch(n){throw t.releaseLock(),n}},async return(){const n=t.cancel();return t.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function jl(e){var s,o;if(e===null||typeof e!="object")return;if(e[Symbol.asyncIterator]){await((o=(s=e[Symbol.asyncIterator]()).return)==null?void 0:o.call(s));return}const t=e.getReader(),n=t.cancel();t.releaseLock(),await n}const ql=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)}),pr="RFC3986",fr=e=>String(e),co={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:fr},Nl="RFC1738";let is=(e,t)=>(is=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),is(e,t));const Ie=(()=>{const e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})(),Un=1024,Bl=(e,t,n,s,o)=>{if(e.length===0)return e;let r=e;if(typeof e=="symbol"?r=Symbol.prototype.toString.call(e):typeof e!="string"&&(r=String(e)),n==="iso-8859-1")return escape(r).replace(/%u[0-9a-f]{4}/gi,function(i){return"%26%23"+parseInt(i.slice(2),16)+"%3B"});let a="";for(let i=0;i<r.length;i+=Un){const l=r.length>=Un?r.slice(i,i+Un):r,c=[];for(let f=0;f<l.length;++f){let p=l.charCodeAt(f);if(p===45||p===46||p===95||p===126||p>=48&&p<=57||p>=65&&p<=90||p>=97&&p<=122||o===Nl&&(p===40||p===41)){c[c.length]=l.charAt(f);continue}if(p<128){c[c.length]=Ie[p];continue}if(p<2048){c[c.length]=Ie[192|p>>6]+Ie[128|p&63];continue}if(p<55296||p>=57344){c[c.length]=Ie[224|p>>12]+Ie[128|p>>6&63]+Ie[128|p&63];continue}f+=1,p=65536+((p&1023)<<10|l.charCodeAt(f)&1023),c[c.length]=Ie[240|p>>18]+Ie[128|p>>12&63]+Ie[128|p>>6&63]+Ie[128|p&63]}a+=c.join("")}return a};function Hl(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}function ho(e,t){if(fe(e)){const n=[];for(let s=0;s<e.length;s+=1)n.push(t(e[s]));return n}return t(e)}const gr={brackets(e){return String(e)+"[]"},comma:"comma",indices(e,t){return String(e)+"["+t+"]"},repeat(e){return String(e)}},mr=function(e,t){Array.prototype.push.apply(e,fe(t)?t:[t])};let po;const ne={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Bl,encodeValuesOnly:!1,format:pr,formatter:fr,indices:!1,serializeDate(e){return(po??(po=Function.prototype.call.bind(Date.prototype.toISOString)))(e)},skipNulls:!1,strictNullHandling:!1};function zl(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"}const Gn={};function yr(e,t,n,s,o,r,a,i,l,c,f,p,h,u,d,m,y,x){let S=e,C=x,F=0,z=!1;for(;(C=C.get(Gn))!==void 0&&!z;){const q=C.get(e);if(F+=1,typeof q<"u"){if(q===F)throw new RangeError("Cyclic object value");z=!0}typeof C.get(Gn)>"u"&&(F=0)}if(typeof c=="function"?S=c(t,S):S instanceof Date?S=h==null?void 0:h(S):n==="comma"&&fe(S)&&(S=ho(S,function(q){return q instanceof Date?h==null?void 0:h(q):q})),S===null){if(r)return l&&!m?l(t,ne.encoder,y,"key",u):t;S=""}if(zl(S)||Hl(S)){if(l){const q=m?t:l(t,ne.encoder,y,"key",u);return[(d==null?void 0:d(q))+"="+(d==null?void 0:d(l(S,ne.encoder,y,"value",u)))]}return[(d==null?void 0:d(t))+"="+(d==null?void 0:d(String(S)))]}const B=[];if(typeof S>"u")return B;let X;if(n==="comma"&&fe(S))m&&l&&(S=ho(S,l)),X=[{value:S.length>0?S.join(",")||null:void 0}];else if(fe(c))X=c;else{const q=Object.keys(S);X=f?q.sort(f):q}const G=i?String(t).replace(/\./g,"%2E"):String(t),de=s&&fe(S)&&S.length===1?G+"[]":G;if(o&&fe(S)&&S.length===0)return de+"[]";for(let q=0;q<X.length;++q){const ae=X[q],J=typeof ae=="object"&&typeof ae.value<"u"?ae.value:S[ae];if(a&&J===null)continue;const Pe=p&&i?ae.replace(/\./g,"%2E"):ae,Re=fe(S)?typeof n=="function"?n(de,Pe):de:de+(p?"."+Pe:"["+Pe+"]");x.set(e,F);const $t=new WeakMap;$t.set(Gn,x),mr(B,yr(J,Re,n,s,o,r,a,i,n==="comma"&&m&&fe(S)?null:l,c,f,p,h,u,d,m,y,$t))}return B}function Ul(e=ne){if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");const t=e.charset||ne.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=pr;if(typeof e.format<"u"){if(!is(co,e.format))throw new TypeError("Unknown format option provided.");n=e.format}const s=co[n];let o=ne.filter;(typeof e.filter=="function"||fe(e.filter))&&(o=e.filter);let r;if(e.arrayFormat&&e.arrayFormat in gr?r=e.arrayFormat:"indices"in e?r=e.indices?"indices":"repeat":r=ne.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const a=typeof e.allowDots>"u"?e.encodeDotInKeys?!0:ne.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:ne.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:ne.allowEmptyArrays,arrayFormat:r,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:ne.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?ne.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:ne.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:ne.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:ne.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:ne.encodeValuesOnly,filter:o,format:n,formatter:s,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:ne.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:ne.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:ne.strictNullHandling}}function Gl(e,t={}){let n=e;const s=Ul(t);let o,r;typeof s.filter=="function"?(r=s.filter,n=r("",n)):fe(s.filter)&&(r=s.filter,o=r);const a=[];if(typeof n!="object"||n===null)return"";const i=gr[s.arrayFormat],l=i==="comma"&&s.commaRoundTrip;o||(o=Object.keys(n)),s.sort&&o.sort(s.sort);const c=new WeakMap;for(let h=0;h<o.length;++h){const u=o[h];s.skipNulls&&n[u]===null||mr(a,yr(n[u],u,i,l,s.allowEmptyArrays,s.strictNullHandling,s.skipNulls,s.encodeDotInKeys,s.encode?s.encoder:null,s.filter,s.sort,s.allowDots,s.serializeDate,s.format,s.formatter,s.encodeValuesOnly,s.charset,c))}const f=a.join(s.delimiter);let p=s.addQueryPrefix===!0?"?":"";return s.charsetSentinel&&(s.charset==="iso-8859-1"?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),f.length>0?p+f:""}function Wl(e){let t=0;for(const o of e)t+=o.length;const n=new Uint8Array(t);let s=0;for(const o of e)n.set(o,s),s+=o.length;return n}let fo;function xs(e){let t;return(fo??(t=new globalThis.TextEncoder,fo=t.encode.bind(t)))(e)}let go;function mo(e){let t;return(go??(t=new globalThis.TextDecoder,go=t.decode.bind(t)))(e)}var ye,be;class Sn{constructor(){ye.set(this,void 0),be.set(this,void 0),V(this,ye,new Uint8Array),V(this,be,null)}decode(t){if(t==null)return[];const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?xs(t):t;V(this,ye,Wl([g(this,ye,"f"),n]));const s=[];let o;for(;(o=Xl(g(this,ye,"f"),g(this,be,"f")))!=null;){if(o.carriage&&g(this,be,"f")==null){V(this,be,o.index);continue}if(g(this,be,"f")!=null&&(o.index!==g(this,be,"f")+1||o.carriage)){s.push(mo(g(this,ye,"f").subarray(0,g(this,be,"f")-1))),V(this,ye,g(this,ye,"f").subarray(g(this,be,"f"))),V(this,be,null);continue}const r=g(this,be,"f")!==null?o.preceding-1:o.preceding,a=mo(g(this,ye,"f").subarray(0,r));s.push(a),V(this,ye,g(this,ye,"f").subarray(o.index)),V(this,be,null)}return s}flush(){return g(this,ye,"f").length?this.decode(`
`):[]}}ye=new WeakMap,be=new WeakMap;Sn.NEWLINE_CHARS=new Set([`
`,"\r"]);Sn.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Xl(e,t){for(let n=t??0;n<e.length;n++){if(e[n]===10)return{preceding:n,index:n+1,carriage:!1};if(e[n]===13)return{preceding:n,index:n+1,carriage:!0}}return null}function Kl(e){for(let t=0;t<e.length-1;t++){if(e[t]===10&&e[t+1]===10||e[t]===13&&e[t+1]===13)return t+2;if(e[t]===13&&e[t+1]===10&&t+3<e.length&&e[t+2]===13&&e[t+3]===10)return t+4}return-1}const dn={off:0,error:200,warn:300,info:400,debug:500},yo=(e,t,n)=>{if(e){if(Pl(dn,e))return e;ie(n).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(dn))}`)}};function ht(){}function jt(e,t,n){return!t||dn[e]>dn[n]?ht:t[e].bind(t)}const Jl={error:ht,warn:ht,info:ht,debug:ht};let bo=new WeakMap;function ie(e){const t=e.logger,n=e.logLevel??"off";if(!t)return Jl;const s=bo.get(t);if(s&&s[0]===n)return s[1];const o={error:jt("error",t,n),warn:jt("warn",t,n),info:jt("info",t,n),debug:jt("debug",t,n)};return bo.set(t,[n,o]),o}const Ue=e=>(e.options&&(e.options={...e.options},delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([t,n])=>[t,t.toLowerCase()==="authorization"||t.toLowerCase()==="cookie"||t.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);var ut;class Me{constructor(t,n,s){this.iterator=t,ut.set(this,void 0),this.controller=n,V(this,ut,s)}static fromSSEResponse(t,n,s){let o=!1;const r=s?ie(s):console;async function*a(){if(o)throw new P("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let i=!1;try{for await(const l of Ql(t,n))if(!i){if(l.data.startsWith("[DONE]")){i=!0;continue}if(l.event===null||!l.event.startsWith("thread.")){let c;try{c=JSON.parse(l.data)}catch(f){throw r.error("Could not parse message into JSON:",l.data),r.error("From chunk:",l.raw),f}if(c&&c.error)throw new ce(void 0,c.error,void 0,t.headers);yield c}else{let c;try{c=JSON.parse(l.data)}catch(f){throw console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),f}if(l.event=="error")throw new ce(void 0,c.error,c.message,void 0);yield{event:l.event,data:c}}}i=!0}catch(l){if(rs(l))return;throw l}finally{i||n.abort()}}return new Me(a,n,s)}static fromReadableStream(t,n,s){let o=!1;async function*r(){const i=new Sn,l=hr(t);for await(const c of l)for(const f of i.decode(c))yield f;for(const c of i.flush())yield c}async function*a(){if(o)throw new P("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let i=!1;try{for await(const l of r())i||l&&(yield JSON.parse(l));i=!0}catch(l){if(rs(l))return;throw l}finally{i||n.abort()}}return new Me(a,n,s)}[(ut=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const t=[],n=[],s=this.iterator(),o=r=>({next:()=>{if(r.length===0){const a=s.next();t.push(a),n.push(a)}return r.shift()}});return[new Me(()=>o(t),this.controller,g(this,ut,"f")),new Me(()=>o(n),this.controller,g(this,ut,"f"))]}toReadableStream(){const t=this;let n;return cr({async start(){n=t[Symbol.asyncIterator]()},async pull(s){try{const{value:o,done:r}=await n.next();if(r)return s.close();const a=xs(JSON.stringify(o)+`
`);s.enqueue(a)}catch(o){s.error(o)}},async cancel(){var s;await((s=n.return)==null?void 0:s.call(n))}})}}async function*Ql(e,t){if(!e.body)throw t.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new P("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new P("Attempted to iterate over a response with no body");const n=new Zl,s=new Sn,o=hr(e.body);for await(const r of Yl(o))for(const a of s.decode(r)){const i=n.decode(a);i&&(yield i)}for(const r of s.flush()){const a=n.decode(r);a&&(yield a)}}async function*Yl(e){let t=new Uint8Array;for await(const n of e){if(n==null)continue;const s=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?xs(n):n;let o=new Uint8Array(t.length+s.length);o.set(t),o.set(s,t.length),t=o;let r;for(;(r=Kl(t))!==-1;)yield t.slice(0,r),t=t.slice(r)}t.length>0&&(yield t)}class Zl{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const r={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],r}if(this.chunks.push(t),t.startsWith(":"))return null;let[n,s,o]=eu(t,":");return o.startsWith(" ")&&(o=o.substring(1)),n==="event"?this.event=o:n==="data"&&this.data.push(o),null}}function eu(e,t){const n=e.indexOf(t);return n!==-1?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}async function br(e,t){const{response:n,requestLogID:s,retryOfRequestLogID:o,startTime:r}=t,a=await(async()=>{var l,c;if(t.options.stream)return ie(e).debug("response",n.status,n.url,n.headers,n.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(n,t.controller,e):Me.fromSSEResponse(n,t.controller,e);if(n.status===204)return null;if(t.options.__binaryResponse)return n;const i=(c=(l=n.headers.get("content-type"))==null?void 0:l.split(";")[0])==null?void 0:c.trim();if(i!=null&&i.includes("application/json")||i!=null&&i.endsWith("+json")){const f=await n.json();return wr(f,n)}return await n.text()})();return ie(e).debug(`[${s}] response parsed`,Ue({retryOfRequestLogID:o,url:n.url,status:n.status,body:a,durationMs:Date.now()-r})),a}function wr(e,t){return!e||typeof e!="object"||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}var pt;class xn extends Promise{constructor(t,n,s=br){super(o=>{o(null)}),this.responsePromise=n,this.parseResponse=s,pt.set(this,void 0),V(this,pt,t)}_thenUnwrap(t){return new xn(g(this,pt,"f"),this.responsePromise,async(n,s)=>wr(t(await this.parseResponse(n,s),s),s.response))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(t=>this.parseResponse(g(this,pt,"f"),t))),this.parsedPromise}then(t,n){return this.parse().then(t,n)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}pt=new WeakMap;var qt;class Cs{constructor(t,n,s,o){qt.set(this,void 0),V(this,qt,t),this.options=o,this.response=n,this.body=s}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const t=this.nextPageRequestOptions();if(!t)throw new P("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await g(this,qt,"f").requestAPIList(this.constructor,t)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(qt=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const n of t.getPaginatedItems())yield n}}class tu extends xn{constructor(t,n,s){super(t,n,async(o,r)=>new s(o,r.response,await br(o,r),r.options))}async*[Symbol.asyncIterator](){const t=await this;for await(const n of t)yield n}}class Cn extends Cs{constructor(t,n,s,o){super(t,n,s,o),this.data=s.data||[],this.object=s.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class ee extends Cs{constructor(t,n,s,o){super(t,n,s,o),this.data=s.data||[],this.has_more=s.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){var s;const t=this.getPaginatedItems(),n=(s=t[t.length-1])==null?void 0:s.id;return n?{...this.options,query:{...ur(this.options.query),after:n}}:null}}class hn extends Cs{constructor(t,n,s,o){super(t,n,s,o),this.data=s.data||[],this.has_more=s.has_more||!1,this.last_id=s.last_id||""}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const t=this.last_id;return t?{...this.options,query:{...ur(this.options.query),after:t}}:null}}const vr=()=>{var e;if(typeof File>"u"){const{process:t}=globalThis,n=typeof((e=t==null?void 0:t.versions)==null?void 0:e.node)=="string"&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function St(e,t,n){return vr(),new File(e,t??"unknown_file",n)}function Wt(e){return(typeof e=="object"&&e!==null&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}const Rs=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function",wo=async(e,t)=>ls(e.body)?{...e,body:await _r(e.body,t)}:e,Je=async(e,t)=>({...e,body:await _r(e.body,t)}),vo=new WeakMap;function nu(e){const t=typeof e=="function"?e:e.fetch,n=vo.get(t);if(n)return n;const s=(async()=>{try{const o="Response"in t?t.Response:(await t("data:,")).constructor,r=new FormData;return r.toString()!==await new o(r).text()}catch{return!0}})();return vo.set(t,s),s}const _r=async(e,t)=>{if(!await nu(t))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const n=new FormData;return await Promise.all(Object.entries(e||{}).map(([s,o])=>us(n,s,o))),n},Sr=e=>e instanceof Blob&&"name"in e,su=e=>typeof e=="object"&&e!==null&&(e instanceof Response||Rs(e)||Sr(e)),ls=e=>{if(su(e))return!0;if(Array.isArray(e))return e.some(ls);if(e&&typeof e=="object"){for(const t in e)if(ls(e[t]))return!0}return!1},us=async(e,t,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")e.append(t,String(n));else if(n instanceof Response)e.append(t,St([await n.blob()],Wt(n)));else if(Rs(n))e.append(t,St([await new Response(dr(n)).blob()],Wt(n)));else if(Sr(n))e.append(t,n,Wt(n));else if(Array.isArray(n))await Promise.all(n.map(s=>us(e,t+"[]",s)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([s,o])=>us(e,`${t}[${s}]`,o)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}},xr=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",ou=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&xr(e),ru=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function";async function au(e,t,n){if(vr(),e=await e,ou(e))return e instanceof File?e:St([await e.arrayBuffer()],e.name);if(ru(e)){const o=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),St(await cs(o),t,n)}const s=await cs(e);if(t||(t=Wt(e)),!(n!=null&&n.type)){const o=s.find(r=>typeof r=="object"&&"type"in r&&r.type);typeof o=="string"&&(n={...n,type:o})}return St(s,t,n)}async function cs(e){var n;let t=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(xr(e))t.push(e instanceof Blob?e:await e.arrayBuffer());else if(Rs(e))for await(const s of e)t.push(...await cs(s));else{const s=(n=e==null?void 0:e.constructor)==null?void 0:n.name;throw new Error(`Unexpected data type: ${typeof e}${s?`; constructor: ${s}`:""}${iu(e)}`)}return t}function iu(e){return typeof e!="object"||e===null?"":`; props: [${Object.getOwnPropertyNames(e).map(t=>`"${t}"`).join(", ")}]`}class M{constructor(t){this._client=t}}function Cr(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const _o=Object.freeze(Object.create(null)),lu=(e=Cr)=>function(t,...n){if(t.length===1)return t[0];let s=!1;const o=[],r=t.reduce((c,f,p)=>{var d;/[?#]/.test(f)&&(s=!0);const h=n[p];let u=(s?encodeURIComponent:e)(""+h);return p!==n.length&&(h==null||typeof h=="object"&&h.toString===((d=Object.getPrototypeOf(Object.getPrototypeOf(h.hasOwnProperty??_o)??_o))==null?void 0:d.toString))&&(u=h+"",o.push({start:c.length+f.length,length:u.length,error:`Value of type ${Object.prototype.toString.call(h).slice(8,-1)} is not a valid path parameter`})),c+f+(p===n.length?"":u)},""),a=r.split(/[?#]/,1)[0],i=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let l;for(;(l=i.exec(a))!==null;)o.push({start:l.index,length:l[0].length,error:`Value "${l[0]}" can't be safely passed as a path parameter`});if(o.sort((c,f)=>c.start-f.start),o.length>0){let c=0;const f=o.reduce((p,h)=>{const u=" ".repeat(h.start-c),d="^".repeat(h.length);return c=h.start+h.length,p+u+d},"");throw new P(`Path parameters result in path with invalid segments:
${o.map(p=>p.error).join(`
`)}
${r}
${f}`)}return r},b=lu(Cr);let Rr=class extends M{list(e,t={},n){return this._client.getAPIList(b`/chat/completions/${e}/messages`,ee,{query:t,...n})}};function pn(e){return e!==void 0&&"function"in e&&e.function!==void 0}function Is(e){return(e==null?void 0:e.$brand)==="auto-parseable-response-format"}function Pt(e){return(e==null?void 0:e.$brand)==="auto-parseable-tool"}function uu(e,t){return!t||!Ir(t)?{...e,choices:e.choices.map(n=>(kr(n.message.tool_calls),{...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:ks(e,t)}function ks(e,t){const n=e.choices.map(s=>{var o;if(s.finish_reason==="length")throw new ir;if(s.finish_reason==="content_filter")throw new lr;return kr(s.message.tool_calls),{...s,message:{...s.message,...s.message.tool_calls?{tool_calls:((o=s.message.tool_calls)==null?void 0:o.map(r=>du(t,r)))??void 0}:void 0,parsed:s.message.content&&!s.message.refusal?cu(t,s.message.content):null}}});return{...e,choices:n}}function cu(e,t){var n,s;return((n=e.response_format)==null?void 0:n.type)!=="json_schema"?null:((s=e.response_format)==null?void 0:s.type)==="json_schema"?"$parseRaw"in e.response_format?e.response_format.$parseRaw(t):JSON.parse(t):null}function du(e,t){var s;const n=(s=e.tools)==null?void 0:s.find(o=>{var r;return pn(o)&&((r=o.function)==null?void 0:r.name)===t.function.name});return{...t,function:{...t.function,parsed_arguments:Pt(n)?n.$parseRaw(t.function.arguments):n!=null&&n.function.strict?JSON.parse(t.function.arguments):null}}}function hu(e,t){var s;if(!e||!("tools"in e)||!e.tools)return!1;const n=(s=e.tools)==null?void 0:s.find(o=>{var r;return pn(o)&&((r=o.function)==null?void 0:r.name)===t.function.name});return pn(n)&&(Pt(n)||(n==null?void 0:n.function.strict)||!1)}function Ir(e){var t;return Is(e.response_format)?!0:((t=e.tools)==null?void 0:t.some(n=>Pt(n)||n.type==="function"&&n.function.strict===!0))??!1}function kr(e){for(const t of e||[])if(t.type!=="function")throw new P(`Currently only \`function\` tool calls are supported; Received \`${t.type}\``)}function pu(e){for(const t of e??[]){if(t.type!=="function")throw new P(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(t.function.strict!==!0)throw new P(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}const fn=e=>(e==null?void 0:e.role)==="assistant",Ar=e=>(e==null?void 0:e.role)==="tool";var ds,Xt,Kt,ft,gt,Jt,mt,Ee,yt,gn,mn,nt,Mr;class As{constructor(){ds.add(this),this.controller=new AbortController,Xt.set(this,void 0),Kt.set(this,()=>{}),ft.set(this,()=>{}),gt.set(this,void 0),Jt.set(this,()=>{}),mt.set(this,()=>{}),Ee.set(this,{}),yt.set(this,!1),gn.set(this,!1),mn.set(this,!1),nt.set(this,!1),V(this,Xt,new Promise((t,n)=>{V(this,Kt,t,"f"),V(this,ft,n,"f")})),V(this,gt,new Promise((t,n)=>{V(this,Jt,t,"f"),V(this,mt,n,"f")})),g(this,Xt,"f").catch(()=>{}),g(this,gt,"f").catch(()=>{})}_run(t){setTimeout(()=>{t().then(()=>{this._emitFinal(),this._emit("end")},g(this,ds,"m",Mr).bind(this))},0)}_connected(){this.ended||(g(this,Kt,"f").call(this),this._emit("connect"))}get ended(){return g(this,yt,"f")}get errored(){return g(this,gn,"f")}get aborted(){return g(this,mn,"f")}abort(){this.controller.abort()}on(t,n){return(g(this,Ee,"f")[t]||(g(this,Ee,"f")[t]=[])).push({listener:n}),this}off(t,n){const s=g(this,Ee,"f")[t];if(!s)return this;const o=s.findIndex(r=>r.listener===n);return o>=0&&s.splice(o,1),this}once(t,n){return(g(this,Ee,"f")[t]||(g(this,Ee,"f")[t]=[])).push({listener:n,once:!0}),this}emitted(t){return new Promise((n,s)=>{V(this,nt,!0),t!=="error"&&this.once("error",s),this.once(t,n)})}async done(){V(this,nt,!0),await g(this,gt,"f")}_emit(t,...n){if(g(this,yt,"f"))return;t==="end"&&(V(this,yt,!0),g(this,Jt,"f").call(this));const s=g(this,Ee,"f")[t];if(s&&(g(this,Ee,"f")[t]=s.filter(o=>!o.once),s.forEach(({listener:o})=>o(...n))),t==="abort"){const o=n[0];!g(this,nt,"f")&&!(s!=null&&s.length)&&Promise.reject(o),g(this,ft,"f").call(this,o),g(this,mt,"f").call(this,o),this._emit("end");return}if(t==="error"){const o=n[0];!g(this,nt,"f")&&!(s!=null&&s.length)&&Promise.reject(o),g(this,ft,"f").call(this,o),g(this,mt,"f").call(this,o),this._emit("end")}}_emitFinal(){}}Xt=new WeakMap,Kt=new WeakMap,ft=new WeakMap,gt=new WeakMap,Jt=new WeakMap,mt=new WeakMap,Ee=new WeakMap,yt=new WeakMap,gn=new WeakMap,mn=new WeakMap,nt=new WeakMap,ds=new WeakSet,Mr=function(e){if(V(this,gn,!0),e instanceof Error&&e.name==="AbortError"&&(e=new _e),e instanceof _e)return V(this,mn,!0),this._emit("abort",e);if(e instanceof P)return this._emit("error",e);if(e instanceof Error){const t=new P(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new P(String(e)))};function fu(e){return typeof e.parse=="function"}var pe,hs,yn,ps,fs,gs,Pr,Or;const gu=10;class $r extends As{constructor(){super(...arguments),pe.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(t){var s;this._chatCompletions.push(t),this._emit("chatCompletion",t);const n=(s=t.choices[0])==null?void 0:s.message;return n&&this._addMessage(n),t}_addMessage(t,n=!0){if("content"in t||(t.content=null),this.messages.push(t),n){if(this._emit("message",t),Ar(t)&&t.content)this._emit("functionToolCallResult",t.content);else if(fn(t)&&t.tool_calls)for(const s of t.tool_calls)s.type==="function"&&this._emit("functionToolCall",s.function)}}async finalChatCompletion(){await this.done();const t=this._chatCompletions[this._chatCompletions.length-1];if(!t)throw new P("stream ended without producing a ChatCompletion");return t}async finalContent(){return await this.done(),g(this,pe,"m",hs).call(this)}async finalMessage(){return await this.done(),g(this,pe,"m",yn).call(this)}async finalFunctionToolCall(){return await this.done(),g(this,pe,"m",ps).call(this)}async finalFunctionToolCallResult(){return await this.done(),g(this,pe,"m",fs).call(this)}async totalUsage(){return await this.done(),g(this,pe,"m",gs).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const t=this._chatCompletions[this._chatCompletions.length-1];t&&this._emit("finalChatCompletion",t);const n=g(this,pe,"m",yn).call(this);n&&this._emit("finalMessage",n);const s=g(this,pe,"m",hs).call(this);s&&this._emit("finalContent",s);const o=g(this,pe,"m",ps).call(this);o&&this._emit("finalFunctionToolCall",o);const r=g(this,pe,"m",fs).call(this);r!=null&&this._emit("finalFunctionToolCallResult",r),this._chatCompletions.some(a=>a.usage)&&this._emit("totalUsage",g(this,pe,"m",gs).call(this))}async _createChatCompletion(t,n,s){const o=s==null?void 0:s.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort())),g(this,pe,"m",Pr).call(this,n);const r=await t.chat.completions.create({...n,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addChatCompletion(ks(r,n))}async _runChatCompletion(t,n,s){for(const o of n.messages)this._addMessage(o,!1);return await this._createChatCompletion(t,n,s)}async _runTools(t,n,s){var u,d,m;const o="tool",{tool_choice:r="auto",stream:a,...i}=n,l=typeof r!="string"&&r.type==="function"&&((u=r==null?void 0:r.function)==null?void 0:u.name),{maxChatCompletions:c=gu}=s||{},f=n.tools.map(y=>{if(Pt(y)){if(!y.$callback)throw new P("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:y.$callback,name:y.function.name,description:y.function.description||"",parameters:y.function.parameters,parse:y.$parseRaw,strict:!0}}}return y}),p={};for(const y of f)y.type==="function"&&(p[y.function.name||y.function.function.name]=y.function);const h="tools"in n?f.map(y=>y.type==="function"?{type:"function",function:{name:y.function.name||y.function.function.name,parameters:y.function.parameters,description:y.function.description,strict:y.function.strict}}:y):void 0;for(const y of n.messages)this._addMessage(y,!1);for(let y=0;y<c;++y){const x=(d=(await this._createChatCompletion(t,{...i,tool_choice:r,tools:h,messages:[...this.messages]},s)).choices[0])==null?void 0:d.message;if(!x)throw new P("missing message in ChatCompletion response");if(!((m=x.tool_calls)!=null&&m.length))return;for(const S of x.tool_calls){if(S.type!=="function")continue;const C=S.id,{name:F,arguments:z}=S.function,B=p[F];if(B){if(l&&l!==F){const q=`Invalid tool_call: ${JSON.stringify(F)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:o,tool_call_id:C,content:q});continue}}else{const q=`Invalid tool_call: ${JSON.stringify(F)}. Available options are: ${Object.keys(p).map(ae=>JSON.stringify(ae)).join(", ")}. Please try again`;this._addMessage({role:o,tool_call_id:C,content:q});continue}let X;try{X=fu(B)?await B.parse(z):z}catch(q){const ae=q instanceof Error?q.message:String(q);this._addMessage({role:o,tool_call_id:C,content:ae});continue}const G=await B.function(X,this),de=g(this,pe,"m",Or).call(this,G);if(this._addMessage({role:o,tool_call_id:C,content:de}),l)return}}}}pe=new WeakSet,hs=function(){return g(this,pe,"m",yn).call(this).content??null},yn=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(fn(t))return{...t,content:t.content??null,refusal:t.refusal??null}}throw new P("stream ended without producing a ChatCompletionMessage with role=assistant")},ps=function(){var e,t;for(let n=this.messages.length-1;n>=0;n--){const s=this.messages[n];if(fn(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(t=s.tool_calls.filter(o=>o.type==="function").at(-1))==null?void 0:t.function}},fs=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(Ar(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>{var s;return n.role==="assistant"&&((s=n.tool_calls)==null?void 0:s.some(o=>o.type==="function"&&o.id===t.tool_call_id))}))return t.content}},gs=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},Pr=function(e){if(e.n!=null&&e.n>1)throw new P("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Or=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Ms extends $r{static runTools(t,n,s){const o=new Ms,r={...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"runTools"}};return o._run(()=>o._runTools(t,n,r)),o}_addMessage(t,n=!0){super._addMessage(t,n),fn(t)&&t.content&&this._emit("content",t.content)}}const Fr=1,Er=2,Vr=4,Dr=8,Lr=16,Tr=32,jr=64,qr=128,Nr=256,Br=qr|Nr,Hr=Lr|Tr|Br|jr,zr=Fr|Er|Hr,Ur=Vr|Dr,mu=zr|Ur,oe={STR:Fr,NUM:Er,ARR:Vr,OBJ:Dr,NULL:Lr,BOOL:Tr,NAN:jr,INFINITY:qr,MINUS_INFINITY:Nr,INF:Br,SPECIAL:Hr,ATOM:zr,COLLECTION:Ur,ALL:mu};class yu extends Error{}class bu extends Error{}function wu(e,t=oe.ALL){if(typeof e!="string")throw new TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw new Error(`${e} is empty`);return vu(e.trim(),t)}const vu=(e,t)=>{const n=e.length;let s=0;const o=h=>{throw new yu(`${h} at position ${s}`)},r=h=>{throw new bu(`${h} at position ${s}`)},a=()=>(p(),s>=n&&o("Unexpected end of input"),e[s]==='"'?i():e[s]==="{"?l():e[s]==="["?c():e.substring(s,s+4)==="null"||oe.NULL&t&&n-s<4&&"null".startsWith(e.substring(s))?(s+=4,null):e.substring(s,s+4)==="true"||oe.BOOL&t&&n-s<4&&"true".startsWith(e.substring(s))?(s+=4,!0):e.substring(s,s+5)==="false"||oe.BOOL&t&&n-s<5&&"false".startsWith(e.substring(s))?(s+=5,!1):e.substring(s,s+8)==="Infinity"||oe.INFINITY&t&&n-s<8&&"Infinity".startsWith(e.substring(s))?(s+=8,1/0):e.substring(s,s+9)==="-Infinity"||oe.MINUS_INFINITY&t&&1<n-s&&n-s<9&&"-Infinity".startsWith(e.substring(s))?(s+=9,-1/0):e.substring(s,s+3)==="NaN"||oe.NAN&t&&n-s<3&&"NaN".startsWith(e.substring(s))?(s+=3,NaN):f()),i=()=>{const h=s;let u=!1;for(s++;s<n&&(e[s]!=='"'||u&&e[s-1]==="\\");)u=e[s]==="\\"?!u:!1,s++;if(e.charAt(s)=='"')try{return JSON.parse(e.substring(h,++s-Number(u)))}catch(d){r(String(d))}else if(oe.STR&t)try{return JSON.parse(e.substring(h,s-Number(u))+'"')}catch{return JSON.parse(e.substring(h,e.lastIndexOf("\\"))+'"')}o("Unterminated string literal")},l=()=>{s++,p();const h={};try{for(;e[s]!=="}";){if(p(),s>=n&&oe.OBJ&t)return h;const u=i();p(),s++;try{const d=a();Object.defineProperty(h,u,{value:d,writable:!0,enumerable:!0,configurable:!0})}catch(d){if(oe.OBJ&t)return h;throw d}p(),e[s]===","&&s++}}catch{if(oe.OBJ&t)return h;o("Expected '}' at end of object")}return s++,h},c=()=>{s++;const h=[];try{for(;e[s]!=="]";)h.push(a()),p(),e[s]===","&&s++}catch{if(oe.ARR&t)return h;o("Expected ']' at end of array")}return s++,h},f=()=>{if(s===0){e==="-"&&oe.NUM&t&&o("Not sure what '-' is");try{return JSON.parse(e)}catch(u){if(oe.NUM&t)try{return e[e.length-1]==="."?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch{}r(String(u))}}const h=s;for(e[s]==="-"&&s++;e[s]&&!",]}".includes(e[s]);)s++;s==n&&!(oe.NUM&t)&&o("Unterminated number literal");try{return JSON.parse(e.substring(h,s))}catch{e.substring(h,s)==="-"&&oe.NUM&t&&o("Not sure what '-' is");try{return JSON.parse(e.substring(h,e.lastIndexOf("e")))}catch(u){r(String(u))}}},p=()=>{for(;s<n&&` 
\r	`.includes(e[s]);)s++};return a()},So=e=>wu(e,oe.ALL^oe.NUM);var te,Fe,Ye,Le,Wn,Nt,Xn,Kn,Jn,Bt,Qn,xo;class kt extends $r{constructor(t){super(),te.add(this),Fe.set(this,void 0),Ye.set(this,void 0),Le.set(this,void 0),V(this,Fe,t),V(this,Ye,[])}get currentChatCompletionSnapshot(){return g(this,Le,"f")}static fromReadableStream(t){const n=new kt(null);return n._run(()=>n._fromReadableStream(t)),n}static createChatCompletion(t,n,s){const o=new kt(n);return o._run(()=>o._runChatCompletion(t,{...n,stream:!0},{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createChatCompletion(t,n,s){var a;super._createChatCompletion;const o=s==null?void 0:s.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort())),g(this,te,"m",Wn).call(this);const r=await t.chat.completions.create({...n,stream:!0},{...s,signal:this.controller.signal});this._connected();for await(const i of r)g(this,te,"m",Xn).call(this,i);if((a=r.controller.signal)!=null&&a.aborted)throw new _e;return this._addChatCompletion(g(this,te,"m",Bt).call(this))}async _fromReadableStream(t,n){var a;const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),g(this,te,"m",Wn).call(this),this._connected();const o=Me.fromReadableStream(t,this.controller);let r;for await(const i of o)r&&r!==i.id&&this._addChatCompletion(g(this,te,"m",Bt).call(this)),g(this,te,"m",Xn).call(this,i),r=i.id;if((a=o.controller.signal)!=null&&a.aborted)throw new _e;return this._addChatCompletion(g(this,te,"m",Bt).call(this))}[(Fe=new WeakMap,Ye=new WeakMap,Le=new WeakMap,te=new WeakSet,Wn=function(){this.ended||V(this,Le,void 0)},Nt=function(t){let n=g(this,Ye,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},g(this,Ye,"f")[t.index]=n,n)},Xn=function(t){var s,o,r,a,i,l,c,f,p,h,u,d,m,y,x;if(this.ended)return;const n=g(this,te,"m",xo).call(this,t);this._emit("chunk",t,n);for(const S of t.choices){const C=n.choices[S.index];S.delta.content!=null&&((s=C.message)==null?void 0:s.role)==="assistant"&&((o=C.message)!=null&&o.content)&&(this._emit("content",S.delta.content,C.message.content),this._emit("content.delta",{delta:S.delta.content,snapshot:C.message.content,parsed:C.message.parsed})),S.delta.refusal!=null&&((r=C.message)==null?void 0:r.role)==="assistant"&&((a=C.message)!=null&&a.refusal)&&this._emit("refusal.delta",{delta:S.delta.refusal,snapshot:C.message.refusal}),((i=S.logprobs)==null?void 0:i.content)!=null&&((l=C.message)==null?void 0:l.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(c=S.logprobs)==null?void 0:c.content,snapshot:((f=C.logprobs)==null?void 0:f.content)??[]}),((p=S.logprobs)==null?void 0:p.refusal)!=null&&((h=C.message)==null?void 0:h.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(u=S.logprobs)==null?void 0:u.refusal,snapshot:((d=C.logprobs)==null?void 0:d.refusal)??[]});const F=g(this,te,"m",Nt).call(this,C);C.finish_reason&&(g(this,te,"m",Jn).call(this,C),F.current_tool_call_index!=null&&g(this,te,"m",Kn).call(this,C,F.current_tool_call_index));for(const z of S.delta.tool_calls??[])F.current_tool_call_index!==z.index&&(g(this,te,"m",Jn).call(this,C),F.current_tool_call_index!=null&&g(this,te,"m",Kn).call(this,C,F.current_tool_call_index)),F.current_tool_call_index=z.index;for(const z of S.delta.tool_calls??[]){const B=(m=C.message.tool_calls)==null?void 0:m[z.index];B!=null&&B.type&&((B==null?void 0:B.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(y=B.function)==null?void 0:y.name,index:z.index,arguments:B.function.arguments,parsed_arguments:B.function.parsed_arguments,arguments_delta:((x=z.function)==null?void 0:x.arguments)??""}):B==null||B.type)}}},Kn=function(t,n){var o,r,a;if(g(this,te,"m",Nt).call(this,t).done_tool_calls.has(n))return;const s=(o=t.message.tool_calls)==null?void 0:o[n];if(!s)throw new Error("no tool call snapshot");if(!s.type)throw new Error("tool call snapshot missing `type`");if(s.type==="function"){const i=(a=(r=g(this,Fe,"f"))==null?void 0:r.tools)==null?void 0:a.find(l=>pn(l)&&l.function.name===s.function.name);this._emit("tool_calls.function.arguments.done",{name:s.function.name,index:n,arguments:s.function.arguments,parsed_arguments:Pt(i)?i.$parseRaw(s.function.arguments):i!=null&&i.function.strict?JSON.parse(s.function.arguments):null})}else s.type},Jn=function(t){var s,o;const n=g(this,te,"m",Nt).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const r=g(this,te,"m",Qn).call(this);this._emit("content.done",{content:t.message.content,parsed:r?r.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(s=t.logprobs)!=null&&s.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(o=t.logprobs)!=null&&o.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},Bt=function(){if(this.ended)throw new P("stream has ended, this shouldn't happen");const t=g(this,Le,"f");if(!t)throw new P("request ended without sending any chunks");return V(this,Le,void 0),V(this,Ye,[]),_u(t,g(this,Fe,"f"))},Qn=function(){var n;const t=(n=g(this,Fe,"f"))==null?void 0:n.response_format;return Is(t)?t:null},xo=function(t){var n,s,o,r;let a=g(this,Le,"f");const{choices:i,...l}=t;a?Object.assign(a,l):a=V(this,Le,{...l,choices:[]});for(const{delta:c,finish_reason:f,index:p,logprobs:h=null,...u}of t.choices){let d=a.choices[p];if(d||(d=a.choices[p]={finish_reason:f,index:p,message:{},logprobs:h,...u}),h)if(!d.logprobs)d.logprobs=Object.assign({},h);else{const{content:z,refusal:B,...X}=h;Object.assign(d.logprobs,X),z&&((n=d.logprobs).content??(n.content=[]),d.logprobs.content.push(...z)),B&&((s=d.logprobs).refusal??(s.refusal=[]),d.logprobs.refusal.push(...B))}if(f&&(d.finish_reason=f,g(this,Fe,"f")&&Ir(g(this,Fe,"f")))){if(f==="length")throw new ir;if(f==="content_filter")throw new lr}if(Object.assign(d,u),!c)continue;const{content:m,refusal:y,function_call:x,role:S,tool_calls:C,...F}=c;if(Object.assign(d.message,F),y&&(d.message.refusal=(d.message.refusal||"")+y),S&&(d.message.role=S),x&&(d.message.function_call?(x.name&&(d.message.function_call.name=x.name),x.arguments&&((o=d.message.function_call).arguments??(o.arguments=""),d.message.function_call.arguments+=x.arguments)):d.message.function_call=x),m&&(d.message.content=(d.message.content||"")+m,!d.message.refusal&&g(this,te,"m",Qn).call(this)&&(d.message.parsed=So(d.message.content))),C){d.message.tool_calls||(d.message.tool_calls=[]);for(const{index:z,id:B,type:X,function:G,...de}of C){const q=(r=d.message.tool_calls)[z]??(r[z]={});Object.assign(q,de),B&&(q.id=B),X&&(q.type=X),G&&(q.function??(q.function={name:G.name??"",arguments:""})),G!=null&&G.name&&(q.function.name=G.name),G!=null&&G.arguments&&(q.function.arguments+=G.arguments,hu(g(this,Fe,"f"),q)&&(q.function.parsed_arguments=So(q.function.arguments)))}}}return a},Symbol.asyncIterator)](){const t=[],n=[];let s=!1;return this.on("chunk",o=>{const r=n.shift();r?r.resolve(o):t.push(o)}),this.on("end",()=>{s=!0;for(const o of n)o.resolve(void 0);n.length=0}),this.on("abort",o=>{s=!0;for(const r of n)r.reject(o);n.length=0}),this.on("error",o=>{s=!0;for(const r of n)r.reject(o);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((o,r)=>n.push({resolve:o,reject:r})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Me(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function _u(e,t){const{id:n,choices:s,created:o,model:r,system_fingerprint:a,...i}=e,l={...i,id:n,choices:s.map(({message:c,finish_reason:f,index:p,logprobs:h,...u})=>{if(!f)throw new P(`missing finish_reason for choice ${p}`);const{content:d=null,function_call:m,tool_calls:y,...x}=c,S=c.role;if(!S)throw new P(`missing role for choice ${p}`);if(m){const{arguments:C,name:F}=m;if(C==null)throw new P(`missing function_call.arguments for choice ${p}`);if(!F)throw new P(`missing function_call.name for choice ${p}`);return{...u,message:{content:d,function_call:{arguments:C,name:F},role:S,refusal:c.refusal??null},finish_reason:f,index:p,logprobs:h}}return y?{...u,index:p,finish_reason:f,logprobs:h,message:{...x,role:S,content:d,refusal:c.refusal??null,tool_calls:y.map((C,F)=>{const{function:z,type:B,id:X,...G}=C,{arguments:de,name:q,...ae}=z||{};if(X==null)throw new P(`missing choices[${p}].tool_calls[${F}].id
${Ht(e)}`);if(B==null)throw new P(`missing choices[${p}].tool_calls[${F}].type
${Ht(e)}`);if(q==null)throw new P(`missing choices[${p}].tool_calls[${F}].function.name
${Ht(e)}`);if(de==null)throw new P(`missing choices[${p}].tool_calls[${F}].function.arguments
${Ht(e)}`);return{...G,id:X,type:B,function:{...ae,name:q,arguments:de}}})}}:{...u,message:{...x,content:d,role:S,refusal:c.refusal??null},finish_reason:f,index:p,logprobs:h}}),created:o,model:r,object:"chat.completion",...a?{system_fingerprint:a}:{}};return uu(l,t)}function Ht(e){return JSON.stringify(e)}class bn extends kt{static fromReadableStream(t){const n=new bn(null);return n._run(()=>n._fromReadableStream(t)),n}static runTools(t,n,s){const o=new bn(n),r={...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"runTools"}};return o._run(()=>o._runTools(t,n,r)),o}}let Ps=class extends M{constructor(){super(...arguments),this.messages=new Rr(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(b`/chat/completions/${e}`,t)}update(e,t,n){return this._client.post(b`/chat/completions/${e}`,{body:t,...n})}list(e={},t){return this._client.getAPIList("/chat/completions",ee,{query:e,...t})}delete(e,t){return this._client.delete(b`/chat/completions/${e}`,t)}parse(e,t){return pu(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(n=>ks(n,e))}runTools(e,t){return e.stream?bn.runTools(this._client,e,t):Ms.runTools(this._client,e,t)}stream(e,t){return kt.createChatCompletion(this._client,e,t)}};Ps.Messages=Rr;class Os extends M{constructor(){super(...arguments),this.completions=new Ps(this._client)}}Os.Completions=Ps;const Gr=Symbol("brand.privateNullableHeaders");function*Su(e){if(!e)return;if(Gr in e){const{values:s,nulls:o}=e;yield*s.entries();for(const r of o)yield[r,null];return}let t=!1,n;e instanceof Headers?n=e.entries():ao(e)?n=e:(t=!0,n=Object.entries(e??{}));for(let s of n){const o=s[0];if(typeof o!="string")throw new TypeError("expected header name to be a string");const r=ao(s[1])?s[1]:[s[1]];let a=!1;for(const i of r)i!==void 0&&(t&&!a&&(a=!0,yield[o,null]),yield[o,i])}}const I=e=>{const t=new Headers,n=new Set;for(const s of e){const o=new Set;for(const[r,a]of Su(s)){const i=r.toLowerCase();o.has(i)||(t.delete(r),o.add(i)),a===null?(t.delete(r),n.add(i)):(t.append(r,a),n.delete(i))}}return{[Gr]:!0,values:t,nulls:n}};class Wr extends M{create(t,n){return this._client.post("/audio/speech",{body:t,...n,headers:I([{Accept:"application/octet-stream"},n==null?void 0:n.headers]),__binaryResponse:!0})}}class Xr extends M{create(t,n){return this._client.post("/audio/transcriptions",Je({body:t,...n,stream:t.stream??!1,__metadata:{model:t.model}},this._client))}}class Kr extends M{create(t,n){return this._client.post("/audio/translations",Je({body:t,...n,__metadata:{model:t.model}},this._client))}}class Ot extends M{constructor(){super(...arguments),this.transcriptions=new Xr(this._client),this.translations=new Kr(this._client),this.speech=new Wr(this._client)}}Ot.Transcriptions=Xr;Ot.Translations=Kr;Ot.Speech=Wr;class Jr extends M{create(t,n){return this._client.post("/batches",{body:t,...n})}retrieve(t,n){return this._client.get(b`/batches/${t}`,n)}list(t={},n){return this._client.getAPIList("/batches",ee,{query:t,...n})}cancel(t,n){return this._client.post(b`/batches/${t}/cancel`,n)}}class Qr extends M{create(t,n){return this._client.post("/assistants",{body:t,...n,headers:I([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(t,n){return this._client.get(b`/assistants/${t}`,{...n,headers:I([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(t,n,s){return this._client.post(b`/assistants/${t}`,{body:n,...s,headers:I([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}list(t={},n){return this._client.getAPIList("/assistants",ee,{query:t,...n,headers:I([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(t,n){return this._client.delete(b`/assistants/${t}`,{...n,headers:I([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}let Yr=class extends M{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:I([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}};class Zr extends M{create(t,n){return this._client.post("/realtime/transcription_sessions",{body:t,...n,headers:I([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}let Rn=class extends M{constructor(){super(...arguments),this.sessions=new Yr(this._client),this.transcriptionSessions=new Zr(this._client)}};Rn.Sessions=Yr;Rn.TranscriptionSessions=Zr;class ea extends M{create(t,n){return this._client.post("/chatkit/sessions",{body:t,...n,headers:I([{"OpenAI-Beta":"chatkit_beta=v1"},n==null?void 0:n.headers])})}cancel(t,n){return this._client.post(b`/chatkit/sessions/${t}/cancel`,{...n,headers:I([{"OpenAI-Beta":"chatkit_beta=v1"},n==null?void 0:n.headers])})}}let ta=class extends M{retrieve(e,t){return this._client.get(b`/chatkit/threads/${e}`,{...t,headers:I([{"OpenAI-Beta":"chatkit_beta=v1"},t==null?void 0:t.headers])})}list(e={},t){return this._client.getAPIList("/chatkit/threads",hn,{query:e,...t,headers:I([{"OpenAI-Beta":"chatkit_beta=v1"},t==null?void 0:t.headers])})}delete(e,t){return this._client.delete(b`/chatkit/threads/${e}`,{...t,headers:I([{"OpenAI-Beta":"chatkit_beta=v1"},t==null?void 0:t.headers])})}listItems(e,t={},n){return this._client.getAPIList(b`/chatkit/threads/${e}/items`,hn,{query:t,...n,headers:I([{"OpenAI-Beta":"chatkit_beta=v1"},n==null?void 0:n.headers])})}};class In extends M{constructor(){super(...arguments),this.sessions=new ea(this._client),this.threads=new ta(this._client)}}In.Sessions=ea;In.Threads=ta;class na extends M{create(t,n,s){return this._client.post(b`/threads/${t}/messages`,{body:n,...s,headers:I([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}retrieve(t,n,s){const{thread_id:o}=n;return this._client.get(b`/threads/${o}/messages/${t}`,{...s,headers:I([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}update(t,n,s){const{thread_id:o,...r}=n;return this._client.post(b`/threads/${o}/messages/${t}`,{body:r,...s,headers:I([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}list(t,n={},s){return this._client.getAPIList(b`/threads/${t}/messages`,ee,{query:n,...s,headers:I([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}delete(t,n,s){const{thread_id:o}=n;return this._client.delete(b`/threads/${o}/messages/${t}`,{...s,headers:I([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}class sa extends M{retrieve(t,n,s){const{thread_id:o,run_id:r,...a}=n;return this._client.get(b`/threads/${o}/runs/${r}/steps/${t}`,{query:a,...s,headers:I([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}list(t,n,s){const{thread_id:o,...r}=n;return this._client.getAPIList(b`/threads/${o}/runs/${t}/steps`,ee,{query:r,...s,headers:I([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}const xu=e=>{if(typeof Buffer<"u"){const t=Buffer.from(e,"base64");return Array.from(new Float32Array(t.buffer,t.byteOffset,t.length/Float32Array.BYTES_PER_ELEMENT))}else{const t=atob(e),n=t.length,s=new Uint8Array(n);for(let o=0;o<n;o++)s[o]=t.charCodeAt(o);return Array.from(new Float32Array(s.buffer))}},Ze=e=>{var t,n,s,o;if(typeof globalThis.process<"u")return((t=En==null?void 0:En[e])==null?void 0:t.trim())??void 0;if(typeof globalThis.Deno<"u")return(o=(s=(n=globalThis.Deno.env)==null?void 0:n.get)==null?void 0:s.call(n,e))==null?void 0:o.trim()};var le,Xe,ms,ke,Qt,xe,Ke,ot,We,wn,we,Yt,Zt,xt,bt,wt,Co,Ro,Io,ko,Ao,Mo,Po;class Ct extends As{constructor(){super(...arguments),le.add(this),ms.set(this,[]),ke.set(this,{}),Qt.set(this,{}),xe.set(this,void 0),Ke.set(this,void 0),ot.set(this,void 0),We.set(this,void 0),wn.set(this,void 0),we.set(this,void 0),Yt.set(this,void 0),Zt.set(this,void 0),xt.set(this,void 0)}[(ms=new WeakMap,ke=new WeakMap,Qt=new WeakMap,xe=new WeakMap,Ke=new WeakMap,ot=new WeakMap,We=new WeakMap,wn=new WeakMap,we=new WeakMap,Yt=new WeakMap,Zt=new WeakMap,xt=new WeakMap,le=new WeakSet,Symbol.asyncIterator)](){const t=[],n=[];let s=!1;return this.on("event",o=>{const r=n.shift();r?r.resolve(o):t.push(o)}),this.on("end",()=>{s=!0;for(const o of n)o.resolve(void 0);n.length=0}),this.on("abort",o=>{s=!0;for(const r of n)r.reject(o);n.length=0}),this.on("error",o=>{s=!0;for(const r of n)r.reject(o);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((o,r)=>n.push({resolve:o,reject:r})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(t){const n=new Xe;return n._run(()=>n._fromReadableStream(t)),n}async _fromReadableStream(t,n){var r;const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),this._connected();const o=Me.fromReadableStream(t,this.controller);for await(const a of o)g(this,le,"m",bt).call(this,a);if((r=o.controller.signal)!=null&&r.aborted)throw new _e;return this._addRun(g(this,le,"m",wt).call(this))}toReadableStream(){return new Me(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(t,n,s,o){const r=new Xe;return r._run(()=>r._runToolAssistantStream(t,n,s,{...o,headers:{...o==null?void 0:o.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createToolAssistantStream(t,n,s,o){var l;const r=o==null?void 0:o.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort()));const a={...s,stream:!0},i=await t.submitToolOutputs(n,a,{...o,signal:this.controller.signal});this._connected();for await(const c of i)g(this,le,"m",bt).call(this,c);if((l=i.controller.signal)!=null&&l.aborted)throw new _e;return this._addRun(g(this,le,"m",wt).call(this))}static createThreadAssistantStream(t,n,s){const o=new Xe;return o._run(()=>o._threadAssistantStream(t,n,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),o}static createAssistantStream(t,n,s,o){const r=new Xe;return r._run(()=>r._runAssistantStream(t,n,s,{...o,headers:{...o==null?void 0:o.headers,"X-Stainless-Helper-Method":"stream"}})),r}currentEvent(){return g(this,Yt,"f")}currentRun(){return g(this,Zt,"f")}currentMessageSnapshot(){return g(this,xe,"f")}currentRunStepSnapshot(){return g(this,xt,"f")}async finalRunSteps(){return await this.done(),Object.values(g(this,ke,"f"))}async finalMessages(){return await this.done(),Object.values(g(this,Qt,"f"))}async finalRun(){if(await this.done(),!g(this,Ke,"f"))throw Error("Final run was not received.");return g(this,Ke,"f")}async _createThreadAssistantStream(t,n,s){var i;const o=s==null?void 0:s.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const r={...n,stream:!0},a=await t.createAndRun(r,{...s,signal:this.controller.signal});this._connected();for await(const l of a)g(this,le,"m",bt).call(this,l);if((i=a.controller.signal)!=null&&i.aborted)throw new _e;return this._addRun(g(this,le,"m",wt).call(this))}async _createAssistantStream(t,n,s,o){var l;const r=o==null?void 0:o.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort()));const a={...s,stream:!0},i=await t.create(n,a,{...o,signal:this.controller.signal});this._connected();for await(const c of i)g(this,le,"m",bt).call(this,c);if((l=i.controller.signal)!=null&&l.aborted)throw new _e;return this._addRun(g(this,le,"m",wt).call(this))}static accumulateDelta(t,n){for(const[s,o]of Object.entries(n)){if(!t.hasOwnProperty(s)){t[s]=o;continue}let r=t[s];if(r==null){t[s]=o;continue}if(s==="index"||s==="type"){t[s]=o;continue}if(typeof r=="string"&&typeof o=="string")r+=o;else if(typeof r=="number"&&typeof o=="number")r+=o;else if(zn(r)&&zn(o))r=this.accumulateDelta(r,o);else if(Array.isArray(r)&&Array.isArray(o)){if(r.every(a=>typeof a=="string"||typeof a=="number")){r.push(...o);continue}for(const a of o){if(!zn(a))throw new Error(`Expected array delta entry to be an object but got: ${a}`);const i=a.index;if(i==null)throw console.error(a),new Error("Expected array delta entry to have an `index` property");if(typeof i!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${i}`);const l=r[i];l==null?r.push(a):r[i]=this.accumulateDelta(l,a)}continue}else throw Error(`Unhandled record type: ${s}, deltaValue: ${o}, accValue: ${r}`);t[s]=r}return t}_addRun(t){return t}async _threadAssistantStream(t,n,s){return await this._createThreadAssistantStream(n,t,s)}async _runAssistantStream(t,n,s,o){return await this._createAssistantStream(n,t,s,o)}async _runToolAssistantStream(t,n,s,o){return await this._createToolAssistantStream(n,t,s,o)}}Xe=Ct,bt=function(e){if(!this.ended)switch(V(this,Yt,e),g(this,le,"m",Io).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":g(this,le,"m",Po).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":g(this,le,"m",Ro).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":g(this,le,"m",Co).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},wt=function(){if(this.ended)throw new P("stream has ended, this shouldn't happen");if(!g(this,Ke,"f"))throw Error("Final run has not been received");return g(this,Ke,"f")},Co=function(e){const[t,n]=g(this,le,"m",Ao).call(this,e,g(this,xe,"f"));V(this,xe,t),g(this,Qt,"f")[t.id]=t;for(const s of n){const o=t.content[s.index];(o==null?void 0:o.type)=="text"&&this._emit("textCreated",o.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let o=s.text,r=t.content[s.index];if(r&&r.type=="text")this._emit("textDelta",o,r.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=g(this,ot,"f")){if(g(this,We,"f"))switch(g(this,We,"f").type){case"text":this._emit("textDone",g(this,We,"f").text,g(this,xe,"f"));break;case"image_file":this._emit("imageFileDone",g(this,We,"f").image_file,g(this,xe,"f"));break}V(this,ot,s.index)}V(this,We,t.content[s.index])}break;case"thread.message.completed":case"thread.message.incomplete":if(g(this,ot,"f")!==void 0){const s=e.data.content[g(this,ot,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,g(this,xe,"f"));break;case"text":this._emit("textDone",s.text,g(this,xe,"f"));break}}g(this,xe,"f")&&this._emit("messageDone",e.data),V(this,xe,void 0)}},Ro=function(e){const t=g(this,le,"m",ko).call(this,e);switch(V(this,xt,t),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const s of n.step_details.tool_calls)s.index==g(this,wn,"f")?this._emit("toolCallDelta",s,t.step_details.tool_calls[s.index]):(g(this,we,"f")&&this._emit("toolCallDone",g(this,we,"f")),V(this,wn,s.index),V(this,we,t.step_details.tool_calls[s.index]),g(this,we,"f")&&this._emit("toolCallCreated",g(this,we,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":V(this,xt,void 0),e.data.step_details.type=="tool_calls"&&g(this,we,"f")&&(this._emit("toolCallDone",g(this,we,"f")),V(this,we,void 0)),this._emit("runStepDone",e.data,t);break}},Io=function(e){g(this,ms,"f").push(e),this._emit("event",e)},ko=function(e){switch(e.event){case"thread.run.step.created":return g(this,ke,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=g(this,ke,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const s=Xe.accumulateDelta(t,n.delta);g(this,ke,"f")[e.data.id]=s}return g(this,ke,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":g(this,ke,"f")[e.data.id]=e.data;break}if(g(this,ke,"f")[e.data.id])return g(this,ke,"f")[e.data.id];throw new Error("No snapshot available")},Ao=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const o of s.delta.content)if(o.index in t.content){let r=t.content[o.index];t.content[o.index]=g(this,le,"m",Mo).call(this,o,r)}else t.content[o.index]=o,n.push(o);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Mo=function(e,t){return Xe.accumulateDelta(t,e)},Po=function(e){switch(V(this,Zt,e.data),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":V(this,Ke,e.data),g(this,we,"f")&&(this._emit("toolCallDone",g(this,we,"f")),V(this,we,void 0));break}};let $s=class extends M{constructor(){super(...arguments),this.steps=new sa(this._client)}create(e,t,n){const{include:s,...o}=t;return this._client.post(b`/threads/${e}/runs`,{query:{include:s},body:o,...n,headers:I([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers]),stream:t.stream??!1})}retrieve(e,t,n){const{thread_id:s}=t;return this._client.get(b`/threads/${s}/runs/${e}`,{...n,headers:I([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,t,n){const{thread_id:s,...o}=t;return this._client.post(b`/threads/${s}/runs/${e}`,{body:o,...n,headers:I([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}list(e,t={},n){return this._client.getAPIList(b`/threads/${e}/runs`,ee,{query:t,...n,headers:I([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}cancel(e,t,n){const{thread_id:s}=t;return this._client.post(b`/threads/${s}/runs/${e}/cancel`,{...n,headers:I([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}async createAndPoll(e,t,n){const s=await this.create(e,t,n);return await this.poll(s.id,{thread_id:e},n)}createAndStream(e,t,n){return Ct.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){var o;const s=I([n==null?void 0:n.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((o=n==null?void 0:n.pollIntervalMs)==null?void 0:o.toString())??void 0}]);for(;;){const{data:r,response:a}=await this.retrieve(e,t,{...n,headers:{...n==null?void 0:n.headers,...s}}).withResponse();switch(r.status){case"queued":case"in_progress":case"cancelling":let i=5e3;if(n!=null&&n.pollIntervalMs)i=n.pollIntervalMs;else{const l=a.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(i=c)}}await Mt(i);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return r}}}stream(e,t,n){return Ct.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n){const{thread_id:s,...o}=t;return this._client.post(b`/threads/${s}/runs/${e}/submit_tool_outputs`,{body:o,...n,headers:I([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers]),stream:t.stream??!1})}async submitToolOutputsAndPoll(e,t,n){const s=await this.submitToolOutputs(e,t,n);return await this.poll(s.id,t,n)}submitToolOutputsStream(e,t,n){return Ct.createToolAssistantStream(e,this._client.beta.threads.runs,t,n)}};$s.Steps=sa;class kn extends M{constructor(){super(...arguments),this.runs=new $s(this._client),this.messages=new na(this._client)}create(t={},n){return this._client.post("/threads",{body:t,...n,headers:I([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(t,n){return this._client.get(b`/threads/${t}`,{...n,headers:I([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(t,n,s){return this._client.post(b`/threads/${t}`,{body:n,...s,headers:I([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}delete(t,n){return this._client.delete(b`/threads/${t}`,{...n,headers:I([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}createAndRun(t,n){return this._client.post("/threads/runs",{body:t,...n,headers:I([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers]),stream:t.stream??!1})}async createAndRunPoll(t,n){const s=await this.createAndRun(t,n);return await this.runs.poll(s.id,{thread_id:s.thread_id},n)}createAndRunStream(t,n){return Ct.createThreadAssistantStream(t,this._client.beta.threads,n)}}kn.Runs=$s;kn.Messages=na;class at extends M{constructor(){super(...arguments),this.realtime=new Rn(this._client),this.chatkit=new In(this._client),this.assistants=new Qr(this._client),this.threads=new kn(this._client)}}at.Realtime=Rn;at.ChatKit=In;at.Assistants=Qr;at.Threads=kn;class oa extends M{create(t,n){return this._client.post("/completions",{body:t,...n,stream:t.stream??!1})}}class ra extends M{retrieve(t,n,s){const{container_id:o}=n;return this._client.get(b`/containers/${o}/files/${t}/content`,{...s,headers:I([{Accept:"application/binary"},s==null?void 0:s.headers]),__binaryResponse:!0})}}let Fs=class extends M{constructor(){super(...arguments),this.content=new ra(this._client)}create(e,t,n){return this._client.post(b`/containers/${e}/files`,Je({body:t,...n},this._client))}retrieve(e,t,n){const{container_id:s}=t;return this._client.get(b`/containers/${s}/files/${e}`,n)}list(e,t={},n){return this._client.getAPIList(b`/containers/${e}/files`,ee,{query:t,...n})}delete(e,t,n){const{container_id:s}=t;return this._client.delete(b`/containers/${s}/files/${e}`,{...n,headers:I([{Accept:"*/*"},n==null?void 0:n.headers])})}};Fs.Content=ra;class Es extends M{constructor(){super(...arguments),this.files=new Fs(this._client)}create(t,n){return this._client.post("/containers",{body:t,...n})}retrieve(t,n){return this._client.get(b`/containers/${t}`,n)}list(t={},n){return this._client.getAPIList("/containers",ee,{query:t,...n})}delete(t,n){return this._client.delete(b`/containers/${t}`,{...n,headers:I([{Accept:"*/*"},n==null?void 0:n.headers])})}}Es.Files=Fs;class aa extends M{create(t,n,s){const{include:o,...r}=n;return this._client.post(b`/conversations/${t}/items`,{query:{include:o},body:r,...s})}retrieve(t,n,s){const{conversation_id:o,...r}=n;return this._client.get(b`/conversations/${o}/items/${t}`,{query:r,...s})}list(t,n={},s){return this._client.getAPIList(b`/conversations/${t}/items`,hn,{query:n,...s})}delete(t,n,s){const{conversation_id:o}=n;return this._client.delete(b`/conversations/${o}/items/${t}`,s)}}class Vs extends M{constructor(){super(...arguments),this.items=new aa(this._client)}create(t={},n){return this._client.post("/conversations",{body:t,...n})}retrieve(t,n){return this._client.get(b`/conversations/${t}`,n)}update(t,n,s){return this._client.post(b`/conversations/${t}`,{body:n,...s})}delete(t,n){return this._client.delete(b`/conversations/${t}`,n)}}Vs.Items=aa;class ia extends M{create(t,n){const s=!!t.encoding_format;let o=s?t.encoding_format:"base64";s&&ie(this._client).debug("embeddings/user defined encoding_format:",t.encoding_format);const r=this._client.post("/embeddings",{body:{...t,encoding_format:o},...n});return s?r:(ie(this._client).debug("embeddings/decoding base64 embeddings from base64"),r._thenUnwrap(a=>(a&&a.data&&a.data.forEach(i=>{const l=i.embedding;i.embedding=xu(l)}),a)))}}class la extends M{retrieve(t,n,s){const{eval_id:o,run_id:r}=n;return this._client.get(b`/evals/${o}/runs/${r}/output_items/${t}`,s)}list(t,n,s){const{eval_id:o,...r}=n;return this._client.getAPIList(b`/evals/${o}/runs/${t}/output_items`,ee,{query:r,...s})}}class Ds extends M{constructor(){super(...arguments),this.outputItems=new la(this._client)}create(t,n,s){return this._client.post(b`/evals/${t}/runs`,{body:n,...s})}retrieve(t,n,s){const{eval_id:o}=n;return this._client.get(b`/evals/${o}/runs/${t}`,s)}list(t,n={},s){return this._client.getAPIList(b`/evals/${t}/runs`,ee,{query:n,...s})}delete(t,n,s){const{eval_id:o}=n;return this._client.delete(b`/evals/${o}/runs/${t}`,s)}cancel(t,n,s){const{eval_id:o}=n;return this._client.post(b`/evals/${o}/runs/${t}`,s)}}Ds.OutputItems=la;class Ls extends M{constructor(){super(...arguments),this.runs=new Ds(this._client)}create(t,n){return this._client.post("/evals",{body:t,...n})}retrieve(t,n){return this._client.get(b`/evals/${t}`,n)}update(t,n,s){return this._client.post(b`/evals/${t}`,{body:n,...s})}list(t={},n){return this._client.getAPIList("/evals",ee,{query:t,...n})}delete(t,n){return this._client.delete(b`/evals/${t}`,n)}}Ls.Runs=Ds;let ua=class extends M{create(e,t){return this._client.post("/files",Je({body:e,...t},this._client))}retrieve(e,t){return this._client.get(b`/files/${e}`,t)}list(e={},t){return this._client.getAPIList("/files",ee,{query:e,...t})}delete(e,t){return this._client.delete(b`/files/${e}`,t)}content(e,t){return this._client.get(b`/files/${e}/content`,{...t,headers:I([{Accept:"application/binary"},t==null?void 0:t.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:n=1800*1e3}={}){const s=new Set(["processed","error","deleted"]),o=Date.now();let r=await this.retrieve(e);for(;!r.status||!s.has(r.status);)if(await Mt(t),r=await this.retrieve(e),Date.now()-o>n)throw new Ss({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return r}};class ca extends M{}let da=class extends M{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...t})}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...t})}};class Ts extends M{constructor(){super(...arguments),this.graders=new da(this._client)}}Ts.Graders=da;class ha extends M{create(t,n,s){return this._client.getAPIList(b`/fine_tuning/checkpoints/${t}/permissions`,Cn,{body:n,method:"post",...s})}retrieve(t,n={},s){return this._client.get(b`/fine_tuning/checkpoints/${t}/permissions`,{query:n,...s})}delete(t,n,s){const{fine_tuned_model_checkpoint:o}=n;return this._client.delete(b`/fine_tuning/checkpoints/${o}/permissions/${t}`,s)}}let js=class extends M{constructor(){super(...arguments),this.permissions=new ha(this._client)}};js.Permissions=ha;class pa extends M{list(t,n={},s){return this._client.getAPIList(b`/fine_tuning/jobs/${t}/checkpoints`,ee,{query:n,...s})}}class qs extends M{constructor(){super(...arguments),this.checkpoints=new pa(this._client)}create(t,n){return this._client.post("/fine_tuning/jobs",{body:t,...n})}retrieve(t,n){return this._client.get(b`/fine_tuning/jobs/${t}`,n)}list(t={},n){return this._client.getAPIList("/fine_tuning/jobs",ee,{query:t,...n})}cancel(t,n){return this._client.post(b`/fine_tuning/jobs/${t}/cancel`,n)}listEvents(t,n={},s){return this._client.getAPIList(b`/fine_tuning/jobs/${t}/events`,ee,{query:n,...s})}pause(t,n){return this._client.post(b`/fine_tuning/jobs/${t}/pause`,n)}resume(t,n){return this._client.post(b`/fine_tuning/jobs/${t}/resume`,n)}}qs.Checkpoints=pa;class it extends M{constructor(){super(...arguments),this.methods=new ca(this._client),this.jobs=new qs(this._client),this.checkpoints=new js(this._client),this.alpha=new Ts(this._client)}}it.Methods=ca;it.Jobs=qs;it.Checkpoints=js;it.Alpha=Ts;class fa extends M{}class Ns extends M{constructor(){super(...arguments),this.graderModels=new fa(this._client)}}Ns.GraderModels=fa;class ga extends M{createVariation(t,n){return this._client.post("/images/variations",Je({body:t,...n},this._client))}edit(t,n){return this._client.post("/images/edits",Je({body:t,...n,stream:t.stream??!1},this._client))}generate(t,n){return this._client.post("/images/generations",{body:t,...n,stream:t.stream??!1})}}class ma extends M{retrieve(t,n){return this._client.get(b`/models/${t}`,n)}list(t){return this._client.getAPIList("/models",Cn,t)}delete(t,n){return this._client.delete(b`/models/${t}`,n)}}class ya extends M{create(t,n){return this._client.post("/moderations",{body:t,...n})}}class ba extends M{accept(t,n,s){return this._client.post(b`/realtime/calls/${t}/accept`,{body:n,...s,headers:I([{Accept:"*/*"},s==null?void 0:s.headers])})}hangup(t,n){return this._client.post(b`/realtime/calls/${t}/hangup`,{...n,headers:I([{Accept:"*/*"},n==null?void 0:n.headers])})}refer(t,n,s){return this._client.post(b`/realtime/calls/${t}/refer`,{body:n,...s,headers:I([{Accept:"*/*"},s==null?void 0:s.headers])})}reject(t,n={},s){return this._client.post(b`/realtime/calls/${t}/reject`,{body:n,...s,headers:I([{Accept:"*/*"},s==null?void 0:s.headers])})}}class wa extends M{create(t,n){return this._client.post("/realtime/client_secrets",{body:t,...n})}}class An extends M{constructor(){super(...arguments),this.clientSecrets=new wa(this._client),this.calls=new ba(this._client)}}An.ClientSecrets=wa;An.Calls=ba;function Cu(e,t){return!t||!Iu(t)?{...e,output_parsed:null,output:e.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(s=>({...s,parsed:null}))}:n)}:va(e,t)}function va(e,t){const n=e.output.map(o=>{if(o.type==="function_call")return{...o,parsed_arguments:Mu(t,o)};if(o.type==="message"){const r=o.content.map(a=>a.type==="output_text"?{...a,parsed:Ru(t,a.text)}:a);return{...o,content:r}}return o}),s=Object.assign({},e,{output:n});return Object.getOwnPropertyDescriptor(e,"output_text")||ys(s),Object.defineProperty(s,"output_parsed",{enumerable:!0,get(){for(const o of s.output)if(o.type==="message"){for(const r of o.content)if(r.type==="output_text"&&r.parsed!==null)return r.parsed}return null}}),s}function Ru(e,t){var n,s,o,r;return((s=(n=e.text)==null?void 0:n.format)==null?void 0:s.type)!=="json_schema"?null:"$parseRaw"in((o=e.text)==null?void 0:o.format)?((r=e.text)==null?void 0:r.format).$parseRaw(t):JSON.parse(t)}function Iu(e){var t;return!!Is((t=e.text)==null?void 0:t.format)}function ku(e){return(e==null?void 0:e.$brand)==="auto-parseable-tool"}function Au(e,t){return e.find(n=>n.type==="function"&&n.name===t)}function Mu(e,t){const n=Au(e.tools??[],t.name);return{...t,...t,parsed_arguments:ku(n)?n.$parseRaw(t.arguments):n!=null&&n.strict?JSON.parse(t.arguments):null}}function ys(e){const t=[];for(const n of e.output)if(n.type==="message")for(const s of n.content)s.type==="output_text"&&t.push(s.text);e.output_text=t.join("")}var et,zt,Te,Ut,Oo,$o,Fo,Eo;class Bs extends As{constructor(t){super(),et.add(this),zt.set(this,void 0),Te.set(this,void 0),Ut.set(this,void 0),V(this,zt,t)}static createResponse(t,n,s){const o=new Bs(n);return o._run(()=>o._createOrRetrieveResponse(t,n,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createOrRetrieveResponse(t,n,s){var i;const o=s==null?void 0:s.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort())),g(this,et,"m",Oo).call(this);let r,a=null;"response_id"in n?(r=await t.responses.retrieve(n.response_id,{stream:!0},{...s,signal:this.controller.signal,stream:!0}),a=n.starting_after??null):r=await t.responses.create({...n,stream:!0},{...s,signal:this.controller.signal}),this._connected();for await(const l of r)g(this,et,"m",$o).call(this,l,a);if((i=r.controller.signal)!=null&&i.aborted)throw new _e;return g(this,et,"m",Fo).call(this)}[(zt=new WeakMap,Te=new WeakMap,Ut=new WeakMap,et=new WeakSet,Oo=function(){this.ended||V(this,Te,void 0)},$o=function(t,n){if(this.ended)return;const s=(r,a)=>{(n==null||a.sequence_number>n)&&this._emit(r,a)},o=g(this,et,"m",Eo).call(this,t);switch(s("event",t),t.type){case"response.output_text.delta":{const r=o.output[t.output_index];if(!r)throw new P(`missing output at index ${t.output_index}`);if(r.type==="message"){const a=r.content[t.content_index];if(!a)throw new P(`missing content at index ${t.content_index}`);if(a.type!=="output_text")throw new P(`expected content to be 'output_text', got ${a.type}`);s("response.output_text.delta",{...t,snapshot:a.text})}break}case"response.function_call_arguments.delta":{const r=o.output[t.output_index];if(!r)throw new P(`missing output at index ${t.output_index}`);r.type==="function_call"&&s("response.function_call_arguments.delta",{...t,snapshot:r.arguments});break}default:s(t.type,t);break}},Fo=function(){if(this.ended)throw new P("stream has ended, this shouldn't happen");const t=g(this,Te,"f");if(!t)throw new P("request ended without sending any events");V(this,Te,void 0);const n=Pu(t,g(this,zt,"f"));return V(this,Ut,n),n},Eo=function(t){var s;let n=g(this,Te,"f");if(!n){if(t.type!=="response.created")throw new P(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return n=V(this,Te,t.response),n}switch(t.type){case"response.output_item.added":{n.output.push(t.item);break}case"response.content_part.added":{const o=n.output[t.output_index];if(!o)throw new P(`missing output at index ${t.output_index}`);const r=o.type,a=t.part;r==="message"&&a.type!=="reasoning_text"?o.content.push(a):r==="reasoning"&&a.type==="reasoning_text"&&(o.content||(o.content=[]),o.content.push(a));break}case"response.output_text.delta":{const o=n.output[t.output_index];if(!o)throw new P(`missing output at index ${t.output_index}`);if(o.type==="message"){const r=o.content[t.content_index];if(!r)throw new P(`missing content at index ${t.content_index}`);if(r.type!=="output_text")throw new P(`expected content to be 'output_text', got ${r.type}`);r.text+=t.delta}break}case"response.function_call_arguments.delta":{const o=n.output[t.output_index];if(!o)throw new P(`missing output at index ${t.output_index}`);o.type==="function_call"&&(o.arguments+=t.delta);break}case"response.reasoning_text.delta":{const o=n.output[t.output_index];if(!o)throw new P(`missing output at index ${t.output_index}`);if(o.type==="reasoning"){const r=(s=o.content)==null?void 0:s[t.content_index];if(!r)throw new P(`missing content at index ${t.content_index}`);if(r.type!=="reasoning_text")throw new P(`expected content to be 'reasoning_text', got ${r.type}`);r.text+=t.delta}break}case"response.completed":{V(this,Te,t.response);break}}return n},Symbol.asyncIterator)](){const t=[],n=[];let s=!1;return this.on("event",o=>{const r=n.shift();r?r.resolve(o):t.push(o)}),this.on("end",()=>{s=!0;for(const o of n)o.resolve(void 0);n.length=0}),this.on("abort",o=>{s=!0;for(const r of n)r.reject(o);n.length=0}),this.on("error",o=>{s=!0;for(const r of n)r.reject(o);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((o,r)=>n.push({resolve:o,reject:r})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const t=g(this,Ut,"f");if(!t)throw new P("stream ended without producing a ChatCompletion");return t}}function Pu(e,t){return Cu(e,t)}class _a extends M{list(t,n={},s){return this._client.getAPIList(b`/responses/${t}/input_items`,ee,{query:n,...s})}}class Sa extends M{count(t={},n){return this._client.post("/responses/input_tokens",{body:t,...n})}}class Mn extends M{constructor(){super(...arguments),this.inputItems=new _a(this._client),this.inputTokens=new Sa(this._client)}create(t,n){return this._client.post("/responses",{body:t,...n,stream:t.stream??!1})._thenUnwrap(s=>("object"in s&&s.object==="response"&&ys(s),s))}retrieve(t,n={},s){return this._client.get(b`/responses/${t}`,{query:n,...s,stream:(n==null?void 0:n.stream)??!1})._thenUnwrap(o=>("object"in o&&o.object==="response"&&ys(o),o))}delete(t,n){return this._client.delete(b`/responses/${t}`,{...n,headers:I([{Accept:"*/*"},n==null?void 0:n.headers])})}parse(t,n){return this._client.responses.create(t,n)._thenUnwrap(s=>va(s,t))}stream(t,n){return Bs.createResponse(this._client,t,n)}cancel(t,n){return this._client.post(b`/responses/${t}/cancel`,n)}}Mn.InputItems=_a;Mn.InputTokens=Sa;class xa extends M{create(t,n,s){return this._client.post(b`/uploads/${t}/parts`,Je({body:n,...s},this._client))}}class Hs extends M{constructor(){super(...arguments),this.parts=new xa(this._client)}create(t,n){return this._client.post("/uploads",{body:t,...n})}cancel(t,n){return this._client.post(b`/uploads/${t}/cancel`,n)}complete(t,n,s){return this._client.post(b`/uploads/${t}/complete`,{body:n,...s})}}Hs.Parts=xa;const Ou=async e=>{const t=await Promise.allSettled(e),n=t.filter(o=>o.status==="rejected");if(n.length){for(const o of n)console.error(o.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const s=[];for(const o of t)o.status==="fulfilled"&&s.push(o.value);return s};class Ca extends M{create(t,n,s){return this._client.post(b`/vector_stores/${t}/file_batches`,{body:n,...s,headers:I([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}retrieve(t,n,s){const{vector_store_id:o}=n;return this._client.get(b`/vector_stores/${o}/file_batches/${t}`,{...s,headers:I([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}cancel(t,n,s){const{vector_store_id:o}=n;return this._client.post(b`/vector_stores/${o}/file_batches/${t}/cancel`,{...s,headers:I([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}async createAndPoll(t,n,s){const o=await this.create(t,n);return await this.poll(t,o.id,s)}listFiles(t,n,s){const{vector_store_id:o,...r}=n;return this._client.getAPIList(b`/vector_stores/${o}/file_batches/${t}/files`,ee,{query:r,...s,headers:I([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}async poll(t,n,s){var r;const o=I([s==null?void 0:s.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((r=s==null?void 0:s.pollIntervalMs)==null?void 0:r.toString())??void 0}]);for(;;){const{data:a,response:i}=await this.retrieve(n,{vector_store_id:t},{...s,headers:o}).withResponse();switch(a.status){case"in_progress":let l=5e3;if(s!=null&&s.pollIntervalMs)l=s.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const f=parseInt(c);isNaN(f)||(l=f)}}await Mt(l);break;case"failed":case"cancelled":case"completed":return a}}}async uploadAndPoll(t,{files:n,fileIds:s=[]},o){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const r=(o==null?void 0:o.maxConcurrency)??5,a=Math.min(r,n.length),i=this._client,l=n.values(),c=[...s];async function f(h){for(let u of h){const d=await i.files.create({file:u,purpose:"assistants"},o);c.push(d.id)}}const p=Array(a).fill(l).map(f);return await Ou(p),await this.createAndPoll(t,{file_ids:c})}}class Ra extends M{create(t,n,s){return this._client.post(b`/vector_stores/${t}/files`,{body:n,...s,headers:I([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}retrieve(t,n,s){const{vector_store_id:o}=n;return this._client.get(b`/vector_stores/${o}/files/${t}`,{...s,headers:I([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}update(t,n,s){const{vector_store_id:o,...r}=n;return this._client.post(b`/vector_stores/${o}/files/${t}`,{body:r,...s,headers:I([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}list(t,n={},s){return this._client.getAPIList(b`/vector_stores/${t}/files`,ee,{query:n,...s,headers:I([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}delete(t,n,s){const{vector_store_id:o}=n;return this._client.delete(b`/vector_stores/${o}/files/${t}`,{...s,headers:I([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}async createAndPoll(t,n,s){const o=await this.create(t,n,s);return await this.poll(t,o.id,s)}async poll(t,n,s){var r;const o=I([s==null?void 0:s.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((r=s==null?void 0:s.pollIntervalMs)==null?void 0:r.toString())??void 0}]);for(;;){const a=await this.retrieve(n,{vector_store_id:t},{...s,headers:o}).withResponse(),i=a.data;switch(i.status){case"in_progress":let l=5e3;if(s!=null&&s.pollIntervalMs)l=s.pollIntervalMs;else{const c=a.response.headers.get("openai-poll-after-ms");if(c){const f=parseInt(c);isNaN(f)||(l=f)}}await Mt(l);break;case"failed":case"completed":return i}}}async upload(t,n,s){const o=await this._client.files.create({file:n,purpose:"assistants"},s);return this.create(t,{file_id:o.id},s)}async uploadAndPoll(t,n,s){const o=await this.upload(t,n,s);return await this.poll(t,o.id,s)}content(t,n,s){const{vector_store_id:o}=n;return this._client.getAPIList(b`/vector_stores/${o}/files/${t}/content`,Cn,{...s,headers:I([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}class Pn extends M{constructor(){super(...arguments),this.files=new Ra(this._client),this.fileBatches=new Ca(this._client)}create(t,n){return this._client.post("/vector_stores",{body:t,...n,headers:I([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(t,n){return this._client.get(b`/vector_stores/${t}`,{...n,headers:I([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(t,n,s){return this._client.post(b`/vector_stores/${t}`,{body:n,...s,headers:I([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}list(t={},n){return this._client.getAPIList("/vector_stores",ee,{query:t,...n,headers:I([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(t,n){return this._client.delete(b`/vector_stores/${t}`,{...n,headers:I([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}search(t,n,s){return this._client.getAPIList(b`/vector_stores/${t}/search`,Cn,{body:n,method:"post",...s,headers:I([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}Pn.Files=Ra;Pn.FileBatches=Ca;class Ia extends M{create(t,n){return this._client.post("/videos",wo({body:t,...n},this._client))}retrieve(t,n){return this._client.get(b`/videos/${t}`,n)}list(t={},n){return this._client.getAPIList("/videos",hn,{query:t,...n})}delete(t,n){return this._client.delete(b`/videos/${t}`,n)}downloadContent(t,n={},s){return this._client.get(b`/videos/${t}/content`,{query:n,...s,headers:I([{Accept:"application/binary"},s==null?void 0:s.headers]),__binaryResponse:!0})}remix(t,n,s){return this._client.post(b`/videos/${t}/remix`,wo({body:n,...s},this._client))}}var st,ka,en;class Aa extends M{constructor(){super(...arguments),st.add(this)}async unwrap(t,n,s=this._client.webhookSecret,o=300){return await this.verifySignature(t,n,s,o),JSON.parse(t)}async verifySignature(t,n,s=this._client.webhookSecret,o=300){if(typeof crypto>"u"||typeof crypto.subtle.importKey!="function"||typeof crypto.subtle.verify!="function")throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");g(this,st,"m",ka).call(this,s);const r=I([n]).values,a=g(this,st,"m",en).call(this,r,"webhook-signature"),i=g(this,st,"m",en).call(this,r,"webhook-timestamp"),l=g(this,st,"m",en).call(this,r,"webhook-id"),c=parseInt(i,10);if(isNaN(c))throw new dt("Invalid webhook timestamp format");const f=Math.floor(Date.now()/1e3);if(f-c>o)throw new dt("Webhook timestamp is too old");if(c>f+o)throw new dt("Webhook timestamp is too new");const p=a.split(" ").map(m=>m.startsWith("v1,")?m.substring(3):m),h=s.startsWith("whsec_")?Buffer.from(s.replace("whsec_",""),"base64"):Buffer.from(s,"utf-8"),u=l?`${l}.${i}.${t}`:`${i}.${t}`,d=await crypto.subtle.importKey("raw",h,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(const m of p)try{const y=Buffer.from(m,"base64");if(await crypto.subtle.verify("HMAC",d,y,new TextEncoder().encode(u)))return}catch{continue}throw new dt("The given webhook signature does not match the expected signature")}}st=new WeakSet,ka=function(e){if(typeof e!="string"||e.length===0)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},en=function(e,t){if(!e)throw new Error("Headers are required");const n=e.get(t);if(n==null)throw new Error(`Missing required header: ${t}`);return n};var bs,zs,tn,Ma;class N{constructor({baseURL:t=Ze("OPENAI_BASE_URL"),apiKey:n=Ze("OPENAI_API_KEY"),organization:s=Ze("OPENAI_ORG_ID")??null,project:o=Ze("OPENAI_PROJECT_ID")??null,webhookSecret:r=Ze("OPENAI_WEBHOOK_SECRET")??null,...a}={}){if(bs.add(this),tn.set(this,void 0),this.completions=new oa(this),this.chat=new Os(this),this.embeddings=new ia(this),this.files=new ua(this),this.images=new ga(this),this.audio=new Ot(this),this.moderations=new ya(this),this.models=new ma(this),this.fineTuning=new it(this),this.graders=new Ns(this),this.vectorStores=new Pn(this),this.webhooks=new Aa(this),this.beta=new at(this),this.batches=new Jr(this),this.uploads=new Hs(this),this.responses=new Mn(this),this.realtime=new An(this),this.conversations=new Vs(this),this.evals=new Ls(this),this.containers=new Es(this),this.videos=new Ia(this),n===void 0)throw new P("Missing credentials. Please pass an `apiKey`, or set the `OPENAI_API_KEY` environment variable.");const i={apiKey:n,organization:s,project:o,webhookSecret:r,...a,baseURL:t||"https://api.openai.com/v1"};if(!i.dangerouslyAllowBrowser&&Fl())throw new P(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=i.baseURL,this.timeout=i.timeout??zs.DEFAULT_TIMEOUT,this.logger=i.logger??console;const l="warn";this.logLevel=l,this.logLevel=yo(i.logLevel,"ClientOptions.logLevel",this)??yo(Ze("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??l,this.fetchOptions=i.fetchOptions,this.maxRetries=i.maxRetries??2,this.fetch=i.fetch??Tl(),V(this,tn,ql),this._options=i,this.apiKey=typeof n=="string"?n:"Missing Key",this.organization=s,this.project=o,this.webhookSecret=r}withOptions(t){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...t})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:n}){}async authHeaders(t){return I([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(t){return Gl(t,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${tt}`}defaultIdempotencyKey(){return`stainless-node-retry-${Yo()}`}makeStatusError(t,n,s,o){return ce.generate(t,n,s,o)}async _callApiKey(){const t=this._options.apiKey;if(typeof t!="function")return!1;let n;try{n=await t()}catch(s){throw s instanceof P?s:new P(`Failed to get token from 'apiKey' function: ${s.message}`,{cause:s})}if(typeof n!="string"||!n)throw new P(`Expected 'apiKey' function argument to return a string but it returned ${n}`);return this.apiKey=n,!0}buildURL(t,n,s){const o=!g(this,bs,"m",Ma).call(this)&&s||this.baseURL,r=Al(t)?new URL(t):new URL(o+(o.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),a=this.defaultQuery();return Ml(a)||(n={...a,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}async prepareOptions(t){await this._callApiKey()}async prepareRequest(t,{url:n,options:s}){}get(t,n){return this.methodRequest("get",t,n)}post(t,n){return this.methodRequest("post",t,n)}patch(t,n){return this.methodRequest("patch",t,n)}put(t,n){return this.methodRequest("put",t,n)}delete(t,n){return this.methodRequest("delete",t,n)}methodRequest(t,n,s){return this.request(Promise.resolve(s).then(o=>({method:t,path:n,...o})))}request(t,n=null){return new xn(this,this.makeRequest(t,n,void 0))}async makeRequest(t,n,s){var x,S;const o=await t,r=o.maxRetries??this.maxRetries;n==null&&(n=r),await this.prepareOptions(o);const{req:a,url:i,timeout:l}=await this.buildRequest(o,{retryCount:r-n});await this.prepareRequest(a,{url:i,options:o});const c="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),f=s===void 0?"":`, retryOf: ${s}`,p=Date.now();if(ie(this).debug(`[${c}] sending request`,Ue({retryOfRequestLogID:s,method:o.method,url:i,options:o,headers:a.headers})),(x=o.signal)==null?void 0:x.aborted)throw new _e;const h=new AbortController,u=await this.fetchWithTimeout(i,a,l,h).catch(as),d=Date.now();if(u instanceof globalThis.Error){const C=`retrying, ${n} attempts remaining`;if((S=o.signal)!=null&&S.aborted)throw new _e;const F=rs(u)||/timed? ?out/i.test(String(u)+("cause"in u?String(u.cause):""));if(n)return ie(this).info(`[${c}] connection ${F?"timed out":"failed"} - ${C}`),ie(this).debug(`[${c}] connection ${F?"timed out":"failed"} (${C})`,Ue({retryOfRequestLogID:s,url:i,durationMs:d-p,message:u.message})),this.retryRequest(o,n,s??c);throw ie(this).info(`[${c}] connection ${F?"timed out":"failed"} - error; no more retries left`),ie(this).debug(`[${c}] connection ${F?"timed out":"failed"} (error; no more retries left)`,Ue({retryOfRequestLogID:s,url:i,durationMs:d-p,message:u.message})),F?new Ss:new _n({cause:u})}const m=[...u.headers.entries()].filter(([C])=>C==="x-request-id").map(([C,F])=>", "+C+": "+JSON.stringify(F)).join(""),y=`[${c}${f}${m}] ${a.method} ${i} ${u.ok?"succeeded":"failed"} with status ${u.status} in ${d-p}ms`;if(!u.ok){const C=await this.shouldRetry(u);if(n&&C){const G=`retrying, ${n} attempts remaining`;return await jl(u.body),ie(this).info(`${y} - ${G}`),ie(this).debug(`[${c}] response error (${G})`,Ue({retryOfRequestLogID:s,url:u.url,status:u.status,headers:u.headers,durationMs:d-p})),this.retryRequest(o,n,s??c,u.headers)}const F=C?"error; no more retries left":"error; not retryable";ie(this).info(`${y} - ${F}`);const z=await u.text().catch(G=>as(G).message),B=$l(z),X=B?void 0:z;throw ie(this).debug(`[${c}] response error (${F})`,Ue({retryOfRequestLogID:s,url:u.url,status:u.status,headers:u.headers,message:X,durationMs:Date.now()-p})),this.makeStatusError(u.status,B,X,u.headers)}return ie(this).info(y),ie(this).debug(`[${c}] response start`,Ue({retryOfRequestLogID:s,url:u.url,status:u.status,headers:u.headers,durationMs:d-p})),{response:u,options:o,controller:h,requestLogID:c,retryOfRequestLogID:s,startTime:p}}getAPIList(t,n,s){return this.requestAPIList(n,{method:"get",path:t,...s})}requestAPIList(t,n){const s=this.makeRequest(n,null,void 0);return new tu(this,s,t)}async fetchWithTimeout(t,n,s,o){const{signal:r,method:a,...i}=n||{};r&&r.addEventListener("abort",()=>o.abort());const l=setTimeout(()=>o.abort(),s),c=globalThis.ReadableStream&&i.body instanceof globalThis.ReadableStream||typeof i.body=="object"&&i.body!==null&&Symbol.asyncIterator in i.body,f={signal:o.signal,...c?{duplex:"half"}:{},method:"GET",...i};a&&(f.method=a.toUpperCase());try{return await this.fetch.call(void 0,t,f)}finally{clearTimeout(l)}}async shouldRetry(t){const n=t.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,n,s,o){let r;const a=o==null?void 0:o.get("retry-after-ms");if(a){const l=parseFloat(a);Number.isNaN(l)||(r=l)}const i=o==null?void 0:o.get("retry-after");if(i&&!r){const l=parseFloat(i);Number.isNaN(l)?r=Date.parse(i)-Date.now():r=l*1e3}if(!(r&&0<=r&&r<60*1e3)){const l=t.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(n,l)}return await Mt(r),this.makeRequest(t,n-1,s)}calculateDefaultRetryTimeoutMillis(t,n){const s=n-t,o=Math.min(.5*Math.pow(2,s),8),r=1-Math.random()*.25;return o*r*1e3}async buildRequest(t,{retryCount:n=0}={}){const s={...t},{method:o,path:r,query:a,defaultBaseURL:i}=s,l=this.buildURL(r,a,i);"timeout"in s&&Ol("timeout",s.timeout),s.timeout=s.timeout??this.timeout;const{bodyHeaders:c,body:f}=this.buildBody({options:s}),p=await this.buildHeaders({options:t,method:o,bodyHeaders:c,retryCount:n});return{req:{method:o,headers:p,...s.signal&&{signal:s.signal},...globalThis.ReadableStream&&f instanceof globalThis.ReadableStream&&{duplex:"half"},...f&&{body:f},...this.fetchOptions??{},...s.fetchOptions??{}},url:l,timeout:s.timeout}}async buildHeaders({options:t,method:n,bodyHeaders:s,retryCount:o}){let r={};this.idempotencyHeader&&n!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),r[this.idempotencyHeader]=t.idempotencyKey);const a=I([r,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(o),...t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{},...Ll(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(t),this._options.defaultHeaders,s,t.headers]);return this.validateHeaders(a),a.values}buildBody({options:{body:t,headers:n}}){if(!t)return{bodyHeaders:void 0,body:void 0};const s=I([n]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||typeof t=="string"&&s.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:typeof t=="object"&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&typeof t.next=="function")?{bodyHeaders:void 0,body:dr(t)}:g(this,tn,"f").call(this,{body:t,headers:s})}}zs=N,tn=new WeakMap,bs=new WeakSet,Ma=function(){return this.baseURL!=="https://api.openai.com/v1"};N.OpenAI=zs;N.DEFAULT_TIMEOUT=6e5;N.OpenAIError=P;N.APIError=ce;N.APIConnectionError=_n;N.APIConnectionTimeoutError=Ss;N.APIUserAbortError=_e;N.NotFoundError=nr;N.ConflictError=sr;N.RateLimitError=rr;N.BadRequestError=Zo;N.AuthenticationError=er;N.InternalServerError=ar;N.PermissionDeniedError=tr;N.UnprocessableEntityError=or;N.InvalidWebhookSignatureError=dt;N.toFile=au;N.Completions=oa;N.Chat=Os;N.Embeddings=ia;N.Files=ua;N.Images=ga;N.Audio=Ot;N.Moderations=ya;N.Models=ma;N.FineTuning=it;N.Graders=Ns;N.VectorStores=Pn;N.Webhooks=Aa;N.Beta=at;N.Batches=Jr;N.Uploads=Hs;N.Responses=Mn;N.Realtime=An;N.Conversations=Vs;N.Evals=Ls;N.Containers=Es;N.Videos=Ia;const $u=Be({__name:"filter-operator",props:Qe({options:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=ge(e,"modelValue");return(n,s)=>(w(),A(qo,null,{default:v(()=>[_(To,{"as-child":""},{default:v(()=>[_(Ae,{variant:"outline",size:"sm"},{default:v(()=>{var o;return[re(U((o=e.options.find(r=>r.value===t.value))==null?void 0:o.label),1)]}),_:1})]),_:1}),_(jo,{align:"start"},{default:v(()=>[_(bi,{modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=o=>t.value=o)},{default:v(()=>[(w(!0),H(K,null,ue(e.options,o=>(w(),A(wi,{key:o.value,value:o.value},{default:v(()=>[re(U(o.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}))}}),Yn=Be({inheritAttrs:!1,__name:"filter-input",props:Qe({class:{},prefix:{},suffix:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=ge(e,"modelValue");return(n,s)=>(w(),A(Bo,{class:rt(k(Zn)("h-8 w-fit",e.class))},{default:v(()=>[e.prefix?(w(),A(nn,{key:0,align:"inline-start"},{default:v(()=>[(w(),A(Ve(e.prefix)))]),_:1})):W("",!0),_(No,Gt({modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=o=>t.value=o)},n.$attrs),null,16,["modelValue"]),e.suffix?(w(),A(nn,{key:1,align:"inline-end"},{default:v(()=>[(w(),A(Ve(e.suffix)))]),_:1})):W("",!0)]),_:1},8,["class"]))}}),Fu={key:0,class:"[&>*:not([class*='bg-'])]:bg-background *:ring-background flex items-center -space-x-0.5 *:ring-1 [&>*:not([class*='rounded-'])]:rounded-full"},Eu=Be({__name:"filter-select-options-popover",props:Qe({definition:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const{t}=At(),n=ge(e,"modelValue"),s=se(()=>e.definition.type==="multiselect"),o=se(()=>n.value===void 0?[]:Array.isArray(n.value)?n.value:[n.value]),r=se(()=>e.definition.options.filter(f=>o.value.includes(f.value))),a=se(()=>e.definition.hideValueIcon?[]:r.value.filter(f=>f.icon)),i=se(()=>e.definition.options.filter(f=>!o.value.includes(f.value)));function l(f){s.value?n.value=o.value.filter(p=>p!==f):n.value=void 0}function c(f){s.value?n.value=[...o.value,f]:n.value=f}return(f,p)=>(w(),A(cn,null,{default:v(()=>[_(sn,{"as-child":""},{default:v(()=>[_(Ae,{variant:"outline",size:"sm"},{default:v(()=>{var h;return[a.value.length?(w(),H("div",Fu,[(w(!0),H(K,null,ue(a.value.slice(0,3),u=>(w(),A(Ve(u.icon),{key:String(u.value)}))),128))])):W("",!0),Z("span",null,[r.value.length===1?(w(),H(K,{key:0},[re(U((h=r.value[0])==null?void 0:h.label),1)],64)):(w(),H(K,{key:1},[re(U(k(t)("filters.selected",{count:r.value.length})),1)],64))])]}),_:1})]),_:1}),_(on,{align:"start",class:"w-[200px] p-0"},{default:v(()=>[_(rn,null,{default:v(()=>[_(an,{placeholder:e.definition.label},null,8,["placeholder"]),_(ln,null,{default:v(()=>[_(un,null,{default:v(()=>[re(U(k(t)("filters.noResults")),1)]),_:1}),r.value.length?(w(),A(Rt,{key:0},{default:v(()=>[(w(!0),H(K,null,ue(r.value,h=>(w(),A(It,{key:String(h.value),value:h.label,onSelect:()=>l(h.value)},{default:v(()=>[h.icon?(w(),A(Ve(h.icon),{key:0})):W("",!0),Z("span",null,U(h.label),1),_(k(Lo),{class:"ml-auto"})]),_:2},1032,["value","onSelect"]))),128))]),_:1})):W("",!0),r.value.length&&i.value.length?(w(),A(_i,{key:1})):W("",!0),i.value.length?(w(),A(Rt,{key:2},{default:v(()=>[(w(!0),H(K,null,ue(i.value,h=>(w(),A(It,{key:String(h.value),value:h.label,onSelect:()=>c(h.value)},{default:v(()=>[h.icon?(w(),A(Ve(h.icon),{key:0})):W("",!0),Z("span",null,U(h.label),1)]),_:2},1032,["value","onSelect"]))),128))]),_:1})):W("",!0)]),_:1})]),_:1})]),_:1})]),_:1}))}}),Vu={key:0,class:"flex h-8 items-center justify-center rounded-md border px-3"},Du={class:"flex h-8 items-center justify-center border px-3 text-sm font-medium"},Lu=Be({__name:"filter-value-selector",props:Qe({definition:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const{t}=At(),n=ge(e,"modelValue"),s=se(()=>Array.isArray(n.value)?n.value[0]:n.value),o=se(()=>s.value!==void 0?String(s.value):""),r=se(()=>Array.isArray(n.value)?[String(n.value[0]??""),String(n.value[1]??"")]:["",""]);return(a,i)=>e.definition.type==="boolean"?(w(),H("div",Vu,[_(vi,{"model-value":!!s.value,"onUpdate:modelValue":i[0]||(i[0]=l=>n.value=l)},null,8,["model-value"])])):e.definition.type==="select"||e.definition.type==="multiselect"?(w(),A(Eu,{key:1,modelValue:n.value,"onUpdate:modelValue":i[1]||(i[1]=l=>n.value=l),definition:e.definition},null,8,["modelValue","definition"])):e.definition.type==="inputrange"?(w(),H(K,{key:2},[_(Yn,Gt(e.definition.inputAttributes,{type:e.definition.inputType,prefix:e.definition.prefix,suffix:e.definition.suffix,placeholder:k(t)("filters.range.min"),"model-value":r.value[0],"onUpdate:modelValue":i[2]||(i[2]=l=>n.value=[l??"",r.value[1]])}),null,16,["type","prefix","suffix","placeholder","model-value"]),Z("div",Du,U(k(t)("filters.range.to")),1),_(Yn,Gt(e.definition.inputAttributes,{type:e.definition.inputType,prefix:e.definition.prefix,suffix:e.definition.suffix,placeholder:k(t)("filters.range.max"),"model-value":r.value[1],"onUpdate:modelValue":i[3]||(i[3]=l=>n.value=[r.value[0],l??""])}),null,16,["type","prefix","suffix","placeholder","model-value"])],64)):e.definition.type==="input"?(w(),A(Yn,Gt({key:3},e.definition.inputAttributes,{type:e.definition.inputType,prefix:e.definition.prefix,suffix:e.definition.suffix,"model-value":o.value,"onUpdate:modelValue":i[4]||(i[4]=l=>n.value=l)}),null,16,["type","prefix","suffix","model-value"])):W("",!0)}}),Tu={class:"flex flex-wrap gap-2"},ju={class:"sr-only"},qu={class:"sr-only"},Nu=Be({__name:"filters",props:Qe({definitions:{}},{filters:{required:!0},filtersModifiers:{}}),emits:["update:filters"],setup(e){const{t}=At(),n=ge(e,"filters"),s=qa({}),o=vt(!1),r=se(()=>e.definitions.reduce((u,d)=>(u[d.key]=d,u),{})),a=se(()=>{const u=new Set(n.value.map(d=>d.field).filter(d=>{var m;return!((m=r.value[d])!=null&&m.enableMultipleInstances)}));return e.definitions.filter(d=>d.enableMultipleInstances||!u.has(d.key))}),i=u=>{if(!u.pinned)return!1;const d=r.value[u.field];return(d==null?void 0:d.type)!=="select"&&(d==null?void 0:d.type)!=="multiselect"?!1:u.value===void 0||u.value===null?!0:Array.isArray(u.value)?u.value.length===0:!1},l=(u,d)=>{n.value=n.value.map(m=>m.id!==u?m:{...m,...d})},c=u=>{n.value=n.value.filter(d=>d.id!==u)},f=(u,d)=>{var x;const m=r.value[u.field],y=m.type==="multiselect";l(u.id,{operator:u.operator||((x=m.operators[0])==null?void 0:x.value),value:y?[d]:d}),s[u.id]=!1},p=u=>{var d;if(u.pinned){const m=((d=r.value[u.field])==null?void 0:d.type)==="multiselect";l(u.id,{value:m?[]:void 0})}else c(u.id)},h=u=>{var y,x;let d;u.type==="select"?d=(y=u.options[0])==null?void 0:y.value:u.type==="multiselect"&&(d=u.options[0]?[u.options[0].value]:[]);const m={id:crypto.randomUUID(),field:u.key,operator:((x=u.operators[0])==null?void 0:x.value)??"",value:d};n.value=[...n.value,m],o.value=!1};return(u,d)=>(w(),H("div",Tu,[(w(!0),H(K,null,ue(n.value,m=>(w(),H(K,{key:m.id},[r.value[m.field]&&i(m)?(w(),A(cn,{key:0,open:s[m.id],"onUpdate:open":y=>s[m.id]=y},{default:v(()=>[_(sn,{"as-child":""},{default:v(()=>[_(Ae,{variant:"outline",size:"sm"},{default:v(()=>[r.value[m.field].icon?(w(),A(Ve(r.value[m.field].icon),{key:0})):W("",!0),Z("span",null,U(r.value[m.field].label),1)]),_:2},1024)]),_:2},1024),_(on,{align:"start",class:"w-[200px] p-0"},{default:v(()=>[_(rn,null,{default:v(()=>[_(an,{placeholder:r.value[m.field].label},null,8,["placeholder"]),_(ln,null,{default:v(()=>[_(un,null,{default:v(()=>[re(U(k(t)("filters.noResults")),1)]),_:1}),_(Rt,null,{default:v(()=>[(w(!0),H(K,null,ue(r.value[m.field].options,y=>(w(),A(It,{key:String(y.value),value:y.label,onSelect:()=>f(m,y.value)},{default:v(()=>[y.icon?(w(),A(Ve(y.icon),{key:0})):W("",!0),Z("span",null,U(y.label),1)]),_:2},1032,["value","onSelect"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["open","onUpdate:open"])):r.value[m.field]?(w(),A(mi,{key:1},{default:v(()=>[_(hi,{class:"bg-background gap-1.5 px-3 has-[>svg]:px-2.5"},{default:v(()=>[r.value[m.field].icon?(w(),A(Ve(r.value[m.field].icon),{key:0})):W("",!0),Z("span",null,U(r.value[m.field].label),1)]),_:2},1024),r.value[m.field].operators.length?(w(),A($u,{key:0,"model-value":m.operator,options:r.value[m.field].operators,"onUpdate:modelValue":y=>l(m.id,{operator:y})},null,8,["model-value","options","onUpdate:modelValue"])):W("",!0),m.hideValue?W("",!0):(w(),A(Lu,{key:1,definition:r.value[m.field],"model-value":m.value,"onUpdate:modelValue":y=>l(m.id,{value:y})},null,8,["definition","model-value","onUpdate:modelValue"])),_(pi,null,{default:v(()=>[_(fi,{"as-child":""},{default:v(()=>[_(Ae,{variant:"outline",size:"icon-sm",onClick:y=>p(m)},{default:v(()=>[_(k(Na)),Z("span",ju,U(m.pinned?k(t)("filters.clearFilter"):k(t)("filters.removeFilter")),1)]),_:2},1032,["onClick"])]),_:2},1024),_(gi,null,{default:v(()=>[re(U(m.pinned?k(t)("filters.clearFilter"):k(t)("filters.removeFilter")),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)):W("",!0)],64))),128)),a.value.length?(w(),A(cn,{key:0,open:o.value,"onUpdate:open":d[0]||(d[0]=m=>o.value=m)},{default:v(()=>[_(sn,{"as-child":""},{default:v(()=>[_(Ae,{variant:"outline",size:"icon-sm"},{default:v(()=>[_(k(Vi)),Z("span",qu,U(k(t)("filters.addFilter")),1)]),_:1})]),_:1}),_(on,{align:"start",class:"w-[200px] p-0"},{default:v(()=>[_(rn,null,{default:v(()=>[_(an,{placeholder:k(t)("filters.filterPlaceholder")},null,8,["placeholder"]),_(ln,null,{default:v(()=>[_(un,null,{default:v(()=>[re(U(k(t)("filters.noResults")),1)]),_:1}),_(Rt,null,{default:v(()=>[(w(!0),H(K,null,ue(a.value,m=>(w(),A(It,{key:m.key,value:m.label,onSelect:()=>h(m)},{default:v(()=>[m.icon?(w(),A(Ve(m.icon),{key:0})):W("",!0),Z("span",null,U(m.label),1)]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])):W("",!0)]))}}),Bu={class:"flex w-full flex-col gap-3 self-stretch"},Hu={class:"flex flex-wrap justify-between gap-2"},zu={class:"flex flex-wrap items-center gap-2"},Uu={class:"flex flex-wrap items-center gap-2"},Gu={key:0,class:"bg-muted flex flex-wrap items-center justify-between gap-2 rounded-lg p-1"},Wu={class:"flex flex-wrap items-center gap-2"},Xu={class:"flex flex-wrap items-center gap-2"},Ku={key:1,"data-slot":"frame",class:"bg-muted relative flex flex-col rounded-lg"},Ju={"data-slot":"frame-panel",class:"relative bg-clip-padding p-1 dark:bg-clip-border"},Qu={key:0,class:"flex items-center justify-between gap-2"},Yu={class:"min-w-0 flex-1"},Zu={key:0,class:"flex items-center justify-between px-4 pt-1 pb-2"},ec={key:0,class:"flex items-center gap-2"},tc={class:"text-muted-foreground shrink-0 text-sm"},nc={class:"flex items-center gap-2"},sc={class:"text-muted-foreground shrink-0 text-sm"},oc={key:0,class:"dark fixed bottom-6 left-1/2 z-50 -translate-x-1/2"},rc={class:"bg-background text-foreground flex flex-wrap items-center justify-center gap-2 rounded-lg p-2 shadow-lg"},dc=Be({__name:"data-table",props:Qe({data:{},columns:{},meta:{},loading:{type:Boolean},paginationOptions:{},globalFilterOptions:{},columnFiltersOptions:{}},{columnFilters:{required:!1},columnFiltersModifiers:{},columnVisibility:{required:!1},columnVisibilityModifiers:{},globalFilter:{required:!1},globalFilterModifiers:{},pagination:{required:!1},paginationModifiers:{},rowSelection:{required:!1},rowSelectionModifiers:{},sorting:{required:!1},sortingModifiers:{}}),emits:["update:columnFilters","update:columnVisibility","update:globalFilter","update:pagination","update:rowSelection","update:sorting"],setup(e){const{t}=At(),n=Ri(),s=ki(),o="row-selection",r="column-visibility",a=e,i=se(()=>{var $;if(!h.value||!(($=a.paginationOptions)!=null&&$.rowCount))return"";const{pageIndex:R,pageSize:E}=h.value,j=a.paginationOptions.rowCount,O=J.getRowModel().rows.length>0,Q=O?R*E+1:0,T=O?Math.min((R+1)*E,j):0;return t("dataTable.pageInfo",{start:Q,end:T,total:j})}),l=se(()=>{var R;return((R=a.paginationOptions)==null?void 0:R.pageSizeOptions)??[10,20,30,40,50]}),c=ge(e,"columnFilters"),f=ge(e,"columnVisibility"),p=ge(e,"globalFilter"),h=ge(e,"pagination"),u=ge(e,"rowSelection"),d=ge(e,"sorting"),m=vt(p.value??""),y=vt(!1),x=vt(!1);function S(R){return async(E,j)=>{const O=await R(),Q=new Headers(j==null?void 0:j.headers);return Q.set("X-Proxy-Authorization",`Bearer ${O}`),fetch(E,{...j,headers:Q})}}const C=se(()=>{if(!n.value)return null;const{apiKey:R,getAccessToken:E}=n.value,j=xi(s.value),O=E?S(E):void 0;return new N({apiKey:R,baseURL:j,dangerouslyAllowBrowser:!0,fetch:O})}),F=se(()=>!!C.value);function z(R){const E={},j=(O,Q)=>Q?`${O} Hint: ${Q}`:O;for(const O of R){const Q=O.operators.map($=>$.value),T=O.operators.map($=>`"${$.value}" (${$.label})`).join(", ");switch(O.type){case"select":E[O.key]={type:["object","null"],description:j(`Filter by ${O.label}. Values: ${O.options.map($=>$.label).join(", ")}. Operators: ${T}.`,O.aiHint),properties:{operator:{type:"string",enum:Q},value:{type:"string",enum:O.options.map($=>String($.value))}},required:["operator","value"],additionalProperties:!1};break;case"multiselect":E[O.key]={type:["object","null"],description:j(`Filter by ${O.label}. Values: ${O.options.map($=>$.label).join(", ")}. Operators: ${T}.`,O.aiHint),properties:{operator:{type:"string",enum:Q},value:{type:"array",items:{type:"string",enum:O.options.map($=>String($.value))}}},required:["operator","value"],additionalProperties:!1};break;case"boolean":E[O.key]={type:["object","null"],description:j(`Filter by ${O.label}. Operators: ${T}.`,O.aiHint),properties:{operator:{type:"string",enum:Q},value:{type:"boolean"}},required:["operator","value"],additionalProperties:!1};break;case"input":E[O.key]={type:["object","null"],description:j(`Filter by ${O.label}. Operators: ${T}.`,O.aiHint),properties:{operator:{type:"string",enum:Q},value:{type:"string"}},required:["operator","value"],additionalProperties:!1};break;case"inputrange":E[O.key]={type:["object","null"],description:j(`Filter by ${O.label} range. Operators: ${T}.`,O.aiHint),properties:{operator:{type:"string",enum:Q},value:{type:"object",properties:{min:{type:["string","null"]},max:{type:["string","null"]}},required:["min","max"],additionalProperties:!1}},required:["operator","value"],additionalProperties:!1};break}}return{type:"object",properties:E,required:Object.keys(E),additionalProperties:!1}}async function B(R){var E,j,O;if(!((E=a.columnFiltersOptions)!=null&&E.filterDefs)||!c.value||!C.value)return!1;x.value=!0;try{const Q=a.columnFiltersOptions.filterDefs,T=z(Q),$=(O=(j=(await C.value.chat.completions.create({model:"gpt-4.1-nano",messages:[{role:"system",content:'You are a filter assistant. Extract filter values and operators from user queries. Choose the appropriate operator based on query semantics (e.g., "not" implies negation operators like "is_not" or "is_not_any_of"). Only set filters explicitly mentioned. Set null for filters not mentioned.'},{role:"user",content:R}],response_format:{type:"json_schema",json_schema:{name:"filters",schema:T,strict:!0}}})).choices[0])==null?void 0:j.message)==null?void 0:O.content;if(!$)return!1;const He=JSON.parse($),Oe=[];for(const[ze,Y]of Object.entries(He)){if(!Y)continue;const{operator:$e,value:Se}=Y;Se==null||Se===""||Array.isArray(Se)&&Se.length===0||Oe.push({id:crypto.randomUUID(),field:ze,operator:$e,value:Se})}return Oe.length===0?!1:(c.value=Oe,!0)}catch(Q){return console.error("AI filter processing failed:",Q),!1}finally{x.value=!1}}async function X(){y.value&&m.value.trim()&&await B(m.value)&&(m.value="")}Do(p,R=>{R!==m.value&&(m.value=R??"")}),Oa(m,R=>{y.value||(p.value=R)},{debounce:()=>{var R;return((R=a.globalFilterOptions)==null?void 0:R.debounce)??300}});const G=Di(),de=se(()=>u.value===void 0?null:G.display({id:o,header:({table:R})=>me(Zs,{modelValue:R.getIsAllRowsSelected()||R.getIsSomeRowsSelected()&&"indeterminate","onUpdate:modelValue":()=>{R.toggleAllRowsSelected(!(R.getIsSomeRowsSelected()||R.getIsAllRowsSelected()))}}),cell:({row:R})=>me(Zs,{modelValue:R.getIsSelected(),disabled:!R.getCanSelect(),"onUpdate:modelValue":E=>R.toggleSelected(!!E)}),meta:{title:"Row selection",class:{th:"w-8 min-w-8 max-w-8",td:"w-8 min-w-8 max-w-8"}},enableHiding:!1})),q=se(()=>f.value===void 0?null:G.display({id:r,header:()=>me(qo,()=>[me(To,{asChild:!0},()=>me(Ae,{variant:"outline",size:"icon-sm",class:"before:bg-background relative before:absolute before:-inset-px before:-z-10 before:rounded-md"},()=>[me(Ei),me("span",{class:"sr-only"},t("dataTable.columns.label"))])),me(jo,{align:"end",class:"w-64"},()=>{const R=J.getAllColumns().filter(j=>{var O;return j.id!==o&&j.id!==r&&((O=j.columnDef.meta)==null?void 0:O.title)}),E=R.every(j=>j.getIsVisible());return[me("div",{class:"flex items-center justify-between px-2 py-1.5"},[me(Ba,{class:"p-0"},()=>t("dataTable.columns.label")),me(Ae,{variant:"secondary",size:"xs",onClick:()=>{const j={};R.forEach(O=>{O.getCanHide()&&(j[O.id]=!E)}),J.setColumnVisibility(j)}},()=>t(E?"dataTable.columns.hideAll":"dataTable.columns.showAll"))]),...R.map(j=>me(Ha,{key:j.id,modelValue:j.getIsVisible(),disabled:!j.getCanHide(),"onUpdate:modelValue":O=>j.toggleVisibility(!!O),onSelect:O=>O.preventDefault()},()=>{var O;return((O=j.columnDef.meta)==null?void 0:O.title)??""}))]})]),meta:{title:"Column visibility",class:{th:"sticky right-0 w-8 max-w-8 min-w-8 p-0 align-top",td:"w-8 max-w-8 min-w-8"}},enableHiding:!1})),ae=se(()=>{const R=[...a.columns];return de.value&&R.unshift(de.value),q.value&&R.push(q.value),R}),J=Il({get data(){return a.data},get columns(){return ae.value},getCoreRowModel:xl(),manualFiltering:!0,manualPagination:!0,manualSorting:!0,state:{get columnVisibility(){return f.value},get globalFilter(){return p.value},get pagination(){return h.value},get rowSelection(){return u.value},get sorting(){return d.value}},get rowCount(){var R;return(R=a.paginationOptions)==null?void 0:R.rowCount},onColumnVisibilityChange:R=>Pe(R,f),onGlobalFilterChange:R=>Pe(R,p),onPaginationChange:R=>Pe(R,h),onRowSelectionChange:R=>Pe(R,u),onSortingChange:R=>Pe(R,d)});function Pe(R,E){E.value=typeof R=="function"?R(E.value):R}function Re(R,E){return typeof R=="function"?R(E):R}const $t=()=>{const R=J.getState().pagination.pageIndex,E=J.getPageCount(),j=[],O=R>2,Q=R<E-3;if(E<=7)return Array.from({length:E},(T,$)=>$);j.push(0),O&&j.push("ellipsis-start");for(let T=Math.max(1,R-1);T<=Math.min(E-2,R+1);T++)j.push(T);return Q&&j.push("ellipsis-end"),E>1&&j.push(E-1),j};return(R,E)=>{var j,O,Q;return w(),H("div",Bu,[Z("div",Hu,[Z("div",zu,[p.value!==void 0?(w(),A(Bo,{key:0},{default:v(()=>{var T;return[_(No,{modelValue:m.value,"onUpdate:modelValue":E[0]||(E[0]=$=>m.value=$),class:"w-72",placeholder:y.value?k(t)("dataTable.aiSearch.placeholder"):k(t)("dataTable.search"),disabled:x.value,onKeydown:$a(X,["enter"])},null,8,["modelValue","placeholder","disabled"]),_(nn,null,{default:v(()=>[x.value?(w(),A(k(za),{key:0,class:"animate-spin"})):y.value?(w(),A(k(no),{key:1})):(w(),A(k(Fa),{key:2}))]),_:1}),(T=e.columnFiltersOptions)!=null&&T.filterDefs&&F.value?(w(),A(nn,{key:0,align:"inline-end"},{default:v(()=>[_(Ua,{variant:y.value?"default":"secondary",disabled:x.value,onClick:E[1]||(E[1]=$=>y.value=!y.value)},{default:v(()=>[_(k(no)),re(" "+U(k(t)("dataTable.aiSearch.toggle")),1)]),_:1},8,["variant","disabled"])]),_:1})):W("",!0)]}),_:1})):W("",!0)]),Z("div",Uu,[Ge(R.$slots,"toolbar")])]),(j=e.columnFiltersOptions)!=null&&j.filterDefs&&c.value!==void 0?(w(),H("div",Gu,[Z("div",Wu,[Ge(R.$slots,"filter-bar-start"),_(Nu,{filters:c.value,"onUpdate:filters":E[2]||(E[2]=T=>c.value=T),definitions:e.columnFiltersOptions.filterDefs},null,8,["filters","definitions"])]),Z("div",Xu,[Ge(R.$slots,"filter-bar-end")])])):W("",!0),e.loading||(O=k(J).getRowModel().rows)!=null&&O.length?(w(),H("div",Ku,[Z("div",Ju,[_(Ka,null,{default:v(()=>[_(Ga,{class:"in-data-[slot=frame]:**:[th]:h-8 in-data-[slot=frame]:**:[th]:pb-1 *:[tr]:*:[th]:border-transparent *:[tr]:*:[th]:first:border-s *:[tr]:*:[th]:last:border-e"},{default:v(()=>[(w(!0),H(K,null,ue(k(J).getHeaderGroups(),T=>(w(),A($n,{key:T.id},{default:v(()=>[(w(!0),H(K,null,ue(T.headers,$=>{var He,Oe,ze,Y;return w(),A(Wa,{key:$.id,colspan:$.colSpan>1?$.colSpan:void 0,rowspan:$.rowSpan>1?$.rowSpan:void 0,class:rt(Re((Oe=(He=$.column.columnDef.meta)==null?void 0:He.class)==null?void 0:Oe.th,$)),style:On(Re((Y=(ze=$.column.columnDef.meta)==null?void 0:ze.style)==null?void 0:Y.th,$))},{default:v(()=>[$.isPlaceholder?W("",!0):(w(),H(K,{key:0},[d.value!==void 0&&$.column.getCanSort()?(w(),A(Ae,{key:0,size:"sm",variant:"ghost",class:"group -ml-2.5",onClick:$e=>{var Se;return(Se=$.column.getToggleSortingHandler())==null?void 0:Se($e)}},{default:v(()=>{var $e;return[re(U((($e=$.column.columnDef.meta)==null?void 0:$e.title)??"")+" ",1),$.column.getIsSorted()==="asc"?(w(),A(k(Oi),{key:0,class:"size-3.5"})):$.column.getIsSorted()==="desc"?(w(),A(k(Ai),{key:1,class:"size-3.5"})):(w(),A(k(Mi),{key:2,class:"size-3.5 opacity-0 transition-opacity group-hover:opacity-100"}))]}),_:2},1032,["onClick"])):(w(),A(k(Hn),{key:1,render:$.column.columnDef.header,props:$.getContext()},null,8,["render","props"]))],64))]),_:2},1032,["colspan","rowspan","class","style"])}),128))]),_:2},1024))),128))]),_:1}),_(Xa,{class:"in-data-[slot=frame]:*:[tr]:data-[state=selected]:*:[td]:bg-[color-mix(in_srgb,white_95%,var(--color-primary))]"},{default:v(()=>[e.loading?(w(),H(K,{key:0},ue(3,T=>_($n,{key:T},{default:v(()=>[(w(!0),H(K,null,ue(k(J).getVisibleLeafColumns(),$=>(w(),A(eo,{key:$.id},{default:v(()=>[$.id!==o&&$.id!==r?(w(),A(Fn,{key:0,class:"h-6 w-full"})):W("",!0)]),_:2},1024))),128))]),_:1})),64)):(w(!0),H(K,{key:1},ue(k(J).getRowModel().rows,T=>{var $,He,Oe,ze;return w(),A($n,{key:T.id,class:rt(["group",Re((He=($=k(J).options.meta)==null?void 0:$.class)==null?void 0:He.tr,T)]),style:On(Re((ze=(Oe=k(J).options.meta)==null?void 0:Oe.style)==null?void 0:ze.tr,T)),"data-state":T.getIsSelected()&&"selected"},{default:v(()=>[(w(!0),H(K,null,ue(T.getVisibleCells(),Y=>{var $e,Se,Us,Gs,Ws,Xs,Ks,Js;return w(),A(eo,{key:Y.id,class:rt(Re((Se=($e=Y.column.columnDef.meta)==null?void 0:$e.class)==null?void 0:Se.td,Y)),style:On(Re((Gs=(Us=Y.column.columnDef.meta)==null?void 0:Us.style)==null?void 0:Gs.td,Y)),colspan:Re((Xs=(Ws=Y.column.columnDef.meta)==null?void 0:Ws.colspan)==null?void 0:Xs.td,Y),rowspan:Re((Js=(Ks=Y.column.columnDef.meta)==null?void 0:Ks.rowspan)==null?void 0:Js.td,Y)},{default:v(()=>{var Qs;return[(Qs=Y.column.columnDef.meta)!=null&&Qs.onOpen?(w(),H("div",Qu,[Z("div",Yu,[_(k(Hn),{render:Y.column.columnDef.cell,props:Y.getContext()},null,8,["render","props"])]),_(Ae,{size:"sm",variant:"outline",class:"opacity-0 transition-opacity group-hover:opacity-100",onClick:Ea(lc=>{var Ys;return(Ys=Y.column.columnDef.meta)==null?void 0:Ys.onOpen(Y.row)},["stop"])},{default:v(()=>[_(k(Pi)),re(" "+U(k(t)("dataTable.open")),1)]),_:1},8,["onClick"])])):(w(),A(k(Hn),{key:1,render:Y.column.columnDef.cell,props:Y.getContext()},null,8,["render","props"]))]}),_:2},1032,["class","style","colspan","rowspan"])}),128))]),_:2},1032,["class","style","data-state"])}),128))]),_:1})]),_:1})]),h.value!==void 0&&((Q=e.paginationOptions)==null?void 0:Q.rowCount)!==void 0?(w(),H("footer",Zu,[l.value.length>0?(w(),H("div",ec,[Z("span",tc,U(k(t)("dataTable.itemsPerPage")),1),_(ei,{disabled:e.loading,"model-value":k(J).getState().pagination.pageSize.toString(),"onUpdate:modelValue":E[3]||(E[3]=T=>k(J).setPageSize(Number(T)))},{default:v(()=>[_(Ja,{class:"bg-background"},{default:v(()=>[_(Qa)]),_:1}),_(Ya,null,{default:v(()=>[(w(!0),H(K,null,ue(l.value,T=>(w(),A(Za,{key:T,value:T.toString()},{default:v(()=>[re(U(T),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["disabled","model-value"])])):W("",!0),Z("div",nc,[Z("span",sc,[e.loading?(w(),A(Fn,{key:0,class:"h-5 w-24"})):(w(),H(K,{key:1},[re(U(i.value),1)],64))]),_(ai,null,{default:v(()=>[_(ti,null,{default:v(()=>[_(Ft,null,{default:v(()=>[_(ni,{class:"size-9 p-0 *:[span]:sr-only",disabled:e.loading||!k(J).getCanPreviousPage(),onClick:E[4]||(E[4]=T=>k(J).previousPage())},null,8,["disabled"])]),_:1}),e.loading?(w(),H(K,{key:0},ue(3,T=>_(Ft,{key:T},{default:v(()=>[_(Fn,{class:"size-9"})]),_:1})),64)):(w(!0),H(K,{key:1},ue($t(),T=>(w(),A(Ft,{key:T},{default:v(()=>[typeof T=="number"?(w(),A(si,{key:0,"is-active":k(J).getState().pagination.pageIndex===T,onClick:$=>k(J).setPageIndex(T)},{default:v(()=>[re(U(T+1),1)]),_:2},1032,["is-active","onClick"])):(w(),A(oi,{key:1}))]),_:2},1024))),128)),_(Ft,null,{default:v(()=>[_(ri,{class:"size-9 p-0 *:[span]:sr-only",disabled:e.loading||!k(J).getCanNextPage(),onClick:E[5]||(E[5]=T=>k(J).nextPage())},null,8,["disabled"])]),_:1})]),_:1})]),_:1})])])):W("",!0)])):Ge(R.$slots,"empty-state",{key:2},()=>[_(di,{class:"border"},{default:v(()=>[_(ii,null,{default:v(()=>[_(li,{variant:"icon"},{default:v(()=>[_(k($i))]),_:1}),_(ui,null,{default:v(()=>[re(U(k(t)("dataTable.empty.title")),1)]),_:1}),_(ci,null,{default:v(()=>[re(U(k(t)("dataTable.empty.description")),1)]),_:1})]),_:1})]),_:1})]),(w(),A(Da,{to:"body"},[_(Va,{"enter-active-class":"animate-in slide-in-from-bottom-2 fade-in-0 zoom-in-95","leave-active-class":"animate-out fade-out-0 zoom-out-95"},{default:v(()=>[u.value!==void 0&&Object.keys(u.value).length?(w(),H("div",oc,[Z("div",rc,[Ge(R.$slots,"batch-action-bar")])])):W("",!0)]),_:3})]))])}}}),ac={key:0,class:"truncate"},ic={key:1,class:"text-muted-foreground"},hc=Be({__name:"select-menu",props:Qe({items:{},placeholder:{},disabled:{type:Boolean},multiple:{type:Boolean},loading:{type:Boolean},searchInput:{type:Boolean,default:!0},labelKey:{default:"label"},valueKey:{},ignoreFilter:{type:Boolean},class:{}},{modelValue:{type:[String,Number,Object,null,Boolean,Array]},modelModifiers:{},searchTerm:{default:""},searchTermModifiers:{},open:{type:Boolean,default:!1},openModifiers:{}}),emits:["update:modelValue","update:searchTerm","update:open"],setup(e){const{t}=At(),n=ge(e,"modelValue"),s=ge(e,"searchTerm"),o=ge(e,"open");function r(h){return typeof h=="object"&&h!==null}function a(h){return r(h)?String(to(h,e.labelKey)??h.label??h.value??""):String(h)}function i(h){return r(h)?e.valueKey?to(h,e.valueKey):h.value??a(h):h}function l(h){return(e.items??[]).find(u=>{const d=i(u);return e.valueKey?Et(d,h,e.valueKey):d===h})}function c(h){const u=n.value;if(u==null)return!1;const d=i(h);return e.multiple&&Array.isArray(u)?e.valueKey?u.some(m=>Et(m,d,e.valueKey)):u.includes(d):e.valueKey?Et(u,d,e.valueKey):u===d}function f(h){const u=i(h);if(e.multiple){const d=Array.isArray(n.value)?[...n.value]:[],m=e.valueKey?d.findIndex(y=>Et(y,u,e.valueKey)):d.indexOf(u);m>=0?d.splice(m,1):d.push(u),n.value=d}else n.value=u,o.value=!1}const p=se(()=>{const h=n.value;if(h===void 0)return"";if(e.multiple&&Array.isArray(h))return h.length===0?"":h.map(d=>l(d)?a(l(d)):void 0).filter(Boolean).join(", ");const u=l(h);return u?a(u):""});return(h,u)=>(w(),A(cn,{open:o.value,"onUpdate:open":u[1]||(u[1]=d=>o.value=d)},{default:v(()=>[_(sn,{"as-child":""},{default:v(()=>[_(Ae,{variant:"outline",role:"combobox","aria-expanded":o.value,disabled:e.disabled,class:rt(k(Zn)("w-full justify-between",e.class))},{default:v(()=>[p.value?(w(),H("span",ac,U(p.value),1)):(w(),H("span",ic,U(e.placeholder??k(t)("selectMenu.placeholder")),1)),e.loading?(w(),A(yi,{key:3})):(w(),A(k(Fi),{key:2,class:"opacity-50"}))]),_:1},8,["aria-expanded","disabled","class"])]),_:1}),_(on,{class:"w-[--reka-popover-trigger-width] p-0"},{default:v(()=>[_(rn,{"ignore-filter":e.ignoreFilter},{default:v(()=>[e.searchInput?(w(),A(an,{key:0,modelValue:s.value,"onUpdate:modelValue":u[0]||(u[0]=d=>s.value=d),placeholder:k(t)("selectMenu.search"),class:"h-9"},null,8,["modelValue","placeholder"])):W("",!0),_(ln,null,{default:v(()=>[_(un,null,{default:v(()=>[Ge(h.$slots,"empty",{searchTerm:s.value},()=>[re(U(s.value?k(t)("selectMenu.empty.noResults"):k(t)("selectMenu.empty.noItems")),1)])]),_:3}),_(Rt,null,{default:v(()=>[(w(!0),H(K,null,ue(e.items,(d,m)=>(w(),A(It,{key:m,value:a(d),disabled:r(d)&&d.disabled===!0,onSelect:y=>f(d)},{default:v(()=>[Ge(h.$slots,"item",{item:d,index:m},()=>[re(U(a(d))+" ",1),_(k(Lo),{class:rt(k(Zn)("ml-auto",c(d)?"opacity-100":"opacity-0"))},null,8,["class"])])]),_:2},1032,["value","disabled","onSelect"]))),128))]),_:3})]),_:3})]),_:3},8,["ignore-filter"])]),_:3})]),_:3},8,["open"]))}});export{hc as S,dc as y};
