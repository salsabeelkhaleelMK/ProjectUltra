const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-D8nDSNmq.js","assets/index-B2AXF7q7.css"])))=>i.map(i=>d[i]);
import{aa as c,_ as p,bp as w,bq as l,br as h,bs as y,ax as C}from"./index-D8nDSNmq.js";const i=(n=300)=>new Promise(t=>setTimeout(t,n)),u=()=>c.filter(n=>!n.company||n.company===""),g=async(n={})=>{await i();let t=u();if(n.search){const e=n.search.toLowerCase();t=t.filter(s=>s.name.toLowerCase().includes(e)||s.email.toLowerCase().includes(e))}return{data:t,total:t.length}},q=async n=>{await i();const e=u().find(s=>s.id===parseInt(n));if(!e)throw new Error("Contact not found");return e},E=async n=>{await i();const t={id:c.length+1,...n,company:null,createdAt:new Date().toISOString(),lastContact:new Date().toISOString()};return c.push(t),t},T=async(n,t)=>{if(await i(),u().findIndex(o=>o.id===parseInt(n))===-1)throw new Error("Contact not found");const a=c.findIndex(o=>o.id===parseInt(n));return a!==-1&&(c[a]={...c[a],...t,company:null}),c[a]},v=async n=>{await i();const t=c.findIndex(e=>e.id===parseInt(n));if(t===-1)throw new Error("Contact not found");return c.splice(t,1),{success:!0}},x=async(n,t)=>{if(await i(),!u().find(o=>o.id===parseInt(n)))throw new Error("Contact not found");const a=c.findIndex(o=>o.id===parseInt(n));if(a===-1)throw new Error("Contact not found");return c[a].requestedCar={...t,id:Date.now()},{...c[a]}},L=async n=>{await i();const e=u().find(o=>o.id===parseInt(n));if(!e)throw new Error("Contact not found");if(!e.requestedCar)throw new Error("Contact must have requested car");const{createLead:s}=await p(async()=>{const{createLead:o}=await import("./index-D8nDSNmq.js").then(r=>r.bu);return{createLead:o}},__vite__mapDeps([0,1]));return await s({customerId:e.id,requestedCar:e.requestedCar,source:e.source||"Direct",tags:e.tags||[],stage:"Open Lead",status:"Open",priority:"Normal"})},O=async n=>{await i();const e=u().find(o=>o.id===parseInt(n));if(!e)throw new Error("Contact not found");if(!e.requestedCar)throw new Error("Contact must have requested car");const{createOpportunity:s}=await p(async()=>{const{createOpportunity:o}=await import("./index-D8nDSNmq.js").then(r=>r.bv);return{createOpportunity:o}},__vite__mapDeps([0,1]));return await s({customerId:e.id,vehicle:e.requestedCar,source:e.source||"Direct",tags:e.tags||[],stage:"Qualified",value:e.requestedCar.price||0})},_=async n=>{await i();const t=w.filter(e=>e.customerId===parseInt(n));return{data:t,total:t.length}},k=async n=>{await i();const t=l.filter(e=>e.customerId===parseInt(n));return{data:t,total:t.length}},b=async n=>{await i();const t=[],e=c.find(r=>r.id===parseInt(n));e!=null&&e.id,w.filter(r=>r.customerId===parseInt(n)).forEach(r=>{r.requestedCar&&t.push({...r.requestedCar,id:`requested-${r.id}`,type:"requested",leadId:r.id,leadStage:r.stage})}),e!=null&&e.requestedCar&&t.push({...e.requestedCar,id:`requested-contact-${e.id}`,type:"requested",contactId:e.id});const a=l.filter(r=>r.customerId===parseInt(n));return a.forEach(r=>{y.filter(d=>d.opportunityId===r.id&&d.type==="offer").forEach(d=>{var f;(f=d.data)!=null&&f.vehicle&&t.push({...d.data.vehicle,id:`offered-${d.id}`,type:"offered",opportunityId:r.id,opportunityStage:r.stage,offerDate:d.timestamp})})}),C.filter(r=>r.customerId===parseInt(n)&&r.type==="test-drive").forEach(r=>{r.vehicle&&t.push({brand:r.vehicle.split(" ")[0]||"",model:r.vehicle.split(" ").slice(1).join(" ")||"",id:`drove-${r.id}`,type:"drove",eventId:r.id,testDriveDate:r.start,vehicle:r.vehicle})}),a.forEach(r=>{r.stage==="Closed Won"&&r.vehicle&&t.push({...r.vehicle,id:`purchased-${r.id}`,type:"purchased",opportunityId:r.id,purchaseDate:r.contractDate||r.lastActivity})}),e!=null&&e.vehicles&&Array.isArray(e.vehicles)&&e.vehicles.forEach(r=>{r.type==="owned"&&t.push({...r,id:r.id||`owned-${e.id}-${Date.now()}`,type:"owned",customerId:e.id})}),{data:t,total:t.length}},A=async(n,t)=>{await i();const e=c.findIndex(o=>o.id===parseInt(n));if(e===-1)throw new Error("Customer not found");const s=c[e];s.vehicles||(s.vehicles=[]);const a={...t,id:t.id||Date.now()};return t.type==="requested"&&(s.requestedCar={brand:t.brand,model:t.model,year:t.year,price:t.price,requestType:t.requestType,requestMessage:t.requestMessage,image:t.image,dealership:t.dealership,fuelType:t.fuelType,gearType:t.gearType,kilometers:t.kilometers,id:a.id}),s.vehicles.push(a),c[e]=s,{...s}},$=async n=>{await i();const t=h.filter(e=>e.customerId===parseInt(n));return{data:t,total:t.length}};export{x as addRequestedCarToContact,A as addVehicleToCustomer,L as convertContactToLead,O as convertContactToOpportunity,E as createContact,v as deleteContact,q as fetchContactById,g as fetchContacts,b as fetchCustomerCars,_ as fetchLeadsByCustomerId,k as fetchOpportunitiesByCustomerId,$ as fetchTasksByCustomerId,T as updateContact};
