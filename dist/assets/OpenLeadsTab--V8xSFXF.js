import{h as L,C as T,r as a,c as $,m as h,d as B,o as I,s as R,D as V,e as i,y as n}from"./index-C3vqiHZ_.js";import{y as Q}from"./components--p21PNMm.js";import{g as z,c as E,f as G}from"./formatters-B1RFjlNy.js";import{u as K}from"./useCustomersTable-1mV-Bts0.js";import"./toggle-group-item.vue_vue_type_script_setup_true_lang-Csij51_o-D8IcTfaq.js";const W={class:"table-wrapper w-full"},Y={__name:"OpenLeadsTab",setup(_){const S=L(),o=T(),A=a(!1),r=a({pageIndex:0,pageSize:10}),u=a(""),l=a([]),c=a([]),d=e=>e?new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}):"-",w=e=>({Valid:"bg-green-100 text-green-700","Not valid":"bg-red-100 text-red-700",Qualified:"bg-surfaceSecondary text-body","Not interested":"bg-red-100 text-red-700",Open:"bg-blue-100 text-blue-700"})[e]||"bg-surfaceSecondary text-body",p=$(()=>{let e=o.leads;return A.value?e=o.leads.filter(t=>t.isDisqualified===!0):e=o.leads.filter(t=>!t.isDisqualified),e.map(t=>{var s,g,f,y,b,D,x,C,v,k,q,F;return{id:`lead-${t.id}`,stageKey:"open-leads",customer:((s=t.customer)==null?void 0:s.name)||"Unknown",email:((g=t.customer)==null?void 0:g.email)||"",initials:((f=t.customer)==null?void 0:f.initials)||((b=(y=t.customer)==null?void 0:y.name)==null?void 0:b.slice(0,2).toUpperCase())||"?",nextAction:G(t.nextActionDue)||"No due date",nextActionFull:E(t.nextActionDue),deadlineStatus:z(t.nextActionDue),car:`${((D=t.requestedCar)==null?void 0:D.brand)||""} ${((x=t.requestedCar)==null?void 0:x.model)||""}`.trim()||"N/A",carStatus:((C=t.requestedCar)==null?void 0:C.stockDays)!==void 0&&((v=t.requestedCar)==null?void 0:v.stockDays)!==null?"In Stock":"Out of Stock",carStatusClass:((k=t.requestedCar)==null?void 0:k.stockDays)!==void 0&&((q=t.requestedCar)==null?void 0:q.stockDays)!==null?"bg-green-100 text-green-700":"bg-surfaceSecondary text-body",requestType:((F=t.requestedCar)==null?void 0:F.requestType)||"Quotation",source:t.source||"Marketing",assignee:t.assignee,assigneeInitials:t.assignee?t.assignee.slice(0,2).toUpperCase():"NA",createdAt:d(t.createdAt),lastActivity:d(t.lastActivity),status:t.status,statusClass:w(t.status),priority:t.priority||"Normal"}})}),m=e=>{if(e.id.startsWith("lead-")){const t=e.id.match(/-(\d+)$/),s=t?t[1]:e.id.replace("lead-","");S.push({path:`/tasks/${s}`,query:{type:"lead"}})}},N=a("open-leads"),{columns:O,filterDefinitions:U,tableMeta:M}=K(N,m);return h(async()=>{await o.fetchLeads()}),(e,t)=>(I(),B("div",W,[R(n(Q),{data:p.value,columns:n(O),meta:n(M),onRowClick:m,columnFiltersOptions:{filterDefs:n(U)},pagination:r.value,"onUpdate:pagination":t[0]||(t[0]=s=>r.value=s),globalFilter:u.value,"onUpdate:globalFilter":t[1]||(t[1]=s=>u.value=s),sorting:l.value,"onUpdate:sorting":t[2]||(t[2]=s=>l.value=s),columnFilters:c.value,"onUpdate:columnFilters":t[3]||(t[3]=s=>c.value=s),paginationOptions:{rowCount:p.value.length},globalFilterOptions:{debounce:300}},{"empty-state":V(()=>[...t[4]||(t[4]=[i("div",{class:"empty-state"},[i("i",{class:"fa-solid fa-inbox empty-state-icon"}),i("p",{class:"empty-state-text"},"No records found")],-1)])]),_:1},8,["data","columns","meta","columnFiltersOptions","pagination","globalFilter","sorting","columnFilters","paginationOptions"])]))}};export{Y as default};
