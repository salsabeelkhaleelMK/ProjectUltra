import{D as Q,r as m,J as W,c as C,K as E,L as N,a as d,b as F,e as t,x as z,F as M,g as U,w as n,v as c,q as S,h as I,f as $,k as q,j as A,t as i,T as H,G,i as u,n as y}from"./index-DEHLoFOu.js";import{_ as X}from"./PageHeader-BWxZ8X_b.js";const Y={class:"page-container"},Z={class:"p-4 md:p-8"},ee={class:"flex items-center gap-3 mb-6 overflow-x-auto pb-2 scrollbar-hide"},te=["onClick"],se={class:"text-sm font-medium text-foreground whitespace-nowrap"},ae={class:"mb-6 bg-gray-50 border border-gray-200 rounded-lg px-4 py-3"},oe={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3"},le={class:"flex flex-wrap items-center gap-2 md:gap-3"},ne={class:"w-full sm:w-auto sm:min-w-[260px] sm:max-w-md"},ie={class:"relative"},re={class:"flex justify-end"},ue={key:0,class:"empty-state"},pe={key:1,class:"card overflow-hidden"},de={class:"overflow-x-auto -mx-4 md:mx-0"},ce={class:"w-full"},me={class:"divide-y divide-gray-100"},be=["onClick"],xe={class:"px-3 md:px-6 py-3 whitespace-nowrap"},ge={class:"flex items-center gap-2 md:gap-3"},ye={class:"w-9 h-9 rounded-full bg-orange-100 text-orange-600 flex items-center justify-center text-xs font-bold shrink-0"},ve={class:"min-w-0"},fe={class:"text-content-bold truncate"},we={class:"text-meta truncate hidden sm:block"},he={class:"px-3 md:px-6 py-3 whitespace-nowrap"},ke={class:"px-3 md:px-6 py-3 whitespace-nowrap"},Ce={class:"flex items-center gap-2"},Ne={class:"text-content font-medium truncate max-w-[120px]"},Se={class:"px-3 md:px-6 py-3 whitespace-nowrap"},Ae={class:"px-3 md:px-6 py-3 text-content text-gray-600 whitespace-nowrap"},Ve={class:"px-3 md:px-6 py-3 whitespace-nowrap"},Te={class:"flex items-center gap-2"},Me={class:"w-6 h-6 rounded-full bg-gray-100 flex items-center justify-center text-[10px] font-bold text-gray-600 shrink-0"},Ue={class:"text-content text-gray-600 truncate max-w-[80px] hidden md:inline"},Ie={class:"px-3 md:px-6 py-3 whitespace-nowrap"},$e={class:"bg-white rounded-xl shadow-2xl w-full max-w-md mx-4 my-4 max-h-[90vh] overflow-y-auto animate-fade-in"},qe={class:"p-5 border-b border-gray-100 bg-gray-50/50"},De={class:"modal-title"},Le={class:"p-5 space-y-4"},Oe={key:0},Re={key:1},je={key:2},_e={class:"p-4 bg-gray-50 flex justify-end gap-3 border-t border-gray-100"},Pe={__name:"Pipeline",setup(Ke){const w=G(),V=Q(),b=m(W),p=m("open-leads"),x=m(""),g=m(!1),r=m({status:"",priority:"",source:""}),l=m({customerName:"",email:"",vehicle:"",value:"",probability:"",reason:""}),D=C(()=>{const o=[{key:"open-leads",label:"Open Leads",count:b.value.openLeads,borderColor:"border-t-blue-600",badgeColor:"bg-blue-600 text-white"},{key:"open-opportunities",label:"Open opportunities",count:b.value.openOpportunities,borderColor:"border-t-orange-500",badgeColor:"bg-orange-500 text-white"},{key:"in-negotiation",label:"In negotiation",count:b.value.inNegotiation,borderColor:"border-t-blue-500",badgeColor:"bg-blue-500 text-white"},{key:"won",label:"Won",count:b.value.won,borderColor:"border-t-green-500",badgeColor:"bg-green-500 text-white"},{key:"lost",label:"Lost",count:b.value.lost,borderColor:"border-t-red-500",badgeColor:"bg-red-500 text-white"}];return V.isOperator()?o.filter(e=>e.key==="open-leads"):V.isSalesman()?o.filter(e=>e.key!=="open-leads"):o}),L=()=>({"open-leads":"Create New Lead","open-opportunities":"Create New Opportunity","in-negotiation":"Create New Opportunity",won:"Add Won Deal",lost:"Add Lost Deal"})[p.value]||"Add New",O=()=>({"open-leads":"Lead","open-opportunities":"Opportunity","in-negotiation":"Opportunity",won:"Deal",lost:"Deal"})[p.value]||"Item",R=()=>{l.value={customerName:"",email:"",vehicle:"",value:"",probability:"",reason:""},g.value=!1},j=C(()=>{const o=E.map(a=>({id:`lead-${a.id}`,stageKey:"open-leads",customer:a.customer.name,email:a.customer.email,initials:a.customer.initials||a.customer.name.slice(0,2).toUpperCase(),nextAction:a.nextActionDue||"1h 12m",car:`${a.requestedCar.brand} ${a.requestedCar.model}`,carStatus:a.carStatus||"New",carStatusClass:a.carStatus==="New"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700",requestType:a.requestType||"Quotation",source:a.source||"Marketing",assignee:a.assignee,assigneeInitials:a.assigneeInitials||(a.assignee?a.assignee.slice(0,2).toUpperCase():"NA"),createdAt:v(a.createdAt),lastActivity:v(a.lastActivity),status:a.status,statusClass:B(a.status),priority:a.priority})),e=N.map(a=>{let f="open-opportunities";return a.stage==="In Negotiation"||a.stage==="In negotiation"?f="in-negotiation":a.stage==="Closed"&&(f="won"),{id:`opp-${a.id}`,stageKey:f,customer:a.customer.name,email:a.customer.email,initials:a.customer.initials||a.customer.name.slice(0,2).toUpperCase(),nextAction:"1h 12m",car:`${a.vehicle.brand} ${a.vehicle.model}`,carStatus:"New",carStatusClass:"bg-green-100 text-green-700",requestType:"Opportunity",source:"Marketing",assignee:a.assignee,assigneeInitials:a.assignee?a.assignee.slice(0,2).toUpperCase():"NA",createdAt:v(a.createdAt),lastActivity:v(a.lastActivity),status:a.stage,statusClass:f==="in-negotiation"?"bg-orange-100 text-orange-700":"bg-purple-100 text-purple-700",priority:"Normal"}}),s=[{id:"won-1",stageKey:"won",customer:"John Doe",email:"john.doe@example.com",initials:"JD",nextAction:"-",car:"Audi A6",carStatus:"New",carStatusClass:"bg-green-100 text-green-700",requestType:"Quotation",source:"Marketing",assignee:"Michael Thomas",assigneeInitials:"MT",createdAt:"15/03/2025",lastActivity:"15/03/2025",status:"Won",statusClass:"bg-green-100 text-green-700",priority:"Normal"}],k=[{id:"lost-1",stageKey:"lost",customer:"Jane Smith",email:"jane.smith@example.com",initials:"JS",nextAction:"-",car:"BMW X5",carStatus:"New",carStatusClass:"bg-green-100 text-green-700",requestType:"Test Drive",source:"Marketing",assignee:"Sarah Jenkins",assigneeInitials:"SJ",createdAt:"10/03/2025",lastActivity:"10/03/2025",status:"Lost",statusClass:"bg-red-100 text-red-700",priority:"Normal"}];return[...o,...e,...s,...k]}),T=C(()=>{let o=j.value.filter(e=>e.stageKey===p.value);if(x.value){const e=x.value.toLowerCase();o=o.filter(s=>s.customer.toLowerCase().includes(e)||s.email.toLowerCase().includes(e)||s.car.toLowerCase().includes(e))}return r.value.status&&(o=o.filter(e=>e.status===r.value.status)),r.value.priority&&(o=o.filter(e=>e.priority===r.value.priority)),r.value.source&&(o=o.filter(e=>e.source===r.value.source)),o}),_=o=>{p.value=o},K=()=>{},h=()=>{},J=()=>{r.value={status:"",priority:"",source:""},x.value=""},B=o=>({Valid:"bg-green-100 text-green-700","Not valid":"bg-red-100 text-red-700",Qualified:"bg-gray-100 text-gray-700","Not interested":"bg-red-100 text-red-700",Open:"bg-blue-100 text-blue-700"})[o]||"bg-gray-100 text-gray-700",v=o=>o?new Date(o).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}):"-",P=o=>{const e=o.id.match(/-(\d+)$/);if(p.value==="open-leads"&&o.id.startsWith("lead-")){const s=e?e[1]:o.id.replace("lead-","");w.push({path:`/tasks/${s}`,query:{type:"lead"}})}else if(o.id.startsWith("opp-")){const s=e?e[1]:o.id.replace("opp-","");w.push({path:`/tasks/${s}`,query:{type:"opportunity"}})}else(o.stageKey==="won"||o.stageKey==="lost")&&N.length>0&&w.push({path:`/tasks/${N[0].id}`,query:{type:"opportunity"}})};return(o,e)=>(u(),d("div",Y,[F(X,{title:"Pipeline",subtitle:"Manage your opportunities and deals"}),t("div",Z,[t("div",ee,[(u(!0),d(M,null,U(D.value,s=>(u(),d("button",{key:s.key,onClick:k=>_(s.key),class:y(["flex items-center justify-between gap-3 px-4 py-3 bg-white border border-border rounded-lg cursor-pointer hover:shadow-sm transition-all shrink-0 min-w-[160px] border-t-4",p.value===s.key?s.borderColor:"border-t-border"])},[t("span",se,i(s.label),1),t("span",{class:y(["px-2.5 py-1 text-sm font-semibold rounded-full min-w-[32px] text-center",p.value===s.key?s.badgeColor:"bg-muted text-muted-foreground"])},i(s.count),3)],10,te))),128))]),t("div",ae,[t("div",oe,[t("div",le,[t("div",ne,[t("div",ie,[e[19]||(e[19]=t("i",{class:"fa-solid fa-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"},null,-1)),n(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>x.value=s),onInput:K,type:"text",placeholder:"Search or ask a question",class:"input-with-icon"},null,544),[[c,x.value]])])]),n(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>r.value.status=s),onChange:h,class:"input text-sm w-auto shrink-0"},[...e[20]||(e[20]=[I('<option value="">Status</option><option value="Valid">Valid</option><option value="Not valid">Not valid</option><option value="Qualified">Qualified</option><option value="Not interested">Not interested</option>',5)])],544),[[S,r.value.status]]),n(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>r.value.priority=s),onChange:h,class:"input text-sm w-auto shrink-0"},[...e[21]||(e[21]=[t("option",{value:""},"Priority",-1),t("option",{value:"Hot"},"Hot",-1),t("option",{value:"Normal"},"Normal",-1)])],544),[[S,r.value.priority]]),n(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>r.value.source=s),onChange:h,class:"input text-sm w-auto shrink-0"},[...e[22]||(e[22]=[t("option",{value:""},"Source",-1),t("option",{value:"Marketing"},"Marketing",-1)])],544),[[S,r.value.source]]),e[23]||(e[23]=t("button",{class:"btn-secondary text-sm"},[t("i",{class:"fa-solid fa-plus mr-1"}),$(" More filters ")],-1)),t("button",{onClick:J,class:"btn-secondary text-sm"}," Clear "),e[24]||(e[24]=t("button",{class:"btn-secondary text-sm"}," Save ",-1))]),t("div",re,[p.value==="open-leads"||p.value==="open-opportunities"?(u(),d("button",{key:0,onClick:e[4]||(e[4]=s=>g.value=!0),class:"btn-primary-lg"},[...e[25]||(e[25]=[t("i",{class:"fa-solid fa-plus"},null,-1),$(" Add new ",-1)])])):q("",!0)])])]),T.value.length===0?(u(),d("div",ue,[...e[26]||(e[26]=[t("i",{class:"fa-solid fa-inbox empty-state-icon"},null,-1),t("p",{class:"empty-state-text"},"No records found",-1)])])):(u(),d("div",pe,[t("div",de,[t("table",ce,[e[30]||(e[30]=t("thead",{class:"bg-gray-50 border-b border-gray-200"},[t("tr",null,[t("th",{class:"px-3 md:px-6 py-3 text-left"},[t("input",{type:"checkbox",class:"rounded"})]),t("th",{class:"px-3 md:px-6 py-3 text-left label-upper whitespace-nowrap"},"Customer"),t("th",{class:"px-3 md:px-6 py-3 text-left label-upper whitespace-nowrap"},"Next action due"),t("th",{class:"px-3 md:px-6 py-3 text-left label-upper whitespace-nowrap"},"Requested car"),t("th",{class:"px-3 md:px-6 py-3 text-left label-upper whitespace-nowrap"},"Car status"),t("th",{class:"px-3 md:px-6 py-3 text-left label-upper whitespace-nowrap"},"Source"),t("th",{class:"px-3 md:px-6 py-3 text-left label-upper whitespace-nowrap"},"Assignee"),t("th",{class:"px-3 md:px-6 py-3 text-left label-upper whitespace-nowrap"},"Status"),t("th",{class:"px-3 md:px-6 py-3"})])],-1)),t("tbody",me,[(u(!0),d(M,null,U(T.value,s=>(u(),d("tr",{key:s.id,class:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:k=>P(s)},[t("td",{class:"px-3 md:px-6 py-3 whitespace-nowrap",onClick:e[5]||(e[5]=A(()=>{},["stop"]))},[...e[27]||(e[27]=[t("input",{type:"checkbox",class:"rounded"},null,-1)])]),t("td",xe,[t("div",ge,[t("div",ye,i(s.initials),1),t("div",ve,[t("div",fe,i(s.customer),1),t("div",we,i(s.email),1)])])]),t("td",he,[t("span",{class:y(["text-content font-medium",s.priority==="Hot"?"text-red-600":"text-gray-600"])},i(s.nextAction),3)]),t("td",ke,[t("div",Ce,[e[28]||(e[28]=t("i",{class:"fa-brands fa-volkswagen text-gray-400 text-sm"},null,-1)),t("span",Ne,i(s.car),1)])]),t("td",Se,[t("span",{class:y(["badge-ui font-semibold",s.carStatusClass])},i(s.carStatus),3)]),t("td",Ae,i(s.source),1),t("td",Ve,[t("div",Te,[t("div",Me,i(s.assigneeInitials),1),t("span",Ue,i(s.assignee),1)])]),t("td",Ie,[t("span",{class:y(["badge-ui font-semibold",s.statusClass])},i(s.status),3)]),t("td",{class:"px-3 md:px-6 py-3 whitespace-nowrap",onClick:e[6]||(e[6]=A(()=>{},["stop"]))},[...e[29]||(e[29]=[t("button",{class:"text-gray-400 hover:text-gray-600"},[t("i",{class:"fa-solid fa-ellipsis-vertical"})],-1)])])],8,be))),128))])])]),e[31]||(e[31]=I('<div class="px-4 md:px-6 py-4 border-t border-gray-200 flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-3"><div class="text-sm text-gray-600 flex items-center"> Rows per page: <select class="ml-2 input text-sm w-auto"><option>10</option><option>25</option><option>50</option><option>100</option></select></div><div class="flex items-center gap-1 md:gap-2 flex-wrap"><button class="btn-secondary text-sm whitespace-nowrap">Previous</button><button class="px-3 py-2 text-sm bg-blue-600 text-white rounded-lg font-medium">1</button><button class="btn-secondary text-sm">2</button><button class="btn-secondary text-sm hidden sm:inline-block">3</button><span class="px-2 text-sm text-gray-500 hidden sm:inline">...</span><button class="btn-secondary text-sm whitespace-nowrap">Next</button></div></div>',1))]))]),(u(),z(H,{to:"body"},[g.value?(u(),d("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center",onClick:e[18]||(e[18]=A(s=>g.value=!1,["self"]))},[t("div",$e,[t("div",qe,[t("h3",De,i(L()),1),e[32]||(e[32]=t("p",{class:"modal-subtitle"},"Fill in the details below",-1))]),t("div",Le,[p.value==="open-leads"?(u(),d("div",Oe,[e[33]||(e[33]=t("label",{class:"block label-upper mb-2"},"Customer Name",-1)),n(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>l.value.customerName=s),type:"text",placeholder:"Enter customer name...",class:"input"},null,512),[[c,l.value.customerName]]),e[34]||(e[34]=t("label",{class:"block label-upper mb-2 mt-4"},"Email",-1)),n(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>l.value.email=s),type:"email",placeholder:"customer@example.com",class:"input"},null,512),[[c,l.value.email]]),e[35]||(e[35]=t("label",{class:"block label-upper mb-2 mt-4"},"Requested Vehicle",-1)),n(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>l.value.vehicle=s),type:"text",placeholder:"e.g., Volkswagen ID.4",class:"input"},null,512),[[c,l.value.vehicle]])])):p.value==="open-opportunities"||p.value==="in-negotiation"?(u(),d("div",Re,[e[36]||(e[36]=t("label",{class:"block label-upper mb-2"},"Customer Name",-1)),n(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>l.value.customerName=s),type:"text",placeholder:"Enter customer name...",class:"input"},null,512),[[c,l.value.customerName]]),e[37]||(e[37]=t("label",{class:"block label-upper mb-2 mt-4"},"Vehicle",-1)),n(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>l.value.vehicle=s),type:"text",placeholder:"e.g., Porsche Taycan",class:"input"},null,512),[[c,l.value.vehicle]]),e[38]||(e[38]=t("label",{class:"block label-upper mb-2 mt-4"},"Opportunity Value",-1)),n(t("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>l.value.value=s),type:"number",placeholder:"0",class:"input"},null,512),[[c,l.value.value]]),e[39]||(e[39]=t("label",{class:"block label-upper mb-2 mt-4"},"Probability (%)",-1)),n(t("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>l.value.probability=s),type:"number",min:"0",max:"100",placeholder:"75",class:"input"},null,512),[[c,l.value.probability]])])):(u(),d("div",je,[e[40]||(e[40]=t("label",{class:"block label-upper mb-2"},"Customer Name",-1)),n(t("input",{"onUpdate:modelValue":e[14]||(e[14]=s=>l.value.customerName=s),type:"text",placeholder:"Enter customer name...",class:"input"},null,512),[[c,l.value.customerName]]),e[41]||(e[41]=t("label",{class:"block label-upper mb-2 mt-4"},"Vehicle",-1)),n(t("input",{"onUpdate:modelValue":e[15]||(e[15]=s=>l.value.vehicle=s),type:"text",placeholder:"Vehicle model",class:"input"},null,512),[[c,l.value.vehicle]]),e[42]||(e[42]=t("label",{class:"block label-upper mb-2 mt-4"},"Reason",-1)),n(t("textarea",{"onUpdate:modelValue":e[16]||(e[16]=s=>l.value.reason=s),rows:"3",placeholder:"Reason for {{ activeTab === 'won' ? 'win' : 'loss' }}...",class:"input resize-none"},null,512),[[c,l.value.reason]])]))]),t("div",_e,[t("button",{onClick:e[17]||(e[17]=s=>g.value=!1),class:"btn-secondary text-sm"}," Cancel "),t("button",{onClick:R,class:"btn-primary"}," Create "+i(O()),1)])])])):q("",!0)]))]))}};export{Pe as default};
