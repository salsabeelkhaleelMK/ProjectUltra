import{u as $,a as A,r as g,k as N,e as l,h as s,l as S,t as w,m as r,g as V,F as C,i as Q,d as D,o as i,p as R,q as U,s as B,v as E}from"./index-HNz1us-X.js";import{_ as F}from"./ActionableQuestionCard-Cu5nvGyN.js";import{_ as M}from"./ReassignUserModal-CuLCytMO.js";import"./ModalShell-D1HAXo86.js";const T={class:"h-full overflow-y-auto bg-gray-50"},L={class:"max-w-4xl mx-auto p-6 space-y-6"},O={class:"mb-6"},Y={class:"text-xs text-gray-500"},j={key:0,class:"flex items-center justify-center py-12"},W={key:1,class:"bg-white border border-gray-200 rounded-xl shadow-sm p-12 text-center"},z={key:2},G={key:0,class:"text-center pt-4"},H={class:"text-sm font-medium text-primary-600 hover:text-primary-700 transition-colors"},q={__name:"ActionItems",setup(J){const p=D(),c=$(),{questions:y,totalQuestionsCount:d,loading:f,loadQuestions:m,dismissQuestion:a,addFollowUpQuestion:x}=A(),u=g(!1),n=g(null);N(async()=>{await m()});const h=async t=>{t.type==="appointment-followup"?(a(t.id),x({id:`offer-followup-${t.opportunityId}`,type:"offer-followup",priority:5,question:`What was the offer given to ${t.customer.name}?`,customer:t.customer,opportunityId:t.opportunityId,opportunity:t.opportunity,createdAt:new Date().toISOString()})):(t.type==="ns-followup"||t.type==="stuck-opportunity"||t.type==="lead-qualification-urgency")&&a(t.id)},v=async t=>{var e;if(t.type==="appointment-followup")try{const o=(e=c.currentUser)==null?void 0:e.id;o&&(await E(t.opportunityId,o),a(t.id),await m())}catch(o){console.error("Error creating NS task:",o)}else t.type==="ns-followup"?a(t.id):t.type==="stuck-opportunity"?p.push(`/tasks/${t.opportunityId}?type=opportunity`):t.type==="lead-qualification-urgency"&&p.push(`/tasks/${t.leadId}?type=lead`)},k=t=>{n.value=t,u.value=!0},I=async t=>{if(n.value)try{const e=n.value.opportunityId||n.value.leadId;n.value.opportunityId&&await U(e,t),a(n.value.id),u.value=!1,n.value=null,await m()}catch(e){console.error("Error reassigning:",e)}},_=t=>{t.opportunityId?p.push(`/tasks/${t.opportunityId}?type=opportunity`):t.leadId&&p.push(`/tasks/${t.leadId}?type=lead`)},b=t=>{c.currentUser&&B(t.id,c.currentUser.id),a(t.id)};return(t,e)=>(i(),l("div",T,[s("div",L,[s("div",O,[e[2]||(e[2]=s("h1",{class:"text-xl font-bold text-slate-800 mb-1"},"Action Items",-1)),s("p",Y,w(r(d)>0?`Showing ${Math.min(r(y).length,5)} of ${r(d)} urgent items`:"No urgent items require your attention"),1)]),r(f)?(i(),l("div",j,[...e[3]||(e[3]=[s("div",{class:"text-gray-500"},"Loading questions...",-1)])])):!r(f)&&r(y).length===0?(i(),l("div",W,[e[4]||(e[4]=s("i",{class:"fa-solid fa-check-circle text-6xl text-emerald-400 mb-4"},null,-1)),e[5]||(e[5]=s("h3",{class:"text-xl font-semibold text-slate-800 mb-2"},"All caught up!",-1)),e[6]||(e[6]=s("p",{class:"text-sm text-gray-600 mb-6"},"No urgent items require your attention right now.",-1)),s("button",{onClick:e[0]||(e[0]=o=>t.$router.push("/tasks")),class:"px-4 py-2 text-sm font-medium text-primary-600 hover:text-primary-700 transition-colors"}," View all tasks → ")])):(i(),l("div",z,[(i(!0),l(C,null,Q(r(y),o=>(i(),R(F,{key:o.id,question:o,onAnswerYes:h,onAnswerNo:v,onReassign:k,onViewTask:_,onDismiss:b},null,8,["question"]))),128)),r(d)>5?(i(),l("div",G,[s("button",H," View all items ("+w(r(d))+") → ",1)])):V("",!0)]))]),S(M,{show:u.value,onClose:e[1]||(e[1]=o=>u.value=!1),onConfirm:I},null,8,["show"])]))}};export{q as default};
