import{n as oe,p as fe,d as at,r as k,c as N,a,h as l,e,l as v,t as f,j as R,q as j,i as M,v as F,F as Q,f as te,k as J,s as ge,x as Fe,b as z,y as de,o as ae,z as ne,A as W,w as xe,u as Y,B as rt,C as it,T as ue,D as ke,E as Le,g as dt,G as ut,_ as ct,H as Ue,I as pt,J as mt}from"./index-BZLq_7J-.js";const re=(t=300)=>new Promise(y=>setTimeout(y,t)),yt=async(t={})=>{await re();let y=[...oe];if(t.stage&&(y=y.filter(s=>s.stage===t.stage)),t.assignee&&(y=y.filter(s=>s.assignee===t.assignee)),t.search){const s=t.search.toLowerCase();y=y.filter(u=>u.customer.name.toLowerCase().includes(s)||u.vehicle.brand.toLowerCase().includes(s)||u.vehicle.model.toLowerCase().includes(s))}return{data:y,total:y.length}},gt=async t=>{await re();const y=oe.find(s=>s.id===parseInt(t));if(!y)throw new Error("Opportunity not found");return y},ft=async t=>(await re(),fe.filter(y=>y.opportunityId===parseInt(t))),vt=async t=>{await re();const y={id:oe.length+1,...t,createdAt:new Date().toISOString()};return oe.push(y),y},we=async(t,y)=>{await re();const s=oe.findIndex(u=>u.id===parseInt(t));if(s===-1)throw new Error("Opportunity not found");return oe[s]={...oe[s],...y},oe[s]},bt=async t=>{await re();const y=oe.findIndex(s=>s.id===parseInt(t));if(y===-1)throw new Error("Opportunity not found");return oe.splice(y,1),{success:!0}},xt=async(t,y)=>{await re();const s={id:fe.length+1,opportunityId:parseInt(t),timestamp:new Date().toISOString(),...y};return fe.push(s),s},ht=async(t,y,s)=>{await re();const u=fe.find(o=>o.id===parseInt(y)&&o.opportunityId===parseInt(t));if(!u)throw new Error("Activity not found");return Object.assign(u,s,{timestamp:new Date().toISOString()}),u},wt=async(t,y)=>{await re();const s=fe.findIndex(u=>u.id===parseInt(y)&&u.opportunityId===parseInt(t));if(s===-1)throw new Error("Activity not found");return fe.splice(s,1),{success:!0}},Ee=at("opportunities",()=>{const t=k([]),y=k(null),s=k([]),u=k(!1),o=k(null),n=k({stage:null,assignee:null,search:""}),p=N(()=>t.value.length),d=N(()=>{const D={};return t.value.forEach(O=>{D[O.stage]||(D[O.stage]=[]),D[O.stage].push(O)}),D}),r=N(()=>t.value.reduce((D,O)=>D+O.value,0));async function i(){u.value=!0,o.value=null;try{const D=await yt(n.value);t.value=D.data}catch(D){o.value=D.message}finally{u.value=!1}}async function b(D){u.value=!0,o.value=null;try{y.value=await gt(D),s.value=await ft(D);const O=t.value.findIndex(T=>T.id===parseInt(D));O!==-1&&(t.value[O]=y.value)}catch(O){o.value=O.message}finally{u.value=!1}}async function c(D){u.value=!0,o.value=null;try{const O=await vt(D);return t.value.unshift(O),O}catch(O){throw o.value=O.message,O}finally{u.value=!1}}async function m(D,O){u.value=!0,o.value=null;try{const T=await we(D,O),P=t.value.findIndex($=>$.id===D);return P!==-1&&(t.value[P]=T),T}catch(T){throw o.value=T.message,T}finally{u.value=!1}}async function x(D){u.value=!0,o.value=null;try{await bt(D),t.value=t.value.filter(O=>O.id!==D)}catch(O){throw o.value=O.message,O}finally{u.value=!1}}async function g(D,O){try{const T=await xt(D,O);return s.value.unshift(T),T}catch(T){throw o.value=T.message,T}}async function C(D,O,T){try{const P=await ht(D,O,T),$=s.value.findIndex(I=>I.id===parseInt(O));return $!==-1&&(s.value[$]=P),P}catch(P){throw o.value=P.message,P}}async function q(D,O){try{return await wt(D,O),s.value=s.value.filter(T=>T.id!==parseInt(O)),{success:!0}}catch(T){throw o.value=T.message,T}}function V(D){n.value={...n.value,...D},i()}async function L(D){var O;u.value=!0,o.value=null;try{const T=t.value.find(B=>B.id===D)||y.value,P={stage:"Qualified"};((T==null?void 0:T.probability)===0||(T==null?void 0:T.probability)===100)&&(P.probability=50);const $=await we(D,P),I=t.value.findIndex(B=>B.id===D);return I!==-1&&(t.value[I]=$),((O=y.value)==null?void 0:O.id)===D&&(y.value=$),await g(D,{type:"note",user:"You",action:"reopened opportunity",content:`Opportunity has been reopened and moved back to ${$.stage} stage`}),$}catch(T){throw o.value=T.message,T}finally{u.value=!1}}async function H(D){var O;u.value=!0,o.value=null;try{const T=await we(D,{stage:"Registration"}),P=t.value.findIndex($=>$.id===D);return P!==-1&&(t.value[P]=T),((O=y.value)==null?void 0:O.id)===D&&(y.value=T),await g(D,{type:"note",user:"You",action:"marked as registration",content:"Opportunity moved to Registration stage - administrative phase before delivery"}),T}catch(T){throw o.value=T.message,T}finally{u.value=!1}}async function le(D){var O;u.value=!0,o.value=null;try{const T=await we(D,{stage:"Closed",probability:100}),P=t.value.findIndex($=>$.id===D);return P!==-1&&(t.value[P]=T),((O=y.value)==null?void 0:O.id)===D&&(y.value=T),await g(D,{type:"note",user:"You",action:"marked as closed won",content:"Opportunity marked as Closed Won - contract signed and deal completed"}),T}catch(T){throw o.value=T.message,T}finally{u.value=!1}}return{opportunities:t,currentOpportunity:y,currentOpportunityActivities:s,loading:u,error:o,filters:n,totalOpportunities:p,opportunitiesByStage:d,totalValue:r,loadOpportunities:i,loadOpportunityById:b,addOpportunity:c,modifyOpportunity:m,removeOpportunity:x,addActivity:g,updateActivity:C,deleteActivity:q,setFilters:V,reopenOpportunity:L,markAsRegistration:H,markAsClosedWon:le}}),kt={class:"bg-white border-r border-gray-200 flex flex-col shrink-0 w-full lg:w-80 h-full"},Ct={class:"h-16 px-5 border-b border-gray-100 flex justify-between items-center bg-gray-50/50"},$t={class:"flex items-center gap-3"},St={class:"font-bold text-lg text-gray-800"},Dt={key:0,class:"px-5 py-2 border-b border-gray-100 bg-gray-50/50"},At={class:"flex gap-2"},It={class:"px-5 py-3"},Tt={class:"relative"},Ot=["placeholder"],qt={class:"flex-1 overflow-y-auto px-4 space-y-4 pb-4 scrollbar-hide"},Nt=["onClick"],Mt=["onClick"],jt={key:1,class:"absolute right-2 top-8 w-36 bg-white border border-gray-200 rounded-lg shadow-lg z-50 overflow-hidden"},Rt={class:"flex items-start gap-3.5 pr-6"},Vt={class:"flex-1 min-w-0"},Ft={class:"font-bold text-gray-800 text-sm leading-snug truncate"},Lt={class:"text-gray-600 text-xs mt-1 truncate"},Ut={class:"text-right shrink-0"},Et={class:"flex items-center gap-2 flex-wrap mt-3"},Bt={__name:"EntityListSidebar",props:{title:{type:String,required:!0},items:{type:Array,required:!0},selectedId:{type:[Number,String],default:null},selectedClass:{type:[String,Function],default:"bg-white border-2 border-blue-500 shadow-md"},unselectedClass:{type:String,default:"bg-white border border-gray-200 hover:border-blue-300"},searchPlaceholder:{type:String,default:"Search..."},showMenu:{type:Boolean,default:!0},openMenuId:{type:[Number,String],default:null},getName:{type:Function,required:!0},getInitials:{type:Function,required:!0},getVehicleInfo:{type:Function,required:!0},avatarClass:{type:Function,default:()=>"bg-orange-100 text-orange-600"},typeFilter:{type:String,default:"all"},showTypeFilter:{type:Boolean,default:!1},showMobileClose:{type:Boolean,default:!1}},emits:["select","menu-click","menu-close","filter-change","close"],setup(t,{emit:y}){const s={mounted(d,r){d.clickOutsideEvent=i=>{d===i.target||d.contains(i.target)||r.value()},document.addEventListener("click",d.clickOutsideEvent)},unmounted(d){document.removeEventListener("click",d.clickOutsideEvent)}},u=t,o=k(""),n=N(()=>{let d=u.items;if(u.typeFilter&&u.typeFilter!=="all"&&(d=d.filter(r=>r.type===u.typeFilter)),o.value){const r=o.value.toLowerCase();d=d.filter(i=>{const b=u.getName(i).toLowerCase(),c=u.getVehicleInfo(i).toLowerCase();return b.includes(r)||c.includes(r)})}return d}),p=d=>{const r=d.compositeId||`${d.type||"task"}-${d.id}`||d.id;return u.selectedId===r};return(d,r)=>(l(),a("div",kt,[e("div",Ct,[e("div",$t,[t.showMobileClose?(l(),a("button",{key:0,onClick:r[0]||(r[0]=i=>d.$emit("close")),class:"lg:hidden w-8 h-8 flex items-center justify-center text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"},[...r[5]||(r[5]=[e("i",{class:"fa-solid fa-xmark text-lg"},null,-1)])])):v("",!0),e("h2",St,f(t.title),1)]),r[6]||(r[6]=e("div",{class:"flex items-center gap-2"},[e("button",{class:"text-xs font-medium bg-white hover:bg-gray-50 px-3 py-1.5 rounded-md border border-gray-200"},[R(" Urgent first "),e("i",{class:"fa-solid fa-chevron-down text-[10px] ml-1"})])],-1))]),t.showTypeFilter?(l(),a("div",Dt,[e("div",At,[e("button",{onClick:r[1]||(r[1]=i=>d.$emit("filter-change","all")),class:j(["text-xs font-medium px-3 py-1.5 rounded-md border transition-colors",t.typeFilter==="all"?"bg-blue-600 text-white border-blue-600":"bg-white hover:bg-gray-50 border-gray-200 text-gray-700"])}," All ",2),e("button",{onClick:r[2]||(r[2]=i=>d.$emit("filter-change","lead")),class:j(["text-xs font-medium px-3 py-1.5 rounded-md border transition-colors",t.typeFilter==="lead"?"bg-blue-600 text-white border-blue-600":"bg-white hover:bg-gray-50 border-gray-200 text-gray-700"])}," Leads ",2),e("button",{onClick:r[3]||(r[3]=i=>d.$emit("filter-change","opportunity")),class:j(["text-xs font-medium px-3 py-1.5 rounded-md border transition-colors",t.typeFilter==="opportunity"?"bg-blue-600 text-white border-blue-600":"bg-white hover:bg-gray-50 border-gray-200 text-gray-700"])}," Opportunities ",2)])])):v("",!0),e("div",It,[e("div",Tt,[r[7]||(r[7]=e("i",{class:"fa-solid fa-magnifying-glass absolute left-3 top-2.5 text-gray-400 text-sm"},null,-1)),M(e("input",{"onUpdate:modelValue":r[4]||(r[4]=i=>o.value=i),type:"text",placeholder:t.searchPlaceholder,class:"w-full bg-gray-50 border border-gray-200 rounded-lg pl-9 pr-3 py-2 text-sm"},null,8,Ot),[[F,o.value]])])]),e("div",qt,[(l(!0),a(Q,null,te(n.value,i=>(l(),a("div",{key:i.id,onClick:b=>d.$emit("select",i.compositeId||`${i.type||"task"}-${i.id}`||i.id),class:j(["rounded-xl px-4 py-3.5 cursor-pointer transition-all relative group",p(i)?typeof t.selectedClass=="function"?t.selectedClass(i):t.selectedClass:typeof t.unselectedClass=="function"?t.unselectedClass(i):t.unselectedClass])},[t.showMenu?(l(),a("button",{key:0,onClick:J(b=>d.$emit("menu-click",i.id),["stop"]),class:"absolute top-2 right-2 w-5 h-5 flex items-center justify-center rounded hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors z-10"},[...r[8]||(r[8]=[e("i",{class:"fa-solid fa-ellipsis-vertical text-xs"},null,-1)])],8,Mt)):v("",!0),t.openMenuId===i.id&&t.showMenu?M((l(),a("div",jt,[ge(d.$slots,"menu",{item:i})])),[[s,()=>d.$emit("menu-close")]]):v("",!0),e("div",Rt,[e("div",{class:j(["w-10 h-10 rounded-full flex items-center justify-center text-xs font-bold shrink-0",t.avatarClass(i)])},f(t.getInitials(i)),3),e("div",Vt,[e("div",Ft,f(t.getName(i)),1),e("div",Lt,f(t.getVehicleInfo(i)),1)]),e("div",Ut,[ge(d.$slots,"meta",{item:i}),ge(d.$slots,"footer",{item:i})])]),e("div",Et,[ge(d.$slots,"badges",{item:i})])],10,Nt))),128))])]))}},Wt={class:"h-16 px-5 border-b border-gray-100 bg-gray-50/50 flex items-center justify-between gap-3"},Pt={class:"flex items-center gap-3"},zt={key:2,class:"font-bold text-lg text-gray-800"},Yt={key:0,class:"flex-1 overflow-y-auto px-5 py-6 scrollbar-hide relative"},Qt={key:0,class:"absolute left-[39px] top-0 bottom-0 w-0.5 bg-gray-200 z-0"},Ht={key:1,class:"text-center py-8 text-gray-400 relative z-10"},Jt={class:"text-sm"},Kt={key:2,class:"space-y-6 relative z-10"},Gt={key:0,class:"mb-4 pl-12"},Xt={class:"text-sm font-semibold text-gray-800"},Zt={class:"flex gap-4 relative mb-6"},_t={class:"flex-1 min-w-0"},es={class:"text-sm text-slate-700 leading-snug"},ts={class:"font-bold"},ss={key:0,class:"mt-2 bg-orange-50/50 border border-orange-100 p-3 rounded-lg text-sm text-gray-700"},os={class:"text-xs text-gray-400 mt-1"},je={__name:"ActivitySummarySidebar",props:{title:{type:String,default:"Activity summary"},activities:{type:Array,default:()=>[]},emptyMessage:{type:String,default:"No activities yet"},collapsed:{type:Boolean,default:!1},showCollapse:{type:Boolean,default:!0},show:{type:Boolean,default:!0},mobileFullscreen:{type:Boolean,default:!1}},emits:["toggle-collapse","close"],setup(t,{emit:y}){const s=t,u=r=>{const i={call:"fa-solid fa-phone text-blue-600",email:"fa-solid fa-envelope text-green-600",note:"fa-solid fa-sticky-note text-yellow-600",meeting:"fa-solid fa-calendar text-purple-600",task:"fa-solid fa-check-circle text-indigo-600",attachment:"fa-solid fa-paperclip text-gray-600",status:"fa-solid fa-tag text-orange-600",default:"fa-solid fa-circle text-gray-400"};return i[r]||i.default},o=r=>{const i={call:"bg-blue-100 text-blue-600",email:"bg-green-100 text-green-600",note:"bg-yellow-100 text-yellow-600",meeting:"bg-purple-100 text-purple-600",task:"bg-indigo-100 text-indigo-600",attachment:"bg-gray-100 text-gray-600",status:"bg-orange-100 text-orange-600",default:"bg-gray-100 text-gray-400"};return i[r]||i.default},n=r=>{if(!r)return"";const i=new Date(r),b=new Date,c=new Date(b);return c.setDate(c.getDate()-1),i.toDateString()===b.toDateString()?"Today":i.toDateString()===c.toDateString()?"Yesterday":i.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},p=r=>r?new Date(r).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",d=(r,i)=>{if(r===0)return!0;const b=s.activities[r-1];if(!b)return!0;const c=new Date(i.timestamp).toDateString(),m=new Date(b.timestamp).toDateString();return c!==m};return(r,i)=>t.show?(l(),a("div",{key:0,class:j(["bg-white border-l border-gray-200 shrink-0 flex flex-col transition-all duration-300",[t.collapsed?"w-16":"w-80",t.mobileFullscreen?"xl:relative xl:border-l":""]])},[e("div",Wt,[e("div",Pt,[t.mobileFullscreen?(l(),a("button",{key:0,onClick:i[0]||(i[0]=b=>r.$emit("close")),class:"xl:hidden w-8 h-8 flex items-center justify-center text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"},[...i[2]||(i[2]=[e("i",{class:"fa-solid fa-xmark text-lg"},null,-1)])])):t.showCollapse?(l(),a("button",{key:1,onClick:i[1]||(i[1]=b=>r.$emit("toggle-collapse")),class:"w-8 h-8 flex items-center justify-center rounded-md text-gray-400 hover:text-gray-900 hover:bg-gray-100 transition-colors shrink-0",title:"Toggle Sidebar"},[e("i",{class:j(["fa-solid fa-arrow-right-from-bracket transition-transform duration-300",t.collapsed?"rotate-180":""])},null,2)])):v("",!0),t.collapsed?v("",!0):(l(),a("h2",zt,f(t.title),1))])]),t.collapsed?v("",!0):(l(),a("div",Yt,[t.activities.length>0?(l(),a("div",Qt)):v("",!0),t.activities.length===0?(l(),a("div",Ht,[i[3]||(i[3]=e("i",{class:"fa-solid fa-clock text-4xl mb-2"},null,-1)),e("p",Jt,f(t.emptyMessage),1)])):(l(),a("div",Kt,[(l(!0),a(Q,null,te(t.activities,(b,c)=>(l(),a(Q,{key:b.id},[d(c,b)?(l(),a("div",Gt,[e("h3",Xt,f(n(b.timestamp)),1)])):v("",!0),e("div",Zt,[e("div",{class:j(["w-10 h-10 rounded-full flex items-center justify-center shrink-0 z-10 relative bg-white",o(b.type)])},[e("i",{class:j([u(b.type),"text-sm"])},null,2)],2),e("div",_t,[e("div",es,[e("span",ts,f(b.user),1),R(" "+f(b.action),1)]),b.content?(l(),a("div",ss,f(b.content),1)):v("",!0),e("div",os,f(p(b.timestamp)),1)])])],64))),128))]))]))],2)):v("",!0)}},ls={class:"w-full"},ns={class:"flex items-center justify-between gap-3 md:gap-4"},as={class:"flex items-center gap-3 md:gap-4 flex-1"},rs={class:"min-w-0 flex-1"},is={class:"heading-main truncate"},ds={class:"flex flex-wrap items-center gap-2 mt-1"},us={class:"flex items-center gap-1 ml-2"},cs={key:0,class:"mt-4 pt-4 border-t-2 border-dashed border-gray-300 animate-fade-in relative"},ps={class:"flex items-center gap-4"},ms={class:"flex flex-wrap items-center gap-x-6 gap-y-2"},ys={class:"flex items-center gap-2"},gs={class:"text-xs text-gray-900 font-medium"},fs={class:"flex items-center gap-2"},vs={class:"text-xs text-gray-900 font-medium"},bs={class:"flex items-center gap-2"},xs={class:"w-6 h-6 rounded bg-gray-100 flex items-center justify-center shrink-0"},hs={key:0,class:"fa-solid fa-map-marker-alt text-gray-500 text-[10px]"},ws={key:1,class:"fa-regular fa-calendar text-gray-500 text-[10px]"},ks={class:"text-xs text-gray-900 font-medium"},Cs={key:0,class:"absolute -bottom-6 left-0 px-2 py-1 bg-gray-900 text-white text-[10px] rounded shadow-lg whitespace-nowrap"},$s={__name:"ContactInfo",props:{initials:{type:String,required:!0},name:{type:String,required:!0},avatarColorClass:{type:String,default:"bg-orange-100 text-orange-600"},email:{type:String,required:!0},phone:{type:String,required:!0},thirdFieldValue:{type:String,required:!0},emailLabel:{type:String,default:"Email"},phoneLabel:{type:String,default:"Phone"},thirdFieldLabel:{type:String,default:"Expected Close"}},setup(t){const y=k(!1),s=k(null),u=async(o,n)=>{try{await navigator.clipboard.writeText(o),s.value=n,setTimeout(()=>{s.value=null},1500)}catch(p){console.error("Failed to copy:",p)}};return(o,n)=>(l(),a("div",ls,[e("div",ns,[e("div",as,[e("div",{class:j(["w-12 h-12 rounded-full flex items-center justify-center text-lg font-bold border-2 border-white shadow-sm shrink-0",t.avatarColorClass])},f(t.initials),3),e("div",rs,[e("h1",is,f(t.name),1),e("div",ds,[ge(o.$slots,"tags")])])]),e("div",us,[e("button",{onClick:n[0]||(n[0]=p=>y.value=!y.value),class:"w-9 h-9 flex items-center justify-center bg-white border border-gray-200 rounded-lg hover:bg-gray-50 shrink-0"},[e("i",{class:j(["fa-solid fa-chevron-down text-sm transition-transform duration-200",{"rotate-180":y.value}])},null,2)])])]),y.value?(l(),a("div",cs,[e("div",ps,[e("div",ms,[e("div",ys,[n[4]||(n[4]=e("div",{class:"w-6 h-6 rounded bg-gray-100 flex items-center justify-center shrink-0"},[e("i",{class:"fa-regular fa-envelope text-gray-500 text-[10px]"})],-1)),e("span",gs,f(t.email),1),e("button",{onClick:n[1]||(n[1]=J(p=>u(t.email,"email"),["stop"])),class:"w-5 h-5 flex items-center justify-center rounded hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors shrink-0",title:"Copy email"},[...n[3]||(n[3]=[e("i",{class:"fa-regular fa-copy text-[10px]"},null,-1)])])]),e("div",fs,[n[6]||(n[6]=e("div",{class:"w-6 h-6 rounded bg-gray-100 flex items-center justify-center shrink-0"},[e("i",{class:"fa-solid fa-phone text-gray-500 text-[10px]"})],-1)),e("span",vs,f(t.phone),1),e("button",{onClick:n[2]||(n[2]=J(p=>u(t.phone,"phone"),["stop"])),class:"w-5 h-5 flex items-center justify-center rounded hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors shrink-0",title:"Copy phone"},[...n[5]||(n[5]=[e("i",{class:"fa-regular fa-copy text-[10px]"},null,-1)])])]),e("div",bs,[e("div",xs,[t.thirdFieldLabel.toLowerCase().includes("address")?(l(),a("i",hs)):(l(),a("i",ws))]),e("span",ks,f(t.thirdFieldValue),1)])])]),s.value?(l(),a("div",Cs,f(s.value==="email"?"Email":"Phone")+" copied! ",1)):v("",!0)])):v("",!0)]))}},Ss={class:"flex gap-8 text-base font-medium text-slate-500 py-1 overflow-x-auto scrollbar-hide"},Ds=["onClick"],As={__name:"Tabs",props:{modelValue:{type:String,required:!0},tabs:{type:Array,required:!0}},emits:["update:modelValue"],setup(t){return(y,s)=>(l(),a("div",Ss,[(l(!0),a(Q,null,te(t.tabs,u=>(l(),a("div",{key:u.key,onClick:o=>y.$emit("update:modelValue",u.key),class:j(["pb-2 border-b-2 cursor-pointer whitespace-nowrap transition-colors",t.modelValue===u.key?"border-slate-900 text-slate-900":"border-transparent hover:text-slate-700 hover:border-slate-200"])},[R(f(u.label)+" ",1),u.count!==void 0?(l(),a("span",{key:0,class:j(["ml-2 inline-flex items-center justify-center px-2 py-0.5 rounded-full text-xs font-semibold",t.modelValue===u.key?"bg-gray-200 text-gray-700":"bg-gray-100 text-gray-500"])},f(u.count),3)):v("",!0)],10,Ds))),128))]))}},Is={class:"metadata-bar w-full"},Ts={class:"flex items-center gap-2 px-3 py-1.5"},Os={class:"text-xs font-bold text-gray-800"},qs={key:0,class:"flex items-center gap-2 px-3 py-1.5"},Ns={class:"flex items-center gap-2"},Ms={class:"w-16 bg-gray-200 rounded-full h-2"},js={class:"text-xs font-bold text-gray-800"},Rs={key:1,class:"metadata-divider"},Vs={class:"flex items-center gap-2 px-3 py-1.5"},Fs={class:"text-xs font-bold text-gray-800"},Ls={class:"flex items-center gap-2 px-3 py-1.5"},Us={class:"text-xs font-bold text-gray-800"},Es={__name:"StageOwnerBar",props:{stage:{type:String,required:!0},owner:{type:String,required:!0},source:{type:String,default:""},probability:{type:Number,default:null}},setup(t){const y=t,s=N(()=>y.probability!==null&&y.probability!==void 0),u=N(()=>y.probability>=70?"bg-green-500":y.probability>=40?"bg-orange-500":"bg-red-500");return(o,n)=>(l(),a("div",Is,[e("div",Ts,[n[0]||(n[0]=e("span",{class:"label-upper"},"Stage",-1)),e("span",Os,f(t.stage),1)]),n[5]||(n[5]=e("div",{class:"metadata-divider"},null,-1)),s.value?(l(),a("div",qs,[n[1]||(n[1]=e("span",{class:"label-upper"},"Probability",-1)),e("div",Ns,[e("div",Ms,[e("div",{class:j(["h-2 rounded-full transition-all",u.value]),style:Fe({width:t.probability+"%"})},null,6)]),e("span",js,f(t.probability)+"%",1)])])):v("",!0),s.value?(l(),a("div",Rs)):v("",!0),e("div",Vs,[n[2]||(n[2]=e("span",{class:"label-upper"},"Owner",-1)),e("span",Fs,f(t.owner),1)]),t.source?(l(),a(Q,{key:2},[n[4]||(n[4]=e("div",{class:"metadata-divider"},null,-1)),e("div",Ls,[n[3]||(n[3]=e("span",{class:"label-upper"},"Source",-1)),e("span",Us,f(t.source),1)])],64)):v("",!0)]))}},Bs={key:0,class:"flex-grow border-t border-gray-200"},Ws={key:0,class:"absolute top-full left-1/2 -translate-x-1/2 mt-2 w-48 bg-white border border-gray-200 rounded-xl shadow-lg shadow-gray-100/50 z-10 overflow-hidden flex flex-col p-1"},Ps={key:0,class:"border-t border-gray-100 my-1"},zs={key:1,class:"flex-grow border-t border-gray-200"},Re={__name:"AddNewButton",props:{show:{type:Boolean,default:!0},actions:{type:Array,default:()=>["note","financing","tradein","attachment","email","whatsapp","sms"]},activeTab:{type:String,default:"overview"},inline:{type:Boolean,default:!1}},emits:["action"],setup(t,{emit:y}){const s={mounted(x,g){x.clickOutsideEvent=C=>{x===C.target||x.contains(C.target)||g.value()},document.addEventListener("click",x.clickOutsideEvent)},unmounted(x){document.removeEventListener("click",x.clickOutsideEvent)}},u=t,o=y,n=k(!1),p=N(()=>u.inline?"bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-1.5 text-sm shadow-sm transition-all flex items-center gap-2 z-20 relative":"bg-gray-50 hover:bg-white border border-gray-200 text-slate-700 font-medium px-4 py-1.5 rounded-full text-sm shadow-sm transition-all flex items-center gap-2 z-20 relative"),d={note:"note",attachment:"attachment",email:"communication",whatsapp:"communication",sms:"communication"},r=N(()=>{if(!u.activeTab||u.activeTab==="overview")return u.actions.filter(g=>!d[g]);const x=Object.entries(d).filter(([,g])=>g===u.activeTab).map(([g])=>g);return u.actions.filter(g=>x.includes(g))}),i=N(()=>r.value.some(x=>["email","whatsapp","sms"].includes(x))),b=N(()=>r.value.some(x=>["addVehicle","configureVehicle"].includes(x))),c=N(()=>r.value.some(x=>["note","financing","tradein","attachment","requestedCar","purchase"].includes(x))),m=x=>{n.value=!1,o("action",x)};return(x,g)=>t.show?(l(),a("div",{key:0,class:j(["relative flex items-center",t.inline?"justify-end mb-0 py-0":"py-1 mb-4"])},[t.inline?v("",!0):(l(),a("div",Bs)),e("div",{class:j(["relative",t.inline?"mx-0":"mx-4"])},[e("button",{onClick:g[0]||(g[0]=J(C=>n.value=!n.value,["stop"])),class:j(p.value)},[...g[12]||(g[12]=[e("i",{class:"fa-solid fa-plus text-xs"},null,-1),R(" Add new ",-1)])],2),n.value?M((l(),a("div",Ws,[b.value?(l(),a(Q,{key:0},[r.value.includes("addVehicle")?(l(),a("button",{key:0,onClick:g[1]||(g[1]=C=>m("addVehicle")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Add Vehicle ")):v("",!0),r.value.includes("configureVehicle")?(l(),a("button",{key:1,onClick:g[2]||(g[2]=C=>m("configureVehicle")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Configure Vehicle ")):v("",!0)],64)):v("",!0),c.value?(l(),a(Q,{key:1},[b.value?(l(),a("div",Ps)):v("",!0),r.value.includes("note")?(l(),a("button",{key:1,onClick:g[3]||(g[3]=C=>m("note")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Note ")):v("",!0),r.value.includes("financing")?(l(),a("button",{key:2,onClick:g[4]||(g[4]=C=>m("financing")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Financing ")):v("",!0),r.value.includes("tradein")?(l(),a("button",{key:3,onClick:g[5]||(g[5]=C=>m("tradein")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Trade-in ")):v("",!0),r.value.includes("requestedCar")?(l(),a("button",{key:4,onClick:g[6]||(g[6]=C=>m("requestedCar")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Requested car ")):v("",!0),r.value.includes("purchase")?(l(),a("button",{key:5,onClick:g[7]||(g[7]=C=>m("purchase")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Purchase ")):v("",!0),r.value.includes("attachment")?(l(),a("button",{key:6,onClick:g[8]||(g[8]=C=>m("attachment")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Attachment ")):v("",!0)],64)):v("",!0),i.value?(l(),a(Q,{key:2},[g[16]||(g[16]=e("div",{class:"border-t border-gray-100 my-1"},null,-1)),r.value.includes("email")?(l(),a("button",{key:0,onClick:g[9]||(g[9]=C=>m("email")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...g[13]||(g[13]=[e("i",{class:"fa-regular fa-envelope text-xs text-gray-400"},null,-1),R(" Send Email ",-1)])])):v("",!0),r.value.includes("whatsapp")?(l(),a("button",{key:1,onClick:g[10]||(g[10]=C=>m("whatsapp")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...g[14]||(g[14]=[e("i",{class:"fa-brands fa-whatsapp text-xs text-gray-400"},null,-1),R(" Send WhatsApp ",-1)])])):v("",!0),r.value.includes("sms")?(l(),a("button",{key:2,onClick:g[11]||(g[11]=C=>m("sms")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...g[15]||(g[15]=[e("i",{class:"fa-solid fa-comment-dots text-xs text-gray-400"},null,-1),R(" Send SMS ",-1)])])):v("",!0)],64)):v("",!0)])),[[s,()=>n.value=!1]]):v("",!0)],2),t.inline?v("",!0):(l(),a("div",zs))],2)):v("",!0)}},Ys={class:"bg-purple-50/50 border border-purple-100 rounded-lg p-4"},Qs={class:"flex items-start gap-3"},Hs={class:"flex-1 min-w-0"},Js={class:"font-bold text-sm text-slate-800 mb-2"},Ks={class:"space-y-1.5 text-xs text-gray-600"},Gs={class:"flex items-center gap-2"},Xs={class:"flex items-center gap-2"},Zs={class:"flex items-center gap-2"},_s={key:0,class:"mt-2"},eo={__name:"AppointmentWidget",props:{appointmentData:{type:Object,required:!0}},setup(t){const y=t,s=N(()=>y.appointmentData.date?new Date(y.appointmentData.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""),u=N(()=>y.appointmentData.time?y.appointmentData.time:""),o=n=>({scheduled:"bg-blue-100 text-blue-700 border border-blue-200",confirmed:"bg-green-100 text-green-700 border border-green-200",pending:"bg-yellow-100 text-yellow-700 border border-yellow-200",cancelled:"bg-red-100 text-red-700 border border-red-200"})[n==null?void 0:n.toLowerCase()]||"bg-gray-100 text-gray-700 border border-gray-200";return(n,p)=>(l(),a("div",Ys,[e("div",Qs,[p[3]||(p[3]=e("div",{class:"w-10 h-10 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center shrink-0"},[e("i",{class:"fa-solid fa-calendar text-sm"})],-1)),e("div",Hs,[e("h4",Js,f(t.appointmentData.type),1),e("div",Ks,[e("div",Gs,[p[0]||(p[0]=e("i",{class:"fa-regular fa-calendar text-gray-400"},null,-1)),e("span",null,f(s.value),1)]),e("div",Xs,[p[1]||(p[1]=e("i",{class:"fa-regular fa-clock text-gray-400"},null,-1)),e("span",null,f(u.value),1)]),e("div",Zs,[p[2]||(p[2]=e("i",{class:"fa-solid fa-user text-gray-400"},null,-1)),e("span",null,f(t.appointmentData.assignee),1)])]),t.appointmentData.status?(l(),a("div",_s,[e("span",{class:j(["inline-flex px-2 py-0.5 rounded text-[10px] font-semibold",o(t.appointmentData.status)])},f(t.appointmentData.status),3)])):v("",!0)])])]))}},to={class:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm flex gap-4 animate-fade-in mb-4 feed-item"},so={class:"flex-1"},oo={class:"flex items-center gap-2 mb-1"},lo={class:"text-xs font-bold text-slate-800"},no={class:"text-[10px] text-gray-400"},ao={class:"text-[10px] text-gray-400"},ro={key:0,class:"bg-blue-50 text-blue-600 text-[9px] px-1.5 py-0.5 rounded border border-blue-100"},io={class:"ml-auto relative"},uo={key:0,class:"absolute right-0 top-full mt-1 w-32 bg-white border border-gray-200 rounded-lg shadow-lg z-10 overflow-hidden"},co={key:0,class:"text-sm text-slate-700"},po={key:1,class:"text-sm text-slate-700 flex items-center gap-2"},mo={key:2,class:"mt-2"},yo={key:0},go={key:1,class:"bg-gray-50 border border-gray-200 rounded-lg p-3"},fo={key:0},vo={class:"text-sm font-bold text-slate-800"},bo={key:0,class:"text-xs text-gray-600 mt-0.5"},xo={class:"grid grid-cols-2 gap-x-4 gap-y-1 text-xs text-gray-500 mt-2"},ho={key:0},wo={key:1},ko={key:2},Co={key:3},$o={key:4},So={key:1},Do={class:"text-sm font-bold text-slate-800 mb-2"},Ao={class:"grid grid-cols-2 gap-x-4 gap-y-2 text-xs"},Io={key:0},To={class:"text-slate-700 font-medium ml-1"},Oo={key:1},qo={class:"text-slate-700 font-medium ml-1"},No={key:2},Mo={class:"text-slate-700 font-medium ml-1"},jo={key:3},Ro={class:"text-slate-700 font-medium ml-1"},Vo={key:4},Fo={class:"text-slate-700 font-medium ml-1"},Lo={key:5},Uo={class:"text-slate-700 font-medium ml-1"},Eo={key:2,class:"flex items-center gap-3"},Bo={key:0,class:"w-16 h-16 bg-gray-200 rounded overflow-hidden flex-shrink-0"},Wo=["src"],Po={class:"flex-1"},zo={class:"text-sm font-bold text-slate-800"},Yo={class:"text-xs text-gray-500"},Qo={key:1,class:"bg-purple-600 text-white text-[10px] font-bold px-2 py-0.5 rounded"},Ho={key:3,class:"flex items-center gap-3"},Jo={class:"flex-1"},Ko={class:"text-sm font-bold text-slate-800"},Go={class:"text-xs text-gray-500"},Xo={key:0,class:"text-xs text-gray-400 mt-1"},Zo={key:1,class:"text-xs text-gray-600 mt-1"},_o={__name:"FeedItemCard",props:{item:{type:Object,required:!0},taskType:{type:String,default:"lead"},customerInitials:{type:String,required:!0}},emits:["edit","delete"],setup(t,{emit:y}){const s=t,u=y,o=k(!1),n={mounted(x,g){x.clickOutsideEvent=C=>{x===C.target||x.contains(C.target)||g.value()},setTimeout(()=>{document.addEventListener("click",x.clickOutsideEvent)},0)},unmounted(x){document.removeEventListener("click",x.clickOutsideEvent)}},p=x=>({note:"fa-regular fa-note-sticky",communication:"fa-solid fa-comment-dots",email:"fa-regular fa-envelope",whatsapp:"fa-brands fa-whatsapp",sms:"fa-solid fa-comment-dots",attachment:"fa-solid fa-paperclip",tradein:"fa-solid fa-car-side",financing:"fa-solid fa-file-invoice-dollar",offer:"fa-solid fa-handshake",purchase:"fa-solid fa-shopping-cart",appointment:"fa-solid fa-calendar"})[x]||"fa-solid fa-circle",d=x=>({note:"bg-orange-100 text-orange-600 border-orange-200",communication:"bg-gray-100 text-gray-600 border-gray-200",email:"bg-blue-100 text-blue-600 border-blue-200",whatsapp:"bg-green-100 text-green-600 border-green-200",sms:"bg-gray-100 text-gray-600 border-gray-200",attachment:"bg-blue-50 text-blue-600 border-blue-100",tradein:"bg-green-50 text-green-600 border-green-100",financing:"bg-purple-50 text-purple-600 border-purple-100",offer:"bg-indigo-50 text-indigo-600 border-indigo-100",purchase:"bg-teal-50 text-teal-600 border-teal-100",appointment:"bg-purple-100 text-purple-600 border-purple-200"})[x]||"bg-gray-100 text-gray-600 border-gray-200",r=x=>{if(!x)return"Just now";const g=new Date(x),q=new Date-g,V=Math.floor(q/6e4),L=Math.floor(V/60),H=Math.floor(L/24);return V<1?"Just now":V<60?`${V} minutes ago`:L<24?`${L} hours ago`:H===1?"Yesterday":H<7?`${H} days ago`:g.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},i=x=>x?new Intl.NumberFormat("en-US").format(x):"0",b=x=>x?new Date(x).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",c=()=>{o.value=!1,u("edit",s.item)},m=()=>{o.value=!1,confirm("Are you sure you want to delete this item?")&&u("delete",s.item)};return(x,g)=>(l(),a("div",to,[e("div",{class:j(["w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold shrink-0 border",d(t.item.type)])},[e("i",{class:j([p(t.item.type),"text-sm"])},null,2)],2),e("div",so,[e("div",oo,[e("span",lo,f(t.customerInitials),1),e("span",no,f(t.item.action||"added"),1),e("span",ao,"• "+f(r(t.item.timestamp)),1),t.item.autoDetected?(l(),a("span",ro,"Auto-detected")):v("",!0),e("div",io,[e("button",{onClick:g[0]||(g[0]=J(C=>o.value=!o.value,["stop"])),class:"text-gray-400 hover:text-gray-600 transition-colors p-1",title:"More actions"},[...g[1]||(g[1]=[e("i",{class:"fa-solid fa-ellipsis-vertical text-sm"},null,-1)])]),o.value?M((l(),a("div",uo,[e("button",{onClick:c,class:"w-full text-left px-3 py-2 text-xs text-slate-700 hover:bg-gray-50 flex items-center gap-2"},[...g[2]||(g[2]=[e("i",{class:"fa-solid fa-pencil text-gray-400"},null,-1),R(" Edit ",-1)])]),e("button",{onClick:m,class:"w-full text-left px-3 py-2 text-xs text-red-600 hover:bg-red-50 flex items-center gap-2"},[...g[3]||(g[3]=[e("i",{class:"fa-solid fa-trash text-red-400"},null,-1),R(" Delete ",-1)])])])),[[n,()=>o.value=!1]]):v("",!0)])]),t.item.content?(l(),a("div",co,f(t.item.content),1)):v("",!0),t.item.fileName?(l(),a("div",po,[g[4]||(g[4]=e("i",{class:"fa-solid fa-paperclip text-gray-400"},null,-1)),e("span",null,f(t.item.fileName),1)])):v("",!0),t.item.data?(l(),a("div",mo,[t.item.type==="appointment"?(l(),a("div",yo,[z(eo,{"appointment-data":t.item.data},null,8,["appointment-data"])])):(l(),a("div",go,[t.item.type==="tradein"?(l(),a("div",fo,[e("h4",vo,f(t.item.data.brand)+" "+f(t.item.data.model),1),t.item.data.version?(l(),a("p",bo,f(t.item.data.version),1)):v("",!0),e("div",xo,[t.item.data.year?(l(),a("div",ho,[g[5]||(g[5]=e("i",{class:"fa-regular fa-calendar mr-1"},null,-1)),R(f(t.item.data.year),1)])):v("",!0),t.item.data.km?(l(),a("div",wo,[g[6]||(g[6]=e("i",{class:"fa-solid fa-road mr-1"},null,-1)),R(f(t.item.data.km)+" km ",1)])):v("",!0),t.item.data.plate?(l(),a("div",ko,[g[7]||(g[7]=e("i",{class:"fa-solid fa-id-card mr-1"},null,-1)),R(f(t.item.data.plate),1)])):v("",!0),t.item.data.date?(l(),a("div",Co,[g[8]||(g[8]=e("i",{class:"fa-regular fa-calendar-check mr-1"},null,-1)),R(f(b(t.item.data.date)),1)])):v("",!0),t.item.data.class?(l(),a("div",$o,[g[9]||(g[9]=e("i",{class:"fa-solid fa-car mr-1"},null,-1)),R(f(t.item.data.class),1)])):v("",!0)])])):t.item.type==="financing"?(l(),a("div",So,[e("h4",Do,f(t.item.data.product),1),e("div",Ao,[t.item.data.provider?(l(),a("div",Io,[g[10]||(g[10]=e("span",{class:"text-gray-500"},"Provider:",-1)),e("span",To,f(t.item.data.provider),1)])):v("",!0),t.item.data.total?(l(),a("div",Oo,[g[11]||(g[11]=e("span",{class:"text-gray-500"},"Total:",-1)),e("span",qo,"€"+f(i(t.item.data.total)),1)])):v("",!0),t.item.data.monthly?(l(),a("div",No,[g[12]||(g[12]=e("span",{class:"text-gray-500"},"Monthly:",-1)),e("span",Mo,"€"+f(i(t.item.data.monthly)),1)])):v("",!0),t.item.data.deposit?(l(),a("div",jo,[g[13]||(g[13]=e("span",{class:"text-gray-500"},"Deposit:",-1)),e("span",Ro,"€"+f(i(t.item.data.deposit)),1)])):v("",!0),t.item.data.startDate?(l(),a("div",Vo,[g[14]||(g[14]=e("span",{class:"text-gray-500"},"Start:",-1)),e("span",Fo,f(b(t.item.data.startDate)),1)])):v("",!0),t.item.data.expDate?(l(),a("div",Lo,[g[15]||(g[15]=e("span",{class:"text-gray-500"},"Expires:",-1)),e("span",Uo,f(b(t.item.data.expDate)),1)])):v("",!0)])])):t.item.type==="offer"?(l(),a("div",Eo,[t.item.data.image?(l(),a("div",Bo,[e("img",{src:t.item.data.image,alt:"Car",class:"w-full h-full object-cover"},null,8,Wo)])):v("",!0),e("div",Po,[e("h4",zo,f(t.item.data.brand)+" "+f(t.item.data.model)+" ("+f(t.item.data.year)+")",1),e("p",Yo,"€ "+f(i(t.item.data.price)),1)]),t.item.data.isMainOffer?(l(),a("span",Qo,"Main Offer")):v("",!0)])):t.item.type==="purchase"?(l(),a("div",Ho,[e("div",Jo,[e("h4",Ko,f(t.item.data.brand)+" "+f(t.item.data.model)+" ("+f(t.item.data.year)+")",1),e("p",Go,"€ "+f(i(t.item.data.price)),1),t.item.data.purchaseDate?(l(),a("p",Xo,"Purchased: "+f(b(t.item.data.purchaseDate)),1)):v("",!0),t.item.data.notes?(l(),a("p",Zo,f(t.item.data.notes),1)):v("",!0)])])):v("",!0)]))])):v("",!0)])]))}},el={class:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm mb-6 animate-fade-in relative"},tl={class:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3"},sl={class:"mb-3"},ol={class:"flex justify-end gap-2"},ll={__name:"CommunicationWidget",props:{type:{type:String,required:!0},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(t,{emit:y}){const s=t,u=y,o=k(""),n=k(""),p=()=>{!o.value.trim()&&!n.value||u("save",{type:"communication",action:`sent via ${s.type}`,content:o.value||`Sent template: ${n.value}`,communicationType:s.type})};return(d,r)=>(l(),a("div",el,[r[5]||(r[5]=e("div",{class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-t border-l border-gray-200 rotate-45"},null,-1)),e("h5",tl,f(t.type==="email"?"Send Email":t.type==="whatsapp"?"Send WhatsApp":t.type==="sms"?"Send SMS":"Send Message"),1),e("div",sl,[r[4]||(r[4]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Template",-1)),M(e("select",{"onUpdate:modelValue":r[0]||(r[0]=i=>n.value=i),class:"w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500 cursor-pointer"},[...r[3]||(r[3]=[e("option",{value:""},"Select a template...",-1),e("option",null,"Follow-up",-1),e("option",null,"Meeting Confirmation",-1),e("option",null,"Quote Proposal",-1),e("option",null,"Unable to Reach",-1)])],512),[[de,n.value]])]),M(e("textarea",{"onUpdate:modelValue":r[1]||(r[1]=i=>o.value=i),class:"w-full bg-gray-50 border border-gray-200 rounded-lg p-3 text-sm focus:outline-none focus:border-blue-500 resize-none mb-3",rows:"4",placeholder:"Type your message here..."},null,512),[[F,o.value]]),e("div",ol,[e("button",{onClick:r[2]||(r[2]=i=>d.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:p,class:"bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Send")])]))}},nl={class:"bg-white border border-gray-200 rounded-xl p-5 shadow-sm mb-6 animate-fade-in relative"},al={class:"flex justify-between items-center mb-4"},rl={class:"text-sm font-bold text-slate-800"},il={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},dl={__name:"NoteWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(t,{emit:y}){const s=t,u=y,o=k("");ae(()=>{s.item&&(o.value=s.item.content||"")});const n=()=>{var p,d;o.value.trim()&&u("save",{id:((p=s.item)==null?void 0:p.id)||Date.now(),type:"note",action:s.item?"updated a note":"added a note",content:o.value,timestamp:((d=s.item)==null?void 0:d.timestamp)||new Date().toISOString(),isEdit:!!s.item})};return(p,d)=>(l(),a("div",nl,[d[5]||(d[5]=e("div",{class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-t border-l border-gray-200 rotate-45"},null,-1)),e("div",al,[e("h5",rl,f(t.item?"Edit Note":"Add Note"),1),e("button",{onClick:d[0]||(d[0]=r=>p.$emit("cancel")),class:"text-gray-400 hover:text-gray-600"},[...d[3]||(d[3]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),e("div",null,[d[4]||(d[4]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Note",-1)),M(e("textarea",{"onUpdate:modelValue":d[1]||(d[1]=r=>o.value=r),rows:"4",class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500 placeholder-gray-400 transition-colors shadow-sm resize-none",placeholder:"Enter your note..."},null,512),[[F,o.value]])]),e("div",il,[e("button",{onClick:d[2]||(d[2]=r=>p.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:n,class:"bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save")])]))}},ul={class:"bg-white border border-gray-200 rounded-xl p-5 shadow-sm mb-6 animate-fade-in relative"},cl={class:"flex justify-between items-center mb-4"},pl={class:"text-sm font-bold text-slate-800"},ml={class:"flex items-center gap-3"},yl={key:0,class:"text-sm text-slate-600"},gl={key:1,class:"text-sm text-gray-400"},fl={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},vl=["disabled"],bl={__name:"AttachmentWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(t,{emit:y}){const s=t,u=y,o=k(null),n=k("");ae(()=>{s.item&&(n.value=s.item.fileName||"")});const p=r=>{const i=r.target.files[0];i&&(o.value=i,n.value=i.name)},d=()=>{var r,i;!o.value&&!s.item||u("save",{id:((r=s.item)==null?void 0:r.id)||Date.now(),type:"attachment",action:s.item?"updated an attachment":"added an attachment",fileName:n.value,timestamp:((i=s.item)==null?void 0:i.timestamp)||new Date().toISOString(),isEdit:!!s.item})};return(r,i)=>(l(),a("div",ul,[i[6]||(i[6]=e("div",{class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-t border-l border-gray-200 rotate-45"},null,-1)),e("div",cl,[e("h5",pl,f(t.item?"Edit Attachment":"Add Attachment"),1),e("button",{onClick:i[0]||(i[0]=b=>r.$emit("cancel")),class:"text-gray-400 hover:text-gray-600"},[...i[3]||(i[3]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),e("div",null,[i[5]||(i[5]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"File",-1)),e("div",ml,[e("input",{type:"file",onChange:p,ref:"fileInput",class:"hidden"},null,544),e("button",{onClick:i[1]||(i[1]=b=>r.$refs.fileInput.click()),class:"bg-gray-50 hover:bg-gray-100 border border-gray-300 rounded-md px-4 py-2 text-sm text-slate-700 transition-colors"},[...i[4]||(i[4]=[e("i",{class:"fa-solid fa-paperclip mr-2"},null,-1),R("Choose File ",-1)])]),n.value?(l(),a("span",yl,f(n.value),1)):(l(),a("span",gl,"No file selected"))])]),e("div",fl,[e("button",{onClick:i[2]||(i[2]=b=>r.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:d,disabled:!o.value,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save",8,vl)])]))}},xl={class:"animate-fade-in"},hl={class:"space-y-4"},wl={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},kl={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Cl={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},$l=["disabled"],Sl={__name:"FinancingWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(t,{emit:y}){const s=t,u=y,o=k({startDate:"",expDate:"",productName:"",deposit:"",loanAmount:""});ae(()=>{s.item&&s.item.data&&(o.value={startDate:s.item.data.startDate||"",expDate:s.item.data.expDate||"",productName:s.item.data.product||s.item.data.productName||"",deposit:s.item.data.deposit||"",loanAmount:s.item.data.total||s.item.data.loanAmount||""})});const n=()=>{var p,d;o.value.productName&&u("save",{id:((p=s.item)==null?void 0:p.id)||Date.now(),type:"financing",action:s.item?"updated a financing proposal":"added a financing proposal",data:{product:o.value.productName,provider:"Audi Financial",total:o.value.loanAmount||"0",monthly:Math.round(parseFloat(o.value.loanAmount||0)/36).toString(),startDate:o.value.startDate,expDate:o.value.expDate,deposit:o.value.deposit},timestamp:((d=s.item)==null?void 0:d.timestamp)||new Date().toISOString(),isEdit:!!s.item})};return(p,d)=>(l(),a("div",xl,[e("div",hl,[e("div",wl,[e("div",null,[d[6]||(d[6]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Start date",-1)),M(e("input",{type:"date","onUpdate:modelValue":d[0]||(d[0]=r=>o.value.startDate=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[F,o.value.startDate]])]),e("div",null,[d[7]||(d[7]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Expiration date",-1)),M(e("input",{type:"date","onUpdate:modelValue":d[1]||(d[1]=r=>o.value.expDate=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[F,o.value.expDate]])])]),e("div",null,[d[8]||(d[8]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Financial product name",-1)),M(e("input",{type:"text","onUpdate:modelValue":d[2]||(d[2]=r=>o.value.productName=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[F,o.value.productName]])]),e("div",kl,[e("div",null,[d[9]||(d[9]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Deposit",-1)),M(e("input",{type:"number","onUpdate:modelValue":d[3]||(d[3]=r=>o.value.deposit=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[F,o.value.deposit]])]),e("div",null,[d[10]||(d[10]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Total loan amount",-1)),M(e("input",{type:"number","onUpdate:modelValue":d[4]||(d[4]=r=>o.value.loanAmount=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[F,o.value.loanAmount]])])])]),e("div",Cl,[e("button",{onClick:d[5]||(d[5]=r=>p.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:n,disabled:!o.value.productName,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save",8,$l)])]))}},Dl={class:"animate-fade-in"},Al={class:"space-y-4"},Il={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Tl={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ol={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},ql=["disabled"],Nl={__name:"TradeInWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(t,{emit:y}){const s=t,u=y,o=k({class:"Car",brand:"",model:"",version:"",km:"",plate:"",date:""});ae(()=>{s.item&&s.item.data&&(o.value={class:s.item.data.class||"Car",brand:s.item.data.brand||"",model:s.item.data.model||"",version:s.item.data.version||"",km:s.item.data.km||"",plate:s.item.data.plate||"",date:s.item.data.date||""})});const n=()=>{var p,d;o.value.brand&&u("save",{id:((p=s.item)==null?void 0:p.id)||Date.now(),type:"tradein",action:s.item?"updated a trade-in":"added a trade-in",data:{class:o.value.class,brand:o.value.brand,model:o.value.model||"Unknown Model",year:o.value.date?new Date(o.value.date).getFullYear():"Unknown Year",km:o.value.km||"0",plate:o.value.plate||"",date:o.value.date||""},timestamp:((d=s.item)==null?void 0:d.timestamp)||new Date().toISOString(),isEdit:!!s.item})};return(p,d)=>(l(),a("div",Dl,[e("div",Al,[e("div",null,[d[9]||(d[9]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Class",-1)),M(e("select",{"onUpdate:modelValue":d[0]||(d[0]=r=>o.value.class=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},[...d[8]||(d[8]=[e("option",{value:"Car"},"Car",-1),e("option",{value:"Motorcycle"},"Motorcycle",-1),e("option",{value:"Truck"},"Truck",-1)])],512),[[de,o.value.class]])]),e("div",Il,[e("div",null,[d[10]||(d[10]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Brand",-1)),M(e("input",{type:"text","onUpdate:modelValue":d[1]||(d[1]=r=>o.value.brand=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[F,o.value.brand]])]),e("div",null,[d[11]||(d[11]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Model",-1)),M(e("input",{type:"text","onUpdate:modelValue":d[2]||(d[2]=r=>o.value.model=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[F,o.value.model]])])]),e("div",null,[d[12]||(d[12]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Version",-1)),M(e("input",{type:"text","onUpdate:modelValue":d[3]||(d[3]=r=>o.value.version=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[F,o.value.version]])]),e("div",Tl,[e("div",null,[d[13]||(d[13]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Km",-1)),M(e("input",{type:"number","onUpdate:modelValue":d[4]||(d[4]=r=>o.value.km=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[F,o.value.km]])]),e("div",null,[d[14]||(d[14]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Plate",-1)),M(e("input",{type:"text","onUpdate:modelValue":d[5]||(d[5]=r=>o.value.plate=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[F,o.value.plate]])])]),e("div",null,[d[15]||(d[15]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Registration date",-1)),M(e("input",{type:"date","onUpdate:modelValue":d[6]||(d[6]=r=>o.value.date=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[F,o.value.date]])])]),e("div",Ol,[e("button",{onClick:d[7]||(d[7]=r=>p.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:n,disabled:!o.value.brand,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save",8,ql)])]))}},Ml={class:"bg-white border border-gray-200 rounded-xl p-5 shadow-sm mb-6 animate-fade-in relative"},jl={class:"flex justify-between items-center mb-4"},Rl={class:"text-sm font-bold text-slate-800"},Vl={class:"space-y-4"},Fl={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ll={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ul={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},El=["disabled"],Bl={__name:"PurchaseWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"opportunity"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(t,{emit:y}){const s=t,u=y,o=k({brand:"",model:"",year:"",price:"",purchaseDate:"",notes:""});ae(()=>{s.item&&s.item.data&&(o.value={brand:s.item.data.brand||"",model:s.item.data.model||"",year:s.item.data.year||"",price:s.item.data.price||"",purchaseDate:s.item.data.purchaseDate||"",notes:s.item.data.notes||""})});const n=N(()=>o.value.brand&&o.value.model&&o.value.price),p=()=>{var d,r;n.value&&u("save",{id:((d=s.item)==null?void 0:d.id)||Date.now(),type:"purchase",action:s.item?"updated a purchase":"added a purchase",data:{brand:o.value.brand,model:o.value.model,year:o.value.year||new Date().getFullYear(),price:o.value.price,purchaseDate:o.value.purchaseDate||new Date().toISOString().split("T")[0],notes:o.value.notes||""},timestamp:((r=s.item)==null?void 0:r.timestamp)||new Date().toISOString(),isEdit:!!s.item})};return(d,r)=>(l(),a("div",Ml,[r[15]||(r[15]=e("div",{class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-t border-l border-gray-200 rotate-45"},null,-1)),e("div",jl,[e("h5",Rl,f(t.item?"Edit Purchase":"Add Purchase"),1),e("button",{onClick:r[0]||(r[0]=i=>d.$emit("cancel")),class:"text-gray-400 hover:text-gray-600"},[...r[8]||(r[8]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),e("div",Vl,[e("div",Fl,[e("div",null,[r[9]||(r[9]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Brand",-1)),M(e("input",{type:"text","onUpdate:modelValue":r[1]||(r[1]=i=>o.value.brand=i),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[F,o.value.brand]])]),e("div",null,[r[10]||(r[10]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Model",-1)),M(e("input",{type:"text","onUpdate:modelValue":r[2]||(r[2]=i=>o.value.model=i),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[F,o.value.model]])])]),e("div",Ll,[e("div",null,[r[11]||(r[11]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Year",-1)),M(e("input",{type:"number","onUpdate:modelValue":r[3]||(r[3]=i=>o.value.year=i),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[F,o.value.year]])]),e("div",null,[r[12]||(r[12]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Purchase Price (€)",-1)),M(e("input",{type:"number","onUpdate:modelValue":r[4]||(r[4]=i=>o.value.price=i),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[F,o.value.price]])])]),e("div",null,[r[13]||(r[13]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Purchase Date",-1)),M(e("input",{type:"date","onUpdate:modelValue":r[5]||(r[5]=i=>o.value.purchaseDate=i),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[F,o.value.purchaseDate]])]),e("div",null,[r[14]||(r[14]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Notes",-1)),M(e("textarea",{"onUpdate:modelValue":r[6]||(r[6]=i=>o.value.notes=i),rows:"3",class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500 placeholder-gray-400 transition-colors shadow-sm resize-none",placeholder:"Additional purchase details..."},null,512),[[F,o.value.notes]])])]),e("div",Ul,[e("button",{onClick:r[7]||(r[7]=i=>d.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:p,disabled:!n.value,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save",8,El)])]))}},Wl=t=>t==="note"?"note":["call","email","sms","whatsapp","communication"].includes(t)?"communication":t==="attachment"?"attachment":"overview";function Pl(t){const{store:y,taskId:s,getTabForItemType:u,isOverviewModalAction:o}=t,n=k("overview"),p=k(null),d=k(null),r=k("email"),i=k([]),b=N(()=>[...y.currentActivities.value,...i.value.filter(V=>!V.activityId)].filter(V=>{const L=u(V.type);return n.value==="overview"?L==="overview":L===n.value})),c=q=>(d.value=null,n.value==="overview"&&o(q)?{modalAction:q}:(["email","whatsapp","sms"].includes(q)?(r.value=q,p.value="communication"):p.value=q,null)),m=async q=>{var V;if(q.isEdit){const L=i.value.findIndex(H=>H.id===q.id);L>-1&&(i.value[L]={...i.value[L],...q}),(V=d.value)!=null&&V.activityId&&await y.updateActivity(s.value,d.value.activityId,{type:q.communicationType||q.type,user:"You",action:q.action,content:q.content,fileName:q.fileName,data:q.data})}else{const L=q.communicationType||q.type,H=await y.addActivity(s.value,{type:L,user:"You",action:q.action,content:q.content,fileName:q.fileName,data:q.data});i.value.push({id:H.id,type:L==="email"||L==="whatsapp"||L==="sms"?"communication":L,action:q.action,content:q.content,fileName:q.fileName,data:q.data,timestamp:H.timestamp,activityId:H.id})}p.value=null,d.value=null},x=()=>{p.value=null,d.value=null},g=q=>{d.value=q,p.value=q.type},C=async q=>{const V=i.value.findIndex(L=>L.id===q.id);V>-1&&i.value.splice(V,1),q.activityId&&await y.deleteActivity(s.value,q.activityId)};return ne(n,()=>{p.value=null,d.value=null}),{activeTab:n,showInlineWidget:p,editingItem:d,communicationType:r,inlineContent:i,filteredInlineContent:b,handleAddNewAction:c,handleWidgetSave:m,handleWidgetCancel:x,handleEditItem:g,handleDeleteItem:C}}const zl={class:"flex-1 flex flex-col overflow-hidden"},Yl={class:"bg-white border-b border-gray-200 shrink-0 shadow-sm"},Ql={class:"px-4 md:px-8 py-4 md:py-6"},Hl={class:"flex-1 overflow-y-auto p-4 md:p-8 max-w-4xl mx-auto w-full scrollbar-hide"},Jl={class:"flex items-center justify-between mb-4"},Kl={key:0,class:"mb-6"},Gl={key:1,class:"space-y-6 mb-6"},Xl={key:3},Zl={key:4,class:"space-y-4 mb-6 px-1"},_l={key:0,class:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"},en={class:"p-6"},tn={class:"flex justify-between items-center mb-4"},sn={class:"text-sm font-bold text-slate-800"},on={key:1,class:"max-w-2xl w-full max-h-[90vh] overflow-y-auto"},ln={__name:"TaskShell",props:{task:{type:Object,required:!0},type:{type:String,required:!0},managementWidget:{type:Object,required:!0},storeAdapter:{type:Object,required:!0},addNewConfig:{type:Object,required:!0}},setup(t){const y=t,s=N(()=>y.task.id),u=k(!1),o=k(null),{activeTab:n,showInlineWidget:p,editingItem:d,communicationType:r,inlineContent:i,filteredInlineContent:b,handleAddNewAction:c,handleWidgetSave:m,handleWidgetCancel:x,handleEditItem:g,handleDeleteItem:C}=Pl({store:y.storeAdapter,taskId:s,getTabForItemType:Wl,isOverviewModalAction:D=>n.value==="overview"&&y.addNewConfig.overviewActions.includes(D)}),q=D=>{const O=c(D);O&&O.modalAction&&(o.value=O.modalAction,u.value=!0)},V=()=>{u.value=!1,o.value=null},L=async D=>{await m(D),V()},H=N(()=>{const D=[...y.storeAdapter.currentActivities.value,...i.value],O=D.length,T=D.filter(I=>["call","email","sms","whatsapp","communication"].includes(I.type)).length,P=D.filter(I=>I.type==="note").length,$=D.filter(I=>I.type==="attachment").length;return[{key:"overview",label:"Overview",count:O},{key:"note",label:"Notes",count:P},{key:"communication",label:"Communication",count:T},{key:"attachment",label:"Attachments",count:$}]}),le=N(()=>[...y.storeAdapter.currentActivities.value,...i.value]);return(D,O)=>(l(),a("div",zl,[e("header",Yl,[e("div",Ql,[z($s,{initials:t.task.customer.initials,name:t.task.customer.name,email:t.task.customer.email,phone:t.task.customer.phone,"third-field-value":t.task.customer.address,"avatar-color-class":t.type==="lead"?"bg-orange-100 text-orange-600":"bg-purple-100 text-purple-600","email-label":"Email","phone-label":"Phone","third-field-label":"Address"},{tags:xe(()=>[(l(!0),a(Q,null,te(t.task.tags,T=>(l(),a("span",{key:T,class:"badge-ui bg-blue-50 border-blue-100 text-blue-700 font-semibold"},f(T),1))),128))]),_:1},8,["initials","name","email","phone","third-field-value","avatar-color-class"])])]),e("main",Hl,[e("div",Jl,[z(As,{modelValue:Y(n),"onUpdate:modelValue":O[0]||(O[0]=T=>rt(n)?n.value=T:null),tabs:H.value,class:"mb-0"},null,8,["modelValue","tabs"]),Y(n)==="overview"&&t.addNewConfig.overviewActions.length?(l(),W(Re,{key:0,actions:t.addNewConfig.overviewActions,"active-tab":Y(n),inline:!0,onAction:q},null,8,["actions","active-tab"])):v("",!0)]),Y(n)==="overview"?(l(),a("div",Kl,[z(Es,{stage:t.task.stage,owner:t.task.assignee,source:t.task.source||"",probability:t.task.probability},null,8,["stage","owner","source","probability"])])):v("",!0),Y(n)==="overview"?(l(),a("div",Gl,[(l(),W(it(t.managementWidget),{lead:t.type==="lead"?t.task:void 0,opportunity:t.type==="opportunity"?t.task:void 0,activities:le.value},null,8,["lead","opportunity","activities"])),ge(D.$slots,"pinned-extra",{task:t.task})])):v("",!0),Y(n)!=="overview"?(l(),W(Re,{key:2,actions:t.addNewConfig.tabActions,"active-tab":Y(n),onAction:q},null,8,["actions","active-tab"])):v("",!0),Y(n)!=="overview"?(l(),a("div",Xl,[Y(p)==="communication"?(l(),W(ll,{key:0,type:Y(r),"task-type":t.type,"task-id":t.task.id,onSave:Y(m),onCancel:Y(x)},null,8,["type","task-type","task-id","onSave","onCancel"])):v("",!0),Y(p)==="note"?(l(),W(dl,{key:1,item:Y(d),"task-type":t.type,"task-id":t.task.id,onSave:Y(m),onCancel:Y(x)},null,8,["item","task-type","task-id","onSave","onCancel"])):v("",!0),Y(p)==="attachment"?(l(),W(bl,{key:2,item:Y(d),"task-type":t.type,"task-id":t.task.id,onSave:Y(m),onCancel:Y(x)},null,8,["item","task-type","task-id","onSave","onCancel"])):v("",!0)])):v("",!0),Y(b).length>0?(l(),a("div",Zl,[(l(!0),a(Q,null,te(Y(b),T=>(l(),W(_o,{key:T.id,item:T,"task-type":t.type,"customer-initials":"SK",onEdit:Y(g),onDelete:Y(C)},null,8,["item","task-type","onEdit","onDelete"]))),128))])):v("",!0)]),(l(),W(ue,{to:"body"},[u.value?(l(),a("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",onClick:J(V,["self"])},[o.value==="financing"||o.value==="tradein"?(l(),a("div",_l,[e("div",en,[e("div",tn,[e("h5",sn,f(o.value==="financing"?"Add Financing":"Add Trade-in"),1),e("button",{onClick:V,class:"text-gray-400 hover:text-gray-600"},[...O[1]||(O[1]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),o.value==="financing"?(l(),W(Sl,{key:0,item:null,"task-type":t.type,"task-id":t.task.id,onSave:L,onCancel:V},null,8,["task-type","task-id"])):v("",!0),o.value==="tradein"?(l(),W(Nl,{key:1,item:null,"task-type":t.type,"task-id":t.task.id,onSave:L,onCancel:V},null,8,["task-type","task-id"])):v("",!0)])])):v("",!0),o.value==="purchase"?(l(),a("div",on,[z(Bl,{item:null,"task-type":t.type,"task-id":t.task.id,onSave:L,onCancel:V},null,8,["task-type","task-id"])])):v("",!0)])):v("",!0)]))]))}},nn={key:0,class:"mb-8"},an={class:"flex items-center gap-2 mb-4"},rn={class:"font-bold text-gray-800 text-sm"},dn={class:"bg-white border border-gray-200 rounded-xl shadow-sm mb-6 overflow-hidden"},un={class:"p-4"},cn={key:0,class:"bg-gray-50 border border-gray-200 rounded-lg p-3 mb-4"},pn={class:"text-sm text-slate-700 leading-snug"},mn={class:"flex items-center justify-between"},yn={class:"flex items-center gap-4"},gn={class:"w-16 h-12 bg-gray-200 rounded-md overflow-hidden shrink-0 border border-gray-100"},fn=["src"],vn={key:1,class:"fa-solid fa-car text-3xl text-gray-400 w-full h-full flex items-center justify-center"},bn={class:"flex items-center gap-2"},xn={class:"font-bold text-slate-800 text-sm md:text-base"},hn={class:"mt-1.5"},wn={key:0,class:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-green-50 border border-green-100 text-green-700 text-[10px] font-semibold rounded-md"},kn={key:1,class:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-orange-50 border border-orange-100 text-orange-700 text-[10px] font-semibold rounded-md"},Cn={class:"flex items-center gap-4"},$n={key:0,class:"hidden sm:flex items-center gap-1.5 bg-gray-100 hover:bg-gray-200 border border-gray-200 text-slate-700 text-xs font-semibold px-3 py-1.5 rounded-full transition-colors group/btn"},Sn={key:1,class:"text-right"},Dn={class:"font-bold text-slate-800"},An={class:"border-t border-gray-200"},In={class:"font-medium"},Tn={key:0,class:"border-t border-gray-100 p-6 bg-gray-50/30 text-sm animate-fade-in"},On={class:"mb-6"},qn={class:"grid grid-cols-2 md:grid-cols-4 gap-y-4 gap-x-6"},Nn={key:0},Mn={class:"font-medium text-slate-700"},jn={key:1},Rn={class:"font-medium text-slate-700"},Vn={key:2},Fn={class:"font-medium text-slate-700"},Ln={class:"font-medium text-slate-700"},Un={class:"grid grid-cols-2 md:grid-cols-4 gap-y-4 gap-x-6"},En={key:0},Bn={class:"font-medium text-slate-700"},Wn={key:1},Pn={class:"font-medium text-slate-700"},zn={key:2},Yn={class:"font-medium text-slate-700"},Qn={key:3},Hn={class:"font-medium text-slate-700"},Jn={key:4},Kn={class:"font-mono text-xs bg-white border border-gray-200 px-2 py-1 rounded inline-block text-gray-600"},Gn={key:5},Xn={class:"font-medium text-slate-700"},Zn={key:0,class:"mt-6 flex justify-end"},Ve={__name:"VehicleWidget",props:{show:{type:Boolean,default:!0},label:{type:String,default:"Requested Car"},brand:{type:String,required:!0},model:{type:String,required:!0},year:{type:[Number,String],required:!0},image:{type:String,default:""},price:{type:Number,default:null},requestMessage:{type:String,default:""},requestType:{type:String,default:""},source:{type:String,default:""},dealership:{type:String,default:""},registration:{type:String,default:""},kilometers:{type:Number,default:null},fuelType:{type:String,default:""},gearType:{type:String,default:""},vin:{type:String,default:""},stockDays:{type:Number,default:null},showOpenAd:{type:Boolean,default:!0},showTechnicalSpecs:{type:Boolean,default:!0},channel:{type:String,default:"Email"},adCampaign:{type:String,default:""},expectedPurchaseDate:{type:String,default:""},fiscalEntity:{type:String,default:""},sourceDetails:{type:String,default:""},adMedium:{type:String,default:""},adSource:{type:String,default:""}},setup(t){const y=k(!1),s=o=>new Intl.NumberFormat("en-US").format(o),u=o=>new Intl.NumberFormat("en-US").format(o);return(o,n)=>t.show?(l(),a("div",nn,[e("div",an,[n[1]||(n[1]=e("i",{class:"fa-solid fa-thumbtack text-gray-400 text-xs"},null,-1)),e("h3",rn,f(t.label),1)]),e("div",dn,[e("div",un,[t.requestMessage?(l(),a("div",cn,[n[2]||(n[2]=e("div",{class:"text-xs font-medium text-gray-500 mb-1"},"Request message",-1)),e("p",pn,f(t.requestMessage),1)])):v("",!0),e("div",mn,[e("div",yn,[e("div",gn,[t.image?(l(),a("img",{key:0,src:t.image,alt:"Car",class:"w-full h-full object-cover"},null,8,fn)):(l(),a("i",vn))]),e("div",null,[e("div",bn,[e("div",xn,f(t.brand)+" "+f(t.model)+" ("+f(t.year)+")",1)]),e("div",hn,[t.stockDays!==void 0&&t.stockDays!==null?(l(),a("div",wn,[n[3]||(n[3]=e("div",{class:"w-1 h-1 bg-green-500 rounded-full"},null,-1)),R(" In stock ("+f(t.stockDays)+" days) ",1)])):(l(),a("div",kn,[...n[4]||(n[4]=[e("div",{class:"w-1 h-1 bg-orange-500 rounded-full"},null,-1),R(" Out of stock ",-1)])]))])])]),e("div",Cn,[t.showOpenAd&&t.price?(l(),a("button",$n,[...n[5]||(n[5]=[R(" Open Ad ",-1),e("i",{class:"fa-solid fa-arrow-up-right-from-square text-[10px] text-gray-400 group-hover/btn:text-gray-800"},null,-1)])])):v("",!0),t.price?(l(),a("div",Sn,[n[6]||(n[6]=e("div",{class:"text-xs text-gray-500 font-medium mb-0.5"},"Price",-1)),e("div",Dn,"€ "+f(s(t.price)),1)])):v("",!0)])])]),e("div",An,[e("button",{onClick:n[0]||(n[0]=p=>y.value=!y.value),class:"w-full p-3 flex items-center justify-center gap-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-50 transition-colors"},[e("span",In,f(y.value?"Hide":"View")+" Details",1),e("i",{class:j(["fa-solid fa-chevron-down text-xs transition-transform duration-200",{"rotate-180":y.value}])},null,2)])]),y.value?(l(),a("div",Tn,[e("div",On,[n[17]||(n[17]=e("h4",{class:"text-xs font-bold uppercase text-gray-500 tracking-wider mb-4"},"REQUEST DETAILS",-1)),e("div",qn,[t.requestType?(l(),a("div",Nn,[n[7]||(n[7]=e("div",{class:"text-xs text-gray-500 mb-1"},"Request type",-1)),e("div",Mn,f(t.requestType),1)])):v("",!0),t.source?(l(),a("div",jn,[n[8]||(n[8]=e("div",{class:"text-xs text-gray-500 mb-1"},"Source",-1)),e("div",Rn,f(t.source),1)])):v("",!0),e("div",null,[n[9]||(n[9]=e("div",{class:"text-xs text-gray-500 mb-1"},"Source details",-1)),e("div",{class:j(["font-medium",t.sourceDetails?"text-slate-700":"text-gray-400"])},f(t.sourceDetails||"--"),3)]),t.dealership?(l(),a("div",Vn,[n[10]||(n[10]=e("div",{class:"text-xs text-gray-500 mb-1"},"Dealership",-1)),e("div",Fn,f(t.dealership),1)])):v("",!0),e("div",null,[n[11]||(n[11]=e("div",{class:"text-xs text-gray-500 mb-1"},"Channel",-1)),e("div",Ln,f(t.channel||"Email"),1)]),e("div",null,[n[12]||(n[12]=e("div",{class:"text-xs text-gray-500 mb-1"},"AdCampaign",-1)),e("div",{class:j(["font-medium",t.adCampaign?"text-slate-700":"text-gray-400"])},f(t.adCampaign||"--"),3)]),e("div",null,[n[13]||(n[13]=e("div",{class:"text-xs text-gray-500 mb-1"},"AdMedium",-1)),e("div",{class:j(["font-medium",t.adMedium?"text-slate-700":"text-gray-400"])},f(t.adMedium||"--"),3)]),e("div",null,[n[14]||(n[14]=e("div",{class:"text-xs text-gray-500 mb-1"},"AdSource",-1)),e("div",{class:j(["font-medium",t.adSource?"text-slate-700":"text-gray-400"])},f(t.adSource||"--"),3)]),e("div",null,[n[15]||(n[15]=e("div",{class:"text-xs text-gray-500 mb-1"},"Expected purchase date",-1)),e("div",{class:j(["font-medium",t.expectedPurchaseDate?"text-slate-700":"text-gray-400"])},f(t.expectedPurchaseDate||"--"),3)]),e("div",null,[n[16]||(n[16]=e("div",{class:"text-xs text-gray-500 mb-1"},"Fiscal entity",-1)),e("div",{class:j(["font-medium",t.fiscalEntity?"text-slate-700":"text-gray-400"])},f(t.fiscalEntity||"--"),3)])])]),n[26]||(n[26]=e("div",{class:"border-t border-gray-200 my-4"},null,-1)),e("div",null,[n[25]||(n[25]=e("div",{class:"flex justify-between items-center mb-4"},[e("h4",{class:"text-xs font-bold uppercase text-gray-500 tracking-wider"},"VEHICLE DETAILS")],-1)),e("div",Un,[t.registration?(l(),a("div",En,[n[18]||(n[18]=e("div",{class:"text-xs text-gray-500 mb-1"},"Registration",-1)),e("div",Bn,f(t.registration),1)])):v("",!0),t.kilometers!==void 0&&t.kilometers!==null?(l(),a("div",Wn,[n[19]||(n[19]=e("div",{class:"text-xs text-gray-500 mb-1"},"Kilometers",-1)),e("div",Pn,f(u(t.kilometers))+" Km",1)])):v("",!0),t.fuelType?(l(),a("div",zn,[n[20]||(n[20]=e("div",{class:"text-xs text-gray-500 mb-1"},"Fuel type",-1)),e("div",Yn,f(t.fuelType),1)])):v("",!0),t.gearType?(l(),a("div",Qn,[n[21]||(n[21]=e("div",{class:"text-xs text-gray-500 mb-1"},"Gear type",-1)),e("div",Hn,f(t.gearType),1)])):v("",!0),t.vin?(l(),a("div",Jn,[n[22]||(n[22]=e("div",{class:"text-xs text-gray-500 mb-1"},"VIN Number",-1)),e("div",Kn,f(t.vin),1)])):v("",!0),t.dealership?(l(),a("div",Gn,[n[23]||(n[23]=e("div",{class:"text-xs text-gray-500 mb-1"},"Dealership",-1)),e("div",Xn,f(t.dealership),1)])):v("",!0)]),t.showTechnicalSpecs?(l(),a("div",Zn,[...n[24]||(n[24]=[e("button",{class:"bg-white border border-gray-200 text-slate-700 hover:text-blue-600 hover:border-blue-200 font-medium px-4 py-2 rounded-lg text-xs transition-colors flex items-center gap-2 group"},[e("i",{class:"fa-solid fa-list-check text-gray-400 group-hover:text-blue-500"}),R(" View technical specs ")],-1)])])):v("",!0)])])):v("",!0)])])):v("",!0)}},_n={key:0,class:"border-t border-gray-200 p-5 bg-white transition-all"},ea={class:"grid grid-cols-3 gap-3 mb-4"},ta={class:"flex gap-3 mb-4"},Be={__name:"RescheduleWidget",props:{show:{type:Boolean,default:!1}},emits:["close","confirm"],setup(t,{emit:y}){const s=y,u=k(null),o=k(""),n=k(""),p=i=>{u.value=i;const b=new Date;if(i==="later-today"){const c=new Date(b.getTime()+72e5);o.value=c.toISOString().split("T")[0],n.value=c.toTimeString().slice(0,5)}else if(i==="tomorrow"){const c=new Date(b);c.setDate(c.getDate()+1),o.value=c.toISOString().split("T")[0],n.value="09:00"}else if(i==="next-week"){const c=new Date(b);c.setDate(c.getDate()+(7-c.getDay()+1)),o.value=c.toISOString().split("T")[0],n.value="09:00"}},d=()=>{s("confirm",{date:o.value,time:n.value,option:u.value}),s("close"),u.value=null,o.value="",n.value=""},r=()=>{s("close"),u.value=null,o.value="",n.value=""};return(i,b)=>t.show?(l(),a("div",_n,[b[8]||(b[8]=e("h5",{class:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3"},"Reschedule to...",-1)),e("div",ea,[e("button",{onClick:b[0]||(b[0]=c=>p("later-today")),class:j(["flex flex-col items-center justify-center p-2 border border-gray-200 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-all group",{"border-blue-400 bg-blue-50":u.value==="later-today"}])},[...b[5]||(b[5]=[e("span",{class:"text-xs font-semibold text-slate-700 group-hover:text-blue-700"},"Later Today",-1),e("span",{class:"text-[10px] text-gray-400"},"+2 Hours",-1)])],2),e("button",{onClick:b[1]||(b[1]=c=>p("tomorrow")),class:j(["flex flex-col items-center justify-center p-2 border border-gray-200 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-all group",{"border-blue-400 bg-blue-50":u.value==="tomorrow"}])},[...b[6]||(b[6]=[e("span",{class:"text-xs font-semibold text-slate-700 group-hover:text-blue-700"},"Tomorrow",-1),e("span",{class:"text-[10px] text-gray-400"},"09:00 AM",-1)])],2),e("button",{onClick:b[2]||(b[2]=c=>p("next-week")),class:j(["flex flex-col items-center justify-center p-2 border border-gray-200 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-all group",{"border-blue-400 bg-blue-50":u.value==="next-week"}])},[...b[7]||(b[7]=[e("span",{class:"text-xs font-semibold text-slate-700 group-hover:text-blue-700"},"Next Week",-1),e("span",{class:"text-[10px] text-gray-400"},"Mon, 9 AM",-1)])],2)]),e("div",ta,[M(e("input",{"onUpdate:modelValue":b[3]||(b[3]=c=>o.value=c),type:"date",class:"flex-1 bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 text-sm text-slate-700 focus:border-blue-500 focus:outline-none"},null,512),[[F,o.value]]),M(e("input",{"onUpdate:modelValue":b[4]||(b[4]=c=>n.value=c),type:"time",class:"w-1/3 bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 text-sm text-slate-700 focus:border-blue-500 focus:outline-none"},null,512),[[F,n.value]])]),e("div",{class:"flex gap-3"},[e("button",{onClick:r,class:"flex-1 bg-white hover:bg-gray-50 border border-gray-200 text-gray-700 font-medium py-2 rounded-lg text-sm transition-colors"}," Cancel "),e("button",{onClick:d,class:"flex-1 bg-slate-800 hover:bg-slate-900 text-white font-medium py-2 rounded-lg text-sm transition-colors"}," Confirm New Time ")])])):v("",!0)}},sa={key:0,class:"space-y-4 animate-fade-in"},oa={key:0,class:"animate-fade-in"},la={class:"grid grid-cols-4 gap-2"},na=["onClick"],We={__name:"ScheduleAppointmentWidget",props:{show:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(t,{emit:y}){const s=t,u=y,o=k(""),n=k("Michael Thomas (Me)"),p=k(""),d=k(!1),r=k("");ne(()=>s.show,m=>{m||i()});const i=()=>{o.value="",n.value="Michael Thomas (Me)",p.value="",d.value=!1,r.value=""},b=()=>{!o.value||!p.value||!r.value||(u("confirm",{type:o.value,assignee:n.value,date:p.value,time:r.value}),i())},c=()=>{i(),u("cancel")};return(m,x)=>t.show?(l(),a("div",sa,[e("div",null,[x[5]||(x[5]=e("label",{class:"block text-xs font-medium text-gray-500 mb-1.5"},"Appointment Type",-1)),M(e("select",{"onUpdate:modelValue":x[0]||(x[0]=g=>o.value=g),class:"w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2.5 text-sm text-slate-700 focus:border-blue-500 focus:bg-white focus:outline-none appearance-none cursor-pointer transition-colors shadow-sm"},[...x[4]||(x[4]=[e("option",{value:"",disabled:""},"Select type...",-1),e("option",null,"Showroom Visit",-1),e("option",null,"Test Drive",-1),e("option",null,"Video Call",-1),e("option",null,"Home Visit",-1),e("option",null,"Closing Meeting",-1)])],512),[[de,o.value]])]),e("div",null,[x[7]||(x[7]=e("label",{class:"block text-xs font-medium text-gray-500 mb-1.5"},"Assign to Salesman",-1)),M(e("select",{"onUpdate:modelValue":x[1]||(x[1]=g=>n.value=g),class:"w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2.5 text-sm text-slate-700 focus:border-blue-500 focus:bg-white focus:outline-none appearance-none cursor-pointer transition-colors shadow-sm"},[...x[6]||(x[6]=[e("option",null,"Michael Thomas (Me)",-1),e("option",null,"Sarah Jenkins",-1),e("option",null,"David Miller",-1),e("option",null,"Jessica Lee",-1)])],512),[[de,n.value]])]),e("div",null,[x[8]||(x[8]=e("label",{class:"block text-xs font-medium text-gray-500 mb-1.5"},"Select Date",-1)),M(e("input",{type:"date","onUpdate:modelValue":x[2]||(x[2]=g=>p.value=g),onChange:x[3]||(x[3]=g=>d.value=!0),class:"w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2.5 text-sm text-slate-700 focus:border-blue-500 focus:bg-white focus:outline-none shadow-sm transition-colors cursor-pointer"},null,544),[[F,p.value]])]),d.value?(l(),a("div",oa,[x[9]||(x[9]=e("label",{class:"block text-xs font-medium text-gray-500 mb-2"},"Available Slots",-1)),e("div",la,[(l(),a(Q,null,te(["09:00","10:30","11:00","14:30","15:00","16:30"],g=>e("button",{key:g,onClick:C=>r.value=g,class:j(["py-2 border border-gray-200 rounded-lg text-xs font-medium transition-all",r.value===g?"border-blue-500 bg-blue-50 text-blue-600":"text-slate-600 hover:border-blue-500 hover:bg-blue-50 hover:text-blue-600"])},f(g),11,na)),64))])])):v("",!0),e("div",{class:"flex gap-3 pt-2"},[e("button",{onClick:c,class:"flex-1 bg-white hover:bg-gray-50 border border-gray-200 text-gray-700 font-medium py-2.5 rounded-lg text-sm transition-colors"}," Cancel "),e("button",{onClick:b,class:"flex-1 bg-green-600 hover:bg-green-700 text-white font-medium py-2.5 rounded-lg text-sm transition-colors shadow-sm shadow-green-100 flex items-center justify-center gap-2"},[...x[10]||(x[10]=[R(" Confirm Appointment ",-1),e("i",{class:"fa-solid fa-arrow-right"},null,-1)])])])])):v("",!0)}},aa={class:"bg-white rounded-xl shadow-2xl w-full max-w-md mx-4 overflow-hidden animate-fade-in"},ra={class:"p-6 space-y-6"},ia={class:"flex gap-6"},da={class:"flex items-center gap-2 cursor-pointer"},ua={class:"flex items-center gap-2 cursor-pointer"},ca={class:"p-6 bg-gray-50 flex justify-between gap-3 border-t border-gray-100"},pa=["disabled"],ma={__name:"DisqualifyModal",props:{show:{type:Boolean,required:!0}},emits:["confirm","cancel"],setup(t,{emit:y}){const s=t,u=y,o=k("Not Interested"),n=k("");ne(()=>s.show,r=>{r&&(o.value="Not Interested",n.value="")});const p=()=>{u("confirm",{category:o.value,reason:n.value})},d=()=>{u("cancel")};return(r,i)=>(l(),W(ue,{to:"body"},[t.show?(l(),a("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:J(d,["self"])},[e("div",aa,[i[8]||(i[8]=e("div",{class:"p-6 border-b border-gray-100"},[e("h3",{class:"font-bold text-2xl text-gray-900"},"Disqualify Lead"),e("p",{class:"text-sm text-gray-500 mt-1"},"Please select a reason for disqualification.")],-1)),e("div",ra,[e("div",null,[i[5]||(i[5]=e("label",{class:"block label-upper mb-3"},"Category",-1)),e("div",ia,[e("label",da,[M(e("input",{type:"radio","onUpdate:modelValue":i[0]||(i[0]=b=>o.value=b),value:"Not Valid",class:"w-5 h-5 text-blue-600 focus:ring-blue-500 border-gray-300"},null,512),[[ke,o.value]]),i[3]||(i[3]=e("span",{class:"text-base text-gray-700"},"Not Valid",-1))]),e("label",ua,[M(e("input",{type:"radio","onUpdate:modelValue":i[1]||(i[1]=b=>o.value=b),value:"Not Interested",class:"w-5 h-5 text-blue-600 focus:ring-blue-500 border-gray-300"},null,512),[[ke,o.value]]),i[4]||(i[4]=e("span",{class:"text-base text-gray-700"},"Not Interested",-1))])])]),e("div",null,[i[7]||(i[7]=e("label",{class:"block label-upper mb-3"},"Failure Reason",-1)),M(e("select",{"onUpdate:modelValue":i[2]||(i[2]=b=>n.value=b),class:"w-full bg-white border-2 border-red-500 rounded-lg px-4 py-3 text-base text-gray-700 focus:outline-none focus:border-red-600 transition-colors"},[...i[6]||(i[6]=[e("option",{value:""},"Select a reason...",-1),e("option",{value:"Data cleanup"},"Data cleanup",-1),e("option",{value:"Unreachable"},"Unreachable",-1),e("option",{value:"Purchase postponed"},"Purchase postponed",-1),e("option",{value:"Vehicle sold"},"Vehicle sold",-1),e("option",{value:"Out of budget"},"Out of budget",-1),e("option",{value:"Financing rejected"},"Financing rejected",-1),e("option",{value:"Duplicate"},"Duplicate",-1),e("option",{value:"Bought elsewhere"},"Bought elsewhere",-1)])],512),[[de,n.value]])])]),e("div",ca,[e("button",{onClick:d,class:"text-gray-700 font-medium px-6 py-3 rounded-lg text-base hover:bg-gray-100 transition-colors"}," Cancel "),e("button",{onClick:p,disabled:!o.value||!n.value,class:"bg-red-600 hover:bg-red-700 disabled:bg-red-300 disabled:cursor-not-allowed text-white font-medium px-6 py-3 rounded-lg text-base transition-colors"}," Confirm Disqualification ",8,pa)])])])):v("",!0)]))}},ya={key:0,class:"bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden"},ga={class:"p-5 space-y-6"},fa={class:"bg-blue-50/50 border border-blue-100 rounded-lg p-4 relative transition-all duration-300"},va={class:"flex justify-between items-start mb-3"},ba={class:"text-xs text-gray-500 mt-0.5"},xa={class:"flex items-center gap-2 text-orange-600 bg-white border border-orange-100 px-2 py-1 rounded text-xs font-semibold shadow-sm transition-colors"},ha={key:0},wa={key:1},ka={class:"flex gap-3 flex-wrap"},Ca={key:0,class:"mt-4 bg-slate-900 border border-slate-700 rounded-lg p-4 shadow-inner relative overflow-hidden"},$a={class:"flex justify-between items-center mb-3 border-b border-slate-700 pb-2"},Sa={class:"flex items-center gap-1.5"},Da={class:"text-xs font-mono text-red-400"},Aa={class:"space-y-2 h-32 overflow-y-auto flex flex-col justify-end scrollbar-hide"},Ia={class:"font-bold"},Ta={key:1,class:"mt-3 space-y-2"},Oa={class:"text-xs text-slate-600 leading-relaxed"},qa={key:2,class:"mt-3 relative z-10"},Na={class:"relative"},Ma=["onKeyup"],ja={key:3,class:"mt-4 bg-blue-50 border border-blue-200 rounded-lg p-4"},Ra=["disabled"],Va={key:0,class:"fa-solid fa-spinner fa-spin"},Fa={key:1,class:"fa-solid fa-magic"},La={class:"bg-gray-50 border-t border-gray-200"},Ua={class:"p-4 flex justify-end gap-3"},Ea={key:0,class:"border-t border-gray-200 p-5 bg-white transition-all"},Ba={class:"mb-5"},Wa={class:"flex flex-col gap-2"},Pa={class:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors bg-white shadow-sm"},za=["checked"],Ya={__name:"LeadManagementWidget",props:{lead:{type:Object,required:!0}},setup(t){const y=t,s=Le(),u=k(!1),o=k(!1),n=k(!1),p=k(!1),d=k([]),r=k(0),i=k([]),b=k(""),c=k("qualify"),m=k(null),x=k(null),g=k(0),C=k(!1),q=k([]),V=k(!1),L=[{speaker:"Sales",text:"Good morning, am I speaking with Mr. Adams?"},{speaker:"Lead",text:"Yes, this is Josh Adams speaking."},{speaker:"Sales",text:"Hi Josh, Michael here regarding your Audi A6 inquiry."},{speaker:"Lead",text:"Oh, hi Michael! Yes, I was waiting for your call."},{speaker:"Sales",text:"Great. I see you're interested in the Allroad. Do you have a vehicle you'd like to trade in?"},{speaker:"Lead",text:"Yes, I actually have a BMW X3, 2018 model with about 45,000 km.",action:{type:"tradein",data:{brand:"BMW",model:"X3",year:"2018",km:"45,000",auto:!0}}},{speaker:"Sales",text:"Excellent, we can certainly evaluate that. And regarding payment?"},{speaker:"Lead",text:"I'd like to put down €5,000 and finance the rest over 3 years.",action:{type:"financing",data:{product:"Standard Loan",provider:"Audi Financial",total:"14,000",monthly:"420",auto:!0}}},{speaker:"Sales",text:"Understood. I'll note that down and prepare the proposal.",action:{type:"note",data:"Customer requests 3-year financing with €5k deposit."}},{speaker:"Lead",text:"Sounds amazing. Let's proceed with the paperwork."}],H=U=>{const S=Math.floor(U/60),G=U%60;return`${S.toString().padStart(2,"0")}:${G.toString().padStart(2,"0")}`},le=()=>{p.value=!p.value,p.value?(r.value=0,g.value=0,i.value=[],C.value=!1,q.value=[],m.value=setInterval(()=>{r.value++},1e3),x.value=setInterval(()=>{if(g.value<L.length){const U=L[g.value];i.value.push({speaker:U.speaker,text:U.text}),g.value++,i.value.length>4&&i.value.shift()}else clearInterval(x.value),clearInterval(m.value),C.value=!0,D()},2500)):(m.value&&clearInterval(m.value),x.value&&clearInterval(x.value),C.value=!1,d.value.length>0&&D())},D=async()=>{for(const U of d.value)await s.addActivity(y.lead.id,{type:"note",user:"You",action:"added a note",content:U});d.value=[]},O=async()=>{V.value=!0,await new Promise(U=>setTimeout(U,800));for(let U=0;U<L.length;U++){const S=L[U];S.action&&!q.value.includes(U)&&(S.action.type==="tradein"?I(S.action.data):S.action.type==="financing"?B(S.action.data):S.action.type==="note"&&$(S.action.data),q.value.push(U))}V.value=!1,p.value=!1,C.value=!1},T=()=>{navigator.clipboard.writeText(y.lead.customer.phone)},P=()=>{b.value.trim()&&(d.value.push(b.value),b.value="")},$=U=>{s.addActivity(y.lead.id,{type:"note",user:"You",action:"added a note",content:U,data:{autoDetected:!0}})},I=U=>{s.addActivity(y.lead.id,{type:"tradein",user:"You",action:"added a trade-in",data:{...U,autoDetected:U.auto||!1}})},B=U=>{s.addActivity(y.lead.id,{type:"financing",user:"You",action:"added a financing proposal",data:{...U,autoDetected:U.auto||!1}})},h=()=>{u.value=!u.value,o.value=!1},K=()=>{o.value=!o.value,u.value=!1},he=U=>{u.value=!1},Ce=U=>{c.value="qualify",o.value=!1},$e=()=>{o.value=!1},Se=async()=>{try{await s.requalifyLead(y.lead.id),await s.loadLeadById(y.lead.id)}catch(U){console.error("Failed to requalify lead:",U)}},De=async U=>{try{await s.modifyLead(y.lead.id,{isDisqualified:!0,disqualifyReason:U.reason,status:"Disqualified"}),await s.addActivity(y.lead.id,{type:"note",user:"You",action:"disqualified lead",content:`Lead disqualified - Category: ${U.category}, Reason: ${U.reason}`}),n.value=!1,await s.loadLeadById(y.lead.id)}catch(S){console.error("Failed to disqualify lead:",S)}};return(U,S)=>t.lead?(l(),a("div",ya,[S[28]||(S[28]=dt('<div class="p-4 border-b border-gray-100 bg-gray-50/50 flex justify-between items-center"><div class="flex items-center gap-2"><i class="fa-solid fa-thumbtack text-gray-400 text-xs"></i><h3 class="font-bold text-slate-800 text-sm">Manage Next steps</h3></div><span class="text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded font-medium">Task pending</span></div>',1)),e("div",ga,[e("div",fa,[e("div",va,[e("div",null,[S[8]||(S[8]=e("h4",{class:"font-bold text-slate-800 text-sm"},"Initial Contact",-1)),e("p",ba," Call customer to discuss "+f(t.lead.requestedCar.brand)+" "+f(t.lead.requestedCar.model)+" interest. ",1)]),e("div",xa,[p.value?(l(),a("span",wa,[...S[10]||(S[10]=[R("In Call ",-1),e("i",{class:"fa-solid fa-phone-volume animate-pulse"},null,-1)])])):(l(),a("span",ha,[...S[9]||(S[9]=[R("To be contacted ",-1),e("i",{class:"fa-regular fa-clock"},null,-1)])]))])]),e("div",ka,[e("button",{onClick:le,class:"bg-slate-700 hover:bg-slate-800 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"},[R(f(t.lead.customer.phone)+" Call ",1),S[11]||(S[11]=e("i",{class:"fa-solid fa-phone text-xs"},null,-1))]),e("button",{onClick:T,class:"bg-white hover:bg-gray-50 border border-gray-200 text-slate-700 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"},[...S[12]||(S[12]=[R(" Copy number ",-1),e("i",{class:"fa-regular fa-copy text-xs"},null,-1)])])]),p.value&&!C.value?(l(),a("div",Ca,[e("div",$a,[S[14]||(S[14]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fa-solid fa-wave-square text-blue-400 text-xs"}),e("span",{class:"text-[10px] font-bold uppercase text-slate-400 tracking-wider"},"Transcribing")],-1)),e("div",Sa,[S[13]||(S[13]=e("span",{class:"relative flex h-2 w-2"},[e("span",{class:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),e("span",{class:"relative inline-flex rounded-full h-2 w-2 bg-red-500"})],-1)),e("span",Da,"REC "+f(H(r.value)),1)])]),e("div",Aa,[(l(!0),a(Q,null,te(i.value,(G,ve)=>(l(),a("div",{key:ve,class:j(["text-xs font-mono transition-all duration-500",G.speaker==="Sales"?"text-gray-400":"text-slate-300"])},[e("span",Ia,f(G.speaker)+":",1),S[15]||(S[15]=R()),e("span",null,f(G.text),1)],2))),128))])])):v("",!0),p.value&&!C.value&&d.value.length>0?(l(),a("div",Ta,[(l(!0),a(Q,null,te(d.value,(G,ve)=>(l(),a("div",{key:ve,class:"bg-white border border-gray-200 rounded-lg p-3 shadow-sm animate-fade-in"},[S[16]||(S[16]=e("div",{class:"flex items-center gap-2 mb-1"},[e("div",{class:"w-5 h-5 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center text-[10px] font-bold"},"MT"),e("span",{class:"text-[10px] font-bold text-slate-700"},"You"),e("span",{class:"text-[10px] text-gray-400"},"• Just now")],-1)),e("p",Oa,f(G),1)]))),128))])):v("",!0),p.value&&!C.value?(l(),a("div",qa,[e("div",Na,[M(e("textarea",{"onUpdate:modelValue":S[0]||(S[0]=G=>b.value=G),onKeyup:ut(J(P,["ctrl"]),["enter"]),placeholder:"Add a quick note about this call...",rows:"3",class:"w-full bg-white border border-gray-300 rounded-md pl-3 pr-8 py-2 text-xs text-slate-700 focus:outline-none focus:border-blue-500 placeholder-gray-400 transition-colors shadow-sm resize-none"},null,40,Ma),[[F,b.value]]),e("button",{onClick:P,class:"absolute right-2 bottom-2 text-gray-400 hover:text-gray-600 p-1.5 transition-colors",title:"Save Note"},[...S[17]||(S[17]=[e("i",{class:"fa-solid fa-paper-plane text-xs"},null,-1)])])])])):v("",!0),p.value&&C.value?(l(),a("div",ja,[S[18]||(S[18]=e("div",{class:"flex items-center justify-between mb-3"},[e("div",null,[e("h4",{class:"font-bold text-slate-800 text-sm"},"Call Ended"),e("p",{class:"text-xs text-gray-500 mt-0.5"},"Extract information from the transcription")])],-1)),e("button",{onClick:O,disabled:V.value,class:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white font-medium px-4 py-2.5 rounded-lg text-sm transition-colors flex items-center justify-center gap-2"},[V.value?(l(),a("i",Va)):(l(),a("i",Fa)),e("span",null,f(V.value?"Extracting...":"Extract information from transcription"),1)],8,Ra)])):v("",!0)])]),e("div",La,[e("div",Ua,[t.lead.isDisqualified?(l(),a("button",{key:0,onClick:Se,class:"bg-green-600 hover:bg-green-700 text-white font-medium px-6 py-2.5 rounded-lg text-sm shadow-lg shadow-green-200 transition-colors flex items-center gap-2"},[...S[19]||(S[19]=[R(" Requalify ",-1),e("i",{class:"fa-solid fa-rotate-left"},null,-1)])])):(l(),a(Q,{key:1},[e("button",{onClick:S[1]||(S[1]=G=>n.value=!0),class:"bg-white hover:bg-red-50 text-slate-700 hover:text-red-600 border border-gray-200 hover:border-red-200 font-medium px-4 py-2.5 rounded-lg text-sm shadow-sm transition-colors flex items-center gap-2"},[...S[20]||(S[20]=[R(" Disqualify ",-1),e("i",{class:"fa-solid fa-ban"},null,-1)])]),e("button",{onClick:h,class:"bg-white hover:bg-gray-50 text-slate-700 border border-gray-200 font-medium px-4 py-2.5 rounded-lg text-sm shadow-sm transition-colors flex items-center gap-2"},[...S[21]||(S[21]=[R(" Postpone ",-1),e("i",{class:"fa-regular fa-clock"},null,-1)])]),e("button",{onClick:K,class:"bg-green-600 hover:bg-green-700 text-white font-medium px-6 py-2.5 rounded-lg text-sm shadow-lg shadow-green-200 transition-colors flex items-center gap-2"},[...S[22]||(S[22]=[R(" Qualify ",-1),e("i",{class:"fa-solid fa-check"},null,-1)])])],64))]),z(Be,{show:u.value,onClose:S[2]||(S[2]=G=>u.value=!1),onConfirm:he},null,8,["show"]),o.value?(l(),a("div",Ea,[S[27]||(S[27]=e("h5",{class:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-4"},"Qualify",-1)),e("div",Ba,[S[25]||(S[25]=e("label",{class:"block text-xs font-medium text-gray-500 mb-2"},"Next Step",-1)),e("div",Wa,[e("label",Pa,[M(e("input",{type:"radio","onUpdate:modelValue":S[3]||(S[3]=G=>c.value=G),value:"qualify",class:"w-4 h-4 text-green-600 focus:ring-green-500 border-gray-300"},null,512),[[ke,c.value]]),S[23]||(S[23]=e("div",{class:"flex flex-col"},[e("span",{class:"text-sm font-medium text-slate-700"},"Qualify without appointment"),e("span",{class:"text-[10px] text-gray-400"},"Proceed directly to opportunity stage")],-1))]),e("label",{onClick:S[5]||(S[5]=J(G=>c.value=c.value==="schedule"?"qualify":"schedule",["prevent"])),class:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors bg-white shadow-sm"},[e("input",{type:"radio",checked:c.value==="schedule",class:"w-4 h-4 text-green-600 focus:ring-green-500 border-gray-300",onClick:S[4]||(S[4]=J(()=>{},["stop"]))},null,8,za),S[24]||(S[24]=e("div",{class:"flex flex-col"},[e("span",{class:"text-sm font-medium text-slate-700"},"Schedule Appointment"),e("span",{class:"text-[10px] text-gray-400"},"Book a meeting or test drive")],-1))])])]),c.value==="schedule"?(l(),W(We,{key:0,show:c.value==="schedule",onConfirm:Ce,onCancel:S[6]||(S[6]=G=>c.value="qualify")},null,8,["show"])):v("",!0),c.value!=="schedule"?(l(),a("button",{key:1,onClick:$e,class:"w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2.5 rounded-lg text-sm transition-colors shadow-md shadow-green-100 flex items-center justify-center gap-2 mt-4"},[...S[26]||(S[26]=[R(" Qualify ",-1),e("i",{class:"fa-solid fa-check"},null,-1)])])):v("",!0)])):v("",!0)]),z(ma,{show:n.value,onConfirm:De,onCancel:S[7]||(S[7]=G=>n.value=!1)},null,8,["show"])])):v("",!0)}},Qa={class:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4 overflow-hidden"},Ha={class:"px-6 py-4 border-b border-gray-200 flex items-center justify-between"},Ja={class:"text-lg font-bold text-gray-900"},Ka={__name:"ComingSoonModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Coming Soon"}},emits:["close"],setup(t,{emit:y}){const s=y,u=()=>{s("close")};return(o,n)=>(l(),W(ue,{to:"body"},[t.show?(l(),a("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:J(u,["self"])},[e("div",Qa,[e("div",Ha,[e("h3",Ja,f(t.title),1),e("button",{onClick:u,class:"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors"},[...n[0]||(n[0]=[e("i",{class:"fa-solid fa-times text-sm"},null,-1)])])]),n[1]||(n[1]=e("div",{class:"px-6 py-12 flex items-center justify-center"},[e("p",{class:"text-gray-600 text-lg font-medium"},"Coming soon")],-1)),e("div",{class:"px-6 py-4 border-t border-gray-200 flex justify-end"},[e("button",{onClick:u,class:"bg-gray-800 hover:bg-gray-900 text-white font-medium px-6 py-2 rounded-lg text-sm transition-colors"}," Close ")])])])):v("",!0)]))}},Ga={class:"bg-white rounded-xl shadow-2xl w-full max-w-md mx-4 overflow-hidden animate-fade-in"},Xa={class:"p-5 space-y-4"},Za={class:"p-4 bg-gray-50 flex justify-end gap-3 border-t border-gray-100"},_a=["disabled"],er={__name:"CloseAsLostModal",props:{show:{type:Boolean,required:!0}},emits:["confirm","cancel"],setup(t,{emit:y}){const s=t,u=y,o=k(""),n=k("");ne(()=>s.show,r=>{r&&(o.value="",n.value="")});const p=()=>{o.value&&u("confirm",{reason:o.value,notes:n.value})},d=()=>{u("cancel")};return(r,i)=>(l(),W(ue,{to:"body"},[t.show?(l(),a("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:J(d,["self"])},[e("div",Ga,[i[5]||(i[5]=e("div",{class:"p-5 border-b border-gray-100 bg-gray-50/50"},[e("h3",{class:"font-bold text-lg text-gray-900"},"Close as Lost"),e("p",{class:"text-xs text-gray-500 mt-1"},"Document why this opportunity didn't close")],-1)),e("div",Xa,[e("div",null,[i[3]||(i[3]=e("label",{class:"block label-upper mb-2"},"Reason",-1)),M(e("select",{"onUpdate:modelValue":i[0]||(i[0]=b=>o.value=b),class:"input"},[...i[2]||(i[2]=[e("option",{value:""},"Select a reason...",-1),e("option",{value:"Not interested"},"Not interested",-1),e("option",{value:"Budget constraints"},"Budget constraints",-1),e("option",{value:"Found better price"},"Found better price at competitor",-1),e("option",{value:"No response"},"Customer not responding",-1),e("option",{value:"Wrong timing"},"Timing not right",-1),e("option",{value:"Other"},"Other",-1)])],512),[[de,o.value]])]),e("div",null,[i[4]||(i[4]=e("label",{class:"block label-upper mb-2"},"Additional Notes",-1)),M(e("textarea",{"onUpdate:modelValue":i[1]||(i[1]=b=>n.value=b),rows:"4",placeholder:"Add any relevant details about why this opportunity was lost...",class:"input resize-none"},null,512),[[F,n.value]])])]),e("div",Za,[e("button",{onClick:d,class:"btn-secondary text-sm"}," Cancel "),e("button",{onClick:p,disabled:!o.value,class:"bg-red-600 hover:bg-red-700 disabled:bg-red-300 disabled:cursor-not-allowed text-white font-medium px-4 py-2 rounded-lg text-sm transition-colors"}," Close as Lost ",8,_a)])])])):v("",!0)]))}},tr={class:"bg-white rounded-xl shadow-2xl w-full max-w-md mx-4 overflow-hidden animate-fade-in"},sr={class:"p-5 space-y-4"},or=["max"],lr={class:"p-4 bg-gray-50 flex justify-end gap-3 border-t border-gray-100"},nr=["disabled"],ar={__name:"ContractDateModal",props:{show:{type:Boolean,required:!0}},emits:["confirm","cancel"],setup(t,{emit:y}){const s=t,u=y,o=k(""),n=k(""),p=k(""),d=N(()=>new Date().toISOString().split("T")[0]);ne(()=>s.show,b=>{if(b){const c=new Date;o.value=c.toISOString().split("T")[0],n.value=c.toTimeString().slice(0,5),p.value=""}});const r=()=>{if(!o.value)return;const b=n.value?`${o.value}T${n.value}:00`:`${o.value}T12:00:00`;u("confirm",{contractDate:b,notes:p.value})},i=()=>{u("cancel")};return(b,c)=>(l(),W(ue,{to:"body"},[t.show?(l(),a("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:J(i,["self"])},[e("div",tr,[c[6]||(c[6]=e("div",{class:"p-5 border-b border-gray-100 bg-gray-50/50"},[e("h3",{class:"font-bold text-lg text-gray-900"},"Set Contract Signing Date"),e("p",{class:"text-xs text-gray-500 mt-1"},"Record when the contract was signed to track delivery timeline")],-1)),e("div",sr,[e("div",null,[c[3]||(c[3]=e("label",{class:"block label-upper mb-2"},"Contract Date",-1)),M(e("input",{type:"date","onUpdate:modelValue":c[0]||(c[0]=m=>o.value=m),max:d.value,class:"input"},null,8,or),[[F,o.value]])]),e("div",null,[c[4]||(c[4]=e("label",{class:"block label-upper mb-2"},"Time (Optional)",-1)),M(e("input",{type:"time","onUpdate:modelValue":c[1]||(c[1]=m=>n.value=m),class:"input"},null,512),[[F,n.value]])]),e("div",null,[c[5]||(c[5]=e("label",{class:"block label-upper mb-2"},"Notes (Optional)",-1)),M(e("textarea",{"onUpdate:modelValue":c[2]||(c[2]=m=>p.value=m),rows:"3",placeholder:"Add any relevant notes about the contract signing...",class:"input resize-none"},null,512),[[F,p.value]])])]),e("div",lr,[e("button",{onClick:i,class:"btn-secondary text-sm"}," Cancel "),e("button",{onClick:r,disabled:!o.value,class:"bg-green-600 hover:bg-green-700 disabled:bg-green-300 disabled:cursor-not-allowed text-white font-medium px-4 py-2 rounded-lg text-sm transition-colors"}," Set Contract Date ",8,nr)])])])):v("",!0)]))}},rr={class:"bg-white rounded-xl shadow-2xl w-full max-w-md mx-4 overflow-hidden animate-fade-in"},ir={class:"p-5 space-y-4"},dr=["max"],ur={class:"p-4 bg-gray-50 flex justify-end gap-3 border-t border-gray-100"},cr=["disabled"],pr={__name:"DeliveryModal",props:{show:{type:Boolean,required:!0}},emits:["confirm","cancel"],setup(t,{emit:y}){const s=t,u=y,o=k(""),n=k(""),p=k(""),d=k(""),r=N(()=>new Date().toISOString().split("T")[0]);ne(()=>s.show,c=>{if(c){const m=new Date;o.value=m.toISOString().split("T")[0],n.value=m.toTimeString().slice(0,5),p.value="",d.value=""}});const i=()=>{if(!o.value||!p.value)return;const c=n.value?`${o.value}T${n.value}:00`:`${o.value}T12:00:00`;u("confirm",{deliveryDate:c,location:p.value,notes:d.value})},b=()=>{u("cancel")};return(c,m)=>(l(),W(ue,{to:"body"},[t.show?(l(),a("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:J(b,["self"])},[e("div",rr,[m[9]||(m[9]=e("div",{class:"p-5 border-b border-gray-100 bg-gray-50/50"},[e("h3",{class:"font-bold text-lg text-gray-900"},"Mark as Delivered"),e("p",{class:"text-xs text-gray-500 mt-1"},"Record the vehicle delivery date and details")],-1)),e("div",ir,[e("div",null,[m[4]||(m[4]=e("label",{class:"block label-upper mb-2"},"Delivery Date",-1)),M(e("input",{type:"date","onUpdate:modelValue":m[0]||(m[0]=x=>o.value=x),max:r.value,class:"input"},null,8,dr),[[F,o.value]])]),e("div",null,[m[5]||(m[5]=e("label",{class:"block label-upper mb-2"},"Time (Optional)",-1)),M(e("input",{type:"time","onUpdate:modelValue":m[1]||(m[1]=x=>n.value=x),class:"input"},null,512),[[F,n.value]])]),e("div",null,[m[7]||(m[7]=e("label",{class:"block label-upper mb-2"},"Delivery Location",-1)),M(e("select",{"onUpdate:modelValue":m[2]||(m[2]=x=>p.value=x),class:"input"},[...m[6]||(m[6]=[e("option",{value:""},"Select location...",-1),e("option",{value:"Dealership"},"At Dealership",-1),e("option",{value:"Customer Address"},"Customer Address",-1),e("option",{value:"Other"},"Other Location",-1)])],512),[[de,p.value]])]),e("div",null,[m[8]||(m[8]=e("label",{class:"block label-upper mb-2"},"Delivery Notes",-1)),M(e("textarea",{"onUpdate:modelValue":m[3]||(m[3]=x=>d.value=x),rows:"3",placeholder:"Add any relevant delivery details, customer feedback, etc...",class:"input resize-none"},null,512),[[F,d.value]])])]),e("div",ur,[e("button",{onClick:b,class:"btn-secondary text-sm"}," Cancel "),e("button",{onClick:i,disabled:!o.value||!p.value,class:"bg-green-600 hover:bg-green-700 disabled:bg-green-300 disabled:cursor-not-allowed text-white font-medium px-4 py-2 rounded-lg text-sm transition-colors"}," Mark as Delivered ",8,cr)])])])):v("",!0)]))}},mr={class:"bg-white rounded-xl p-5 mb-6 animate-fade-in relative"},yr={class:"flex justify-between items-center mb-4"},gr={class:"text-sm font-bold text-slate-800"},fr={key:0,class:"mb-4"},vr={class:"max-h-64 overflow-y-auto space-y-2 border border-gray-200 rounded-lg p-2"},br={class:"w-16 h-16 bg-gray-200 rounded overflow-hidden flex-shrink-0"},xr=["src"],hr={key:1,class:"fa-solid fa-car text-gray-400 w-full h-full flex items-center justify-center"},wr={class:"flex-1 min-w-0"},kr={class:"flex items-center gap-2 flex-wrap"},Cr={class:"font-bold text-sm text-gray-800 truncate"},$r={class:"text-xs text-gray-500"},Sr={key:0,class:"text-[10px] text-green-600 mt-0.5"},Dr={key:1,class:"text-[10px] text-orange-600 mt-0.5"},Ar=["onClick"],Ir={class:"w-16 h-16 bg-gray-200 rounded overflow-hidden flex-shrink-0"},Tr=["src"],Or={key:1,class:"fa-solid fa-car text-gray-400 w-full h-full flex items-center justify-center"},qr={class:"flex-1 min-w-0"},Nr={class:"flex items-center gap-2 flex-wrap"},Mr={class:"font-bold text-sm text-gray-800 truncate"},jr={class:"text-xs text-gray-500"},Rr={key:0,class:"text-[10px] text-green-600 mt-0.5"},Vr={key:1,class:"text-center py-4 text-gray-400 text-sm"},Fr={class:"mb-4"},Lr={key:0,class:"flex items-center gap-2 mb-2"},Ur={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Er={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4"},Br={class:"mt-4"},Wr={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},Pr=["disabled"],zr={__name:"OfferWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"opportunity"},taskId:{type:Number,required:!0},requestedCar:{type:Object,default:null},recommendedCars:{type:Array,default:()=>[]}},emits:["save","cancel"],setup(t,{emit:y}){const s=t,u=y,o=k(null),n=k(null),p=k({brand:"",model:"",year:"",price:"",image:""});ae(()=>{s.item&&s.item.data&&(p.value={brand:s.item.data.brand||"",model:s.item.data.model||"",year:s.item.data.year||"",price:s.item.data.price||"",image:s.item.data.image||""})});const d=c=>{if(o.value=c,s.requestedCar){const m=c.id&&s.requestedCar.id&&c.id===s.requestedCar.id||c.brand===s.requestedCar.brand&&c.model===s.requestedCar.model&&c.year===s.requestedCar.year;n.value=m?"requested":"recommended"}else n.value="recommended";p.value={brand:c.brand||"",model:c.model||"",year:c.year||new Date().getFullYear(),price:c.price||"",image:c.image||""}},r=N(()=>o.value||p.value.brand&&p.value.model&&p.value.price),i=c=>new Intl.NumberFormat("en-US").format(c),b=()=>{var m,x;const c=o.value||p.value;u("save",{id:((m=s.item)==null?void 0:m.id)||Date.now(),type:"offer",action:s.item?"updated an offer":"added an offer",data:{brand:c.brand,model:c.model,year:c.year||new Date().getFullYear(),price:c.price,image:c.image||"",isMainOffer:!1},timestamp:((x=s.item)==null?void 0:x.timestamp)||new Date().toISOString(),isEdit:!!s.item})};return(c,m)=>{var x,g;return l(),a("div",mr,[e("div",yr,[e("h5",gr,f(t.item?"Edit Offer":"Add Offer"),1),e("button",{onClick:m[0]||(m[0]=C=>c.$emit("cancel")),class:"text-gray-400 hover:text-gray-600"},[...m[8]||(m[8]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),t.item?v("",!0):(l(),a("div",fr,[m[11]||(m[11]=e("label",{class:"block text-xs font-medium text-slate-700 mb-2"},"Select a vehicle",-1)),e("div",vr,[t.requestedCar?(l(),a("div",{key:0,onClick:m[1]||(m[1]=C=>d(t.requestedCar)),class:j(["flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 cursor-pointer border border-transparent hover:border-gray-200 transition-colors",{"border-blue-400 bg-blue-50":((x=o.value)==null?void 0:x.id)===t.requestedCar.id}])},[e("div",br,[t.requestedCar.image?(l(),a("img",{key:0,src:t.requestedCar.image,alt:"Car",class:"w-full h-full object-cover"},null,8,xr)):(l(),a("i",hr))]),e("div",wr,[e("div",kr,[e("h4",Cr,f(t.requestedCar.brand)+" "+f(t.requestedCar.model)+" ("+f(t.requestedCar.year)+")",1),e("span",{class:j(["inline-flex px-2 py-0.5 rounded text-[10px] font-semibold shrink-0",(((g=o.value)==null?void 0:g.id)===t.requestedCar.id&&n.value==="requested","bg-blue-100 text-blue-700 border border-blue-200")])}," Requested ",2)]),e("p",$r,"€ "+f(i(t.requestedCar.price)),1),t.requestedCar.stockDays!==null&&t.requestedCar.stockDays!==void 0?(l(),a("div",Sr," In stock ("+f(t.requestedCar.stockDays)+" days) ",1)):(l(),a("div",Dr," Out of stock "))]),m[9]||(m[9]=e("i",{class:"fa-solid fa-chevron-right text-gray-400"},null,-1))],2)):v("",!0),(l(!0),a(Q,null,te(t.recommendedCars,C=>{var q,V;return l(),a("div",{key:C.id,onClick:L=>d(C),class:j(["flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 cursor-pointer border border-transparent hover:border-gray-200 transition-colors",{"border-blue-400 bg-blue-50":((q=o.value)==null?void 0:q.id)===C.id}])},[e("div",Ir,[C.image?(l(),a("img",{key:0,src:C.image,alt:"Car",class:"w-full h-full object-cover"},null,8,Tr)):(l(),a("i",Or))]),e("div",qr,[e("div",Nr,[e("h4",Mr,f(C.brand)+" "+f(C.model)+" ("+f(C.year)+")",1),e("span",{class:j(["inline-flex px-2 py-0.5 rounded text-[10px] font-semibold shrink-0",(((V=o.value)==null?void 0:V.id)===C.id&&n.value==="recommended","bg-purple-100 text-purple-700 border border-purple-200")])}," Recommended ",2)]),e("p",jr,"€ "+f(i(C.price)),1),C.stockDays!==null&&C.stockDays!==void 0?(l(),a("div",Rr," In stock ("+f(C.stockDays)+" days) ",1)):v("",!0)]),m[10]||(m[10]=e("i",{class:"fa-solid fa-chevron-right text-gray-400"},null,-1))],10,Ar)}),128)),!t.requestedCar&&t.recommendedCars.length===0?(l(),a("div",Vr," No vehicles available ")):v("",!0)])])),e("div",Fr,[t.requestedCar||t.recommendedCars.length>0?(l(),a("div",Lr,[...m[12]||(m[12]=[e("div",{class:"flex-grow border-t border-gray-200"},null,-1),e("span",{class:"text-xs text-gray-400 uppercase font-semibold"},"Or create manually",-1),e("div",{class:"flex-grow border-t border-gray-200"},null,-1)])])):v("",!0),e("div",Ur,[e("div",null,[m[13]||(m[13]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Brand",-1)),M(e("input",{type:"text","onUpdate:modelValue":m[2]||(m[2]=C=>p.value.brand=C),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[F,p.value.brand]])]),e("div",null,[m[14]||(m[14]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Model",-1)),M(e("input",{type:"text","onUpdate:modelValue":m[3]||(m[3]=C=>p.value.model=C),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[F,p.value.model]])])]),e("div",Er,[e("div",null,[m[15]||(m[15]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Year",-1)),M(e("input",{type:"number","onUpdate:modelValue":m[4]||(m[4]=C=>p.value.year=C),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[F,p.value.year]])]),e("div",null,[m[16]||(m[16]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Price (€)",-1)),M(e("input",{type:"number","onUpdate:modelValue":m[5]||(m[5]=C=>p.value.price=C),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[F,p.value.price]])])]),e("div",Br,[m[17]||(m[17]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Image URL (optional)",-1)),M(e("input",{type:"text","onUpdate:modelValue":m[6]||(m[6]=C=>p.value.image=C),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700",placeholder:"https://..."},null,512),[[F,p.value.image]])])]),e("div",Wr,[e("button",{onClick:m[7]||(m[7]=C=>c.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:b,disabled:!r.value,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save",8,Pr)])])}}},Yr={key:0,class:"mb-8"},Qr={class:"relative"},Hr={class:"flex overflow-x-auto space-x-4 pb-4 scrollbar-hide scroll-smooth",style:{"scroll-behavior":"smooth"}},Jr={class:"w-full h-36 bg-gray-200 flex items-center justify-center overflow-hidden"},Kr=["src"],Gr={key:1,class:"fa-solid fa-car text-4xl text-gray-400"},Xr={class:"p-4"},Zr={class:"font-bold text-gray-800 text-sm mb-1"},_r={class:"text-xs text-gray-500 mb-2"},ei={key:0,class:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-green-50 border border-green-100 text-green-700 text-[10px] font-semibold rounded-md mb-2"},ti=["onClick"],si={__name:"RecommendedCarsSlider",emits:["add-to-opportunity"],setup(t,{emit:y}){const s=k([]);ae(()=>{s.value=Ue.filter(o=>o.stockDays!==null&&o.stockDays!==void 0).slice(0,5)});const u=o=>new Intl.NumberFormat("en-US").format(o);return(o,n)=>s.value.length>0?(l(),a("div",Yr,[n[1]||(n[1]=e("h3",{class:"font-bold text-gray-800 text-sm mb-4"},"Recommended Cars",-1)),e("div",Qr,[e("div",Hr,[(l(!0),a(Q,null,te(s.value,p=>(l(),a("div",{key:p.id,class:"flex-none w-64 bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-shadow"},[e("div",Jr,[p.image?(l(),a("img",{key:0,src:p.image,alt:"Car",class:"w-full h-full object-cover"},null,8,Kr)):(l(),a("i",Gr))]),e("div",Xr,[e("h4",Zr,f(p.brand)+" "+f(p.model)+" ("+f(p.year)+")",1),e("p",_r,"€ "+f(u(p.price)),1),p.stockDays!==null&&p.stockDays!==void 0?(l(),a("div",ei,[n[0]||(n[0]=e("div",{class:"w-1 h-1 bg-green-500 rounded-full"},null,-1)),R(" In stock ("+f(p.stockDays)+" days) ",1)])):v("",!0),e("button",{onClick:d=>o.$emit("add-to-opportunity",p),class:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded-lg text-sm shadow-sm transition-colors mt-2"}," Add to opportunity ",8,ti)])]))),128))])])])):v("",!0)}},oi=ct(si,[["__scopeId","data-v-0d800814"]]),li={class:"mt-1.5 border-t border-gray-200 pt-1.5"},ni={key:1},ai={class:"flex items-center justify-between mb-1.5"},ri={class:"space-y-1.5"},ii={class:"block label-upper mb-1"},di=["onUpdate:modelValue","placeholder"],ui=["onUpdate:modelValue"],ci=["value"],pi={key:2,class:"space-y-0.5"},mi=["onUpdate:modelValue","value"],ye={__name:"SurveyWidget",props:{questions:{type:Array,required:!0}},emits:["survey-completed","survey-refused","not-responding"],setup(t,{emit:y}){const s=t,u=y,o=k(!1),n=k({});ne(()=>s.questions,b=>{const c={};b.forEach(m=>{c[m.key]=""}),n.value=c},{immediate:!0});const p=()=>{u("survey-completed",{...n.value}),i()},d=()=>{u("survey-refused"),i()},r=()=>{u("not-responding"),i()},i=()=>{o.value=!1;const b={};s.questions.forEach(c=>{b[c.key]=""}),n.value=b};return(b,c)=>(l(),a("div",li,[o.value?(l(),a("div",ni,[e("div",ai,[c[4]||(c[4]=e("h5",{class:"text-xs font-semibold text-gray-700"},"Survey / Feedback",-1)),e("button",{onClick:c[1]||(c[1]=m=>o.value=!1),class:"text-xs text-gray-400 hover:text-gray-600 font-medium py-0.5"},[...c[3]||(c[3]=[e("i",{class:"fa-solid fa-chevron-up text-[10px]"},null,-1)])])]),e("div",ri,[(l(!0),a(Q,null,te(t.questions,(m,x)=>(l(),a("div",{key:x,class:"bg-gray-50 rounded-md p-1.5"},[e("label",ii,f(m.label),1),m.type==="text"?M((l(),a("textarea",{key:0,"onUpdate:modelValue":g=>n.value[m.key]=g,placeholder:m.placeholder,rows:"2",class:"input resize-none text-xs py-1 px-2"},null,8,di)),[[F,n.value[m.key]]]):m.type==="select"?M((l(),a("select",{key:1,"onUpdate:modelValue":g=>n.value[m.key]=g,class:"input text-xs py-1 px-2"},[c[5]||(c[5]=e("option",{value:""},"Select an option...",-1)),(l(!0),a(Q,null,te(m.options,g=>(l(),a("option",{key:g,value:g},f(g),9,ci))),128))],8,ui)),[[de,n.value[m.key]]]):m.type==="radio"?(l(),a("div",pi,[(l(!0),a(Q,null,te(m.options,g=>(l(),a("label",{key:g,class:"flex items-center text-xs"},[M(e("input",{type:"radio","onUpdate:modelValue":C=>n.value[m.key]=C,value:g,class:"mr-1"},null,8,mi),[[ke,n.value[m.key]]]),R(" "+f(g),1)]))),128))])):v("",!0)]))),128)),e("div",{class:"flex gap-1.5 flex-wrap pt-0.5"},[e("button",{onClick:p,class:"bg-green-600 hover:bg-green-700 text-white font-medium px-2.5 py-1 rounded-md text-xs transition-colors"}," Complete Survey "),e("button",{onClick:d,class:"bg-white hover:bg-gray-50 border border-gray-200 text-slate-700 font-medium px-2.5 py-1 rounded-md text-xs transition-colors"}," Customer Refused "),e("button",{onClick:r,class:"bg-white hover:bg-gray-50 border border-gray-200 text-slate-700 font-medium px-2.5 py-1 rounded-md text-xs transition-colors"}," Not Responding ")])])])):(l(),a("button",{key:0,onClick:c[0]||(c[0]=m=>o.value=!0),class:"w-full flex items-center justify-between text-xs text-gray-500 hover:text-gray-700 py-0.5 transition-colors"},[...c[2]||(c[2]=[e("span",{class:"font-medium"},"Survey / Feedback",-1),e("i",{class:"fa-solid fa-chevron-down text-[10px]"},null,-1)])]))]))}},yi={class:"bg-orange-50/50 border border-orange-100 rounded-lg p-4 relative transition-all duration-300"},gi={class:"flex justify-between items-start mb-3"},fi={class:"text-xs text-gray-500 mt-0.5"},vi={__name:"OOFBWidget",props:{opportunity:{type:Object,required:!0}},emits:["create-offer","review","close-lost","survey-completed","survey-refused","not-responding"],setup(t,{emit:y}){const s=t,u=y,o=[{key:"offerStatus",label:"Why hasn't an offer been created?",type:"select",options:["Still gathering information","Awaiting customer response","Vehicle unavailable","Pricing concerns","Other"]},{key:"customerInterest",label:"Is customer still interested?",type:"radio",options:["Yes","Maybe","No"]},{key:"notes",label:"Additional notes",type:"text",placeholder:"Any relevant feedback or next steps..."}],n=N(()=>{if(!s.opportunity.createdAt)return 0;const m=new Date(s.opportunity.createdAt),g=Math.abs(new Date-m);return Math.ceil(g/(1e3*60*60*24))}),p=()=>{u("create-offer",s.opportunity)},d=()=>{u("review",s.opportunity)},r=()=>{u("close-lost",s.opportunity)},i=m=>{u("survey-completed",{opportunity:s.opportunity,responses:m})},b=()=>{u("survey-refused",{opportunity:s.opportunity})},c=()=>{u("not-responding",{opportunity:s.opportunity})};return(m,x)=>(l(),a("div",yi,[e("div",gi,[e("div",null,[x[0]||(x[0]=e("h4",{class:"font-bold text-slate-800 text-sm"},"Open Opportunity Feedback",-1)),e("p",fi,"This opportunity has been open for "+f(n.value)+" days without any offer. Consider creating an offer to move forward.",1)])]),e("div",{class:"flex gap-3 flex-wrap"},[e("button",{onClick:p,class:"bg-orange-600 hover:bg-orange-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Create Offer "),e("button",{onClick:d,class:"bg-white hover:bg-gray-50 border border-gray-200 text-slate-700 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"}," Review Opportunity "),e("button",{onClick:r,class:"bg-white hover:bg-red-50 border border-gray-200 text-slate-700 hover:text-red-600 hover:border-red-200 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"}," Close as Lost ")]),z(ye,{questions:o,onSurveyCompleted:i,onSurveyRefused:b,onNotResponding:c})]))}},bi={class:"bg-red-50/50 border border-red-100 rounded-lg p-4 relative transition-all duration-300"},xi={class:"flex justify-between items-start mb-3"},hi={class:"text-xs text-gray-500 mt-0.5"},wi={__name:"UFBWidget",props:{opportunity:{type:Object,required:!0}},emits:["create-offer","mark-unsold","survey-completed","survey-refused","not-responding"],setup(t,{emit:y}){const s=t,u=y,o=[{key:"lostInterest",label:"Has customer lost interest?",type:"radio",options:["Yes","Maybe","No","Unknown"]},{key:"blockers",label:"What are the blockers?",type:"select",options:["Pricing","Availability","Financing","No response","Changed mind","Found competitor","Other"]},{key:"notes",label:"Additional feedback",type:"text",placeholder:"Describe the situation and any relevant details..."}],n=N(()=>{if(!s.opportunity.createdAt)return 0;const c=new Date(s.opportunity.createdAt),x=Math.abs(new Date-c);return Math.ceil(x/(1e3*60*60*24))}),p=()=>{u("create-offer",s.opportunity)},d=()=>{u("mark-unsold",s.opportunity)},r=c=>{u("survey-completed",{opportunity:s.opportunity,responses:c})},i=()=>{u("survey-refused",{opportunity:s.opportunity})},b=()=>{u("not-responding",{opportunity:s.opportunity})};return(c,m)=>(l(),a("div",bi,[e("div",xi,[e("div",null,[m[0]||(m[0]=e("h4",{class:"font-bold text-slate-800 text-sm"},"Unsold Feedback",-1)),e("p",hi,"This opportunity has been open for "+f(n.value)+" days without any offer. This is a follow-up to ensure progress. Consider creating an offer or closing the opportunity.",1)])]),e("div",{class:"flex gap-3 flex-wrap"},[e("button",{onClick:p,class:"bg-red-600 hover:bg-red-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Create Offer "),e("button",{onClick:d,class:"bg-white hover:bg-gray-50 border border-gray-200 text-slate-700 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"}," Close as Lost ")]),z(ye,{questions:o,onSurveyCompleted:r,onSurveyRefused:i,onNotResponding:b})]))}},ki={class:"bg-blue-50/50 border border-blue-100 rounded-lg p-4 relative transition-all duration-300"},Ci={class:"flex justify-between items-start mb-3"},$i={class:"text-xs text-gray-500 mt-0.5"},Si={__name:"OFBWidget",props:{opportunity:{type:Object,required:!0}},emits:["create-contract","close-lost","survey-completed","survey-refused","not-responding"],setup(t,{emit:y}){const s=t,u=y,o=[{key:"customerFeedback",label:"Customer feedback on offer?",type:"select",options:["Positive","Neutral","Negative","No feedback yet"]},{key:"objections",label:"Any objections?",type:"text",placeholder:"Describe any concerns or objections raised by customer..."},{key:"nextSteps",label:"What are the next steps?",type:"select",options:["Waiting for customer decision","Revising offer","Scheduling closing meeting","Addressing objections","Other"]}],n=N(()=>{const c=s.opportunity.lastActivity||s.opportunity.createdAt;if(!c)return 0;const m=new Date(c),g=Math.abs(new Date-m);return Math.ceil(g/(1e3*60*60*24))}),p=()=>{u("create-contract",s.opportunity)},d=()=>{u("close-lost",s.opportunity)},r=c=>{u("survey-completed",{opportunity:s.opportunity,responses:c})},i=()=>{u("survey-refused",{opportunity:s.opportunity})},b=()=>{u("not-responding",{opportunity:s.opportunity})};return(c,m)=>(l(),a("div",ki,[e("div",Ci,[e("div",null,[m[0]||(m[0]=e("h4",{class:"font-bold text-slate-800 text-sm"},"Offer Feedback",-1)),e("p",$i,"This opportunity has been in negotiation for "+f(n.value)+" days without a contract. Consider creating a contract to finalize the deal.",1)])]),e("div",{class:"flex gap-3 flex-wrap"},[e("button",{onClick:p,class:"bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Create Contract "),e("button",{onClick:d,class:"bg-white hover:bg-red-50 border border-gray-200 text-slate-700 hover:text-red-600 hover:border-red-200 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"}," Close as Lost ")]),z(ye,{questions:o,onSurveyCompleted:r,onSurveyRefused:i,onNotResponding:b})]))}},Di={class:"bg-purple-50/50 border border-purple-100 rounded-lg p-4 relative transition-all duration-300"},Ai={__name:"NFUWidget",props:{opportunity:{type:Object,required:!0}},emits:["close-lost","schedule-closing","survey-completed","survey-refused","not-responding"],setup(t,{emit:y}){const s=t,u=y,o=[{key:"appointmentStatus",label:"Why no appointment scheduled?",type:"select",options:["Customer delaying","Awaiting vehicle availability","Logistics issues","Customer not responding","Other"]},{key:"customerStatus",label:"Customer status?",type:"radio",options:["Still interested","Considering","Lost interest","Unknown"]},{key:"notes",label:"Additional information",type:"text",placeholder:"Any relevant details about the follow-up..."}],n=()=>{u("close-lost",s.opportunity)},p=()=>{u("schedule-closing",s.opportunity)},d=b=>{u("survey-completed",{opportunity:s.opportunity,responses:b})},r=()=>{u("survey-refused",{opportunity:s.opportunity})},i=()=>{u("not-responding",{opportunity:s.opportunity})};return(b,c)=>(l(),a("div",Di,[c[0]||(c[0]=e("div",{class:"flex justify-between items-start mb-3"},[e("div",null,[e("h4",{class:"font-bold text-slate-800 text-sm"},"Opportunity Follow-up"),e("p",{class:"text-xs text-gray-500 mt-0.5"},"No contract date exists. Push to close or schedule a closing meeting to finalize the deal.")])],-1)),e("div",{class:"flex gap-3 flex-wrap"},[e("button",{onClick:p,class:"bg-purple-600 hover:bg-purple-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Schedule Closing Meeting "),e("button",{onClick:n,class:"bg-white hover:bg-red-50 border border-gray-200 text-slate-700 hover:text-red-600 hover:border-red-200 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"}," Close as Lost ")]),z(ye,{questions:o,onSurveyCompleted:d,onSurveyRefused:r,onNotResponding:i})]))}},Ii={class:"bg-yellow-50/50 border border-yellow-100 rounded-lg p-4 relative transition-all duration-300"},Ti={class:"flex justify-between items-start mb-3"},Oi={class:"text-xs text-gray-500 mt-0.5"},qi={__name:"NSWidget",props:{opportunity:{type:Object,required:!0},scheduledAppointment:{type:Object,required:!0}},emits:["contact-customer","reschedule","close-lost","survey-completed","survey-refused","not-responding"],setup(t,{emit:y}){const s=t,u=y,o=[{key:"contactStatus",label:"Were you able to reach the customer?",type:"radio",options:["Yes","No","Left message"]},{key:"noShowReason",label:"Reason for no-show?",type:"select",options:["Emergency","Forgot","Changed mind","No response","Schedule conflict","Other"]},{key:"nextAction",label:"Next action?",type:"select",options:["Reschedule appointment","Customer will call back","Continue follow-up","Close as lost","Other"]},{key:"notes",label:"Additional notes",type:"text",placeholder:"Document the conversation and any relevant details..."}],n=N(()=>{var x;return(x=s.scheduledAppointment)!=null&&x.start?new Date(s.scheduledAppointment.start).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"unknown date"}),p=()=>{u("contact-customer",s.opportunity)},d=()=>{u("reschedule",s.opportunity)},r=()=>{u("close-lost",s.opportunity)},i=m=>{u("survey-completed",{opportunity:s.opportunity,responses:m})},b=()=>{u("survey-refused",{opportunity:s.opportunity})},c=()=>{u("not-responding",{opportunity:s.opportunity})};return(m,x)=>(l(),a("div",Ii,[e("div",Ti,[e("div",null,[x[0]||(x[0]=e("h4",{class:"font-bold text-slate-800 text-sm"},"No-Show Follow-up",-1)),e("p",Oi,"Appointment was scheduled for "+f(n.value)+" but customer did not show up. Follow up with customer to understand the situation.",1)])]),e("div",{class:"flex gap-3 flex-wrap"},[e("button",{onClick:p,class:"bg-yellow-600 hover:bg-yellow-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Contact Customer "),e("button",{onClick:d,class:"bg-white hover:bg-gray-50 border border-gray-200 text-slate-700 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"}," Reschedule "),e("button",{onClick:r,class:"bg-white hover:bg-red-50 border border-gray-200 text-slate-700 hover:text-red-600 hover:border-red-200 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"}," Close as Lost ")]),z(ye,{questions:o,onSurveyCompleted:i,onSurveyRefused:b,onNotResponding:c})]))}},Ni={class:"bg-green-50/50 border border-green-100 rounded-lg p-4 relative transition-all duration-300"},Mi={class:"flex justify-between items-start mb-3"},ji={class:"text-xs text-gray-500 mt-0.5"},Ri={__name:"CFBWidget",props:{opportunity:{type:Object,required:!0}},emits:["prepare-delivery","pre-delivery-checklist","survey-completed","survey-refused","not-responding"],setup(t,{emit:y}){const s=t,u=y,o=[{key:"deliveryTimeline",label:"Delivery timeline confirmation?",type:"select",options:["On schedule","Delayed","Ahead of schedule","To be determined"]},{key:"concerns",label:"Any concerns?",type:"text",placeholder:"Document any concerns or special requests from customer..."},{key:"readiness",label:"Vehicle readiness status?",type:"select",options:["Ready","In preparation","Waiting for parts","Other"]}],n=N(()=>{var g;if(!((g=s.opportunity)!=null&&g.contractDate))return 0;const c=new Date(s.opportunity.contractDate),x=Math.abs(new Date-c);return Math.ceil(x/(1e3*60*60*24))}),p=()=>{u("prepare-delivery",s.opportunity)},d=()=>{u("pre-delivery-checklist",s.opportunity)},r=c=>{u("survey-completed",{opportunity:s.opportunity,responses:c})},i=()=>{u("survey-refused",{opportunity:s.opportunity})},b=()=>{u("not-responding",{opportunity:s.opportunity})};return(c,m)=>(l(),a("div",Ni,[e("div",Mi,[e("div",null,[m[0]||(m[0]=e("h4",{class:"font-bold text-slate-800 text-sm"},"Contract Feedback",-1)),e("p",ji,"Contract was signed "+f(n.value)+" days ago. Follow up on delivery status and collect customer feedback.",1)])]),e("div",{class:"flex gap-3 flex-wrap"},[e("button",{onClick:p,class:"bg-green-600 hover:bg-green-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Prepare for Delivery "),e("button",{onClick:d,class:"bg-white hover:bg-gray-50 border border-gray-200 text-slate-700 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"}," Pre-Delivery Checklist ")]),z(ye,{questions:o,onSurveyCompleted:r,onSurveyRefused:i,onNotResponding:b})]))}},Vi={class:"bg-teal-50/50 border border-teal-100 rounded-lg p-4 relative transition-all duration-300"},Fi={class:"flex justify-between items-start mb-3"},Li={class:"text-xs text-gray-500 mt-0.5"},Ui={__name:"DFBWidget",props:{opportunity:{type:Object,required:!0},activities:{type:Array,default:()=>[]}},emits:["delivery-feedback","survey-completed","survey-refused","not-responding"],setup(t,{emit:y}){const s=t,u=y,o=[{key:"satisfaction",label:"Satisfaction with vehicle?",type:"radio",options:["Very satisfied","Satisfied","Neutral","Dissatisfied","Very dissatisfied"]},{key:"deliveryExperience",label:"Delivery experience rating",type:"select",options:["Excellent","Good","Average","Poor","Very poor"]},{key:"issues",label:"Any issues or concerns?",type:"text",placeholder:"Document any issues or positive feedback from customer..."}],n=N(()=>{const b=s.activities.find(g=>{var C;return g.type==="delivery"||((C=g.action)==null?void 0:C.toLowerCase().includes("delivered"))});if(!b||!b.timestamp)return 0;const c=new Date(b.timestamp),x=Math.abs(new Date-c);return Math.ceil(x/(1e3*60*60*24))}),p=()=>{u("delivery-feedback",s.opportunity)},d=b=>{u("survey-completed",{opportunity:s.opportunity,responses:b})},r=()=>{u("survey-refused",{opportunity:s.opportunity})},i=()=>{u("not-responding",{opportunity:s.opportunity})};return(b,c)=>(l(),a("div",Vi,[e("div",Fi,[e("div",null,[c[0]||(c[0]=e("h4",{class:"font-bold text-slate-800 text-sm"},"Delivery Feedback",-1)),e("p",Li,"Vehicle was delivered "+f(n.value)+" days ago. Ask the customer if they're satisfied with the vehicle.",1)])]),e("button",{onClick:p,class:"bg-teal-600 hover:bg-teal-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Delivery Feedback "),z(ye,{questions:o,onSurveyCompleted:d,onSurveyRefused:r,onNotResponding:i})]))}},Ei={key:0,class:"bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden mb-8"},Bi={class:"p-4 border-b border-gray-100 bg-gray-50/50 flex justify-between items-center"},Wi={class:"text-xs bg-purple-100 text-purple-700 px-2 py-0.5 rounded font-medium"},Pi={class:"p-5 space-y-6"},zi={key:0,class:"bg-green-50/50 border border-green-100 rounded-lg p-4 relative transition-all duration-300"},Yi={key:1,class:"bg-yellow-50/50 border border-yellow-200 rounded-lg p-4 relative transition-all duration-300"},Qi={class:"flex items-start gap-3"},Hi={class:"flex-1"},Ji={class:"font-bold text-slate-800 text-sm mb-1"},Ki={key:0},Gi={key:1},Xi={class:"text-xs text-gray-600"},Zi={key:0},_i={key:1},ed={key:2},td={class:"flex justify-between items-start mb-3"},sd={class:"font-bold text-slate-800 text-sm"},od={key:0},ld={key:1},nd={class:"text-xs text-gray-500 mt-0.5"},ad={key:0},rd={key:1},id={class:"flex gap-3 flex-wrap"},dd={key:0,class:"mt-4"},ud={class:"[&>div]:mb-0"},cd={key:3,class:"bg-blue-50/50 border border-blue-100 rounded-lg p-4 relative transition-all duration-300"},pd={class:"flex justify-between items-start mb-3"},md={class:"text-xs text-gray-500 mt-0.5"},yd={key:0,class:"pt-4"},gd={key:4,class:"bg-gray-50/50 border border-gray-100 rounded-lg p-4 relative transition-all duration-300"},fd={key:5,class:"bg-green-50/50 border border-green-100 rounded-lg p-4 relative transition-all duration-300"},vd={class:"flex justify-between items-start mb-3"},bd={class:"text-xs text-gray-500 mt-0.5"},xd={key:12,class:"bg-indigo-50/50 border border-indigo-100 rounded-lg p-4 relative transition-all duration-300"},hd={class:"bg-white rounded-xl shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"},wd={class:"p-6"},kd={class:"bg-white rounded-xl shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"},Cd={class:"p-6"},$d={__name:"OpportunityManagementWidget",props:{opportunity:{type:Object,required:!0},scheduledAppointment:{type:Object,default:null},activities:{type:Array,default:()=>[]}},emits:["add-vehicle","add-vehicle-from-stock","configure-vehicle","create-offer","add-to-opportunity"],setup(t,{emit:y}){const s=t,u=y,o=N(()=>{var w,A,E;return((w=s.opportunity)==null?void 0:w.stage)==="Closed"||((A=s.opportunity)==null?void 0:A.stage)==="Closed Lost"||((E=s.opportunity)==null?void 0:E.stage)==="Registration"}),n=k(!1),p=k(!1),d=k(null),r=k(!1),i=k(""),b=k(!1),c=k(!1),m=k(!1),x=k(!1),g=k([]),C=Ee();ae(()=>{g.value=Ue.filter(w=>w.stockDays!==null&&w.stockDays!==void 0).slice(0,5).map(w=>({id:w.id,brand:w.brand,model:w.model,year:w.year,price:w.price,image:w.image||"",stockDays:w.stockDays}))});const q=w=>{i.value=w,r.value=!0},V=w=>w?new Date(w).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-",L=w=>w?new Date(w).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"-",H=()=>{n.value=!n.value},le=w=>{n.value=!1},D=N(()=>{var X;if(!((X=s.opportunity)!=null&&X.createdAt))return 0;const w=new Date(s.opportunity.createdAt),E=Math.abs(new Date-w);return Math.ceil(E/(1e3*60*60*24))}),O=N(()=>{var A,E;return s.activities.some(X=>X.type==="offer")||((A=s.opportunity)==null?void 0:A.stage)==="In Negotiation"||((E=s.opportunity)==null?void 0:E.stage)==="Closed"}),T=N(()=>s.activities.some(w=>w.type==="appointment")),P=N(()=>{var E,X,Z,se;const w=((E=s.opportunity)==null?void 0:E.contractDate)!==null&&((X=s.opportunity)==null?void 0:X.contractDate)!==void 0,A=s.activities.some(_=>{var ee,ie;return((ee=_.action)==null?void 0:ee.toLowerCase().includes("won"))||((ie=_.action)==null?void 0:ie.toLowerCase().includes("contract"))});return w||A||((Z=s.opportunity)==null?void 0:Z.stage)==="Closed"&&((se=s.opportunity)==null?void 0:se.probability)===100}),$=N(()=>s.activities.some(w=>{var A,E;return w.type==="delivery"||((A=w.action)==null?void 0:A.toLowerCase().includes("delivered"))||((E=w.action)==null?void 0:E.toLowerCase().includes("delivery"))})),I=N(()=>{var A;if(((A=s.opportunity)==null?void 0:A.stage)!=="Qualified"||O.value||s.scheduledAppointment||T.value)return!1;const w=D.value;return w>=7&&w<14}),B=N(()=>{var A;return((A=s.opportunity)==null?void 0:A.stage)!=="Qualified"||O.value||s.scheduledAppointment||T.value?!1:D.value>=14}),h=N(()=>{var A;return((A=s.opportunity)==null?void 0:A.stage)!=="Qualified"||O.value||!s.scheduledAppointment?!1:D.value>=7}),K=N(()=>{const w=D.value;return w>=14?"high":w>=7?"medium":null}),he=N(()=>{var Z;if(((Z=s.opportunity)==null?void 0:Z.stage)!=="In Negotiation")return!1;const w=s.opportunity.lastActivity?new Date(s.opportunity.lastActivity):new Date(s.opportunity.createdAt),E=Math.abs(new Date-w),X=Math.ceil(E/(1e3*60*60*24));return!P.value&&X>=5}),Ce=N(()=>{var ee,ie,Ne;if(((ee=s.opportunity)==null?void 0:ee.stage)!=="In Negotiation")return!1;const w=((ie=s.opportunity)==null?void 0:ie.contractDate)!==null&&((Ne=s.opportunity)==null?void 0:Ne.contractDate)!==void 0,A=s.scheduledAppointment&&new Date(s.scheduledAppointment.start)>new Date||T.value&&s.activities.some(Te=>{var Me;return Te.type==="appointment"&&((Me=Te.data)!=null&&Me.datetime)?new Date(Te.data.datetime)>new Date:!1}),E=s.opportunity.lastActivity?new Date(s.opportunity.lastActivity):new Date(s.opportunity.createdAt),Z=Math.abs(new Date-E);return Math.ceil(Z/(1e3*60*60*24))>=5&&!w&&!A}),$e=N(()=>{var _,ee,ie;if(((_=s.opportunity)==null?void 0:_.stage)!=="Closed"&&((ee=s.opportunity)==null?void 0:ee.stage)!=="Registration")return!1;const w=(ie=s.opportunity)==null?void 0:ie.contractDate;if(!w||$.value)return!1;const A=new Date(w),X=Math.abs(new Date-A);return Math.ceil(X/(1e3*60*60*24))>=7}),Se=N(()=>{const w=s.activities.find(_=>{var ee;return _.type==="delivery"||((ee=_.action)==null?void 0:ee.toLowerCase().includes("delivered"))});if(!w)return!1;const A=new Date(w.timestamp),X=Math.abs(new Date-A);return Math.ceil(X/(1e3*60*60*24))>=3}),De=N(()=>{if(!s.scheduledAppointment||new Date(s.scheduledAppointment.start)>=new Date)return!1;const E=s.activities.some(Z=>{var se,_,ee;return Z.type==="appointment"&&(((se=Z.data)==null?void 0:se.status)==="completed"||((_=Z.action)==null?void 0:_.toLowerCase().includes("completed")))&&((ee=Z.data)==null?void 0:ee.appointmentId)===s.scheduledAppointment.id}),X=s.scheduledAppointment.status==="no-show";return!E&&!X}),U=N(()=>{var w,A,E;return!(((w=s.opportunity)==null?void 0:w.stage)!=="In Negotiation"||!((A=s.opportunity)!=null&&A.contractDate)||((E=s.opportunity)==null?void 0:E.stage)==="Closed")}),S=N(()=>{var Z,se,_;if(((Z=s.opportunity)==null?void 0:Z.stage)!=="Closed"||!((se=s.opportunity)!=null&&se.contractDate)||$.value||((_=s.opportunity)==null?void 0:_.stage)==="Registration")return!1;const w=new Date(s.opportunity.contractDate),E=Math.abs(new Date-w);return Math.ceil(E/(1e3*60*60*24))>=7}),G=()=>{u("add-vehicle",s.opportunity)},ve=()=>{q("Add Vehicle from Stock")},Pe=()=>{q("Configure Vehicle")},Ae=()=>{b.value=!0},Oe=()=>{b.value=!1},ze=w=>{b.value=!1,u("create-offer",{opportunity:s.opportunity,offerData:w})},Ye=w=>{u("add-to-opportunity",w)},Qe=w=>{q("Review Opportunity")},He=w=>{m.value=!0},Je=w=>{m.value=!1,console.log("Contract date set:",w)},qe=w=>{p.value=!0,d.value=w},Ie=()=>{p.value=!1,d.value=null},Ke=w=>{qe("nfu")},Ge=w=>{Ie();const A={type:"appointment",user:"You",action:"scheduled an appointment",content:`Appointment scheduled: ${w.type} on ${w.date} at ${w.time}`,data:{type:w.type,assignee:w.assignee,date:w.date,time:w.time,datetime:`${w.date}T${w.time}:00`,status:"scheduled"},timestamp:new Date().toISOString()};u("appointment-created",A)},Xe=w=>{x.value=!0},Ze=w=>{q("Pre-Delivery Checklist")},_e=w=>{x.value=!1,console.log("Vehicle marked as delivered:",w)},et=w=>{q("Delivery Feedback")},be=()=>{c.value=!0},tt=w=>{c.value=!1,console.log("Closing opportunity as lost:",w)},st=()=>{q("Contact Customer")},ce=w=>{console.log("Survey completed:",w)},pe=w=>{console.log("Survey refused:",w)},me=w=>{console.log("Customer not responding:",w)},ot=async()=>{try{await C.reopenOpportunity(s.opportunity.id),await C.loadOpportunityById(s.opportunity.id)}catch(w){console.error("Failed to reopen opportunity:",w)}},lt=async()=>{try{await C.markAsRegistration(s.opportunity.id),await C.loadOpportunityById(s.opportunity.id)}catch(w){console.error("Failed to mark as registration:",w)}},nt=async()=>{try{await C.markAsClosedWon(s.opportunity.id),await C.loadOpportunityById(s.opportunity.id)}catch(w){console.error("Failed to mark as closed won:",w)}};return(w,A)=>t.opportunity?(l(),a("div",Ei,[e("div",Bi,[A[6]||(A[6]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fa-solid fa-thumbtack text-gray-400 text-xs"}),e("h3",{class:"font-bold text-slate-800 text-sm"},"Manage Next steps")],-1)),e("span",Wi,f(o.value?"Closed":"Active"),1)]),e("div",Pi,[o.value?(l(),a("div",zi,[A[8]||(A[8]=e("div",{class:"flex justify-between items-start mb-3"},[e("div",null,[e("h4",{class:"font-bold text-slate-800 text-sm"},"Opportunity Closed"),e("p",{class:"text-xs text-gray-500 mt-0.5"},"This opportunity has been closed. Reopen it to restart the management process.")])],-1)),e("button",{onClick:ot,class:"bg-green-600 hover:bg-green-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"},[...A[7]||(A[7]=[R(" Reopen ",-1),e("i",{class:"fa-solid fa-rotate-left"},null,-1)])])])):v("",!0),h.value?(l(),a("div",Yi,[e("div",Qi,[A[9]||(A[9]=e("div",{class:"flex-shrink-0 mt-0.5"},[e("i",{class:"fa-solid fa-exclamation-triangle text-yellow-600 text-sm"})],-1)),e("div",Hi,[e("h4",Ji,[K.value==="high"?(l(),a("span",Ki,"High Risk")):(l(),a("span",Gi,"At Risk"))]),e("p",Xi,[K.value==="high"?(l(),a("span",Zi," This opportunity has been open for "+f(D.value)+" days. Even with a scheduled appointment, consider following up to ensure engagement. ",1)):(l(),a("span",_i," This opportunity has been open for "+f(D.value)+" days. Monitor closely to ensure the scheduled appointment proceeds as planned. ",1))])])])])):v("",!0),t.opportunity.stage==="Qualified"&&t.opportunity.vehicle?(l(),a("div",ed,[e("div",{class:j([t.opportunity.vehicle.stockDays!==null&&t.opportunity.vehicle.stockDays!==void 0?"bg-green-50/50 border border-green-100":"bg-orange-50/50 border border-orange-100","rounded-lg p-4 relative transition-all duration-300"])},[e("div",td,[e("div",null,[e("h4",sd,[t.opportunity.vehicle.stockDays!==null&&t.opportunity.vehicle.stockDays!==void 0?(l(),a("span",od," Add Vehicle ")):(l(),a("span",ld," Find Alternative "))]),e("p",nd,[t.opportunity.vehicle.stockDays!==null&&t.opportunity.vehicle.stockDays!==void 0?(l(),a("span",ad," The requested vehicle is available. Add it to the opportunity to proceed. ")):(l(),a("span",rd," The requested vehicle is currently out of stock. Explore other options. "))])])]),e("div",id,[t.opportunity.vehicle.stockDays!==null&&t.opportunity.vehicle.stockDays!==void 0?(l(),a("button",{key:0,onClick:G,class:"bg-green-600 hover:bg-green-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Add requested vehicle to opportunity ")):v("",!0),e("button",{onClick:ve,class:"bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Add vehicle from stock "),e("button",{onClick:Pe,class:"bg-white hover:bg-gray-50 border border-gray-200 text-slate-700 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"}," Configure vehicle "),e("button",{onClick:Ae,class:"bg-white hover:bg-gray-50 border border-gray-200 text-slate-700 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"}," Create offer ")]),t.opportunity.vehicle.stockDays===null||t.opportunity.vehicle.stockDays===void 0?(l(),a("div",dd,[e("div",ud,[z(oi,{onAddToOpportunity:Ye})])])):v("",!0)],2)])):v("",!0),t.opportunity.stage==="Qualified"&&t.scheduledAppointment?(l(),a("div",cd,[e("div",pd,[e("div",null,[A[10]||(A[10]=e("h4",{class:"font-bold text-slate-800 text-sm"},"Next Appointment",-1)),e("p",md,f(t.scheduledAppointment.title)+" on "+f(V(t.scheduledAppointment.start))+" at "+f(L(t.scheduledAppointment.start)),1)])]),e("button",{onClick:H,class:"bg-white hover:bg-gray-50 border border-gray-200 text-gray-700 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"}," Postpone "),n.value?(l(),a("div",yd,[z(Be,{show:n.value,onClose:A[0]||(A[0]=E=>n.value=!1),onConfirm:le},null,8,["show"])])):v("",!0)])):t.opportunity.stage==="Qualified"&&!T.value?(l(),a("div",gd,[A[11]||(A[11]=e("div",{class:"flex justify-between items-start mb-3"},[e("div",null,[e("h4",{class:"font-bold text-slate-800 text-sm"},"No Appointment Scheduled"),e("p",{class:"text-xs text-gray-500 mt-0.5"},"Schedule a new appointment to move the opportunity forward.")])],-1)),e("button",{onClick:A[1]||(A[1]=E=>qe("no-appointment")),class:"bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Schedule appointment ")])):v("",!0),U.value?(l(),a("div",fd,[e("div",vd,[e("div",null,[A[12]||(A[12]=e("h4",{class:"font-bold text-slate-800 text-sm"},"Contract Signed",-1)),e("p",bd," Contract was signed on "+f(V(t.opportunity.contractDate))+". Mark this opportunity as Closed Won to complete the deal. ",1)])]),e("button",{onClick:nt,class:"bg-green-600 hover:bg-green-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"},[...A[13]||(A[13]=[R(" Mark as Closed Won ",-1),e("i",{class:"fa-solid fa-check-circle"},null,-1)])])])):v("",!0),De.value?(l(),W(qi,{key:6,opportunity:t.opportunity,"scheduled-appointment":t.scheduledAppointment,onContactCustomer:st,onReschedule:w.openRescheduleModal,onCloseLost:be,onSurveyCompleted:ce,onSurveyRefused:pe,onNotResponding:me},null,8,["opportunity","scheduled-appointment","onReschedule"])):v("",!0),B.value?(l(),W(wi,{key:7,opportunity:t.opportunity,onCreateOffer:Ae,onMarkUnsold:be,onSurveyCompleted:ce,onSurveyRefused:pe,onNotResponding:me},null,8,["opportunity"])):v("",!0),I.value?(l(),W(vi,{key:8,opportunity:t.opportunity,onCreateOffer:Ae,onReview:Qe,onCloseLost:be,onSurveyCompleted:ce,onSurveyRefused:pe,onNotResponding:me},null,8,["opportunity"])):v("",!0),Ce.value?(l(),W(Ai,{key:9,opportunity:t.opportunity,onCloseLost:be,onScheduleClosing:Ke,onSurveyCompleted:ce,onSurveyRefused:pe,onNotResponding:me},null,8,["opportunity"])):v("",!0),he.value?(l(),W(Si,{key:10,opportunity:t.opportunity,onCreateContract:He,onCloseLost:be,onSurveyCompleted:ce,onSurveyRefused:pe,onNotResponding:me},null,8,["opportunity"])):v("",!0),$e.value?(l(),W(Ri,{key:11,opportunity:t.opportunity,onPrepareDelivery:Xe,onPreDeliveryChecklist:Ze,onSurveyCompleted:ce,onSurveyRefused:pe,onNotResponding:me},null,8,["opportunity"])):v("",!0),S.value?(l(),a("div",xd,[A[15]||(A[15]=e("div",{class:"flex justify-between items-start mb-3"},[e("div",null,[e("h4",{class:"font-bold text-slate-800 text-sm"},"Administrative Phase"),e("p",{class:"text-xs text-gray-500 mt-0.5"},"Contract has been signed. Move to Registration stage to complete administrative processes before delivery.")])],-1)),e("button",{onClick:lt,class:"bg-indigo-600 hover:bg-indigo-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"},[...A[14]||(A[14]=[R(" Mark as Registration ",-1),e("i",{class:"fa-solid fa-file-contract"},null,-1)])])])):v("",!0),Se.value?(l(),W(Ui,{key:13,opportunity:t.opportunity,activities:t.activities,onDeliveryFeedback:et,onSurveyCompleted:ce,onSurveyRefused:pe,onNotResponding:me},null,8,["opportunity","activities"])):v("",!0)]),z(Ka,{show:r.value,title:i.value,onClose:A[2]||(A[2]=E=>r.value=!1)},null,8,["show","title"]),z(er,{show:c.value,onConfirm:tt,onCancel:A[3]||(A[3]=E=>c.value=!1)},null,8,["show"]),z(ar,{show:m.value,onConfirm:Je,onCancel:A[4]||(A[4]=E=>m.value=!1)},null,8,["show"]),z(pr,{show:x.value,onConfirm:_e,onCancel:A[5]||(A[5]=E=>x.value=!1)},null,8,["show"]),(l(),W(ue,{to:"body"},[b.value?(l(),a("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:J(Oe,["self"])},[e("div",hd,[e("div",wd,[z(zr,{item:null,"task-type":"opportunity","task-id":t.opportunity.id,"requested-car":t.opportunity.vehicle||null,"recommended-cars":g.value,onSave:ze,onCancel:Oe},null,8,["task-id","requested-car","recommended-cars"])])])])):v("",!0)])),(l(),W(ue,{to:"body"},[p.value?(l(),a("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:J(Ie,["self"])},[e("div",kd,[e("div",Cd,[z(We,{show:p.value,onConfirm:Ge,onCancel:Ie},null,8,["show"])])])])):v("",!0)]))])):v("",!0)}},Sd={class:"h-full flex flex-col lg:flex-row overflow-hidden bg-gray-50"},Dd={class:"bg-gray-100 text-gray-600 text-[10px] font-bold uppercase px-2 py-0.5 rounded border border-gray-200"},Ad={key:0,class:"bg-red-50 text-red-600 text-[10px] font-bold uppercase px-2 py-0.5 rounded border border-red-100 flex items-center gap-1"},Id={key:0,class:"fa-solid fa-clock text-[10px]"},Td={class:"text-[10px] font-bold uppercase tracking-wide"},Od={key:1,class:"text-right"},qd={class:"text-sm font-bold text-gray-900"},Nd={class:"mt-1.5"},Md={class:"w-20 h-1.5 bg-gray-200 rounded-full overflow-hidden"},jd={class:"text-[10px] text-gray-500 mt-0.5"},Rd=["onClick"],Vd=["onClick"],Fd=["onClick"],Ld={class:"flex-1 flex flex-col overflow-hidden"},Ud={key:0,class:"lg:hidden xl:hidden fixed bottom-6 right-4 flex flex-col gap-3 z-30"},Ed={key:1,class:"flex-1 flex items-center justify-center"},Bd={key:0,class:"xl:hidden fixed inset-0 z-[60] bg-white"},Pd={__name:"TaskDetail",setup(t){const y=pt(),s=mt(),u=Le(),o=Ee(),n=k("all"),p=k(null),d=k(!1),r=k(!1),i=N(()=>{const $=u.leads.map(B=>({...B,type:"lead",compositeId:`lead-${B.id}`})),I=o.opportunities.map(B=>({...B,type:"opportunity",compositeId:`opportunity-${B.id}`}));return[...$,...I].sort((B,h)=>{const K=new Date(B.lastActivity||B.createdAt||0);return new Date(h.lastActivity||h.createdAt||0)-K})}),b=N(()=>n.value==="all"?i.value:i.value.filter($=>$.type===n.value)),c=N(()=>{const $=parseInt(y.params.id),I=y.query.type;if(I)return i.value.find(K=>K.id===$&&K.type===I)||null;const h=(n.value!=="all"?i.value.filter(K=>K.type===n.value):i.value).find(K=>K.id===$);return h||i.value.find(K=>K.id===$)||null}),m=N(()=>c.value?c.value.type==="lead"?u.currentLeadActivities:o.currentOpportunityActivities:[]),x=N(()=>c.value?c.value.type==="lead"?Ya:$d:null),g=N(()=>c.value?c.value.type==="lead"?{currentActivities:N(()=>u.currentLeadActivities),addActivity:($,I)=>u.addActivity($,I),updateActivity:($,I,B)=>u.updateActivity($,I,B),deleteActivity:($,I)=>u.deleteActivity($,I)}:{currentActivities:N(()=>o.currentOpportunityActivities),addActivity:($,I)=>o.addActivity($,I),updateActivity:($,I,B)=>o.updateActivity($,I,B),deleteActivity:($,I)=>o.deleteActivity($,I)}:null),C=N(()=>c.value?c.value.type==="lead"?{overviewActions:["financing","tradein","purchase"],tabActions:["note","call","email","sms","whatsapp","attachment"]}:{overviewActions:["financing","tradein","purchase"],tabActions:["note","call","email","sms","whatsapp","attachment"]}:{overviewActions:[],tabActions:[]}),q=N(()=>$=>$.type==="lead"?"bg-white border border-gray-200 hover:border-blue-300":"bg-white border border-gray-200 hover:border-purple-300");ae(()=>{u.loadLeads(),o.loadOpportunities();const $=y.params.id;$&&V($)}),ne(()=>y.params.id,$=>{$&&V($)}),ne(c,$=>{$&&($.type==="lead"?u.loadLeadById($.id):o.loadOpportunityById($.id))},{immediate:!0});const V=$=>{const I=parseInt($),B=i.value.find(h=>h.id===I);B&&(B.type==="lead"?u.loadLeadById(I):o.loadOpportunityById(I))},L=$=>{const[I,B]=$.split("-");s.push({path:`/tasks/${B}`,query:{type:I}}),d.value=!1},H=$=>new Intl.NumberFormat("en-US").format($),le=$=>{p.value=p.value===$?null:$},D=$=>{p.value=null},O=async $=>{p.value=null,$.type==="lead"?await u.modifyLead($.id,{priority:"Hot"}):$.type==="opportunity"&&await o.modifyOpportunity($.id,{priority:"Hot"})},T=async $=>{p.value=null,$.type==="lead"?await u.modifyLead($.id,{priority:"Normal"}):$.type==="opportunity"&&await o.modifyOpportunity($.id,{priority:"Normal"})},P=$=>({Open:"bg-blue-100 text-blue-700 border-blue-200","Open Opportunities":"bg-blue-100 text-blue-700 border-blue-200","Open opportunity":"bg-blue-100 text-blue-700 border-blue-200",Qualified:"bg-purple-100 text-purple-700 border-purple-200","In Negotiation":"bg-orange-100 text-orange-700 border-orange-200","Opportunity in negotiation":"bg-orange-100 text-orange-700 border-orange-200",Registration:"bg-indigo-100 text-indigo-700 border-indigo-200",Closed:"bg-gray-100 text-gray-700 border-gray-200","Closed opportunity":"bg-gray-100 text-gray-700 border-gray-200","Closed Lost":"bg-red-100 text-red-700 border-red-200",Won:"bg-green-100 text-green-700 border-green-200",Lost:"bg-red-100 text-red-700 border-red-200"})[$]||"bg-gray-100 text-gray-700 border-gray-200";return($,I)=>{var B;return l(),a("div",Sd,[e("div",{class:j(["lg:relative lg:block",d.value?"fixed inset-0 z-[60] md:relative md:z-auto":"hidden lg:block"])},[z(Bt,{title:"Tasks",items:b.value,"selected-id":(B=c.value)==null?void 0:B.compositeId,"type-filter":n.value,"selected-class":h=>h.type==="lead"?"bg-white border-2 border-blue-500 shadow-md":"bg-white border-2 border-purple-500 shadow-md","unselected-class":q.value,"open-menu-id":p.value,getName:h=>h.customer.name,getInitials:h=>h.customer.initials,getVehicleInfo:h=>h.type==="lead"?`${h.requestedCar.brand} ${h.requestedCar.model}`:`${h.vehicle.brand} ${h.vehicle.model}`,avatarClass:h=>h.type==="lead"?"bg-orange-100 text-orange-600":"bg-purple-100 text-purple-600","show-mobile-close":!0,onSelect:L,onMenuClick:le,onMenuClose:I[0]||(I[0]=h=>p.value=null),onClose:I[1]||(I[1]=h=>d.value=!1),"show-type-filter":!0,onFilterChange:I[2]||(I[2]=h=>n.value=h)},{badges:xe(({item:h})=>[e("span",{class:j(["text-[10px] font-bold uppercase px-2 py-0.5 rounded border",h.type==="lead"?"bg-blue-50 text-blue-700 border-blue-200":"bg-purple-50 text-purple-700 border-purple-200"])},f(h.type==="lead"?"Lead":"Opportunity"),3),h.type==="lead"?(l(),a(Q,{key:0},[e("span",Dd,f(h.status),1),h.priority==="Hot"?(l(),a("span",Ad,[...I[6]||(I[6]=[e("i",{class:"fa-solid fa-fire text-[9px]"},null,-1),R(" Hot ",-1)])])):v("",!0)],64)):(l(),a("span",{key:1,class:j(["text-[10px] font-bold uppercase px-2 py-0.5 rounded border",P(h.stage)])},f(h.stage),3))]),meta:xe(({item:h})=>[h.type==="lead"?(l(),a("div",{key:0,class:j(["flex items-center gap-1.5",h.priority==="Hot"?"text-red-500":"text-gray-400"])},[h.priority==="Hot"?(l(),a("i",Id)):v("",!0),e("span",Td," Due in "+f(h.nextActionDue),1)],2)):(l(),a("div",Od,[e("div",qd,"€"+f(H(h.value)),1),e("div",Nd,[e("div",Md,[e("div",{class:j(["h-full rounded-full",h.probability>=70?"bg-green-500":h.probability>=40?"bg-blue-500":"bg-orange-500"]),style:Fe({width:`${h.probability}%`})},null,6)]),e("div",jd,f(h.probability)+"% PROB",1)])]))]),menu:xe(({item:h})=>[e("button",{onClick:J(K=>D(h),["stop"]),class:"w-full text-left px-3 py-2 text-xs text-slate-700 hover:bg-gray-50 flex items-center gap-2"},[...I[7]||(I[7]=[e("i",{class:"fa-solid fa-share text-gray-400"},null,-1),R(" Reassign ",-1)])],8,Rd),h.priority!=="Hot"?(l(),a("button",{key:0,onClick:J(K=>O(h),["stop"]),class:"w-full text-left px-3 py-2 text-xs text-slate-700 hover:bg-gray-50 flex items-center gap-2"},[...I[8]||(I[8]=[e("i",{class:"fa-solid fa-fire text-orange-500"},null,-1),R(" Mark as hot ",-1)])],8,Vd)):(l(),a("button",{key:1,onClick:J(K=>T(h),["stop"]),class:"w-full text-left px-3 py-2 text-xs text-slate-700 hover:bg-gray-50 flex items-center gap-2"},[...I[9]||(I[9]=[e("i",{class:"fa-regular fa-snowflake text-gray-400"},null,-1),R(" Unmark as hot ",-1)])],8,Fd))]),_:1},8,["items","selected-id","type-filter","selected-class","unselected-class","open-menu-id","getName","getInitials","getVehicleInfo","avatarClass"])],2),e("div",Ld,[c.value?(l(),a("div",Ud,[e("button",{onClick:I[3]||(I[3]=h=>r.value=!r.value),class:"w-14 h-14 bg-purple-600 text-white rounded-full shadow-lg flex items-center justify-center hover:bg-purple-700 transition-all hover:scale-110",title:"Activity"},[...I[10]||(I[10]=[e("i",{class:"fa-solid fa-clock-rotate-left text-lg"},null,-1)])]),e("button",{onClick:I[4]||(I[4]=h=>d.value=!d.value),class:"w-14 h-14 bg-blue-600 text-white rounded-full shadow-lg flex items-center justify-center hover:bg-blue-700 transition-all hover:scale-110",title:"Tasks"},[...I[11]||(I[11]=[e("i",{class:"fa-solid fa-list text-lg"},null,-1)])])])):v("",!0),c.value?(l(),W(ln,{key:2,task:c.value,type:c.value.type,"management-widget":x.value,"store-adapter":g.value,"add-new-config":C.value},{"pinned-extra":xe(({task:h})=>[h.type==="lead"&&h.requestedCar?(l(),W(Ve,{key:0,brand:h.requestedCar.brand,model:h.requestedCar.model,year:h.requestedCar.year,image:h.requestedCar.image||"",price:h.requestedCar.price||null,"request-message":h.requestedCar.requestMessage||"","request-type":h.requestedCar.requestType||"",source:h.source||"",dealership:h.requestedCar.dealership||"",registration:h.requestedCar.registration||"",kilometers:h.requestedCar.kilometers||null,"fuel-type":h.requestedCar.fuelType||"","gear-type":h.requestedCar.gearType||"",vin:h.requestedCar.vin||"","stock-days":h.requestedCar.stockDays!==void 0?h.requestedCar.stockDays:null,channel:h.requestedCar.channel||"Email","ad-campaign":h.requestedCar.adCampaign||"","expected-purchase-date":h.requestedCar.expectedPurchaseDate||"","fiscal-entity":h.requestedCar.fiscalEntity||"","source-details":h.requestedCar.sourceDetails||"","ad-medium":h.requestedCar.adMedium||"","ad-source":h.requestedCar.adSource||"",label:"Requested Car"},null,8,["brand","model","year","image","price","request-message","request-type","source","dealership","registration","kilometers","fuel-type","gear-type","vin","stock-days","channel","ad-campaign","expected-purchase-date","fiscal-entity","source-details","ad-medium","ad-source"])):v("",!0),h.type==="opportunity"&&h.vehicle?(l(),W(Ve,{key:1,brand:h.vehicle.brand,model:h.vehicle.model,year:h.vehicle.year,image:h.vehicle.image||"",price:h.vehicle.price||null,"request-message":h.vehicle.requestMessage||"","request-type":h.vehicle.requestType||"",source:h.source||"",dealership:h.vehicle.dealership||"",registration:h.vehicle.registration||"",kilometers:h.vehicle.kilometers||null,"fuel-type":h.vehicle.fuelType||"","gear-type":h.vehicle.gearType||"",vin:h.vehicle.vin||"","stock-days":h.vehicle.stockDays!==void 0?h.vehicle.stockDays:null,channel:h.vehicle.channel||"Email","ad-campaign":h.vehicle.adCampaign||"","expected-purchase-date":h.vehicle.expectedPurchaseDate||"","fiscal-entity":h.vehicle.fiscalEntity||"","source-details":h.vehicle.sourceDetails||"","ad-medium":h.vehicle.adMedium||"","ad-source":h.vehicle.adSource||"",label:"Vehicle"},null,8,["brand","model","year","image","price","request-message","request-type","source","dealership","registration","kilometers","fuel-type","gear-type","vin","stock-days","channel","ad-campaign","expected-purchase-date","fiscal-entity","source-details","ad-medium","ad-source"])):v("",!0)]),_:1},8,["task","type","management-widget","store-adapter","add-new-config"])):(l(),a("div",Ed,[...I[12]||(I[12]=[e("div",{class:"text-center"},[e("i",{class:"fa-solid fa-tasks text-6xl text-gray-300 mb-4"}),e("p",{class:"text-gray-500"},"Select a task to view details")],-1)])]))]),r.value&&c.value?(l(),a("div",Bd,[z(je,{title:"Activity summary",activities:m.value,collapsed:!1,"show-collapse":!1,show:!0,"mobile-fullscreen":!0,onClose:I[5]||(I[5]=h=>r.value=!1),class:"flex w-full h-full"},null,8,["activities"])])):v("",!0),z(je,{title:"Activity summary",activities:m.value,collapsed:!1,"show-collapse":!1,show:!!c.value,class:"hidden xl:flex"},null,8,["activities","show"])])}}};export{Pd as default};
