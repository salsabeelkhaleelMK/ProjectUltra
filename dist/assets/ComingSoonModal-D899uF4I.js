import{r as A,d as i,o as l,e,g as m,n as D,t as f,C as se,z as C,w as R,j as T,_ as xe,c as V,p as I,Q as he,i as z,y as K,m as $,Z as ke,F as U,l as j,G as le,B as O,k as Q,A as Z,V as we,h as $e,$ as Ce,U as Se,L as Ae,H as W}from"./index-CNXtwH7T.js";import{i as me,R as De}from"./index-X4R71uMA.js";import{_ as Te}from"./ReassignUserModal-70QaKyyV.js";import{_ as Oe}from"./CreateEventModal-J7oxvOIQ.js";import{_ as qe}from"./ModalShell-C2F0rTBB.js";const Ne={class:"w-full"},Ve={class:"flex items-center justify-between gap-3 md:gap-4"},Ee={class:"flex items-center gap-3 md:gap-4 flex-1"},Ie={class:"min-w-0 flex-1"},Fe={class:"flex items-center gap-2"},Ue={class:"heading-main truncate"},Me={class:"flex flex-wrap items-center gap-2 mt-1"},je={class:"flex items-center gap-1 ml-2"},We={class:"relative"},Le={key:0,class:"absolute top-full right-0 mt-2 w-48 bg-white border border-gray-200 rounded-xl shadow-lg shadow-gray-100/50 z-50 overflow-hidden flex flex-col p-1"},Be={key:0,class:"border-t border-gray-100 my-1"},Pe={key:0,class:"mt-4 pt-4 border-t-2 border-dashed border-gray-300 animate-fade-in relative"},Re={class:"flex items-center gap-4"},ze={class:"flex flex-wrap items-center gap-x-6 gap-y-2"},Ye={class:"flex items-center gap-2"},Ke={class:"text-xs text-gray-900 font-medium"},Qe={class:"flex items-center gap-2"},He={class:"text-xs text-gray-900 font-medium"},Ge={class:"flex items-center gap-2"},Je={class:"w-6 h-6 rounded bg-gray-100 flex items-center justify-center shrink-0"},Ze={key:0,class:"fa-solid fa-map-marker-alt text-gray-500 text-[10px]"},Xe={key:1,class:"fa-regular fa-calendar text-gray-500 text-[10px]"},_e={class:"text-xs text-gray-900 font-medium"},et={key:0,class:"absolute -bottom-6 left-0 px-2 py-1 bg-gray-900 text-white text-[10px] rounded shadow-lg whitespace-nowrap"},tt={__name:"ContactInfo",props:{initials:{type:String,required:!0},name:{type:String,required:!0},avatarColorClass:{type:String,default:"bg-orange-100 text-orange-600"},email:{type:String,required:!0},phone:{type:String,required:!0},thirdFieldValue:{type:String,required:!0},emailLabel:{type:String,default:"Email"},phoneLabel:{type:String,default:"Phone"},thirdFieldLabel:{type:String,default:"Expected Close"},taskType:{type:String,default:"lead"}},emits:["action"],setup(t,{emit:y}){const s={mounted(n,d){n.clickOutsideEvent=h=>{n===h.target||n.contains(h.target)||d.value()},document.addEventListener("click",n.clickOutsideEvent)},unmounted(n){document.removeEventListener("click",n.clickOutsideEvent)}},g=y,a=A(!1),r=A(!1),p=A(null),u=n=>{r.value=!1,g("action",n)},o=async(n,d)=>{try{await navigator.clipboard.writeText(n),p.value=d,setTimeout(()=>{p.value=null},1500)}catch(h){console.error("Failed to copy:",h)}};return(n,d)=>(l(),i("div",Ne,[e("div",Ve,[e("div",Ee,[e("div",{class:D(["w-12 h-12 rounded-full flex items-center justify-center text-lg font-bold border-2 border-white shadow-sm shrink-0",t.avatarColorClass])},f(t.initials),3),e("div",Ie,[e("div",Fe,[e("h1",Ue,f(t.name),1),se(n.$slots,"name-action")]),e("div",Me,[se(n.$slots,"tags")])])]),e("div",je,[e("div",We,[e("button",{onClick:d[0]||(d[0]=R(h=>r.value=!r.value,["stop"])),class:"w-9 h-9 flex items-center justify-center bg-blue-600 hover:bg-blue-700 text-white rounded-lg shrink-0 transition-colors"},[...d[14]||(d[14]=[e("i",{class:"fa-solid fa-plus text-sm"},null,-1)])]),r.value?C((l(),i("div",Le,[e("button",{onClick:d[1]||(d[1]=h=>u("note")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Note "),e("button",{onClick:d[2]||(d[2]=h=>u("financing")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Financing "),e("button",{onClick:d[3]||(d[3]=h=>u("tradein")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Trade-in "),e("button",{onClick:d[4]||(d[4]=h=>u("purchase")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Purchase "),e("button",{onClick:d[5]||(d[5]=h=>u("attachment")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Attachment "),d[19]||(d[19]=e("div",{class:"border-t border-gray-100 my-1"},null,-1)),e("button",{onClick:d[6]||(d[6]=h=>u("whatsapp")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...d[15]||(d[15]=[e("i",{class:"fa-brands fa-whatsapp text-xs text-gray-400"},null,-1),T(" WhatsApp msg ",-1)])]),e("button",{onClick:d[7]||(d[7]=h=>u("email")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...d[16]||(d[16]=[e("i",{class:"fa-regular fa-envelope text-xs text-gray-400"},null,-1),T(" Email ",-1)])]),e("button",{onClick:d[8]||(d[8]=h=>u("sms")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...d[17]||(d[17]=[e("i",{class:"fa-solid fa-comment-dots text-xs text-gray-400"},null,-1),T(" SMS ",-1)])]),e("button",{onClick:d[9]||(d[9]=h=>u("call")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...d[18]||(d[18]=[e("i",{class:"fa-solid fa-phone text-xs text-gray-400"},null,-1),T(" Call ",-1)])]),t.taskType==="opportunity"?(l(),i("div",Be)):m("",!0),t.taskType==="opportunity"?(l(),i("button",{key:1,onClick:d[10]||(d[10]=h=>u("appointment")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Appointment ")):m("",!0)])),[[s,()=>r.value=!1]]):m("",!0)]),e("button",{onClick:d[11]||(d[11]=h=>a.value=!a.value),class:"w-9 h-9 flex items-center justify-center bg-white border border-gray-200 rounded-lg hover:bg-gray-50 shrink-0"},[e("i",{class:D(["fa-solid fa-chevron-up text-sm transition-transform duration-200",{"rotate-180":a.value}])},null,2)])])]),a.value?(l(),i("div",Pe,[e("div",Re,[e("div",ze,[e("div",Ye,[d[21]||(d[21]=e("div",{class:"w-6 h-6 rounded bg-gray-100 flex items-center justify-center shrink-0"},[e("i",{class:"fa-regular fa-envelope text-gray-500 text-[10px]"})],-1)),e("span",Ke,f(t.email),1),e("button",{onClick:d[12]||(d[12]=R(h=>o(t.email,"email"),["stop"])),class:"w-5 h-5 flex items-center justify-center rounded hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors shrink-0",title:"Copy email"},[...d[20]||(d[20]=[e("i",{class:"fa-regular fa-copy text-[10px]"},null,-1)])])]),e("div",Qe,[d[23]||(d[23]=e("div",{class:"w-6 h-6 rounded bg-gray-100 flex items-center justify-center shrink-0"},[e("i",{class:"fa-solid fa-phone text-gray-500 text-[10px]"})],-1)),e("span",He,f(t.phone),1),e("button",{onClick:d[13]||(d[13]=R(h=>o(t.phone,"phone"),["stop"])),class:"w-5 h-5 flex items-center justify-center rounded hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors shrink-0",title:"Copy phone"},[...d[22]||(d[22]=[e("i",{class:"fa-regular fa-copy text-[10px]"},null,-1)])])]),e("div",Ge,[e("div",Je,[t.thirdFieldLabel.toLowerCase().includes("address")?(l(),i("i",Ze)):(l(),i("i",Xe))]),e("span",_e,f(t.thirdFieldValue),1)])])]),p.value?(l(),i("div",et,f(p.value==="email"?"Email":"Phone")+" copied! ",1)):m("",!0)])):m("",!0)]))}},at={class:"flex items-center justify-center gap-1.5"},st={class:"hidden md:inline whitespace-nowrap"},lt={__name:"Tabs",props:{modelValue:{type:String,required:!0},tabs:{type:Array,required:!0}},emits:["update:modelValue"],setup(t,{emit:y}){const s=t,g=y,a=V(()=>s.tabs.map(o=>({id:o.key,label:o.label}))),r=o=>{g("update:modelValue",o)},p={overview:"fa-solid fa-house",note:"fa-solid fa-note-sticky",communication:"fa-solid fa-comments",attachment:"fa-solid fa-paperclip"},u=o=>p[o]||"fa-solid fa-circle";return(o,n)=>(l(),I($(De),{tabs:a.value,modelValue:t.modelValue,"onUpdate:modelValue":n[0]||(n[0]=d=>o.$emit("update:modelValue",d)),onTabClick:r,class:"custom-tabs"},he({_:2},[z(t.tabs,(d,h)=>({name:`tab-${h}`,fn:K(()=>[e("div",at,[e("i",{class:D([u(d.key),"text-base md:text-base"])},null,2),e("span",st,f(d.label),1),d.count!==void 0?(l(),I($(me),{key:0,text:String(d.count),size:"small",theme:"gray",class:D(t.modelValue===d.key?"bg-gray-200 text-gray-700":"bg-gray-100 text-gray-500")},null,8,["text","class"])):m("",!0)])])}))]),1032,["tabs","modelValue"]))}},nt=xe(lt,[["__scopeId","data-v-848bb4cf"]]),ot={class:"metadata-bar w-full"},it={class:"flex items-center gap-1.5 md:gap-2 px-2 md:px-3 py-1.5"},rt={class:"flex items-center gap-1.5"},dt={class:"text-[10px] md:text-xs font-bold text-gray-800"},ut={class:"flex items-center gap-1.5 md:gap-2 px-2 md:px-3 py-1.5"},ct={class:"flex items-center gap-1.5 md:gap-2 px-2 md:px-3 py-1.5"},mt={class:"text-[10px] md:text-xs font-bold text-gray-800"},ft={__name:"StageOwnerBar",props:{stage:{type:String,required:!0},owner:{type:String,required:!0},source:{type:String,default:""},deliverySubstatus:{type:String,default:null}},emits:["reassign"],setup(t){const y=t;V(()=>y.deliverySubstatus?ke(y.deliverySubstatus):"");const s=V(()=>y.deliverySubstatus?y.deliverySubstatus==="Delivered"?"green":y.deliverySubstatus==="Awaiting Delivery"?"blue":"gray":"gray");return(g,a)=>(l(),i("div",ot,[e("div",it,[a[1]||(a[1]=e("span",{class:"label-upper text-[9px] md:text-xs"},"Stage",-1)),e("div",rt,[e("span",dt,f(t.stage),1),t.deliverySubstatus?(l(),I($(me),{key:0,text:t.deliverySubstatus,size:"small",theme:s.value},null,8,["text","theme"])):m("",!0)])]),a[5]||(a[5]=e("div",{class:"metadata-divider"},null,-1)),e("div",ut,[a[2]||(a[2]=e("span",{class:"label-upper text-[9px] md:text-xs"},"Owner",-1)),e("button",{onClick:a[0]||(a[0]=r=>g.$emit("reassign")),class:"text-[10px] md:text-xs font-bold text-blue-600 hover:text-blue-700 hover:underline transition-colors cursor-pointer"},f(t.owner),1)]),t.source?(l(),i(U,{key:0},[a[4]||(a[4]=e("div",{class:"metadata-divider"},null,-1)),e("div",ct,[a[3]||(a[3]=e("span",{class:"label-upper text-[9px] md:text-xs"},"Source",-1)),e("span",mt,f(t.source),1)])],64)):m("",!0)]))}},yt={key:0,class:"flex-grow border-t border-gray-200"},gt={key:0,class:"absolute top-full right-0 md:left-1/2 md:-translate-x-1/2 mt-2 w-48 bg-white border border-gray-200 rounded-xl shadow-lg shadow-gray-100/50 z-10 overflow-hidden flex flex-col p-1"},pt={key:0,class:"border-t border-gray-100 my-1"},bt={key:1,class:"flex-grow border-t border-gray-200"},vt={__name:"AddNewButton",props:{show:{type:Boolean,default:!0},actions:{type:Array,default:()=>["note","financing","tradein","attachment","email","whatsapp","sms"]},activeTab:{type:String,default:"overview"},inline:{type:Boolean,default:!1}},emits:["action"],setup(t,{emit:y}){const s={mounted(v,c){v.clickOutsideEvent=b=>{v===b.target||v.contains(b.target)||c.value()},document.addEventListener("click",v.clickOutsideEvent)},unmounted(v){document.removeEventListener("click",v.clickOutsideEvent)}},g=t,a=y,r=A(!1),p=V(()=>g.inline?"bg-blue-600 hover:bg-blue-700 text-white font-medium w-9 h-9 rounded-lg shadow-sm transition-all flex items-center justify-center z-20 relative":"bg-gray-50 hover:bg-white border border-gray-200 text-slate-700 font-medium w-9 h-9 rounded-full text-sm shadow-sm transition-all flex items-center justify-center z-20 relative"),u={note:"note",attachment:"attachment",email:"communication",whatsapp:"communication",sms:"communication"},o=V(()=>{if(!g.activeTab||g.activeTab==="overview")return g.actions.filter(c=>!u[c]);const v=Object.entries(u).filter(([,c])=>c===g.activeTab).map(([c])=>c);return g.actions.filter(c=>v.includes(c))}),n=V(()=>o.value.some(v=>["email","whatsapp","sms"].includes(v))),d=V(()=>o.value.some(v=>["addVehicle","configureVehicle"].includes(v))),h=V(()=>o.value.some(v=>["note","financing","tradein","attachment","requestedCar","purchase"].includes(v))),N=v=>{r.value=!1,a("action",v)};return(v,c)=>t.show?(l(),i("div",{key:0,class:D(["relative flex items-center",t.inline?"justify-end mb-0 py-0":"py-1 mb-4"])},[t.inline?m("",!0):(l(),i("div",yt)),e("div",{class:D(["relative",t.inline?"mx-0":"mx-4"])},[e("button",{onClick:c[0]||(c[0]=R(b=>r.value=!r.value,["stop"])),class:D(p.value)},[...c[12]||(c[12]=[e("i",{class:"fa-solid fa-plus text-xs"},null,-1)])],2),r.value?C((l(),i("div",gt,[d.value?(l(),i(U,{key:0},[o.value.includes("addVehicle")?(l(),i("button",{key:0,onClick:c[1]||(c[1]=b=>N("addVehicle")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Add Vehicle ")):m("",!0),o.value.includes("configureVehicle")?(l(),i("button",{key:1,onClick:c[2]||(c[2]=b=>N("configureVehicle")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Configure Vehicle ")):m("",!0)],64)):m("",!0),h.value?(l(),i(U,{key:1},[d.value?(l(),i("div",pt)):m("",!0),o.value.includes("note")?(l(),i("button",{key:1,onClick:c[3]||(c[3]=b=>N("note")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Note ")):m("",!0),o.value.includes("financing")?(l(),i("button",{key:2,onClick:c[4]||(c[4]=b=>N("financing")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Financing ")):m("",!0),o.value.includes("tradein")?(l(),i("button",{key:3,onClick:c[5]||(c[5]=b=>N("tradein")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Trade-in ")):m("",!0),o.value.includes("requestedCar")?(l(),i("button",{key:4,onClick:c[6]||(c[6]=b=>N("requestedCar")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Requested car ")):m("",!0),o.value.includes("purchase")?(l(),i("button",{key:5,onClick:c[7]||(c[7]=b=>N("purchase")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Purchase ")):m("",!0),o.value.includes("attachment")?(l(),i("button",{key:6,onClick:c[8]||(c[8]=b=>N("attachment")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Attachment ")):m("",!0)],64)):m("",!0),n.value?(l(),i(U,{key:2},[c[16]||(c[16]=e("div",{class:"border-t border-gray-100 my-1"},null,-1)),o.value.includes("email")?(l(),i("button",{key:0,onClick:c[9]||(c[9]=b=>N("email")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...c[13]||(c[13]=[e("i",{class:"fa-regular fa-envelope text-xs text-gray-400"},null,-1),T(" Send Email ",-1)])])):m("",!0),o.value.includes("whatsapp")?(l(),i("button",{key:1,onClick:c[10]||(c[10]=b=>N("whatsapp")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...c[14]||(c[14]=[e("i",{class:"fa-brands fa-whatsapp text-xs text-gray-400"},null,-1),T(" Send WhatsApp ",-1)])])):m("",!0),o.value.includes("sms")?(l(),i("button",{key:2,onClick:c[11]||(c[11]=b=>N("sms")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...c[15]||(c[15]=[e("i",{class:"fa-solid fa-comment-dots text-xs text-gray-400"},null,-1),T(" Send SMS ",-1)])])):m("",!0)],64)):m("",!0)])),[[s,()=>r.value=!1]]):m("",!0)],2),t.inline?m("",!0):(l(),i("div",bt))],2)):m("",!0)}},xt={class:"bg-purple-50/50 border border-purple-100 rounded-lg p-4"},ht={class:"flex items-start gap-3"},kt={class:"flex-1 min-w-0"},wt={class:"font-bold text-sm text-slate-800 mb-2"},$t={class:"space-y-1.5 text-xs text-gray-600"},Ct={class:"flex items-center gap-2"},St={class:"flex items-center gap-2"},At={class:"flex items-center gap-2"},Dt={key:0,class:"mt-2"},Tt={__name:"AppointmentWidget",props:{appointmentData:{type:Object,required:!0}},setup(t){const y=t,s=V(()=>y.appointmentData.date?new Date(y.appointmentData.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""),g=V(()=>y.appointmentData.time?y.appointmentData.time:""),a=r=>({scheduled:"bg-blue-100 text-blue-700 border border-blue-200",confirmed:"bg-green-100 text-green-700 border border-green-200",pending:"bg-yellow-100 text-yellow-700 border border-yellow-200",cancelled:"bg-red-100 text-red-700 border border-red-200"})[r==null?void 0:r.toLowerCase()]||"bg-gray-100 text-gray-700 border border-gray-200";return(r,p)=>(l(),i("div",xt,[e("div",ht,[p[3]||(p[3]=e("div",{class:"w-10 h-10 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center shrink-0"},[e("i",{class:"fa-solid fa-calendar text-sm"})],-1)),e("div",kt,[e("h4",wt,f(t.appointmentData.type),1),e("div",$t,[e("div",Ct,[p[0]||(p[0]=e("i",{class:"fa-regular fa-calendar text-gray-400"},null,-1)),e("span",null,f(s.value),1)]),e("div",St,[p[1]||(p[1]=e("i",{class:"fa-regular fa-clock text-gray-400"},null,-1)),e("span",null,f(g.value),1)]),e("div",At,[p[2]||(p[2]=e("i",{class:"fa-solid fa-user text-gray-400"},null,-1)),e("span",null,f(t.appointmentData.assignee),1)])]),t.appointmentData.status?(l(),i("div",Dt,[e("span",{class:D(["inline-flex px-2 py-0.5 rounded text-[10px] font-semibold",a(t.appointmentData.status)])},f(t.appointmentData.status),3)])):m("",!0)])])]))}},Ot={class:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm flex gap-4 animate-fade-in mb-4 feed-item"},qt={class:"flex-1"},Nt={class:"flex items-center gap-2 mb-1"},Vt={class:"text-xs font-bold text-slate-800"},Et={class:"text-[10px] text-gray-400"},It={class:"text-[10px] text-gray-400"},Ft={key:0,class:"bg-blue-50 text-blue-600 text-[9px] px-1.5 py-0.5 rounded border border-blue-100"},Ut={class:"ml-auto relative"},Mt={key:0,class:"absolute right-0 top-full mt-1 w-32 bg-white border border-gray-200 rounded-lg shadow-lg z-10 overflow-hidden"},jt={key:0,class:"text-sm text-slate-700"},Wt={key:1,class:"text-sm text-slate-700 flex items-center gap-2"},Lt={key:2,class:"mt-2"},Bt={key:0},Pt={key:1,class:"bg-gray-50 border border-gray-200 rounded-lg p-3"},Rt={key:0},zt={class:"text-sm font-bold text-slate-800"},Yt={key:0,class:"text-xs text-gray-600 mt-0.5"},Kt={class:"grid grid-cols-2 gap-x-4 gap-y-1 text-xs text-gray-500 mt-2"},Qt={key:0},Ht={key:1},Gt={key:2},Jt={key:3},Zt={key:4},Xt={key:1},_t={class:"text-sm font-bold text-slate-800 mb-2"},ea={class:"grid grid-cols-2 gap-x-4 gap-y-2 text-xs"},ta={key:0},aa={class:"text-slate-700 font-medium ml-1"},sa={key:1},la={class:"text-slate-700 font-medium ml-1"},na={key:2},oa={class:"text-slate-700 font-medium ml-1"},ia={key:3},ra={class:"text-slate-700 font-medium ml-1"},da={key:4},ua={class:"text-slate-700 font-medium ml-1"},ca={key:5},ma={class:"text-slate-700 font-medium ml-1"},fa={key:2,class:"flex items-center gap-3"},ya={key:0,class:"w-16 h-16 bg-gray-200 rounded overflow-hidden flex-shrink-0"},ga=["src"],pa={class:"flex-1"},ba={class:"text-sm font-bold text-slate-800"},va={class:"text-xs text-gray-500"},xa={key:1,class:"bg-purple-600 text-white text-[10px] font-bold px-2 py-0.5 rounded"},ha={key:3,class:"flex items-center gap-3"},ka={class:"flex-1"},wa={class:"text-sm font-bold text-slate-800"},$a={class:"text-xs text-gray-500"},Ca={key:0,class:"text-xs text-gray-400 mt-1"},Sa={key:1,class:"text-xs text-gray-600 mt-1"},ue={__name:"FeedItemCard",props:{item:{type:Object,required:!0},taskType:{type:String,default:"lead"},customerInitials:{type:String,required:!0}},emits:["edit","delete"],setup(t,{emit:y}){const s=t,g=y,a=A(!1),r={mounted(v,c){v.clickOutsideEvent=b=>{v===b.target||v.contains(b.target)||c.value()},setTimeout(()=>{document.addEventListener("click",v.clickOutsideEvent)},0)},unmounted(v){document.removeEventListener("click",v.clickOutsideEvent)}},p=v=>({note:"fa-regular fa-note-sticky",communication:"fa-solid fa-comment-dots",email:"fa-regular fa-envelope",whatsapp:"fa-brands fa-whatsapp",sms:"fa-solid fa-comment-dots",attachment:"fa-solid fa-paperclip",tradein:"fa-solid fa-car-side",financing:"fa-solid fa-file-invoice-dollar",offer:"fa-solid fa-handshake",purchase:"fa-solid fa-shopping-cart",appointment:"fa-solid fa-calendar"})[v]||"fa-solid fa-circle",u=v=>({note:"bg-orange-100 text-orange-600 border-orange-200",communication:"bg-gray-100 text-gray-600 border-gray-200",email:"bg-blue-100 text-blue-600 border-blue-200",whatsapp:"bg-green-100 text-green-600 border-green-200",sms:"bg-gray-100 text-gray-600 border-gray-200",attachment:"bg-blue-50 text-blue-600 border-blue-100",tradein:"bg-green-50 text-green-600 border-green-100",financing:"bg-purple-50 text-purple-600 border-purple-100",offer:"bg-indigo-50 text-indigo-600 border-indigo-100",purchase:"bg-teal-50 text-teal-600 border-teal-100",appointment:"bg-purple-100 text-purple-600 border-purple-200"})[v]||"bg-gray-100 text-gray-600 border-gray-200",o=v=>{if(!v)return"Just now";const c=new Date(v),q=new Date-c,w=Math.floor(q/6e4),E=Math.floor(w/60),M=Math.floor(E/24);return w<1?"Just now":w<60?`${w} minutes ago`:E<24?`${E} hours ago`:M===1?"Yesterday":M<7?`${M} days ago`:c.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},n=v=>v?new Intl.NumberFormat("en-US").format(v):"0",d=v=>v?new Date(v).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",h=()=>{a.value=!1,g("edit",s.item)},N=()=>{a.value=!1,confirm("Are you sure you want to delete this item?")&&g("delete",s.item)};return(v,c)=>(l(),i("div",Ot,[e("div",{class:D(["w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold shrink-0 border",u(t.item.type)])},[e("i",{class:D([p(t.item.type),"text-sm"])},null,2)],2),e("div",qt,[e("div",Nt,[e("span",Vt,f(t.customerInitials),1),e("span",Et,f(t.item.action||"added"),1),e("span",It,"• "+f(o(t.item.timestamp)),1),t.item.autoDetected?(l(),i("span",Ft,"Auto-detected")):m("",!0),e("div",Ut,[e("button",{onClick:c[0]||(c[0]=R(b=>a.value=!a.value,["stop"])),class:"text-gray-400 hover:text-gray-600 transition-colors p-1",title:"More actions"},[...c[1]||(c[1]=[e("i",{class:"fa-solid fa-ellipsis-vertical text-sm"},null,-1)])]),a.value?C((l(),i("div",Mt,[e("button",{onClick:h,class:"w-full text-left px-3 py-2 text-xs text-slate-700 hover:bg-gray-50 flex items-center gap-2"},[...c[2]||(c[2]=[e("i",{class:"fa-solid fa-pencil text-gray-400"},null,-1),T(" Edit ",-1)])]),e("button",{onClick:N,class:"w-full text-left px-3 py-2 text-xs text-red-600 hover:bg-red-50 flex items-center gap-2"},[...c[3]||(c[3]=[e("i",{class:"fa-solid fa-trash text-red-400"},null,-1),T(" Delete ",-1)])])])),[[r,()=>a.value=!1]]):m("",!0)])]),t.item.content?(l(),i("div",jt,f(t.item.content),1)):m("",!0),t.item.fileName?(l(),i("div",Wt,[c[4]||(c[4]=e("i",{class:"fa-solid fa-paperclip text-gray-400"},null,-1)),e("span",null,f(t.item.fileName),1)])):m("",!0),t.item.data?(l(),i("div",Lt,[t.item.type==="appointment"?(l(),i("div",Bt,[j(Tt,{"appointment-data":t.item.data},null,8,["appointment-data"])])):(l(),i("div",Pt,[t.item.type==="tradein"?(l(),i("div",Rt,[e("h4",zt,f(t.item.data.brand)+" "+f(t.item.data.model),1),t.item.data.version?(l(),i("p",Yt,f(t.item.data.version),1)):m("",!0),e("div",Kt,[t.item.data.year?(l(),i("div",Qt,[c[5]||(c[5]=e("i",{class:"fa-regular fa-calendar mr-1"},null,-1)),T(f(t.item.data.year),1)])):m("",!0),t.item.data.km?(l(),i("div",Ht,[c[6]||(c[6]=e("i",{class:"fa-solid fa-road mr-1"},null,-1)),T(f(t.item.data.km)+" km ",1)])):m("",!0),t.item.data.plate?(l(),i("div",Gt,[c[7]||(c[7]=e("i",{class:"fa-solid fa-id-card mr-1"},null,-1)),T(f(t.item.data.plate),1)])):m("",!0),t.item.data.date?(l(),i("div",Jt,[c[8]||(c[8]=e("i",{class:"fa-regular fa-calendar-check mr-1"},null,-1)),T(f(d(t.item.data.date)),1)])):m("",!0),t.item.data.class?(l(),i("div",Zt,[c[9]||(c[9]=e("i",{class:"fa-solid fa-car mr-1"},null,-1)),T(f(t.item.data.class),1)])):m("",!0)])])):t.item.type==="financing"?(l(),i("div",Xt,[e("h4",_t,f(t.item.data.product),1),e("div",ea,[t.item.data.provider?(l(),i("div",ta,[c[10]||(c[10]=e("span",{class:"text-gray-500"},"Provider:",-1)),e("span",aa,f(t.item.data.provider),1)])):m("",!0),t.item.data.total?(l(),i("div",sa,[c[11]||(c[11]=e("span",{class:"text-gray-500"},"Total:",-1)),e("span",la,"€"+f(n(t.item.data.total)),1)])):m("",!0),t.item.data.monthly?(l(),i("div",na,[c[12]||(c[12]=e("span",{class:"text-gray-500"},"Monthly:",-1)),e("span",oa,"€"+f(n(t.item.data.monthly)),1)])):m("",!0),t.item.data.deposit?(l(),i("div",ia,[c[13]||(c[13]=e("span",{class:"text-gray-500"},"Deposit:",-1)),e("span",ra,"€"+f(n(t.item.data.deposit)),1)])):m("",!0),t.item.data.startDate?(l(),i("div",da,[c[14]||(c[14]=e("span",{class:"text-gray-500"},"Start:",-1)),e("span",ua,f(d(t.item.data.startDate)),1)])):m("",!0),t.item.data.expDate?(l(),i("div",ca,[c[15]||(c[15]=e("span",{class:"text-gray-500"},"Expires:",-1)),e("span",ma,f(d(t.item.data.expDate)),1)])):m("",!0)])])):t.item.type==="offer"?(l(),i("div",fa,[t.item.data.image?(l(),i("div",ya,[e("img",{src:t.item.data.image,alt:"Car",class:"w-full h-full object-cover"},null,8,ga)])):m("",!0),e("div",pa,[e("h4",ba,f(t.item.data.brand)+" "+f(t.item.data.model)+" ("+f(t.item.data.year)+")",1),e("p",va,"€ "+f(n(t.item.data.price)),1)]),t.item.data.isMainOffer?(l(),i("span",xa,"Main Offer")):m("",!0)])):t.item.type==="purchase"?(l(),i("div",ha,[e("div",ka,[e("h4",wa,f(t.item.data.brand)+" "+f(t.item.data.model)+" ("+f(t.item.data.year)+")",1),e("p",$a,"€ "+f(n(t.item.data.price)),1),t.item.data.purchaseDate?(l(),i("p",Ca,"Purchased: "+f(d(t.item.data.purchaseDate)),1)):m("",!0),t.item.data.notes?(l(),i("p",Sa,f(t.item.data.notes),1)):m("",!0)])])):m("",!0)]))])):m("",!0)])]))}},Aa={class:"h-16 px-5 border-b border-gray-100 bg-gray-50/50 flex items-center justify-between gap-3"},Da={class:"flex items-center gap-3"},Ta=["title"],Oa={key:0,class:"fa-solid fa-arrow-left text-sm"},qa={key:1,class:"fa-solid fa-arrow-right text-sm"},Na={key:2,class:"font-bold text-lg text-gray-800"},Va={key:0,class:"flex-1 overflow-y-auto px-5 py-6 scrollbar-hide relative"},Ea={key:0,class:"absolute left-[39px] top-0 bottom-0 w-0.5 bg-gray-200 z-0"},Ia={key:1,class:"text-center py-8 text-gray-400 relative z-10"},Fa={class:"text-sm"},Ua={key:2,class:"space-y-6 relative z-10"},Ma={key:0,class:"mb-4 pl-12"},ja={class:"text-sm font-semibold text-gray-800"},Wa={class:"flex gap-4 relative mb-6"},La={class:"flex-1 min-w-0"},Ba={class:"text-sm text-slate-700 leading-snug"},Pa={class:"font-bold"},Ra={key:0,class:"mt-2 bg-orange-50/50 border border-orange-100 p-3 rounded-lg text-sm text-gray-700"},za={class:"text-xs text-gray-400 mt-1"},Ya={key:1,class:"flex-1 overflow-y-auto py-6 scrollbar-hide relative flex flex-col items-center"},Ka={key:0,class:"absolute left-1/2 top-0 bottom-0 w-0.5 bg-gray-200 -translate-x-1/2 z-0"},Qa={key:1,class:"space-y-4 relative z-10"},Ha=["title"],Ga={key:2,class:"text-center py-8 text-gray-400 relative z-10"},Ja={__name:"ActivitySummarySidebar",props:{title:{type:String,default:"Activity summary"},activities:{type:Array,default:()=>[]},emptyMessage:{type:String,default:"No activities yet"},collapsed:{type:Boolean,default:!0},showCollapse:{type:Boolean,default:!0},show:{type:Boolean,default:!0},mobileFullscreen:{type:Boolean,default:!1}},emits:["toggle-collapse","close"],setup(t,{emit:y}){const s=t,g=o=>{const n={call:"fa-solid fa-phone text-blue-600",email:"fa-solid fa-envelope text-green-600",note:"fa-solid fa-sticky-note text-yellow-600",meeting:"fa-solid fa-calendar text-purple-600",task:"fa-solid fa-check-circle text-indigo-600",attachment:"fa-solid fa-paperclip text-gray-600",status:"fa-solid fa-tag text-orange-600",default:"fa-solid fa-circle text-gray-400"};return n[o]||n.default},a=o=>{const n={call:"bg-blue-100 text-blue-600",email:"bg-green-100 text-green-600",note:"bg-yellow-100 text-yellow-600",meeting:"bg-purple-100 text-purple-600",task:"bg-indigo-100 text-indigo-600",attachment:"bg-gray-100 text-gray-600",status:"bg-orange-100 text-orange-600",default:"bg-gray-100 text-gray-400"};return n[o]||n.default},r=o=>{if(!o)return"";const n=new Date(o),d=new Date,h=new Date(d);return h.setDate(h.getDate()-1),n.toDateString()===d.toDateString()?"Today":n.toDateString()===h.toDateString()?"Yesterday":n.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},p=o=>o?new Date(o).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",u=(o,n)=>{if(o===0)return!0;const d=s.activities[o-1];if(!d)return!0;const h=new Date(n.timestamp).toDateString(),N=new Date(d.timestamp).toDateString();return h!==N};return(o,n)=>t.show?(l(),i("div",{key:0,class:D(["bg-white border-l border-gray-200 shrink-0 flex flex-col transition-all duration-300",[t.collapsed?"w-16":"w-80",t.mobileFullscreen?"xl:relative xl:border-l":""]])},[e("div",Aa,[e("div",Da,[t.mobileFullscreen?(l(),i("button",{key:0,onClick:n[0]||(n[0]=d=>o.$emit("close")),class:"xl:hidden w-8 h-8 flex items-center justify-center text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"},[...n[2]||(n[2]=[e("i",{class:"fa-solid fa-xmark text-lg"},null,-1)])])):t.showCollapse?(l(),i("button",{key:1,onClick:n[1]||(n[1]=d=>o.$emit("toggle-collapse")),class:"w-8 h-8 flex items-center justify-center rounded-md text-gray-400 hover:text-gray-900 hover:bg-gray-100 transition-colors shrink-0",title:t.collapsed?"Expand sidebar":"Collapse sidebar"},[t.collapsed?(l(),i("i",Oa)):(l(),i("i",qa))],8,Ta)):m("",!0),t.collapsed?m("",!0):(l(),i("h2",Na,f(t.title),1))])]),t.collapsed?(l(),i("div",Ya,[t.activities.length>0?(l(),i("div",Ka)):m("",!0),t.activities.length>0?(l(),i("div",Qa,[(l(!0),i(U,null,z(t.activities,d=>(l(),i("div",{key:d.id,class:"relative"},[e("div",{class:D(["w-8 h-8 rounded-full flex items-center justify-center shrink-0 z-10 relative bg-white border-2 border-gray-200",a(d.type)]),title:`${d.user} ${d.action}`},[e("i",{class:D([g(d.type),"text-xs"])},null,2)],10,Ha)]))),128))])):(l(),i("div",Ga,[...n[4]||(n[4]=[e("i",{class:"fa-solid fa-clock text-2xl mb-2"},null,-1)])]))])):(l(),i("div",Va,[t.activities.length>0?(l(),i("div",Ea)):m("",!0),t.activities.length===0?(l(),i("div",Ia,[n[3]||(n[3]=e("i",{class:"fa-solid fa-clock text-4xl mb-2"},null,-1)),e("p",Fa,f(t.emptyMessage),1)])):(l(),i("div",Ua,[(l(!0),i(U,null,z(t.activities,(d,h)=>(l(),i(U,{key:d.id},[u(h,d)?(l(),i("div",Ma,[e("h3",ja,f(r(d.timestamp)),1)])):m("",!0),e("div",Wa,[e("div",{class:D(["w-10 h-10 rounded-full flex items-center justify-center shrink-0 z-10 relative bg-white",a(d.type)])},[e("i",{class:D([g(d.type),"text-sm"])},null,2)],2),e("div",La,[e("div",Ba,[e("span",Pa,f(d.user),1),T(" "+f(d.action),1)]),d.content?(l(),i("div",Ra,f(d.content),1)):m("",!0),e("div",za,f(p(d.timestamp)),1)])])],64))),128))]))]))],2)):m("",!0)}},Za={class:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm mb-6 animate-fade-in relative"},Xa={class:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3"},_a={class:"mb-3"},es={class:"flex justify-end gap-2"},ts={__name:"CommunicationWidget",props:{type:{type:String,required:!0},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(t,{emit:y}){const s=t,g=y,a=A(""),r=A(""),p=()=>{!a.value.trim()&&!r.value||g("save",{type:"communication",action:`sent via ${s.type}`,content:a.value||`Sent template: ${r.value}`,communicationType:s.type})};return(u,o)=>(l(),i("div",Za,[o[5]||(o[5]=e("div",{class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-t border-l border-gray-200 rotate-45"},null,-1)),e("h5",Xa,f(t.type==="email"?"Send Email":t.type==="whatsapp"?"Send WhatsApp":t.type==="sms"?"Send SMS":"Send Message"),1),e("div",_a,[o[4]||(o[4]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Template",-1)),C(e("select",{"onUpdate:modelValue":o[0]||(o[0]=n=>r.value=n),class:"w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500 cursor-pointer"},[...o[3]||(o[3]=[e("option",{value:""},"Select a template...",-1),e("option",null,"Follow-up",-1),e("option",null,"Meeting Confirmation",-1),e("option",null,"Quote Proposal",-1),e("option",null,"Unable to Reach",-1)])],512),[[le,r.value]])]),C(e("textarea",{"onUpdate:modelValue":o[1]||(o[1]=n=>a.value=n),class:"w-full bg-gray-50 border border-gray-200 rounded-lg p-3 text-sm focus:outline-none focus:border-blue-500 resize-none mb-3",rows:"4",placeholder:"Type your message here..."},null,512),[[O,a.value]]),e("div",es,[e("button",{onClick:o[2]||(o[2]=n=>u.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:p,class:"bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Send")])]))}},as={class:"bg-white border border-gray-200 rounded-xl p-5 shadow-sm mb-6 animate-fade-in relative"},ss={class:"flex justify-between items-center mb-4"},ls={class:"text-sm font-bold text-slate-800"},ns={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},os={__name:"NoteWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(t,{emit:y}){const s=t,g=y,a=A("");Q(()=>{s.item&&(a.value=s.item.content||"")});const r=()=>{var p,u;a.value.trim()&&g("save",{id:((p=s.item)==null?void 0:p.id)||Date.now(),type:"note",action:s.item?"updated a note":"added a note",content:a.value,timestamp:((u=s.item)==null?void 0:u.timestamp)||new Date().toISOString(),isEdit:!!s.item})};return(p,u)=>(l(),i("div",as,[u[5]||(u[5]=e("div",{class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-t border-l border-gray-200 rotate-45"},null,-1)),e("div",ss,[e("h5",ls,f(t.item?"Edit Note":"Add Note"),1),e("button",{onClick:u[0]||(u[0]=o=>p.$emit("cancel")),class:"text-gray-400 hover:text-gray-600"},[...u[3]||(u[3]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),e("div",null,[u[4]||(u[4]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Note",-1)),C(e("textarea",{"onUpdate:modelValue":u[1]||(u[1]=o=>a.value=o),rows:"4",class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500 placeholder-gray-400 transition-colors shadow-sm resize-none",placeholder:"Enter your note..."},null,512),[[O,a.value]])]),e("div",ns,[e("button",{onClick:u[2]||(u[2]=o=>p.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:r,class:"bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save")])]))}},is={class:"bg-white border border-gray-200 rounded-xl p-5 shadow-sm mb-6 animate-fade-in relative"},rs={class:"flex justify-between items-center mb-4"},ds={class:"text-sm font-bold text-slate-800"},us={class:"flex items-center gap-3"},cs={key:0,class:"text-sm text-slate-600"},ms={key:1,class:"text-sm text-gray-400"},fs={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},ys=["disabled"],gs={__name:"AttachmentWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(t,{emit:y}){const s=t,g=y,a=A(null),r=A("");Q(()=>{s.item&&(r.value=s.item.fileName||"")});const p=o=>{const n=o.target.files[0];n&&(a.value=n,r.value=n.name)},u=()=>{var o,n;!a.value&&!s.item||g("save",{id:((o=s.item)==null?void 0:o.id)||Date.now(),type:"attachment",action:s.item?"updated an attachment":"added an attachment",fileName:r.value,timestamp:((n=s.item)==null?void 0:n.timestamp)||new Date().toISOString(),isEdit:!!s.item})};return(o,n)=>(l(),i("div",is,[n[6]||(n[6]=e("div",{class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-t border-l border-gray-200 rotate-45"},null,-1)),e("div",rs,[e("h5",ds,f(t.item?"Edit Attachment":"Add Attachment"),1),e("button",{onClick:n[0]||(n[0]=d=>o.$emit("cancel")),class:"text-gray-400 hover:text-gray-600"},[...n[3]||(n[3]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),e("div",null,[n[5]||(n[5]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"File",-1)),e("div",us,[e("input",{type:"file",onChange:p,ref:"fileInput",class:"hidden"},null,544),e("button",{onClick:n[1]||(n[1]=d=>o.$refs.fileInput.click()),class:"bg-gray-50 hover:bg-gray-100 border border-gray-300 rounded-md px-4 py-2 text-sm text-slate-700 transition-colors"},[...n[4]||(n[4]=[e("i",{class:"fa-solid fa-paperclip mr-2"},null,-1),T("Choose File ",-1)])]),r.value?(l(),i("span",cs,f(r.value),1)):(l(),i("span",ms,"No file selected"))])]),e("div",fs,[e("button",{onClick:n[2]||(n[2]=d=>o.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:u,disabled:!a.value,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save",8,ys)])]))}},ps={class:"animate-fade-in"},bs={class:"space-y-4"},vs={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},xs={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},hs={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},ks=["disabled"],ws={__name:"FinancingWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:[String,Number],required:!0}},emits:["save","cancel"],setup(t,{emit:y}){const s=t,g=y,a=A({startDate:"",expDate:"",productName:"",deposit:"",loanAmount:""});Q(()=>{s.item&&s.item.data&&(a.value={startDate:s.item.data.startDate||"",expDate:s.item.data.expDate||"",productName:s.item.data.product||s.item.data.productName||"",deposit:s.item.data.deposit||"",loanAmount:s.item.data.total||s.item.data.loanAmount||""})});const r=()=>{var p,u;a.value.productName&&g("save",{id:((p=s.item)==null?void 0:p.id)||Date.now(),type:"financing",action:s.item?"updated a financing proposal":"added a financing proposal",data:{product:a.value.productName,provider:"Audi Financial",total:a.value.loanAmount||"0",monthly:Math.round(parseFloat(a.value.loanAmount||0)/36).toString(),startDate:a.value.startDate,expDate:a.value.expDate,deposit:a.value.deposit},timestamp:((u=s.item)==null?void 0:u.timestamp)||new Date().toISOString(),isEdit:!!s.item})};return(p,u)=>(l(),i("div",ps,[e("div",bs,[e("div",vs,[e("div",null,[u[6]||(u[6]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Start date",-1)),C(e("input",{type:"date","onUpdate:modelValue":u[0]||(u[0]=o=>a.value.startDate=o),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.startDate]])]),e("div",null,[u[7]||(u[7]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Expiration date",-1)),C(e("input",{type:"date","onUpdate:modelValue":u[1]||(u[1]=o=>a.value.expDate=o),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.expDate]])])]),e("div",null,[u[8]||(u[8]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Financial product name",-1)),C(e("input",{type:"text","onUpdate:modelValue":u[2]||(u[2]=o=>a.value.productName=o),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.productName]])]),e("div",xs,[e("div",null,[u[9]||(u[9]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Deposit",-1)),C(e("input",{type:"number","onUpdate:modelValue":u[3]||(u[3]=o=>a.value.deposit=o),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.deposit]])]),e("div",null,[u[10]||(u[10]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Total loan amount",-1)),C(e("input",{type:"number","onUpdate:modelValue":u[4]||(u[4]=o=>a.value.loanAmount=o),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.loanAmount]])])])]),e("div",hs,[e("button",{onClick:u[5]||(u[5]=o=>p.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:r,disabled:!a.value.productName,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save",8,ks)])]))}},$s={class:"animate-fade-in"},Cs={class:"space-y-4"},Ss={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},As={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ds={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},Ts=["disabled"],Os={__name:"TradeInWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:[String,Number],required:!0}},emits:["save","cancel"],setup(t,{emit:y}){const s=t,g=y,a=A({class:"Car",brand:"",model:"",version:"",km:"",plate:"",date:""});Q(()=>{s.item&&s.item.data&&(a.value={class:s.item.data.class||"Car",brand:s.item.data.brand||"",model:s.item.data.model||"",version:s.item.data.version||"",km:s.item.data.km||"",plate:s.item.data.plate||"",date:s.item.data.date||""})});const r=()=>{var p,u;a.value.brand&&g("save",{id:((p=s.item)==null?void 0:p.id)||Date.now(),type:"tradein",action:s.item?"updated a trade-in":"added a trade-in",data:{class:a.value.class,brand:a.value.brand,model:a.value.model||"Unknown Model",year:a.value.date?new Date(a.value.date).getFullYear():"Unknown Year",km:a.value.km||"0",plate:a.value.plate||"",date:a.value.date||""},timestamp:((u=s.item)==null?void 0:u.timestamp)||new Date().toISOString(),isEdit:!!s.item})};return(p,u)=>(l(),i("div",$s,[e("div",Cs,[e("div",null,[u[9]||(u[9]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Class",-1)),C(e("select",{"onUpdate:modelValue":u[0]||(u[0]=o=>a.value.class=o),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},[...u[8]||(u[8]=[e("option",{value:"Car"},"Car",-1),e("option",{value:"Motorcycle"},"Motorcycle",-1),e("option",{value:"Truck"},"Truck",-1)])],512),[[le,a.value.class]])]),e("div",Ss,[e("div",null,[u[10]||(u[10]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Brand",-1)),C(e("input",{type:"text","onUpdate:modelValue":u[1]||(u[1]=o=>a.value.brand=o),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.brand]])]),e("div",null,[u[11]||(u[11]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Model",-1)),C(e("input",{type:"text","onUpdate:modelValue":u[2]||(u[2]=o=>a.value.model=o),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.model]])])]),e("div",null,[u[12]||(u[12]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Version",-1)),C(e("input",{type:"text","onUpdate:modelValue":u[3]||(u[3]=o=>a.value.version=o),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.version]])]),e("div",As,[e("div",null,[u[13]||(u[13]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Km",-1)),C(e("input",{type:"number","onUpdate:modelValue":u[4]||(u[4]=o=>a.value.km=o),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.km]])]),e("div",null,[u[14]||(u[14]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Plate",-1)),C(e("input",{type:"text","onUpdate:modelValue":u[5]||(u[5]=o=>a.value.plate=o),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.plate]])])]),e("div",null,[u[15]||(u[15]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Registration date",-1)),C(e("input",{type:"date","onUpdate:modelValue":u[6]||(u[6]=o=>a.value.date=o),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.date]])])]),e("div",Ds,[e("button",{onClick:u[7]||(u[7]=o=>p.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:r,disabled:!a.value.brand,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save",8,Ts)])]))}},qs={class:"bg-white rounded-xl p-5 mb-6 animate-fade-in relative"},Ns={class:"flex justify-between items-center mb-4"},Vs={class:"text-sm font-bold text-slate-800"},Es={key:0,class:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200"},Is={class:"flex items-center gap-3"},Fs={class:"w-16 h-16 bg-gray-200 rounded overflow-hidden flex-shrink-0"},Us=["src"],Ms={key:1,class:"fa-solid fa-car text-gray-400 w-full h-full flex items-center justify-center"},js={class:"font-bold text-sm text-gray-800"},Ws={class:"text-xs text-gray-500"},Ls={class:"space-y-4"},Bs={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ps={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},Rs=["disabled"],zs={__name:"OfferWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"opportunity"},taskId:{type:Number,required:!0},selectedVehicle:{type:Object,default:null}},emits:["save","cancel"],setup(t,{emit:y}){const s=t,g=y,a=A({price:0,financingType:"",downPayment:0,monthlyPayment:0,term:36,interestRate:3.5,deliveryDate:"",validUntil:"",notes:"",brand:"",model:"",year:"",image:""});Q(()=>{if(s.selectedVehicle){a.value.price=s.selectedVehicle.price||0,a.value.brand=s.selectedVehicle.brand||"",a.value.model=s.selectedVehicle.model||"",a.value.year=s.selectedVehicle.year||"",a.value.image=s.selectedVehicle.image||"";const o=new Date;o.setDate(o.getDate()+30),a.value.validUntil=o.toISOString().split("T")[0]}s.item&&s.item.data&&(a.value={...a.value,...s.item.data,price:s.item.data.price||s.item.data.total||0,financingType:s.item.data.financingType||s.item.data.paymentMethod||"",notes:s.item.data.notes||s.item.data.description||""})}),Z(()=>s.selectedVehicle,o=>{o&&!s.item&&(a.value.price=o.price||0,a.value.brand=o.brand||"",a.value.model=o.model||"",a.value.year=o.year||"",a.value.image=o.image||"")});const r=V(()=>a.value.price>0&&a.value.financingType!==""),p=o=>o?o.toLocaleString("en-US"):"0",u=()=>{var n,d;if(!r.value)return;const o={id:((n=s.item)==null?void 0:n.id)||Date.now(),type:"offer",action:s.item?"updated an offer":"created an offer",data:{brand:a.value.brand,model:a.value.model,year:a.value.year,price:a.value.price,total:a.value.price,paymentMethod:a.value.financingType,financingType:a.value.financingType,downPayment:a.value.downPayment,monthlyPayment:a.value.monthlyPayment,term:a.value.term,interestRate:a.value.interestRate,deliveryDate:a.value.deliveryDate,validUntil:a.value.validUntil,notes:a.value.notes,description:a.value.notes,image:a.value.image},timestamp:((d=s.item)==null?void 0:d.timestamp)||new Date().toISOString(),isEdit:!!s.item};g("save",o)};return(o,n)=>(l(),i("div",qs,[e("div",Ns,[e("h5",Vs,f(t.item?"Edit Offer":"Create Offer"),1),e("button",{onClick:n[0]||(n[0]=d=>o.$emit("cancel")),class:"text-gray-400 hover:text-gray-600"},[...n[11]||(n[11]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),t.selectedVehicle?(l(),i("div",Es,[n[12]||(n[12]=e("p",{class:"text-xs text-gray-500 mb-2"},"Creating offer for:",-1)),e("div",Is,[e("div",Fs,[t.selectedVehicle.image?(l(),i("img",{key:0,src:t.selectedVehicle.image,alt:"Vehicle",class:"w-full h-full object-cover"},null,8,Us)):(l(),i("i",Ms))]),e("div",null,[e("h4",js,f(t.selectedVehicle.brand)+" "+f(t.selectedVehicle.model)+" ("+f(t.selectedVehicle.year)+") ",1),e("p",Ws,"Base Price: € "+f(p(t.selectedVehicle.price)),1)])])])):m("",!0),e("div",Ls,[e("div",null,[n[13]||(n[13]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},[T(" Offer Price (€) "),e("span",{class:"text-red-500"},"*")],-1)),C(e("input",{type:"number","onUpdate:modelValue":n[1]||(n[1]=d=>a.value.price=d),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500",placeholder:"Enter offer price"},null,512),[[O,a.value.price]])]),e("div",null,[n[15]||(n[15]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},[T(" Payment Method "),e("span",{class:"text-red-500"},"*")],-1)),C(e("select",{"onUpdate:modelValue":n[2]||(n[2]=d=>a.value.financingType=d),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500"},[...n[14]||(n[14]=[e("option",{value:""},"Select payment method",-1),e("option",{value:"cash"},"Cash",-1),e("option",{value:"finance"},"Finance",-1),e("option",{value:"lease"},"Lease",-1)])],512),[[le,a.value.financingType]])]),a.value.financingType==="finance"||a.value.financingType==="lease"?(l(),i("div",Bs,[e("div",null,[n[16]||(n[16]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Down Payment (€)",-1)),C(e("input",{type:"number","onUpdate:modelValue":n[3]||(n[3]=d=>a.value.downPayment=d),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500",placeholder:"0"},null,512),[[O,a.value.downPayment]])]),e("div",null,[n[17]||(n[17]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Monthly Payment (€)",-1)),C(e("input",{type:"number","onUpdate:modelValue":n[4]||(n[4]=d=>a.value.monthlyPayment=d),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500",placeholder:"Calculated automatically"},null,512),[[O,a.value.monthlyPayment]])]),e("div",null,[n[18]||(n[18]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Term (months)",-1)),C(e("input",{type:"number","onUpdate:modelValue":n[5]||(n[5]=d=>a.value.term=d),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500",placeholder:"36"},null,512),[[O,a.value.term]])]),e("div",null,[n[19]||(n[19]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Interest Rate (%)",-1)),C(e("input",{type:"number",step:"0.1","onUpdate:modelValue":n[6]||(n[6]=d=>a.value.interestRate=d),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500",placeholder:"3.5"},null,512),[[O,a.value.interestRate]])])])):m("",!0),e("div",null,[n[20]||(n[20]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Expected Delivery Date",-1)),C(e("input",{type:"date","onUpdate:modelValue":n[7]||(n[7]=d=>a.value.deliveryDate=d),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500"},null,512),[[O,a.value.deliveryDate]])]),e("div",null,[n[21]||(n[21]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Offer Valid Until",-1)),C(e("input",{type:"date","onUpdate:modelValue":n[8]||(n[8]=d=>a.value.validUntil=d),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500"},null,512),[[O,a.value.validUntil]])]),e("div",null,[n[22]||(n[22]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Notes / Special Terms",-1)),C(e("textarea",{"onUpdate:modelValue":n[9]||(n[9]=d=>a.value.notes=d),rows:"3",class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500 resize-none",placeholder:"Any special terms, conditions, or notes about this offer..."},null,512),[[O,a.value.notes]])])]),e("div",Ps,[e("button",{onClick:n[10]||(n[10]=d=>o.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"}," Cancel "),e("button",{onClick:u,disabled:!r.value,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},f(t.item?"Update Offer":"Create Offer"),9,Rs)])]))}},Ys={key:0,class:"mb-8"},Ks={class:"flex items-center gap-2 mb-4"},Qs={class:"font-bold text-gray-800 text-sm"},Hs={class:"bg-white border border-gray-200 rounded-xl shadow-sm mb-6 overflow-hidden"},Gs={class:"p-4"},Js={class:"flex items-center justify-between"},Zs={class:"flex items-center gap-4"},Xs={class:"w-16 h-12 bg-gray-200 rounded-md overflow-hidden shrink-0 border border-gray-100"},_s=["src"],el={key:1,class:"fa-solid fa-car text-3xl text-gray-400 w-full h-full flex items-center justify-center"},tl={class:"flex items-center gap-2"},al={class:"font-bold text-slate-800 text-sm md:text-base"},sl={class:"mt-1.5 flex items-center gap-2"},ll={key:0,class:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-green-50 border border-green-100 text-green-700 text-[10px] font-semibold rounded-md"},nl={key:1,class:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-orange-50 border border-orange-100 text-orange-700 text-[10px] font-semibold rounded-md"},ol={key:2,class:"hidden sm:flex items-center gap-1.5 bg-gray-100 hover:bg-gray-200 border border-gray-200 text-slate-700 text-xs font-semibold px-3 py-1.5 rounded-full transition-colors group/btn"},il={class:"flex items-center gap-4"},rl={key:0,class:"text-right"},dl={class:"font-bold text-slate-800"},ul={class:"border-t border-gray-200"},cl={class:"font-medium"},ml={key:0,class:"border-t border-gray-100 p-6 bg-gray-50/30 text-sm animate-fade-in"},fl={class:"mb-6"},yl={class:"grid grid-cols-2 md:grid-cols-4 gap-y-4 gap-x-6"},gl={key:0},pl={class:"font-medium text-slate-700"},bl={key:1},vl={class:"font-medium text-slate-700"},xl={key:2},hl={class:"font-medium text-slate-700"},kl={class:"font-medium text-slate-700"},wl={class:"grid grid-cols-2 md:grid-cols-4 gap-y-4 gap-x-6"},$l={key:0},Cl={class:"font-medium text-slate-700"},Sl={key:1},Al={class:"font-medium text-slate-700"},Dl={key:2},Tl={class:"font-medium text-slate-700"},Ol={key:3},ql={class:"font-medium text-slate-700"},Nl={key:4},Vl={class:"font-mono text-xs bg-white border border-gray-200 px-2 py-1 rounded inline-block text-gray-600"},El={key:5},Il={class:"font-medium text-slate-700"},Fl={key:0,class:"mt-6 flex justify-end"},Ul={key:0,class:"border-t border-gray-200 my-6"},Ml={key:1,class:"mb-6 px-6"},jl={class:"bg-white border border-gray-200 rounded-lg p-4"},Wl={class:"text-sm text-slate-700 leading-relaxed"},Ll={__name:"VehicleWidget",props:{show:{type:Boolean,default:!0},label:{type:String,default:"Requested Car"},brand:{type:String,required:!0},model:{type:String,required:!0},year:{type:[Number,String],required:!0},image:{type:String,default:""},price:{type:Number,default:null},requestMessage:{type:String,default:""},requestType:{type:String,default:""},source:{type:String,default:""},dealership:{type:String,default:""},registration:{type:String,default:""},kilometers:{type:Number,default:null},fuelType:{type:String,default:""},gearType:{type:String,default:""},vin:{type:String,default:""},stockDays:{type:Number,default:null},showOpenAd:{type:Boolean,default:!0},showTechnicalSpecs:{type:Boolean,default:!0},channel:{type:String,default:"Email"},adCampaign:{type:String,default:""},expectedPurchaseDate:{type:String,default:""},fiscalEntity:{type:String,default:""},sourceDetails:{type:String,default:""},adMedium:{type:String,default:""},adSource:{type:String,default:""}},setup(t){const y=A(!1),s=a=>new Intl.NumberFormat("en-US").format(a),g=a=>new Intl.NumberFormat("en-US").format(a);return(a,r)=>t.show?(l(),i("div",Ys,[e("div",Ks,[r[1]||(r[1]=e("i",{class:"fa-solid fa-thumbtack text-gray-400 text-xs"},null,-1)),e("h3",Qs,f(t.label),1)]),e("div",Hs,[e("div",Gs,[e("div",Js,[e("div",Zs,[e("div",Xs,[t.image?(l(),i("img",{key:0,src:t.image,alt:"Car",class:"w-full h-full object-cover"},null,8,_s)):(l(),i("i",el))]),e("div",null,[e("div",tl,[e("div",al,f(t.brand)+" "+f(t.model)+" ("+f(t.year)+")",1)]),e("div",sl,[t.stockDays!==void 0&&t.stockDays!==null?(l(),i("div",ll,[r[2]||(r[2]=e("div",{class:"w-1 h-1 bg-green-500 rounded-full"},null,-1)),T(" In stock ("+f(t.stockDays)+" days) ",1)])):(l(),i("div",nl,[...r[3]||(r[3]=[e("div",{class:"w-1 h-1 bg-orange-500 rounded-full"},null,-1),T(" Out of stock ",-1)])])),t.showOpenAd&&t.price?(l(),i("button",ol,[...r[4]||(r[4]=[T(" Open Ad ",-1),e("i",{class:"fa-solid fa-arrow-up-right-from-square text-[10px] text-gray-400 group-hover/btn:text-gray-800"},null,-1)])])):m("",!0)])])]),e("div",il,[t.price?(l(),i("div",rl,[r[5]||(r[5]=e("div",{class:"text-xs text-gray-500 font-medium mb-0.5"},"Price",-1)),e("div",dl,"€ "+f(s(t.price)),1)])):m("",!0)])])]),e("div",ul,[e("button",{onClick:r[0]||(r[0]=p=>y.value=!y.value),class:"w-full p-3 flex items-center justify-center gap-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-50 transition-colors"},[e("span",cl,f(y.value?"Hide":"View")+" Details",1),e("i",{class:D(["fa-solid fa-chevron-down text-xs transition-transform duration-200",{"rotate-180":y.value}])},null,2)])]),y.value?(l(),i("div",ml,[e("div",fl,[r[16]||(r[16]=e("h4",{class:"text-xs font-bold uppercase text-gray-500 tracking-wider mb-4"},"REQUEST DETAILS",-1)),e("div",yl,[t.requestType?(l(),i("div",gl,[r[6]||(r[6]=e("div",{class:"text-xs text-gray-500 mb-1"},"Request type",-1)),e("div",pl,f(t.requestType),1)])):m("",!0),t.source?(l(),i("div",bl,[r[7]||(r[7]=e("div",{class:"text-xs text-gray-500 mb-1"},"Source",-1)),e("div",vl,f(t.source),1)])):m("",!0),e("div",null,[r[8]||(r[8]=e("div",{class:"text-xs text-gray-500 mb-1"},"Source details",-1)),e("div",{class:D(["font-medium",t.sourceDetails?"text-slate-700":"text-gray-400"])},f(t.sourceDetails||"--"),3)]),t.dealership?(l(),i("div",xl,[r[9]||(r[9]=e("div",{class:"text-xs text-gray-500 mb-1"},"Dealership",-1)),e("div",hl,f(t.dealership),1)])):m("",!0),e("div",null,[r[10]||(r[10]=e("div",{class:"text-xs text-gray-500 mb-1"},"Channel",-1)),e("div",kl,f(t.channel||"Email"),1)]),e("div",null,[r[11]||(r[11]=e("div",{class:"text-xs text-gray-500 mb-1"},"AdCampaign",-1)),e("div",{class:D(["font-medium",t.adCampaign?"text-slate-700":"text-gray-400"])},f(t.adCampaign||"--"),3)]),e("div",null,[r[12]||(r[12]=e("div",{class:"text-xs text-gray-500 mb-1"},"AdMedium",-1)),e("div",{class:D(["font-medium",t.adMedium?"text-slate-700":"text-gray-400"])},f(t.adMedium||"--"),3)]),e("div",null,[r[13]||(r[13]=e("div",{class:"text-xs text-gray-500 mb-1"},"AdSource",-1)),e("div",{class:D(["font-medium",t.adSource?"text-slate-700":"text-gray-400"])},f(t.adSource||"--"),3)]),e("div",null,[r[14]||(r[14]=e("div",{class:"text-xs text-gray-500 mb-1"},"Expected purchase date",-1)),e("div",{class:D(["font-medium",t.expectedPurchaseDate?"text-slate-700":"text-gray-400"])},f(t.expectedPurchaseDate||"--"),3)]),e("div",null,[r[15]||(r[15]=e("div",{class:"text-xs text-gray-500 mb-1"},"Fiscal entity",-1)),e("div",{class:D(["font-medium",t.fiscalEntity?"text-slate-700":"text-gray-400"])},f(t.fiscalEntity||"--"),3)])])]),r[26]||(r[26]=e("div",{class:"border-t border-gray-200 my-4"},null,-1)),e("div",null,[r[24]||(r[24]=e("div",{class:"flex justify-between items-center mb-4"},[e("h4",{class:"text-xs font-bold uppercase text-gray-500 tracking-wider"},"VEHICLE DETAILS")],-1)),e("div",wl,[t.registration?(l(),i("div",$l,[r[17]||(r[17]=e("div",{class:"text-xs text-gray-500 mb-1"},"Registration",-1)),e("div",Cl,f(t.registration),1)])):m("",!0),t.kilometers!==void 0&&t.kilometers!==null?(l(),i("div",Sl,[r[18]||(r[18]=e("div",{class:"text-xs text-gray-500 mb-1"},"Kilometers",-1)),e("div",Al,f(g(t.kilometers))+" Km",1)])):m("",!0),t.fuelType?(l(),i("div",Dl,[r[19]||(r[19]=e("div",{class:"text-xs text-gray-500 mb-1"},"Fuel type",-1)),e("div",Tl,f(t.fuelType),1)])):m("",!0),t.gearType?(l(),i("div",Ol,[r[20]||(r[20]=e("div",{class:"text-xs text-gray-500 mb-1"},"Gear type",-1)),e("div",ql,f(t.gearType),1)])):m("",!0),t.vin?(l(),i("div",Nl,[r[21]||(r[21]=e("div",{class:"text-xs text-gray-500 mb-1"},"VIN Number",-1)),e("div",Vl,f(t.vin),1)])):m("",!0),t.dealership?(l(),i("div",El,[r[22]||(r[22]=e("div",{class:"text-xs text-gray-500 mb-1"},"Dealership",-1)),e("div",Il,f(t.dealership),1)])):m("",!0)]),t.showTechnicalSpecs?(l(),i("div",Fl,[...r[23]||(r[23]=[e("button",{class:"bg-white border border-gray-200 text-slate-700 hover:text-blue-600 hover:border-blue-200 font-medium px-4 py-2 rounded-lg text-xs transition-colors flex items-center gap-2 group"},[e("i",{class:"fa-solid fa-list-check text-gray-400 group-hover:text-blue-500"}),T(" View technical specs ")],-1)])])):m("",!0)]),t.requestMessage?(l(),i("div",Ul)):m("",!0),t.requestMessage?(l(),i("div",Ml,[r[25]||(r[25]=e("h4",{class:"text-xs font-bold uppercase text-gray-500 tracking-wider mb-4"},"REQUEST MESSAGE",-1)),e("div",jl,[e("p",Wl,f(t.requestMessage),1)])])):m("",!0)])):m("",!0)])])):m("",!0)}},te={note:"note",communication:"communication",email:"communication",call:"communication",sms:"communication",whatsapp:"communication",attachment:"attachment",document:"attachment",file:"attachment",tradein:"tradein","trade-in":"tradein",financing:"financing",offer:"offers",purchase:"offers",appointment:"appointments",survey:"surveys",default:"overview"};function ce(t){if(!t)return te.default;const y=t.toLowerCase().trim();return te[y]||te.default}function Bl({store:t,taskId:y,getTabForItemType:s,isOverviewModalAction:g}){const a=A(null),r=A(null),p=A("overview"),u=A("email"),o=A([]);Z(p,()=>{a.value=null,r.value=null});const n=V(()=>[...t.currentActivities.value,...o.value.filter(q=>!q.activityId)].filter(q=>{const w=s(q.type);return p.value==="overview"?w==="overview":w===p.value}).sort((q,w)=>{const E=new Date(q.timestamp||0);return new Date(w.timestamp||0)-E})),d=b=>(r.value=null,p.value==="overview"&&g&&g(b)?{type:"overview-modal",action:b}:(["email","sms","whatsapp","call"].includes(b)?(u.value=b,a.value="communication"):a.value=b,null)),h=async b=>{var q;if(b.isEdit){const w=o.value.findIndex(E=>E.id===b.id);w>-1&&(o.value[w]={...o.value[w],...b}),(q=r.value)!=null&&q.activityId&&await t.updateActivity(y.value,r.value.activityId,{type:b.communicationType||b.type,user:"You",action:b.action,content:b.content,fileName:b.fileName,data:b.data})}else{const w=b.communicationType||b.type,E=await t.addActivity(y.value,{type:w,user:"You",action:b.action,content:b.content,fileName:b.fileName,data:b.data});o.value.push({id:E.id,type:w==="email"||w==="whatsapp"||w==="sms"?"communication":w,action:b.action,content:b.content,fileName:b.fileName,data:b.data,timestamp:E.timestamp,activityId:E.id})}a.value=null,r.value=null},N=()=>{a.value=null,r.value=null},v=b=>{s(b.type)&&(a.value=b.type==="email"||b.type==="whatsapp"||b.type==="sms"||b.type==="communication"?"communication":b.type,r.value=b)},c=async b=>{try{await t.deleteActivity(y.value,b)}catch(q){throw console.error("Error deleting item:",q),q}};return{activeTab:p,showInlineWidget:a,inlineWidgetType:V(()=>a.value),editingItem:r,isEditing:V(()=>r.value!==null),communicationType:u,inlineContent:o,filteredInlineContent:n,handleAddNewAction:d,handleWidgetSave:h,handleWidgetCancel:N,handleEditItem:v,handleDeleteItem:c}}const Pl={class:"flex-1 flex flex-col overflow-hidden h-full"},Rl={class:"bg-white border-b border-gray-200 shrink-0 shadow-sm"},zl={class:"px-4 md:px-8 py-4 md:py-6"},Yl={class:"flex-1 flex flex-row overflow-hidden"},Kl={class:"flex-1 flex flex-col overflow-hidden min-w-0"},Ql={class:"flex-1 overflow-y-auto p-4 md:p-8 scrollbar-hide"},Hl={class:"mb-4"},Gl={key:0},Jl={key:0,class:"mb-6"},Zl={key:2,class:"mb-6"},Xl={class:"space-y-6 mb-6"},_l={key:3,class:"space-y-4 mb-6 px-1"},en={key:1},tn={key:0,class:"space-y-4 mb-6 px-1"},an={key:0,class:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"},sn={class:"p-6"},ln={class:"flex justify-between items-center mb-4"},nn={class:"text-sm font-bold text-slate-800"},on={key:1,class:"max-w-2xl w-full max-h-[90vh] overflow-y-auto"},yn={__name:"CustomerShell",props:{task:{type:Object,required:!0},type:{type:String,required:!0},managementWidget:{type:Object,required:!0},storeAdapter:{type:Object,required:!0},addNewConfig:{type:Object,required:!0}},emits:["car-added","convert-to-lead","convert-to-opportunity"],setup(t,{emit:y}){const s=t,g=we(),a=$e(),r=V(()=>s.task.id),p=V(()=>s.type==="contact"?"bg-blue-100 text-blue-600":s.type==="lead"?"bg-orange-100 text-orange-600":"bg-purple-100 text-purple-600"),u=V(()=>g.path.startsWith("/tasks")&&!g.path.startsWith("/customer")),o=A(g.path.startsWith("/tasks")&&!g.path.startsWith("/customer"));Z(()=>g.path,x=>{o.value=x.startsWith("/tasks")&&!x.startsWith("/customer")});const n=()=>{a.push({path:`/customer/${s.task.id}`,query:{type:s.type}})};function d(x){b.value=!1}const h=()=>{q.value=!0},N=async x=>{var S,L,J,F;const k=x.name;s.type==="lead"?await((L=(S=s.storeAdapter).updateLead)==null?void 0:L.call(S,s.task.id,{assignee:k,assigneeType:x.type,teamId:x.type==="team"?x.id:null})):s.type==="opportunity"&&await((F=(J=s.storeAdapter).updateOpportunity)==null?void 0:F.call(J,s.task.id,{assignee:k,assigneeType:x.type,teamId:x.type==="team"?x.id:null})),q.value=!1},v=A(!1),c=A(null),b=A(!1),q=A(!1),{activeTab:w,showInlineWidget:E,editingItem:M,communicationType:fe,inlineContent:oe,filteredInlineContent:H,handleAddNewAction:ye,handleWidgetSave:G,handleWidgetCancel:X,handleEditItem:ie,handleDeleteItem:re}=Bl({store:s.storeAdapter,taskId:r,getTabForItemType:ce,isOverviewModalAction:x=>w.value==="overview"&&s.addNewConfig.overviewActions.includes(x)});Z(()=>s.task.id,()=>{w.value="overview"});const _=x=>{const k=ye(x);k&&k.modalAction&&(c.value=k.modalAction,v.value=!0)},ge=x=>{if(x==="appointment"){b.value=!0;return}const k={note:"note",attachment:"attachment",email:"communication",whatsapp:"communication",sms:"communication",call:"communication",appointment:"overview"};if(["financing","tradein","purchase"].includes(x))c.value=x,v.value=!0;else{const S=k[x];S?(w.value=S,setTimeout(()=>{_(x),setTimeout(()=>{const L=document.querySelector(".animate-fade-in");L&&L.scrollIntoView({behavior:"smooth",block:"start"})},100)},50)):_(x)}},P=()=>{v.value=!1,c.value=null},ee=async x=>{await G(x),P()},pe=V(()=>{const x=[...s.storeAdapter.currentActivities.value,...oe.value],k=x.filter(F=>ce(F.type)==="overview").length,S=x.filter(F=>["call","email","sms","whatsapp","communication"].includes(F.type)).length,L=x.filter(F=>F.type==="note").length,J=x.filter(F=>F.type==="attachment").length;return[{key:"overview",label:"Overview",count:k},{key:"note",label:"Notes",count:L},{key:"communication",label:"Communication",count:S},{key:"attachment",label:"Attachments",count:J}]}),de=V(()=>[...s.storeAdapter.currentActivities.value,...oe.value]),be=async x=>{if(s.type==="opportunity")try{await s.storeAdapter.addVehicle(s.task.id,x.vehicleData),s.storeAdapter.loadOpportunityById&&await s.storeAdapter.loadOpportunityById(s.task.id)}catch(k){console.error("Error selecting vehicle:",k)}},ve=async x=>{if(s.type==="opportunity")try{await s.storeAdapter.createOffer(s.task.id,x.offerData),s.storeAdapter.loadOpportunityById&&await s.storeAdapter.loadOpportunityById(s.task.id)}catch(k){console.error("Error creating offer:",k)}};return(x,k)=>(l(),i("div",Pl,[e("header",Rl,[e("div",zl,[j(tt,{initials:t.task.customer.initials,name:t.task.customer.name,email:t.task.customer.email,phone:t.task.customer.phone,"third-field-value":t.task.customer.address,"avatar-color-class":p.value,"task-type":t.type,"email-label":"Email","phone-label":"Phone","third-field-label":"Address",onAction:ge},{tags:K(()=>[(l(!0),i(U,null,z(t.task.tags,S=>(l(),i("span",{key:S,class:"badge-ui bg-blue-50 border-blue-100 text-blue-700 font-semibold"},f(S),1))),128))]),"name-action":K(()=>[u.value?(l(),i("button",{key:0,onClick:n,class:"w-7 h-7 flex items-center justify-center bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-lg text-blue-600 hover:text-blue-700 transition-colors shrink-0",title:"Open in new page"},[...k[7]||(k[7]=[e("i",{class:"fa-solid fa-external-link text-xs"},null,-1)])])):m("",!0)]),_:1},8,["initials","name","email","phone","third-field-value","avatar-color-class","task-type"])])]),e("div",Yl,[e("div",Kl,[e("main",Ql,[e("div",Hl,[j(nt,{modelValue:$(w),"onUpdate:modelValue":k[0]||(k[0]=S=>Ce(w)?w.value=S:null),tabs:pe.value,class:"mb-0"},null,8,["modelValue","tabs"])]),$(w)==="overview"?(l(),i("div",Gl,[t.type!=="contact"?(l(),i("div",Jl,[j(ft,{stage:t.task.displayStage||t.task.stage,owner:t.task.assignee,source:t.task.source||"","delivery-substatus":t.task.deliverySubstatus,onReassign:h},null,8,["stage","owner","source","delivery-substatus"])])):m("",!0),t.task.requestedCar?(l(),I(Ll,{key:1,brand:t.task.requestedCar.brand,model:t.task.requestedCar.model,year:t.task.requestedCar.year,image:t.task.requestedCar.image||"",price:t.task.requestedCar.price||null,"request-message":t.task.requestedCar.requestMessage||"","request-type":t.task.requestedCar.requestType||"",source:t.task.source||"",dealership:t.task.requestedCar.dealership||"",registration:t.task.requestedCar.registration||"",kilometers:t.task.requestedCar.kilometers||null,"fuel-type":t.task.requestedCar.fuelType||"","gear-type":t.task.requestedCar.gearType||"",vin:t.task.requestedCar.vin||"","stock-days":t.task.requestedCar.stockDays!==void 0?t.task.requestedCar.stockDays:null,channel:t.task.requestedCar.channel||"Email","ad-campaign":t.task.requestedCar.adCampaign||"","expected-purchase-date":t.task.requestedCar.expectedPurchaseDate||"","fiscal-entity":t.task.requestedCar.fiscalEntity||"","source-details":t.task.requestedCar.sourceDetails||"","ad-medium":t.task.requestedCar.adMedium||"","ad-source":t.task.requestedCar.adSource||"",label:"Requested Car",class:"mb-6"},null,8,["brand","model","year","image","price","request-message","request-type","source","dealership","registration","kilometers","fuel-type","gear-type","vin","stock-days","channel","ad-campaign","expected-purchase-date","fiscal-entity","source-details","ad-medium","ad-source"])):m("",!0),t.managementWidget?(l(),i("div",Zl,[(l(),I(Se(t.managementWidget),{lead:t.type==="lead"?t.task:void 0,opportunity:t.type==="opportunity"?t.task:void 0,contact:t.type==="contact"?t.task:void 0,activities:de.value,onCarAdded:k[1]||(k[1]=S=>x.$emit("car-added",S)),onConvertToLead:k[2]||(k[2]=S=>x.$emit("convert-to-lead")),onConvertToOpportunity:k[3]||(k[3]=S=>x.$emit("convert-to-opportunity")),onVehicleSelected:be,onCreateOffer:ve},null,40,["lead","opportunity","contact","activities"]))])):m("",!0),e("div",Xl,[se(x.$slots,"pinned-extra",{task:t.task})]),$(H).length>0?(l(),i("div",_l,[(l(!0),i(U,null,z($(H),S=>(l(),I(ue,{key:S.id,item:S,"task-type":t.type,"customer-initials":"SK",onEdit:$(ie),onDelete:$(re)},null,8,["item","task-type","onEdit","onDelete"]))),128))])):m("",!0)])):(l(),i("div",en,[j(vt,{actions:t.addNewConfig.tabActions,"active-tab":$(w),onAction:_},null,8,["actions","active-tab"]),e("div",null,[$(E)==="communication"?(l(),I(ts,{key:0,type:$(fe),"task-type":t.type,"task-id":t.task.id,item:$(M),onSave:$(G),onCancel:$(X)},null,8,["type","task-type","task-id","item","onSave","onCancel"])):m("",!0),$(E)==="note"?(l(),I(os,{key:1,item:$(M),"task-type":t.type,"task-id":t.task.id,onSave:$(G),onCancel:$(X)},null,8,["item","task-type","task-id","onSave","onCancel"])):m("",!0),$(E)==="attachment"?(l(),I(gs,{key:2,item:$(M),"task-type":t.type,"task-id":t.task.id,onSave:$(G),onCancel:$(X)},null,8,["item","task-type","task-id","onSave","onCancel"])):m("",!0)]),$(H).length>0?(l(),i("div",tn,[(l(!0),i(U,null,z($(H),S=>(l(),I(ue,{key:S.id,item:S,"task-type":t.type,"customer-initials":"SK",onEdit:$(ie),onDelete:$(re)},null,8,["item","task-type","onEdit","onDelete"]))),128))])):m("",!0)]))])]),j(Ja,{title:"Activity summary",activities:de.value,collapsed:o.value,"show-collapse":!0,show:!0,class:"hidden lg:flex",onToggleCollapse:k[4]||(k[4]=S=>o.value=!o.value)},null,8,["activities","collapsed"])]),(l(),I(Ae,{to:"body"},[v.value?(l(),i("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",onClick:R(P,["self"])},[c.value==="financing"||c.value==="tradein"?(l(),i("div",an,[e("div",sn,[e("div",ln,[e("h5",nn,f(c.value==="financing"?"Add Financing":"Add Trade-in"),1),e("button",{onClick:P,class:"text-gray-400 hover:text-gray-600"},[...k[8]||(k[8]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),c.value==="financing"?(l(),I(ws,{key:0,item:null,"task-type":t.type,"task-id":t.task.id,onSave:ee,onCancel:P},null,8,["task-type","task-id"])):m("",!0),c.value==="tradein"?(l(),I(Os,{key:1,item:null,"task-type":t.type,"task-id":t.task.id,onSave:ee,onCancel:P},null,8,["task-type","task-id"])):m("",!0)])])):m("",!0),c.value==="purchase"?(l(),i("div",on,[j(zs,{item:null,"task-type":t.type,"task-id":t.task.id,"requested-car":t.type==="lead"?t.task.requestedCar:null,"recommended-cars":[],onSave:ee,onCancel:P},null,8,["task-type","task-id","requested-car"])])):m("",!0)])):m("",!0)])),j(Te,{show:q.value,onClose:k[5]||(k[5]=S=>q.value=!1),onConfirm:N},null,8,["show"]),b.value?(l(),I(Oe,{key:0,show:b.value,customer:t.task.customer,assignee:t.task.assignee,"disabled-fields":["customer"],onCreate:d,onCancel:k[6]||(k[6]=S=>b.value=!1)},null,8,["show","customer","assignee"])):m("",!0)]))}},ne={Qualified:{primaryAction:{key:"schedule-appointment",title:"Schedule First Appointment",description:"Begin the sales process by scheduling an appointment with the customer",label:"Schedule Appointment",icon:"fa-solid fa-calendar-plus",buttonClass:"bg-blue-600 hover:bg-blue-700 text-white",colorScheme:{background:"bg-blue-50/50",border:"border-blue-100"}},secondaryActions:[{key:"select-vehicle",label:"Select Vehicle",icon:"fa-solid fa-car",description:"Choose a vehicle for this opportunity"},{key:"schedule-appointment",label:"Schedule Appointment",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"OOFB",condition:"qualified-no-offers-7-13-days"},{type:"UFB",condition:"qualified-no-offers-14-plus-days"}]},"Awaiting Appointment":{primaryAction:{key:"view-or-schedule-appointment",title:t=>t.scheduledAppointment?"Next Appointment":"Schedule Appointment",description:t=>t.scheduledAppointment?`Scheduled for ${t.formatDateTime(t.scheduledAppointment.start)}`:"Schedule an appointment to move forward",label:t=>t.scheduledAppointment?"View Appointment":"Schedule Appointment",icon:"fa-solid fa-calendar-check",buttonClass:"bg-purple-600 hover:bg-purple-700 text-white",colorScheme:{background:"bg-purple-50/50",border:"border-purple-100"}},secondaryActions:[{key:"reschedule",label:"Reschedule",icon:"fa-solid fa-calendar-days",description:"Change appointment date/time"},{key:"cancel-appointment",label:"Cancel Appointment",icon:"fa-solid fa-calendar-xmark"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"NS",condition:"appointment-past-not-completed"}]},"To be Called Back":{primaryAction:{key:"call-prospect",title:"Call Prospect",description:"Customer requested a callback. Follow up to maintain engagement",label:"Initiate Call",icon:"fa-solid fa-phone",buttonClass:"bg-indigo-600 hover:bg-indigo-700 text-white",colorScheme:{background:"bg-indigo-50/50",border:"border-indigo-100"}},secondaryActions:[{key:"schedule-appointment",label:"Schedule Appointment",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[]},"In Negotiation":{primaryAction:{key:"create-offer",title:"Create Offer",description:t=>t.hasOffers?"Add another offer or refine existing proposal":"Create initial offer to move forward with negotiation",label:t=>t.hasOffers?"Add Another Offer":"Create Offer",icon:"fa-solid fa-file-invoice-dollar",buttonClass:"bg-yellow-600 hover:bg-yellow-700 text-white",colorScheme:{background:"bg-yellow-50/50",border:"border-yellow-100"}},secondaryActions:[{key:"schedule-appointment",label:"Schedule Appointment",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"OFB",condition:"negotiation-5-plus-days-no-contract-has-offers"},{type:"NFU",condition:"negotiation-5-plus-days-no-contract-no-future-appointment-has-offers"}]},"Offer Sent":{primaryAction:{key:"follow-up-offer",title:"Follow Up on Offer",description:"Offer recently sent. Follow up to gauge customer interest",label:"Log Follow-up",icon:"fa-solid fa-phone-volume",buttonClass:"bg-orange-600 hover:bg-orange-700 text-white",colorScheme:{background:"bg-orange-50/50",border:"border-orange-100"}},secondaryActions:[{key:"add-offer",label:"Add Another Offer",icon:"fa-solid fa-file-invoice-dollar"},{key:"schedule-appointment",label:"Schedule Follow-up",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"OFB",condition:"negotiation-5-plus-days-no-contract-has-offers"},{type:"NFU",condition:"negotiation-5-plus-days-no-contract-no-future-appointment-has-offers"}]},"Awaiting Response":{primaryAction:{key:"request-decision",title:"Request Customer Decision",description:"Offer has been pending. Time to request a decision from the prospect",label:"Request Decision",icon:"fa-solid fa-circle-question",buttonClass:"bg-pink-600 hover:bg-pink-700 text-white",colorScheme:{background:"bg-pink-50/50",border:"border-pink-100"}},secondaryActions:[{key:"add-contract",label:"Add Contract",icon:"fa-solid fa-file-contract",description:"Customer accepted - add contract to proceed"},{key:"add-offer",label:"Send New Offer",icon:"fa-solid fa-file-invoice-dollar"},{key:"schedule-appointment",label:"Schedule Meeting",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"OFB",condition:"negotiation-5-plus-days-no-contract-has-offers"},{type:"NFU",condition:"negotiation-5-plus-days-no-contract-no-future-appointment-has-offers"}]},"Contract Pending":{primaryAction:{key:"finalize-contract",title:"Finalize Contract",description:"Collect e-signatures and finalize contract documentation",label:"Collect Signatures",icon:"fa-solid fa-file-signature",buttonClass:"bg-emerald-600 hover:bg-emerald-700 text-white",colorScheme:{background:"bg-emerald-50/50",border:"border-emerald-100"}},secondaryActions:[{key:"close-won",label:"Close as Won",icon:"fa-solid fa-check-circle",description:"Mark deal as won and finalize"},{key:"extend-deadline",label:"Extend Deadline",icon:"fa-solid fa-clock"},{key:"add-offer",label:"Revise Offer",icon:"fa-solid fa-file-invoice-dollar"},{key:"schedule-appointment",label:"Schedule Appointment",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[]},"Closed Won":{primaryAction:t=>{const y=t.deliverySubstatus;return y==="Delivered"?{key:"collect-feedback",title:"Post-Delivery Follow-up",description:"Vehicle delivered. Collect customer feedback",label:"Collect Feedback",icon:"fa-solid fa-comment",buttonClass:"bg-green-600 hover:bg-green-700 text-white",colorScheme:{background:"bg-green-50/50",border:"border-green-100"}}:y==="Awaiting Delivery"?{key:"confirm-delivery",title:"Confirm Delivery Details",description:"Delivery scheduled. Confirm date/time with customer",label:"Confirm Delivery",icon:"fa-solid fa-calendar-check",buttonClass:"bg-teal-600 hover:bg-teal-700 text-white",colorScheme:{background:"bg-teal-50/50",border:"border-teal-100"}}:{key:"schedule-delivery",title:"Set Delivery Date",description:"Contract signed! Schedule vehicle delivery with the customer",label:"Schedule Delivery",icon:"fa-solid fa-truck",buttonClass:"bg-green-600 hover:bg-green-700 text-white",colorScheme:{background:"bg-green-50/50",border:"border-green-100"}}},secondaryActions:[{key:"collect-feedback",label:"Collect Feedback",icon:"fa-solid fa-comment",conditional:"is-delivered"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"CFB",condition:"contract-7-plus-days-no-delivery"},{type:"DFB",condition:"delivery-date-set"},{type:"DFB",condition:"delivery-3-plus-days"}]},Abandoned:{primaryAction:{key:"reopen",title:"Opportunity Abandoned",description:"This opportunity has been inactive for an extended period. Reopen it to continue the sales process.",label:"Reopen Opportunity",icon:"fa-solid fa-rotate-left",buttonClass:"bg-gray-600 hover:bg-gray-700 text-white",colorScheme:{background:"bg-gray-50/50",border:"border-gray-100"}},secondaryActions:[{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark",description:"Mark this opportunity as lost"},{key:"requalify",label:"Requalify as Lead",icon:"fa-solid fa-arrow-left",description:"Convert back to a lead"}],taskWidgets:[{type:"ABANDONED",condition:"opportunity-abandoned"}]}},ae={reopen:{key:"reopen",label:"Reopen Opportunity",icon:"fa-solid fa-rotate-left",description:"Restart the management process"},requalify:{key:"requalify",label:"Requalify as Lead",icon:"fa-solid fa-arrow-left",description:"Convert back to a lead"},closeLost:{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}};function B(t){if(!t)return 0;const y=new Date(t),g=Math.abs(new Date-y);return Math.ceil(g/(1e3*60*60*24))}const Y={"no-appointment":t=>!t.scheduledAppointment,"has-appointment":t=>!!t.scheduledAppointment,"appointment-past-not-completed":t=>t.scheduledAppointment?new Date(t.scheduledAppointment.start)<new Date&&t.scheduledAppointment.status!=="completed":!1,"has-future-appointment":t=>t.scheduledAppointment?new Date(t.scheduledAppointment.start)>new Date:!1,"no-offers":t=>!t.hasOffers,"has-offers":t=>t.hasOffers,"qualified-no-offers-7-13-days":t=>{const y=W(),s=y.getSetting("oofbMinDays"),g=y.getSetting("oofbMaxDays"),a=B(t.opportunity.createdAt);return a>=s&&a<g+1&&!t.hasOffers},"qualified-no-offers-14-plus-days":t=>{const s=W().getSetting("ufbDays");return B(t.opportunity.createdAt)>=s&&!t.hasOffers},"negotiation-5-plus-days-no-contract-has-offers":t=>{if(t.stage==="In Negotiation"&&!t.hasOffers)return!1;const s=W().getSetting("ofbDays");return B(t.opportunity.lastActivity||t.opportunity.createdAt)>=s&&!t.opportunity.contractDate&&t.hasOffers},"negotiation-5-plus-days-no-contract-no-future-appointment-has-offers":t=>{if(t.stage==="In Negotiation"&&!t.hasOffers)return!1;const s=W().getSetting("nfuDays"),g=B(t.opportunity.lastActivity||t.opportunity.createdAt),a=t.scheduledAppointment&&new Date(t.scheduledAppointment.start)>new Date;return g>=s&&!t.opportunity.contractDate&&!a&&t.hasOffers},"contract-7-plus-days-no-delivery":t=>{var r;if(!t.opportunity.contractDate)return!1;const s=W().getSetting("cfbDays"),g=B(t.opportunity.contractDate),a=(r=t.activities)==null?void 0:r.some(p=>{var u;return p.type==="delivery"||((u=p.action)==null?void 0:u.toLowerCase().includes("delivered"))});return g>=s&&!a},"delivery-date-set":t=>!!t.opportunity.deliveryDate,"delivery-3-plus-days":t=>{var r;const y=(r=t.activities)==null?void 0:r.find(p=>{var u;return p.type==="delivery"||((u=p.action)==null?void 0:u.toLowerCase().includes("delivered"))});if(!y)return!1;const g=W().getSetting("dfbDays");return B(y.timestamp)>=g},"is-awaiting-delivery":t=>t.deliverySubstatus==="Awaiting Delivery","is-delivered":t=>t.deliverySubstatus==="Delivered","has-no-delivery":t=>!t.deliverySubstatus||t.deliverySubstatus===null,"is-closed":t=>{const y=t.stage;return y==="Closed Won"||y==="Closed Lost"},"is-closed-with-task-widget":t=>Y["is-closed"](t)&&t.hasActiveTaskWidget,"opportunity-abandoned":t=>{if(Y["is-closed"](t))return!1;const y=W(),s=y.getSetting("abandonedOpportunityDays");if(!y.getSetting("abandonedEligibleStages").includes(t.stage))return!1;const a=t.opportunity.lastActivity||t.opportunity.createdAt;return B(a)>=s}};function gn(t,y){if(Y["is-closed-with-task-widget"](y))return[ae.reopen,ae.requalify,ae.closeLost];const s=ne[t];return!s||!s.secondaryActions?[]:s.secondaryActions.filter(g=>{if(!g.conditional)return!0;const a=Y[g.conditional];return a?a(y):!0})}function pn(t,y){const s=ne[t];if(!s||!s.taskWidgets)return null;const a=W().getSetting("autoCloseWidgetsOnClose"),r=Y["is-closed"]({stage:t});for(const p of s.taskWidgets){if(a&&r&&(p.type==="NFU"||p.type==="OFB"))continue;const u=Y[p.condition];if(u&&u(y))return p.type}return null}function bn(t,y){const s=ne[t];if(!s||!s.primaryAction)return null;const g=s.primaryAction;return{...g,title:typeof g.title=="function"?g.title(y):g.title,description:typeof g.description=="function"?g.description(y):g.description,label:typeof g.label=="function"?g.label(y):g.label}}function vn(t){return{OOFB:"Overdue Offer Follow-up Task",UFB:"Urgent Follow-up Task",NFU:"No Future Updates Task",OFB:"Offer Follow-up Task",CFB:"Contract Follow-up Task",DFB:"Delivery Follow-up Task",NS:"No-Show Follow-up Task",ABANDONED:"Abandoned Opportunity Task"}[t]||"Task"}function xn(t){return t==="Closed Won"||t==="Closed Lost"||t==="Delivered"}const hn={__name:"ComingSoonModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Coming Soon"}},emits:["close"],setup(t,{emit:y}){const s=y,g=()=>{s("close")};return(a,r)=>(l(),I(qe,{show:t.show,title:t.title,onCancel:g},{footer:K(()=>[e("div",{class:"px-6 py-4 border-t border-gray-200 flex justify-end"},[e("button",{onClick:g,class:"bg-gray-800 hover:bg-gray-900 text-white font-medium px-6 py-2 rounded-lg text-sm transition-colors"}," Close ")])]),default:K(()=>[r[0]||(r[0]=e("div",{class:"py-8 flex items-center justify-center"},[e("p",{class:"text-gray-600 text-lg font-medium"},"Coming soon")],-1))]),_:1},8,["show","title"]))}};export{os as _,bn as a,gn as b,vn as c,zs as d,hn as e,yn as f,pn as g,Ll as h,xn as i};
