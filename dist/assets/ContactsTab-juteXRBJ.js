<<<<<<<< HEAD:dist/assets/ContactsTab-rupFigUe.js
import{y as x}from"./components-D2RBuYr8.js";import{u as A}from"./UnifiedAddForm-Wv6zeKuH.js";import{u as k}from"./opportunities-BC_ZMPUZ.js";import{u as T}from"./useCustomersTable-_pAYD1g7.js";import{M as B,r as n,c as D,m as I,x as S,o as U,B as h,e as c,y as i}from"./index-Dj_RD8l0.js";import"./toggle-group-item.vue_vue_type_script_setup_true_lang-Csij51_o-B5cRDmy2.js";import"./contacts-BDIyKZyn.js";const N={__name:"ContactsTab",emits:["row-click"],setup(L,{emit:y}){const a=A(),s=k(),r=n("all"),p=n({pageIndex:0,pageSize:10}),u=n(""),m=n([]),d=n([]),C=e=>{if(!e)return"N/A";const t=e.split(",");return t.length>1&&t[t.length-1].trim().replace(/^\d+\s*/,"").trim()||e},l=e=>e?new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}):"-",f=D(()=>{let e=a.customers;return r.value==="contacts"?e=a.contacts:r.value==="accounts"&&(e=a.accounts),e.map(t=>({id:`customer-${t.id}`,stageKey:"contacts",customer:t.name,accountType:t.company&&t.company!==""?"Account":"Contact",telephone:t.phone,location:C(t.address),createdAt:l(t.createdAt),name:t.name,accountOwner:t.source||"N/A",updatedAt:l(t.lastContact||t.createdAt),lastActivity:l(t.lastContact),openOpportunities:s.opportunities.filter(o=>o.customerId===t.id&&o.stage!=="Closed Won"&&o.stage!=="Closed Lost").length,wonOpportunities:s.opportunities.filter(o=>o.customerId===t.id&&o.stage==="Closed Won").length,initials:t.initials||t.name.slice(0,2).toUpperCase(),type:t.company&&t.company!==""?"account":"contact",customerId:t.id}))}),v=y,g=e=>{e.stageKey==="contacts"&&v("row-click",e)},b=n("contacts"),{columns:F,filterDefinitions:w,tableMeta:O}=T(b,g);return I(async()=>{await a.fetchCustomers(),await s.fetchOpportunities()}),(e,t)=>(U(),S(i(x),{data:f.value,columns:i(F),meta:i(O),onRowClick:g,columnFiltersOptions:{filterDefs:i(w)},pagination:p.value,"onUpdate:pagination":t[0]||(t[0]=o=>p.value=o),globalFilter:u.value,"onUpdate:globalFilter":t[1]||(t[1]=o=>u.value=o),sorting:m.value,"onUpdate:sorting":t[2]||(t[2]=o=>m.value=o),columnFilters:d.value,"onUpdate:columnFilters":t[3]||(t[3]=o=>d.value=o),paginationOptions:{rowCount:f.value.length},globalFilterOptions:{debounce:300},class:"h-full"},{"empty-state":h(()=>[...t[4]||(t[4]=[c("div",{class:"empty-state"},[c("i",{class:"fa-solid fa-inbox empty-state-icon"}),c("p",{class:"empty-state-text"},"No records found")],-1)])]),_:1},8,["data","columns","meta","columnFiltersOptions","pagination","globalFilter","sorting","columnFilters","paginationOptions"]))}},V=B(N,[["__scopeId","data-v-1681c1bc"]]);export{V as default};
========
import{R as x}from"./components-4J0anYM3.js";import{u as A}from"./UnifiedAddForm-wHKvEdz8.js";import{u as k}from"./opportunities-Cr-mXogK.js";import{u as T}from"./useCustomersTable-CQmH99J8.js";import{K as B,r as n,c as D,m as I,x as S,o as U,B as h,e as c,y as i}from"./index-DqWyOYoU.js";import"./toggle-group-item.vue_vue_type_script_setup_true_lang-SVS8Zwad-DVNwBQcn.js";import"./contacts-B55v8mIF.js";const N={__name:"ContactsTab",emits:["row-click"],setup(R,{emit:y}){const a=A(),s=k(),r=n("all"),p=n({pageIndex:0,pageSize:10}),u=n(""),m=n([]),d=n([]),C=e=>{if(!e)return"N/A";const t=e.split(",");return t.length>1&&t[t.length-1].trim().replace(/^\d+\s*/,"").trim()||e},l=e=>e?new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}):"-",f=D(()=>{let e=a.customers;return r.value==="contacts"?e=a.contacts:r.value==="accounts"&&(e=a.accounts),e.map(t=>({id:`customer-${t.id}`,stageKey:"contacts",customer:t.name,accountType:t.company&&t.company!==""?"Account":"Contact",telephone:t.phone,location:C(t.address),createdAt:l(t.createdAt),name:t.name,accountOwner:t.source||"N/A",updatedAt:l(t.lastContact||t.createdAt),lastActivity:l(t.lastContact),openOpportunities:s.opportunities.filter(o=>o.customerId===t.id&&o.stage!=="Closed Won"&&o.stage!=="Closed Lost").length,wonOpportunities:s.opportunities.filter(o=>o.customerId===t.id&&o.stage==="Closed Won").length,initials:t.initials||t.name.slice(0,2).toUpperCase(),type:t.company&&t.company!==""?"account":"contact",customerId:t.id}))}),v=y,g=e=>{e.stageKey==="contacts"&&v("row-click",e)},b=n("contacts"),{columns:F,filterDefinitions:w,tableMeta:O}=T(b,g);return I(async()=>{await a.fetchCustomers(),await s.fetchOpportunities()}),(e,t)=>(U(),S(i(x),{data:f.value,columns:i(F),meta:i(O),onRowClick:g,columnFiltersOptions:{filterDefs:i(w)},pagination:p.value,"onUpdate:pagination":t[0]||(t[0]=o=>p.value=o),globalFilter:u.value,"onUpdate:globalFilter":t[1]||(t[1]=o=>u.value=o),sorting:m.value,"onUpdate:sorting":t[2]||(t[2]=o=>m.value=o),columnFilters:d.value,"onUpdate:columnFilters":t[3]||(t[3]=o=>d.value=o),paginationOptions:{rowCount:f.value.length},globalFilterOptions:{debounce:300},class:"h-full"},{"empty-state":h(()=>[...t[4]||(t[4]=[c("div",{class:"empty-state"},[c("i",{class:"fa-solid fa-inbox empty-state-icon"}),c("p",{class:"empty-state-text"},"No records found")],-1)])]),_:1},8,["data","columns","meta","columnFiltersOptions","pagination","globalFilter","sorting","columnFilters","paginationOptions"]))}},V=B(N,[["__scopeId","data-v-1681c1bc"]]);export{V as default};
>>>>>>>> maciej-branch:dist/assets/ContactsTab-juteXRBJ.js
