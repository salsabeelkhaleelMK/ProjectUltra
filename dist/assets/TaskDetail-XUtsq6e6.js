import{r as k,c as T,a as n,i as o,e,k as g,t as f,f as j,n as N,w as O,v as R,F as P,g as te,j as z,l as be,p as Le,b as B,q as de,o as ie,s as ne,x as L,y as xe,u as E,z as ct,A as pt,T as ue,B as we,C as Ue,D as qe,h as Ee,E as mt,G as Oe,_ as yt,H as Be,I as gt}from"./index-DEHLoFOu.js";import{useOpportunitiesStore as We}from"./opportunities-TBFpB31x.js";const ft={class:"bg-white border-r border-gray-200 flex flex-col shrink-0 w-full lg:w-80 h-full"},bt={class:"h-16 px-5 border-b border-gray-100 flex justify-between items-center bg-gray-50/50"},vt={class:"flex items-center gap-3"},xt={class:"font-bold text-lg text-gray-800"},ht={key:0,class:"px-5 py-2 border-b border-gray-100 bg-gray-50/50"},wt={class:"flex gap-2"},kt={class:"px-5 py-3"},Ct={class:"relative"},$t=["placeholder"],St={class:"flex-1 overflow-y-auto px-4 space-y-4 pb-4 scrollbar-hide"},Dt=["onClick"],At=["onClick"],Tt={key:1,class:"absolute right-2 top-8 w-36 bg-white border border-gray-200 rounded-lg shadow-lg z-50 overflow-hidden"},qt={class:"flex items-start gap-3.5 pr-6"},Ot={class:"flex-1 min-w-0"},It={class:"font-bold text-gray-800 text-sm leading-snug truncate"},Nt={class:"text-gray-600 text-xs mt-1 truncate"},jt={class:"text-right shrink-0"},Mt={class:"flex items-center gap-2 flex-wrap mt-3"},Rt={__name:"EntityListSidebar",props:{title:{type:String,required:!0},items:{type:Array,required:!0},selectedId:{type:[Number,String],default:null},selectedClass:{type:[String,Function],default:"bg-white border-2 border-blue-500 shadow-md"},unselectedClass:{type:String,default:"bg-white border border-gray-200 hover:border-blue-300"},searchPlaceholder:{type:String,default:"Search..."},showMenu:{type:Boolean,default:!0},openMenuId:{type:[Number,String],default:null},getName:{type:Function,required:!0},getInitials:{type:Function,required:!0},getVehicleInfo:{type:Function,required:!0},avatarClass:{type:Function,default:()=>"bg-orange-100 text-orange-600"},typeFilter:{type:String,default:"all"},showTypeFilter:{type:Boolean,default:!1},showMobileClose:{type:Boolean,default:!1}},emits:["select","menu-click","menu-close","filter-change","close"],setup(t,{emit:h}){const s={mounted(r,i){r.clickOutsideEvent=d=>{r===d.target||r.contains(d.target)||i.value()},document.addEventListener("click",r.clickOutsideEvent)},unmounted(r){document.removeEventListener("click",r.clickOutsideEvent)}},u=t,a=k(""),l=T(()=>{let r=u.items;if(u.typeFilter&&u.typeFilter!=="all"&&(r=r.filter(i=>i.type===u.typeFilter)),a.value){const i=a.value.toLowerCase();r=r.filter(d=>{const v=u.getName(d).toLowerCase(),m=u.getVehicleInfo(d).toLowerCase();return v.includes(i)||m.includes(i)})}return r}),p=r=>{const i=r.compositeId||`${r.type||"task"}-${r.id}`||r.id;return u.selectedId===i};return(r,i)=>(o(),n("div",ft,[e("div",bt,[e("div",vt,[t.showMobileClose?(o(),n("button",{key:0,onClick:i[0]||(i[0]=d=>r.$emit("close")),class:"lg:hidden w-8 h-8 flex items-center justify-center text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"},[...i[5]||(i[5]=[e("i",{class:"fa-solid fa-xmark text-lg"},null,-1)])])):g("",!0),e("h2",xt,f(t.title),1)]),i[6]||(i[6]=e("div",{class:"flex items-center gap-2"},[e("button",{class:"text-xs font-medium bg-white hover:bg-gray-50 px-3 py-1.5 rounded-md border border-gray-200"},[j(" Urgent first "),e("i",{class:"fa-solid fa-chevron-down text-[10px] ml-1"})])],-1))]),t.showTypeFilter?(o(),n("div",ht,[e("div",wt,[e("button",{onClick:i[1]||(i[1]=d=>r.$emit("filter-change","all")),class:N(["text-xs font-medium px-3 py-1.5 rounded-md border transition-colors",t.typeFilter==="all"?"bg-blue-600 text-white border-blue-600":"bg-white hover:bg-gray-50 border-gray-200 text-gray-700"])}," All ",2),e("button",{onClick:i[2]||(i[2]=d=>r.$emit("filter-change","lead")),class:N(["text-xs font-medium px-3 py-1.5 rounded-md border transition-colors",t.typeFilter==="lead"?"bg-blue-600 text-white border-blue-600":"bg-white hover:bg-gray-50 border-gray-200 text-gray-700"])}," Leads ",2),e("button",{onClick:i[3]||(i[3]=d=>r.$emit("filter-change","opportunity")),class:N(["text-xs font-medium px-3 py-1.5 rounded-md border transition-colors",t.typeFilter==="opportunity"?"bg-blue-600 text-white border-blue-600":"bg-white hover:bg-gray-50 border-gray-200 text-gray-700"])}," Opportunities ",2)])])):g("",!0),e("div",kt,[e("div",Ct,[i[7]||(i[7]=e("i",{class:"fa-solid fa-magnifying-glass absolute left-3 top-2.5 text-gray-400 text-sm"},null,-1)),O(e("input",{"onUpdate:modelValue":i[4]||(i[4]=d=>a.value=d),type:"text",placeholder:t.searchPlaceholder,class:"w-full bg-gray-50 border border-gray-200 rounded-lg pl-9 pr-3 py-2 text-sm"},null,8,$t),[[R,a.value]])])]),e("div",St,[(o(!0),n(P,null,te(l.value,d=>(o(),n("div",{key:d.id,onClick:v=>r.$emit("select",d.compositeId||`${d.type||"task"}-${d.id}`||d.id),class:N(["rounded-xl px-4 py-3.5 cursor-pointer transition-all relative group",p(d)?typeof t.selectedClass=="function"?t.selectedClass(d):t.selectedClass:typeof t.unselectedClass=="function"?t.unselectedClass(d):t.unselectedClass])},[t.showMenu?(o(),n("button",{key:0,onClick:z(v=>r.$emit("menu-click",d.id),["stop"]),class:"absolute top-2 right-2 w-5 h-5 flex items-center justify-center rounded hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors z-10"},[...i[8]||(i[8]=[e("i",{class:"fa-solid fa-ellipsis-vertical text-xs"},null,-1)])],8,At)):g("",!0),t.openMenuId===d.id&&t.showMenu?O((o(),n("div",Tt,[be(r.$slots,"menu",{item:d})])),[[s,()=>r.$emit("menu-close")]]):g("",!0),e("div",qt,[e("div",{class:N(["w-10 h-10 rounded-full flex items-center justify-center text-xs font-bold shrink-0",t.avatarClass(d)])},f(t.getInitials(d)),3),e("div",Ot,[e("div",It,f(t.getName(d)),1),e("div",Nt,f(t.getVehicleInfo(d)),1)]),e("div",jt,[be(r.$slots,"meta",{item:d}),be(r.$slots,"footer",{item:d})])]),e("div",Mt,[be(r.$slots,"badges",{item:d})])],10,Dt))),128))])]))}},Vt={class:"h-16 px-5 border-b border-gray-100 bg-gray-50/50 flex items-center justify-between gap-3"},Ft={class:"flex items-center gap-3"},Lt={key:2,class:"font-bold text-lg text-gray-800"},Ut={key:0,class:"flex-1 overflow-y-auto px-5 py-6 scrollbar-hide relative"},Et={key:0,class:"absolute left-[39px] top-0 bottom-0 w-0.5 bg-gray-200 z-0"},Bt={key:1,class:"text-center py-8 text-gray-400 relative z-10"},Wt={class:"text-sm"},Pt={key:2,class:"space-y-6 relative z-10"},zt={key:0,class:"mb-4 pl-12"},Yt={class:"text-sm font-semibold text-gray-800"},Qt={class:"flex gap-4 relative mb-6"},Ht={class:"flex-1 min-w-0"},Kt={class:"text-sm text-slate-700 leading-snug"},Jt={class:"font-bold"},Gt={key:0,class:"mt-2 bg-orange-50/50 border border-orange-100 p-3 rounded-lg text-sm text-gray-700"},Xt={class:"text-xs text-gray-400 mt-1"},Ve={__name:"ActivitySummarySidebar",props:{title:{type:String,default:"Activity summary"},activities:{type:Array,default:()=>[]},emptyMessage:{type:String,default:"No activities yet"},collapsed:{type:Boolean,default:!1},showCollapse:{type:Boolean,default:!0},show:{type:Boolean,default:!0},mobileFullscreen:{type:Boolean,default:!1}},emits:["toggle-collapse","close"],setup(t,{emit:h}){const s=t,u=i=>{const d={call:"fa-solid fa-phone text-blue-600",email:"fa-solid fa-envelope text-green-600",note:"fa-solid fa-sticky-note text-yellow-600",meeting:"fa-solid fa-calendar text-purple-600",task:"fa-solid fa-check-circle text-indigo-600",attachment:"fa-solid fa-paperclip text-gray-600",status:"fa-solid fa-tag text-orange-600",default:"fa-solid fa-circle text-gray-400"};return d[i]||d.default},a=i=>{const d={call:"bg-blue-100 text-blue-600",email:"bg-green-100 text-green-600",note:"bg-yellow-100 text-yellow-600",meeting:"bg-purple-100 text-purple-600",task:"bg-indigo-100 text-indigo-600",attachment:"bg-gray-100 text-gray-600",status:"bg-orange-100 text-orange-600",default:"bg-gray-100 text-gray-400"};return d[i]||d.default},l=i=>{if(!i)return"";const d=new Date(i),v=new Date,m=new Date(v);return m.setDate(m.getDate()-1),d.toDateString()===v.toDateString()?"Today":d.toDateString()===m.toDateString()?"Yesterday":d.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},p=i=>i?new Date(i).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",r=(i,d)=>{if(i===0)return!0;const v=s.activities[i-1];if(!v)return!0;const m=new Date(d.timestamp).toDateString(),c=new Date(v.timestamp).toDateString();return m!==c};return(i,d)=>t.show?(o(),n("div",{key:0,class:N(["bg-white border-l border-gray-200 shrink-0 flex flex-col transition-all duration-300",[t.collapsed?"w-16":"w-80",t.mobileFullscreen?"xl:relative xl:border-l":""]])},[e("div",Vt,[e("div",Ft,[t.mobileFullscreen?(o(),n("button",{key:0,onClick:d[0]||(d[0]=v=>i.$emit("close")),class:"xl:hidden w-8 h-8 flex items-center justify-center text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"},[...d[2]||(d[2]=[e("i",{class:"fa-solid fa-xmark text-lg"},null,-1)])])):t.showCollapse?(o(),n("button",{key:1,onClick:d[1]||(d[1]=v=>i.$emit("toggle-collapse")),class:"w-8 h-8 flex items-center justify-center rounded-md text-gray-400 hover:text-gray-900 hover:bg-gray-100 transition-colors shrink-0",title:"Toggle Sidebar"},[e("i",{class:N(["fa-solid fa-arrow-right-from-bracket transition-transform duration-300",t.collapsed?"rotate-180":""])},null,2)])):g("",!0),t.collapsed?g("",!0):(o(),n("h2",Lt,f(t.title),1))])]),t.collapsed?g("",!0):(o(),n("div",Ut,[t.activities.length>0?(o(),n("div",Et)):g("",!0),t.activities.length===0?(o(),n("div",Bt,[d[3]||(d[3]=e("i",{class:"fa-solid fa-clock text-4xl mb-2"},null,-1)),e("p",Wt,f(t.emptyMessage),1)])):(o(),n("div",Pt,[(o(!0),n(P,null,te(t.activities,(v,m)=>(o(),n(P,{key:v.id},[r(m,v)?(o(),n("div",zt,[e("h3",Yt,f(l(v.timestamp)),1)])):g("",!0),e("div",Qt,[e("div",{class:N(["w-10 h-10 rounded-full flex items-center justify-center shrink-0 z-10 relative bg-white",a(v.type)])},[e("i",{class:N([u(v.type),"text-sm"])},null,2)],2),e("div",Ht,[e("div",Kt,[e("span",Jt,f(v.user),1),j(" "+f(v.action),1)]),v.content?(o(),n("div",Gt,f(v.content),1)):g("",!0),e("div",Xt,f(p(v.timestamp)),1)])])],64))),128))]))]))],2)):g("",!0)}},Zt={class:"w-full"},_t={class:"flex items-center justify-between gap-3 md:gap-4"},es={class:"flex items-center gap-3 md:gap-4 flex-1"},ts={class:"min-w-0 flex-1"},ss={class:"heading-main truncate"},os={class:"flex flex-wrap items-center gap-2 mt-1"},ls={class:"flex items-center gap-1 ml-2"},as={key:0,class:"mt-4 pt-4 border-t-2 border-dashed border-gray-300 animate-fade-in relative"},ns={class:"flex items-center gap-4"},is={class:"flex flex-wrap items-center gap-x-6 gap-y-2"},rs={class:"flex items-center gap-2"},ds={class:"text-xs text-gray-900 font-medium"},us={class:"flex items-center gap-2"},cs={class:"text-xs text-gray-900 font-medium"},ps={class:"flex items-center gap-2"},ms={class:"w-6 h-6 rounded bg-gray-100 flex items-center justify-center shrink-0"},ys={key:0,class:"fa-solid fa-map-marker-alt text-gray-500 text-[10px]"},gs={key:1,class:"fa-regular fa-calendar text-gray-500 text-[10px]"},fs={class:"text-xs text-gray-900 font-medium"},bs={key:0,class:"absolute -bottom-6 left-0 px-2 py-1 bg-gray-900 text-white text-[10px] rounded shadow-lg whitespace-nowrap"},vs={__name:"ContactInfo",props:{initials:{type:String,required:!0},name:{type:String,required:!0},avatarColorClass:{type:String,default:"bg-orange-100 text-orange-600"},email:{type:String,required:!0},phone:{type:String,required:!0},thirdFieldValue:{type:String,required:!0},emailLabel:{type:String,default:"Email"},phoneLabel:{type:String,default:"Phone"},thirdFieldLabel:{type:String,default:"Expected Close"}},setup(t){const h=k(!1),s=k(null),u=async(a,l)=>{try{await navigator.clipboard.writeText(a),s.value=l,setTimeout(()=>{s.value=null},1500)}catch(p){console.error("Failed to copy:",p)}};return(a,l)=>(o(),n("div",Zt,[e("div",_t,[e("div",es,[e("div",{class:N(["w-12 h-12 rounded-full flex items-center justify-center text-lg font-bold border-2 border-white shadow-sm shrink-0",t.avatarColorClass])},f(t.initials),3),e("div",ts,[e("h1",ss,f(t.name),1),e("div",os,[be(a.$slots,"tags")])])]),e("div",ls,[e("button",{onClick:l[0]||(l[0]=p=>h.value=!h.value),class:"w-9 h-9 flex items-center justify-center bg-white border border-gray-200 rounded-lg hover:bg-gray-50 shrink-0"},[e("i",{class:N(["fa-solid fa-chevron-down text-sm transition-transform duration-200",{"rotate-180":h.value}])},null,2)])])]),h.value?(o(),n("div",as,[e("div",ns,[e("div",is,[e("div",rs,[l[4]||(l[4]=e("div",{class:"w-6 h-6 rounded bg-gray-100 flex items-center justify-center shrink-0"},[e("i",{class:"fa-regular fa-envelope text-gray-500 text-[10px]"})],-1)),e("span",ds,f(t.email),1),e("button",{onClick:l[1]||(l[1]=z(p=>u(t.email,"email"),["stop"])),class:"w-5 h-5 flex items-center justify-center rounded hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors shrink-0",title:"Copy email"},[...l[3]||(l[3]=[e("i",{class:"fa-regular fa-copy text-[10px]"},null,-1)])])]),e("div",us,[l[6]||(l[6]=e("div",{class:"w-6 h-6 rounded bg-gray-100 flex items-center justify-center shrink-0"},[e("i",{class:"fa-solid fa-phone text-gray-500 text-[10px]"})],-1)),e("span",cs,f(t.phone),1),e("button",{onClick:l[2]||(l[2]=z(p=>u(t.phone,"phone"),["stop"])),class:"w-5 h-5 flex items-center justify-center rounded hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors shrink-0",title:"Copy phone"},[...l[5]||(l[5]=[e("i",{class:"fa-regular fa-copy text-[10px]"},null,-1)])])]),e("div",ps,[e("div",ms,[t.thirdFieldLabel.toLowerCase().includes("address")?(o(),n("i",ys)):(o(),n("i",gs))]),e("span",fs,f(t.thirdFieldValue),1)])])]),s.value?(o(),n("div",bs,f(s.value==="email"?"Email":"Phone")+" copied! ",1)):g("",!0)])):g("",!0)]))}},xs={class:"flex gap-8 text-base font-medium text-slate-500 py-1 overflow-x-auto scrollbar-hide"},hs=["onClick"],ws={__name:"Tabs",props:{modelValue:{type:String,required:!0},tabs:{type:Array,required:!0}},emits:["update:modelValue"],setup(t){return(h,s)=>(o(),n("div",xs,[(o(!0),n(P,null,te(t.tabs,u=>(o(),n("div",{key:u.key,onClick:a=>h.$emit("update:modelValue",u.key),class:N(["pb-2 border-b-2 cursor-pointer whitespace-nowrap transition-colors",t.modelValue===u.key?"border-slate-900 text-slate-900":"border-transparent hover:text-slate-700 hover:border-slate-200"])},[j(f(u.label)+" ",1),u.count!==void 0?(o(),n("span",{key:0,class:N(["ml-2 inline-flex items-center justify-center px-2 py-0.5 rounded-full text-xs font-semibold",t.modelValue===u.key?"bg-gray-200 text-gray-700":"bg-gray-100 text-gray-500"])},f(u.count),3)):g("",!0)],10,hs))),128))]))}},ks={class:"metadata-bar w-full"},Cs={class:"flex items-center gap-1.5 md:gap-2 px-2 md:px-3 py-1.5"},$s={class:"text-[10px] md:text-xs font-bold text-gray-800"},Ss={key:0,class:"flex items-center gap-1.5 md:gap-2 px-2 md:px-3 py-1.5"},Ds={class:"flex items-center gap-1.5 md:gap-2"},As={class:"w-12 md:w-16 bg-gray-200 rounded-full h-1.5 md:h-2"},Ts={class:"text-[10px] md:text-xs font-bold text-gray-800"},qs={key:1,class:"metadata-divider"},Os={class:"flex items-center gap-1.5 md:gap-2 px-2 md:px-3 py-1.5"},Is={class:"text-[10px] md:text-xs font-bold text-gray-800"},Ns={class:"flex items-center gap-1.5 md:gap-2 px-2 md:px-3 py-1.5"},js={class:"text-[10px] md:text-xs font-bold text-gray-800"},Ms={__name:"StageOwnerBar",props:{stage:{type:String,required:!0},owner:{type:String,required:!0},source:{type:String,default:""},probability:{type:Number,default:null}},setup(t){const h=t,s=T(()=>h.probability!==null&&h.probability!==void 0),u=T(()=>h.probability>=70?"bg-green-500":h.probability>=40?"bg-orange-500":"bg-red-500");return(a,l)=>(o(),n("div",ks,[e("div",Cs,[l[0]||(l[0]=e("span",{class:"label-upper text-[9px] md:text-xs"},"Stage",-1)),e("span",$s,f(t.stage),1)]),l[5]||(l[5]=e("div",{class:"metadata-divider"},null,-1)),s.value?(o(),n("div",Ss,[l[1]||(l[1]=e("span",{class:"label-upper text-[9px] md:text-xs"},"Probability",-1)),e("div",Ds,[e("div",As,[e("div",{class:N(["h-1.5 md:h-2 rounded-full transition-all",u.value]),style:Le({width:t.probability+"%"})},null,6)]),e("span",Ts,f(t.probability)+"%",1)])])):g("",!0),s.value?(o(),n("div",qs)):g("",!0),e("div",Os,[l[2]||(l[2]=e("span",{class:"label-upper text-[9px] md:text-xs"},"Owner",-1)),e("span",Is,f(t.owner),1)]),t.source?(o(),n(P,{key:2},[l[4]||(l[4]=e("div",{class:"metadata-divider"},null,-1)),e("div",Ns,[l[3]||(l[3]=e("span",{class:"label-upper text-[9px] md:text-xs"},"Source",-1)),e("span",js,f(t.source),1)])],64)):g("",!0)]))}},Rs={key:0,class:"flex-grow border-t border-gray-200"},Vs={key:0,class:"absolute top-full right-0 md:left-1/2 md:-translate-x-1/2 mt-2 w-48 bg-white border border-gray-200 rounded-xl shadow-lg shadow-gray-100/50 z-10 overflow-hidden flex flex-col p-1"},Fs={key:0,class:"border-t border-gray-100 my-1"},Ls={key:1,class:"flex-grow border-t border-gray-200"},Te={__name:"AddNewButton",props:{show:{type:Boolean,default:!0},actions:{type:Array,default:()=>["note","financing","tradein","attachment","email","whatsapp","sms"]},activeTab:{type:String,default:"overview"},inline:{type:Boolean,default:!1}},emits:["action"],setup(t,{emit:h}){const s={mounted(b,y){b.clickOutsideEvent=S=>{b===S.target||b.contains(S.target)||y.value()},document.addEventListener("click",b.clickOutsideEvent)},unmounted(b){document.removeEventListener("click",b.clickOutsideEvent)}},u=t,a=h,l=k(!1),p=T(()=>u.inline?"bg-blue-600 hover:bg-blue-700 text-white font-medium px-3 md:px-4 py-2 md:py-2 text-xs md:text-sm rounded-lg shadow-sm transition-all flex items-center justify-center gap-1.5 md:gap-2 z-20 relative whitespace-nowrap":"bg-gray-50 hover:bg-white border border-gray-200 text-slate-700 font-medium px-4 py-1.5 rounded-full text-sm shadow-sm transition-all flex items-center gap-2 z-20 relative"),r={note:"note",attachment:"attachment",email:"communication",whatsapp:"communication",sms:"communication"},i=T(()=>{if(!u.activeTab||u.activeTab==="overview")return u.actions.filter(y=>!r[y]);const b=Object.entries(r).filter(([,y])=>y===u.activeTab).map(([y])=>y);return u.actions.filter(y=>b.includes(y))}),d=T(()=>i.value.some(b=>["email","whatsapp","sms"].includes(b))),v=T(()=>i.value.some(b=>["addVehicle","configureVehicle"].includes(b))),m=T(()=>i.value.some(b=>["note","financing","tradein","attachment","requestedCar","purchase"].includes(b))),c=b=>{l.value=!1,a("action",b)};return(b,y)=>t.show?(o(),n("div",{key:0,class:N(["relative flex items-center",t.inline?"justify-end mb-0 py-0":"py-1 mb-4"])},[t.inline?g("",!0):(o(),n("div",Rs)),e("div",{class:N(["relative",t.inline?"mx-0":"mx-4"])},[e("button",{onClick:y[0]||(y[0]=z(S=>l.value=!l.value,["stop"])),class:N(p.value)},[...y[12]||(y[12]=[e("i",{class:"fa-solid fa-plus text-[10px] md:text-xs"},null,-1),e("span",{class:"text-xs md:text-sm"},"Add new",-1)])],2),l.value?O((o(),n("div",Vs,[v.value?(o(),n(P,{key:0},[i.value.includes("addVehicle")?(o(),n("button",{key:0,onClick:y[1]||(y[1]=S=>c("addVehicle")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Add Vehicle ")):g("",!0),i.value.includes("configureVehicle")?(o(),n("button",{key:1,onClick:y[2]||(y[2]=S=>c("configureVehicle")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Configure Vehicle ")):g("",!0)],64)):g("",!0),m.value?(o(),n(P,{key:1},[v.value?(o(),n("div",Fs)):g("",!0),i.value.includes("note")?(o(),n("button",{key:1,onClick:y[3]||(y[3]=S=>c("note")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Note ")):g("",!0),i.value.includes("financing")?(o(),n("button",{key:2,onClick:y[4]||(y[4]=S=>c("financing")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Financing ")):g("",!0),i.value.includes("tradein")?(o(),n("button",{key:3,onClick:y[5]||(y[5]=S=>c("tradein")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Trade-in ")):g("",!0),i.value.includes("requestedCar")?(o(),n("button",{key:4,onClick:y[6]||(y[6]=S=>c("requestedCar")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Requested car ")):g("",!0),i.value.includes("purchase")?(o(),n("button",{key:5,onClick:y[7]||(y[7]=S=>c("purchase")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Purchase ")):g("",!0),i.value.includes("attachment")?(o(),n("button",{key:6,onClick:y[8]||(y[8]=S=>c("attachment")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Attachment ")):g("",!0)],64)):g("",!0),d.value?(o(),n(P,{key:2},[y[16]||(y[16]=e("div",{class:"border-t border-gray-100 my-1"},null,-1)),i.value.includes("email")?(o(),n("button",{key:0,onClick:y[9]||(y[9]=S=>c("email")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...y[13]||(y[13]=[e("i",{class:"fa-regular fa-envelope text-xs text-gray-400"},null,-1),j(" Send Email ",-1)])])):g("",!0),i.value.includes("whatsapp")?(o(),n("button",{key:1,onClick:y[10]||(y[10]=S=>c("whatsapp")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...y[14]||(y[14]=[e("i",{class:"fa-brands fa-whatsapp text-xs text-gray-400"},null,-1),j(" Send WhatsApp ",-1)])])):g("",!0),i.value.includes("sms")?(o(),n("button",{key:2,onClick:y[11]||(y[11]=S=>c("sms")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...y[15]||(y[15]=[e("i",{class:"fa-solid fa-comment-dots text-xs text-gray-400"},null,-1),j(" Send SMS ",-1)])])):g("",!0)],64)):g("",!0)])),[[s,()=>l.value=!1]]):g("",!0)],2),t.inline?g("",!0):(o(),n("div",Ls))],2)):g("",!0)}},Us={class:"bg-purple-50/50 border border-purple-100 rounded-lg p-4"},Es={class:"flex items-start gap-3"},Bs={class:"flex-1 min-w-0"},Ws={class:"font-bold text-sm text-slate-800 mb-2"},Ps={class:"space-y-1.5 text-xs text-gray-600"},zs={class:"flex items-center gap-2"},Ys={class:"flex items-center gap-2"},Qs={class:"flex items-center gap-2"},Hs={key:0,class:"mt-2"},Ks={__name:"AppointmentWidget",props:{appointmentData:{type:Object,required:!0}},setup(t){const h=t,s=T(()=>h.appointmentData.date?new Date(h.appointmentData.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""),u=T(()=>h.appointmentData.time?h.appointmentData.time:""),a=l=>({scheduled:"bg-blue-100 text-blue-700 border border-blue-200",confirmed:"bg-green-100 text-green-700 border border-green-200",pending:"bg-yellow-100 text-yellow-700 border border-yellow-200",cancelled:"bg-red-100 text-red-700 border border-red-200"})[l==null?void 0:l.toLowerCase()]||"bg-gray-100 text-gray-700 border border-gray-200";return(l,p)=>(o(),n("div",Us,[e("div",Es,[p[3]||(p[3]=e("div",{class:"w-10 h-10 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center shrink-0"},[e("i",{class:"fa-solid fa-calendar text-sm"})],-1)),e("div",Bs,[e("h4",Ws,f(t.appointmentData.type),1),e("div",Ps,[e("div",zs,[p[0]||(p[0]=e("i",{class:"fa-regular fa-calendar text-gray-400"},null,-1)),e("span",null,f(s.value),1)]),e("div",Ys,[p[1]||(p[1]=e("i",{class:"fa-regular fa-clock text-gray-400"},null,-1)),e("span",null,f(u.value),1)]),e("div",Qs,[p[2]||(p[2]=e("i",{class:"fa-solid fa-user text-gray-400"},null,-1)),e("span",null,f(t.appointmentData.assignee),1)])]),t.appointmentData.status?(o(),n("div",Hs,[e("span",{class:N(["inline-flex px-2 py-0.5 rounded text-[10px] font-semibold",a(t.appointmentData.status)])},f(t.appointmentData.status),3)])):g("",!0)])])]))}},Js={class:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm flex gap-4 animate-fade-in mb-4 feed-item"},Gs={class:"flex-1"},Xs={class:"flex items-center gap-2 mb-1"},Zs={class:"text-xs font-bold text-slate-800"},_s={class:"text-[10px] text-gray-400"},eo={class:"text-[10px] text-gray-400"},to={key:0,class:"bg-blue-50 text-blue-600 text-[9px] px-1.5 py-0.5 rounded border border-blue-100"},so={class:"ml-auto relative"},oo={key:0,class:"absolute right-0 top-full mt-1 w-32 bg-white border border-gray-200 rounded-lg shadow-lg z-10 overflow-hidden"},lo={key:0,class:"text-sm text-slate-700"},ao={key:1,class:"text-sm text-slate-700 flex items-center gap-2"},no={key:2,class:"mt-2"},io={key:0},ro={key:1,class:"bg-gray-50 border border-gray-200 rounded-lg p-3"},uo={key:0},co={class:"text-sm font-bold text-slate-800"},po={key:0,class:"text-xs text-gray-600 mt-0.5"},mo={class:"grid grid-cols-2 gap-x-4 gap-y-1 text-xs text-gray-500 mt-2"},yo={key:0},go={key:1},fo={key:2},bo={key:3},vo={key:4},xo={key:1},ho={class:"text-sm font-bold text-slate-800 mb-2"},wo={class:"grid grid-cols-2 gap-x-4 gap-y-2 text-xs"},ko={key:0},Co={class:"text-slate-700 font-medium ml-1"},$o={key:1},So={class:"text-slate-700 font-medium ml-1"},Do={key:2},Ao={class:"text-slate-700 font-medium ml-1"},To={key:3},qo={class:"text-slate-700 font-medium ml-1"},Oo={key:4},Io={class:"text-slate-700 font-medium ml-1"},No={key:5},jo={class:"text-slate-700 font-medium ml-1"},Mo={key:2,class:"flex items-center gap-3"},Ro={key:0,class:"w-16 h-16 bg-gray-200 rounded overflow-hidden flex-shrink-0"},Vo=["src"],Fo={class:"flex-1"},Lo={class:"text-sm font-bold text-slate-800"},Uo={class:"text-xs text-gray-500"},Eo={key:1,class:"bg-purple-600 text-white text-[10px] font-bold px-2 py-0.5 rounded"},Bo={key:3,class:"flex items-center gap-3"},Wo={class:"flex-1"},Po={class:"text-sm font-bold text-slate-800"},zo={class:"text-xs text-gray-500"},Yo={key:0,class:"text-xs text-gray-400 mt-1"},Qo={key:1,class:"text-xs text-gray-600 mt-1"},Ho={__name:"FeedItemCard",props:{item:{type:Object,required:!0},taskType:{type:String,default:"lead"},customerInitials:{type:String,required:!0}},emits:["edit","delete"],setup(t,{emit:h}){const s=t,u=h,a=k(!1),l={mounted(b,y){b.clickOutsideEvent=S=>{b===S.target||b.contains(S.target)||y.value()},setTimeout(()=>{document.addEventListener("click",b.clickOutsideEvent)},0)},unmounted(b){document.removeEventListener("click",b.clickOutsideEvent)}},p=b=>({note:"fa-regular fa-note-sticky",communication:"fa-solid fa-comment-dots",email:"fa-regular fa-envelope",whatsapp:"fa-brands fa-whatsapp",sms:"fa-solid fa-comment-dots",attachment:"fa-solid fa-paperclip",tradein:"fa-solid fa-car-side",financing:"fa-solid fa-file-invoice-dollar",offer:"fa-solid fa-handshake",purchase:"fa-solid fa-shopping-cart",appointment:"fa-solid fa-calendar"})[b]||"fa-solid fa-circle",r=b=>({note:"bg-orange-100 text-orange-600 border-orange-200",communication:"bg-gray-100 text-gray-600 border-gray-200",email:"bg-blue-100 text-blue-600 border-blue-200",whatsapp:"bg-green-100 text-green-600 border-green-200",sms:"bg-gray-100 text-gray-600 border-gray-200",attachment:"bg-blue-50 text-blue-600 border-blue-100",tradein:"bg-green-50 text-green-600 border-green-100",financing:"bg-purple-50 text-purple-600 border-purple-100",offer:"bg-indigo-50 text-indigo-600 border-indigo-100",purchase:"bg-teal-50 text-teal-600 border-teal-100",appointment:"bg-purple-100 text-purple-600 border-purple-200"})[b]||"bg-gray-100 text-gray-600 border-gray-200",i=b=>{if(!b)return"Just now";const y=new Date(b),q=new Date-y,I=Math.floor(q/6e4),F=Math.floor(I/60),U=Math.floor(F/24);return I<1?"Just now":I<60?`${I} minutes ago`:F<24?`${F} hours ago`:U===1?"Yesterday":U<7?`${U} days ago`:y.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},d=b=>b?new Intl.NumberFormat("en-US").format(b):"0",v=b=>b?new Date(b).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",m=()=>{a.value=!1,u("edit",s.item)},c=()=>{a.value=!1,confirm("Are you sure you want to delete this item?")&&u("delete",s.item)};return(b,y)=>(o(),n("div",Js,[e("div",{class:N(["w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold shrink-0 border",r(t.item.type)])},[e("i",{class:N([p(t.item.type),"text-sm"])},null,2)],2),e("div",Gs,[e("div",Xs,[e("span",Zs,f(t.customerInitials),1),e("span",_s,f(t.item.action||"added"),1),e("span",eo,"• "+f(i(t.item.timestamp)),1),t.item.autoDetected?(o(),n("span",to,"Auto-detected")):g("",!0),e("div",so,[e("button",{onClick:y[0]||(y[0]=z(S=>a.value=!a.value,["stop"])),class:"text-gray-400 hover:text-gray-600 transition-colors p-1",title:"More actions"},[...y[1]||(y[1]=[e("i",{class:"fa-solid fa-ellipsis-vertical text-sm"},null,-1)])]),a.value?O((o(),n("div",oo,[e("button",{onClick:m,class:"w-full text-left px-3 py-2 text-xs text-slate-700 hover:bg-gray-50 flex items-center gap-2"},[...y[2]||(y[2]=[e("i",{class:"fa-solid fa-pencil text-gray-400"},null,-1),j(" Edit ",-1)])]),e("button",{onClick:c,class:"w-full text-left px-3 py-2 text-xs text-red-600 hover:bg-red-50 flex items-center gap-2"},[...y[3]||(y[3]=[e("i",{class:"fa-solid fa-trash text-red-400"},null,-1),j(" Delete ",-1)])])])),[[l,()=>a.value=!1]]):g("",!0)])]),t.item.content?(o(),n("div",lo,f(t.item.content),1)):g("",!0),t.item.fileName?(o(),n("div",ao,[y[4]||(y[4]=e("i",{class:"fa-solid fa-paperclip text-gray-400"},null,-1)),e("span",null,f(t.item.fileName),1)])):g("",!0),t.item.data?(o(),n("div",no,[t.item.type==="appointment"?(o(),n("div",io,[B(Ks,{"appointment-data":t.item.data},null,8,["appointment-data"])])):(o(),n("div",ro,[t.item.type==="tradein"?(o(),n("div",uo,[e("h4",co,f(t.item.data.brand)+" "+f(t.item.data.model),1),t.item.data.version?(o(),n("p",po,f(t.item.data.version),1)):g("",!0),e("div",mo,[t.item.data.year?(o(),n("div",yo,[y[5]||(y[5]=e("i",{class:"fa-regular fa-calendar mr-1"},null,-1)),j(f(t.item.data.year),1)])):g("",!0),t.item.data.km?(o(),n("div",go,[y[6]||(y[6]=e("i",{class:"fa-solid fa-road mr-1"},null,-1)),j(f(t.item.data.km)+" km ",1)])):g("",!0),t.item.data.plate?(o(),n("div",fo,[y[7]||(y[7]=e("i",{class:"fa-solid fa-id-card mr-1"},null,-1)),j(f(t.item.data.plate),1)])):g("",!0),t.item.data.date?(o(),n("div",bo,[y[8]||(y[8]=e("i",{class:"fa-regular fa-calendar-check mr-1"},null,-1)),j(f(v(t.item.data.date)),1)])):g("",!0),t.item.data.class?(o(),n("div",vo,[y[9]||(y[9]=e("i",{class:"fa-solid fa-car mr-1"},null,-1)),j(f(t.item.data.class),1)])):g("",!0)])])):t.item.type==="financing"?(o(),n("div",xo,[e("h4",ho,f(t.item.data.product),1),e("div",wo,[t.item.data.provider?(o(),n("div",ko,[y[10]||(y[10]=e("span",{class:"text-gray-500"},"Provider:",-1)),e("span",Co,f(t.item.data.provider),1)])):g("",!0),t.item.data.total?(o(),n("div",$o,[y[11]||(y[11]=e("span",{class:"text-gray-500"},"Total:",-1)),e("span",So,"€"+f(d(t.item.data.total)),1)])):g("",!0),t.item.data.monthly?(o(),n("div",Do,[y[12]||(y[12]=e("span",{class:"text-gray-500"},"Monthly:",-1)),e("span",Ao,"€"+f(d(t.item.data.monthly)),1)])):g("",!0),t.item.data.deposit?(o(),n("div",To,[y[13]||(y[13]=e("span",{class:"text-gray-500"},"Deposit:",-1)),e("span",qo,"€"+f(d(t.item.data.deposit)),1)])):g("",!0),t.item.data.startDate?(o(),n("div",Oo,[y[14]||(y[14]=e("span",{class:"text-gray-500"},"Start:",-1)),e("span",Io,f(v(t.item.data.startDate)),1)])):g("",!0),t.item.data.expDate?(o(),n("div",No,[y[15]||(y[15]=e("span",{class:"text-gray-500"},"Expires:",-1)),e("span",jo,f(v(t.item.data.expDate)),1)])):g("",!0)])])):t.item.type==="offer"?(o(),n("div",Mo,[t.item.data.image?(o(),n("div",Ro,[e("img",{src:t.item.data.image,alt:"Car",class:"w-full h-full object-cover"},null,8,Vo)])):g("",!0),e("div",Fo,[e("h4",Lo,f(t.item.data.brand)+" "+f(t.item.data.model)+" ("+f(t.item.data.year)+")",1),e("p",Uo,"€ "+f(d(t.item.data.price)),1)]),t.item.data.isMainOffer?(o(),n("span",Eo,"Main Offer")):g("",!0)])):t.item.type==="purchase"?(o(),n("div",Bo,[e("div",Wo,[e("h4",Po,f(t.item.data.brand)+" "+f(t.item.data.model)+" ("+f(t.item.data.year)+")",1),e("p",zo,"€ "+f(d(t.item.data.price)),1),t.item.data.purchaseDate?(o(),n("p",Yo,"Purchased: "+f(v(t.item.data.purchaseDate)),1)):g("",!0),t.item.data.notes?(o(),n("p",Qo,f(t.item.data.notes),1)):g("",!0)])])):g("",!0)]))])):g("",!0)])]))}},Ko={class:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm mb-6 animate-fade-in relative"},Jo={class:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3"},Go={class:"mb-3"},Xo={class:"flex justify-end gap-2"},Zo={__name:"CommunicationWidget",props:{type:{type:String,required:!0},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(t,{emit:h}){const s=t,u=h,a=k(""),l=k(""),p=()=>{!a.value.trim()&&!l.value||u("save",{type:"communication",action:`sent via ${s.type}`,content:a.value||`Sent template: ${l.value}`,communicationType:s.type})};return(r,i)=>(o(),n("div",Ko,[i[5]||(i[5]=e("div",{class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-t border-l border-gray-200 rotate-45"},null,-1)),e("h5",Jo,f(t.type==="email"?"Send Email":t.type==="whatsapp"?"Send WhatsApp":t.type==="sms"?"Send SMS":"Send Message"),1),e("div",Go,[i[4]||(i[4]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Template",-1)),O(e("select",{"onUpdate:modelValue":i[0]||(i[0]=d=>l.value=d),class:"w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500 cursor-pointer"},[...i[3]||(i[3]=[e("option",{value:""},"Select a template...",-1),e("option",null,"Follow-up",-1),e("option",null,"Meeting Confirmation",-1),e("option",null,"Quote Proposal",-1),e("option",null,"Unable to Reach",-1)])],512),[[de,l.value]])]),O(e("textarea",{"onUpdate:modelValue":i[1]||(i[1]=d=>a.value=d),class:"w-full bg-gray-50 border border-gray-200 rounded-lg p-3 text-sm focus:outline-none focus:border-blue-500 resize-none mb-3",rows:"4",placeholder:"Type your message here..."},null,512),[[R,a.value]]),e("div",Xo,[e("button",{onClick:i[2]||(i[2]=d=>r.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:p,class:"bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Send")])]))}},_o={class:"bg-white border border-gray-200 rounded-xl p-5 shadow-sm mb-6 animate-fade-in relative"},el={class:"flex justify-between items-center mb-4"},tl={class:"text-sm font-bold text-slate-800"},sl={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},ol={__name:"NoteWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(t,{emit:h}){const s=t,u=h,a=k("");ie(()=>{s.item&&(a.value=s.item.content||"")});const l=()=>{var p,r;a.value.trim()&&u("save",{id:((p=s.item)==null?void 0:p.id)||Date.now(),type:"note",action:s.item?"updated a note":"added a note",content:a.value,timestamp:((r=s.item)==null?void 0:r.timestamp)||new Date().toISOString(),isEdit:!!s.item})};return(p,r)=>(o(),n("div",_o,[r[5]||(r[5]=e("div",{class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-t border-l border-gray-200 rotate-45"},null,-1)),e("div",el,[e("h5",tl,f(t.item?"Edit Note":"Add Note"),1),e("button",{onClick:r[0]||(r[0]=i=>p.$emit("cancel")),class:"text-gray-400 hover:text-gray-600"},[...r[3]||(r[3]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),e("div",null,[r[4]||(r[4]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Note",-1)),O(e("textarea",{"onUpdate:modelValue":r[1]||(r[1]=i=>a.value=i),rows:"4",class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500 placeholder-gray-400 transition-colors shadow-sm resize-none",placeholder:"Enter your note..."},null,512),[[R,a.value]])]),e("div",sl,[e("button",{onClick:r[2]||(r[2]=i=>p.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:l,class:"bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save")])]))}},ll={class:"bg-white border border-gray-200 rounded-xl p-5 shadow-sm mb-6 animate-fade-in relative"},al={class:"flex justify-between items-center mb-4"},nl={class:"text-sm font-bold text-slate-800"},il={class:"flex items-center gap-3"},rl={key:0,class:"text-sm text-slate-600"},dl={key:1,class:"text-sm text-gray-400"},ul={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},cl=["disabled"],pl={__name:"AttachmentWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(t,{emit:h}){const s=t,u=h,a=k(null),l=k("");ie(()=>{s.item&&(l.value=s.item.fileName||"")});const p=i=>{const d=i.target.files[0];d&&(a.value=d,l.value=d.name)},r=()=>{var i,d;!a.value&&!s.item||u("save",{id:((i=s.item)==null?void 0:i.id)||Date.now(),type:"attachment",action:s.item?"updated an attachment":"added an attachment",fileName:l.value,timestamp:((d=s.item)==null?void 0:d.timestamp)||new Date().toISOString(),isEdit:!!s.item})};return(i,d)=>(o(),n("div",ll,[d[6]||(d[6]=e("div",{class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-t border-l border-gray-200 rotate-45"},null,-1)),e("div",al,[e("h5",nl,f(t.item?"Edit Attachment":"Add Attachment"),1),e("button",{onClick:d[0]||(d[0]=v=>i.$emit("cancel")),class:"text-gray-400 hover:text-gray-600"},[...d[3]||(d[3]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),e("div",null,[d[5]||(d[5]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"File",-1)),e("div",il,[e("input",{type:"file",onChange:p,ref:"fileInput",class:"hidden"},null,544),e("button",{onClick:d[1]||(d[1]=v=>i.$refs.fileInput.click()),class:"bg-gray-50 hover:bg-gray-100 border border-gray-300 rounded-md px-4 py-2 text-sm text-slate-700 transition-colors"},[...d[4]||(d[4]=[e("i",{class:"fa-solid fa-paperclip mr-2"},null,-1),j("Choose File ",-1)])]),l.value?(o(),n("span",rl,f(l.value),1)):(o(),n("span",dl,"No file selected"))])]),e("div",ul,[e("button",{onClick:d[2]||(d[2]=v=>i.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:r,disabled:!a.value,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save",8,cl)])]))}},ml={class:"animate-fade-in"},yl={class:"space-y-4"},gl={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},fl={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},bl={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},vl=["disabled"],xl={__name:"FinancingWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(t,{emit:h}){const s=t,u=h,a=k({startDate:"",expDate:"",productName:"",deposit:"",loanAmount:""});ie(()=>{s.item&&s.item.data&&(a.value={startDate:s.item.data.startDate||"",expDate:s.item.data.expDate||"",productName:s.item.data.product||s.item.data.productName||"",deposit:s.item.data.deposit||"",loanAmount:s.item.data.total||s.item.data.loanAmount||""})});const l=()=>{var p,r;a.value.productName&&u("save",{id:((p=s.item)==null?void 0:p.id)||Date.now(),type:"financing",action:s.item?"updated a financing proposal":"added a financing proposal",data:{product:a.value.productName,provider:"Audi Financial",total:a.value.loanAmount||"0",monthly:Math.round(parseFloat(a.value.loanAmount||0)/36).toString(),startDate:a.value.startDate,expDate:a.value.expDate,deposit:a.value.deposit},timestamp:((r=s.item)==null?void 0:r.timestamp)||new Date().toISOString(),isEdit:!!s.item})};return(p,r)=>(o(),n("div",ml,[e("div",yl,[e("div",gl,[e("div",null,[r[6]||(r[6]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Start date",-1)),O(e("input",{type:"date","onUpdate:modelValue":r[0]||(r[0]=i=>a.value.startDate=i),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[R,a.value.startDate]])]),e("div",null,[r[7]||(r[7]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Expiration date",-1)),O(e("input",{type:"date","onUpdate:modelValue":r[1]||(r[1]=i=>a.value.expDate=i),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[R,a.value.expDate]])])]),e("div",null,[r[8]||(r[8]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Financial product name",-1)),O(e("input",{type:"text","onUpdate:modelValue":r[2]||(r[2]=i=>a.value.productName=i),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[R,a.value.productName]])]),e("div",fl,[e("div",null,[r[9]||(r[9]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Deposit",-1)),O(e("input",{type:"number","onUpdate:modelValue":r[3]||(r[3]=i=>a.value.deposit=i),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[R,a.value.deposit]])]),e("div",null,[r[10]||(r[10]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Total loan amount",-1)),O(e("input",{type:"number","onUpdate:modelValue":r[4]||(r[4]=i=>a.value.loanAmount=i),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[R,a.value.loanAmount]])])])]),e("div",bl,[e("button",{onClick:r[5]||(r[5]=i=>p.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:l,disabled:!a.value.productName,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save",8,vl)])]))}},hl={class:"animate-fade-in"},wl={class:"space-y-4"},kl={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Cl={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},$l={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},Sl=["disabled"],Dl={__name:"TradeInWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(t,{emit:h}){const s=t,u=h,a=k({class:"Car",brand:"",model:"",version:"",km:"",plate:"",date:""});ie(()=>{s.item&&s.item.data&&(a.value={class:s.item.data.class||"Car",brand:s.item.data.brand||"",model:s.item.data.model||"",version:s.item.data.version||"",km:s.item.data.km||"",plate:s.item.data.plate||"",date:s.item.data.date||""})});const l=()=>{var p,r;a.value.brand&&u("save",{id:((p=s.item)==null?void 0:p.id)||Date.now(),type:"tradein",action:s.item?"updated a trade-in":"added a trade-in",data:{class:a.value.class,brand:a.value.brand,model:a.value.model||"Unknown Model",year:a.value.date?new Date(a.value.date).getFullYear():"Unknown Year",km:a.value.km||"0",plate:a.value.plate||"",date:a.value.date||""},timestamp:((r=s.item)==null?void 0:r.timestamp)||new Date().toISOString(),isEdit:!!s.item})};return(p,r)=>(o(),n("div",hl,[e("div",wl,[e("div",null,[r[9]||(r[9]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Class",-1)),O(e("select",{"onUpdate:modelValue":r[0]||(r[0]=i=>a.value.class=i),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},[...r[8]||(r[8]=[e("option",{value:"Car"},"Car",-1),e("option",{value:"Motorcycle"},"Motorcycle",-1),e("option",{value:"Truck"},"Truck",-1)])],512),[[de,a.value.class]])]),e("div",kl,[e("div",null,[r[10]||(r[10]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Brand",-1)),O(e("input",{type:"text","onUpdate:modelValue":r[1]||(r[1]=i=>a.value.brand=i),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[R,a.value.brand]])]),e("div",null,[r[11]||(r[11]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Model",-1)),O(e("input",{type:"text","onUpdate:modelValue":r[2]||(r[2]=i=>a.value.model=i),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[R,a.value.model]])])]),e("div",null,[r[12]||(r[12]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Version",-1)),O(e("input",{type:"text","onUpdate:modelValue":r[3]||(r[3]=i=>a.value.version=i),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[R,a.value.version]])]),e("div",Cl,[e("div",null,[r[13]||(r[13]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Km",-1)),O(e("input",{type:"number","onUpdate:modelValue":r[4]||(r[4]=i=>a.value.km=i),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[R,a.value.km]])]),e("div",null,[r[14]||(r[14]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Plate",-1)),O(e("input",{type:"text","onUpdate:modelValue":r[5]||(r[5]=i=>a.value.plate=i),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[R,a.value.plate]])])]),e("div",null,[r[15]||(r[15]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Registration date",-1)),O(e("input",{type:"date","onUpdate:modelValue":r[6]||(r[6]=i=>a.value.date=i),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[R,a.value.date]])])]),e("div",$l,[e("button",{onClick:r[7]||(r[7]=i=>p.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:l,disabled:!a.value.brand,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save",8,Sl)])]))}},Al={class:"bg-white border border-gray-200 rounded-xl p-5 shadow-sm mb-6 animate-fade-in relative"},Tl={class:"flex justify-between items-center mb-4"},ql={class:"text-sm font-bold text-slate-800"},Ol={class:"space-y-4"},Il={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Nl={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},jl={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},Ml=["disabled"],Rl={__name:"PurchaseWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"opportunity"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(t,{emit:h}){const s=t,u=h,a=k({brand:"",model:"",year:"",price:"",purchaseDate:"",notes:""});ie(()=>{s.item&&s.item.data&&(a.value={brand:s.item.data.brand||"",model:s.item.data.model||"",year:s.item.data.year||"",price:s.item.data.price||"",purchaseDate:s.item.data.purchaseDate||"",notes:s.item.data.notes||""})});const l=T(()=>a.value.brand&&a.value.model&&a.value.price),p=()=>{var r,i;l.value&&u("save",{id:((r=s.item)==null?void 0:r.id)||Date.now(),type:"purchase",action:s.item?"updated a purchase":"added a purchase",data:{brand:a.value.brand,model:a.value.model,year:a.value.year||new Date().getFullYear(),price:a.value.price,purchaseDate:a.value.purchaseDate||new Date().toISOString().split("T")[0],notes:a.value.notes||""},timestamp:((i=s.item)==null?void 0:i.timestamp)||new Date().toISOString(),isEdit:!!s.item})};return(r,i)=>(o(),n("div",Al,[i[15]||(i[15]=e("div",{class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-t border-l border-gray-200 rotate-45"},null,-1)),e("div",Tl,[e("h5",ql,f(t.item?"Edit Purchase":"Add Purchase"),1),e("button",{onClick:i[0]||(i[0]=d=>r.$emit("cancel")),class:"text-gray-400 hover:text-gray-600"},[...i[8]||(i[8]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),e("div",Ol,[e("div",Il,[e("div",null,[i[9]||(i[9]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Brand",-1)),O(e("input",{type:"text","onUpdate:modelValue":i[1]||(i[1]=d=>a.value.brand=d),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[R,a.value.brand]])]),e("div",null,[i[10]||(i[10]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Model",-1)),O(e("input",{type:"text","onUpdate:modelValue":i[2]||(i[2]=d=>a.value.model=d),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[R,a.value.model]])])]),e("div",Nl,[e("div",null,[i[11]||(i[11]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Year",-1)),O(e("input",{type:"number","onUpdate:modelValue":i[3]||(i[3]=d=>a.value.year=d),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[R,a.value.year]])]),e("div",null,[i[12]||(i[12]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Purchase Price (€)",-1)),O(e("input",{type:"number","onUpdate:modelValue":i[4]||(i[4]=d=>a.value.price=d),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[R,a.value.price]])])]),e("div",null,[i[13]||(i[13]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Purchase Date",-1)),O(e("input",{type:"date","onUpdate:modelValue":i[5]||(i[5]=d=>a.value.purchaseDate=d),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[R,a.value.purchaseDate]])]),e("div",null,[i[14]||(i[14]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Notes",-1)),O(e("textarea",{"onUpdate:modelValue":i[6]||(i[6]=d=>a.value.notes=d),rows:"3",class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500 placeholder-gray-400 transition-colors shadow-sm resize-none",placeholder:"Additional purchase details..."},null,512),[[R,a.value.notes]])])]),e("div",jl,[e("button",{onClick:i[7]||(i[7]=d=>r.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:p,disabled:!l.value,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save",8,Ml)])]))}},Vl=t=>t==="note"?"note":["call","email","sms","whatsapp","communication"].includes(t)?"communication":t==="attachment"?"attachment":"overview";function Fl(t){const{store:h,taskId:s,getTabForItemType:u,isOverviewModalAction:a}=t,l=k("overview"),p=k(null),r=k(null),i=k("email"),d=k([]),v=T(()=>[...h.currentActivities.value,...d.value.filter(I=>!I.activityId)].filter(I=>{const F=u(I.type);return l.value==="overview"?F==="overview":F===l.value})),m=q=>(r.value=null,l.value==="overview"&&a(q)?{modalAction:q}:(["email","whatsapp","sms"].includes(q)?(i.value=q,p.value="communication"):p.value=q,null)),c=async q=>{var I;if(q.isEdit){const F=d.value.findIndex(U=>U.id===q.id);F>-1&&(d.value[F]={...d.value[F],...q}),(I=r.value)!=null&&I.activityId&&await h.updateActivity(s.value,r.value.activityId,{type:q.communicationType||q.type,user:"You",action:q.action,content:q.content,fileName:q.fileName,data:q.data})}else{const F=q.communicationType||q.type,U=await h.addActivity(s.value,{type:F,user:"You",action:q.action,content:q.content,fileName:q.fileName,data:q.data});d.value.push({id:U.id,type:F==="email"||F==="whatsapp"||F==="sms"?"communication":F,action:q.action,content:q.content,fileName:q.fileName,data:q.data,timestamp:U.timestamp,activityId:U.id})}p.value=null,r.value=null},b=()=>{p.value=null,r.value=null},y=q=>{r.value=q,p.value=q.type},S=async q=>{const I=d.value.findIndex(F=>F.id===q.id);I>-1&&d.value.splice(I,1),q.activityId&&await h.deleteActivity(s.value,q.activityId)};return ne(l,()=>{p.value=null,r.value=null}),{activeTab:l,showInlineWidget:p,editingItem:r,communicationType:i,inlineContent:d,filteredInlineContent:v,handleAddNewAction:m,handleWidgetSave:c,handleWidgetCancel:b,handleEditItem:y,handleDeleteItem:S}}const Ll={class:"flex-1 flex flex-col overflow-hidden"},Ul={class:"bg-white border-b border-gray-200 shrink-0 shadow-sm"},El={class:"px-4 md:px-8 py-4 md:py-6"},Bl={class:"flex-1 overflow-y-auto p-4 md:p-8 max-w-4xl mx-auto w-full scrollbar-hide"},Wl={class:"mb-4"},Pl={class:"flex items-center justify-between gap-2 mb-3 md:mb-0"},zl={key:0,class:"mb-6"},Yl={key:1,class:"space-y-6 mb-6"},Ql={key:3},Hl={key:4,class:"space-y-4 mb-6 px-1"},Kl={key:0,class:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"},Jl={class:"p-6"},Gl={class:"flex justify-between items-center mb-4"},Xl={class:"text-sm font-bold text-slate-800"},Zl={key:1,class:"max-w-2xl w-full max-h-[90vh] overflow-y-auto"},_l={__name:"TaskShell",props:{task:{type:Object,required:!0},type:{type:String,required:!0},managementWidget:{type:Object,required:!0},storeAdapter:{type:Object,required:!0},addNewConfig:{type:Object,required:!0}},setup(t){const h=t,s=T(()=>h.task.id),u=k(!1),a=k(null),{activeTab:l,showInlineWidget:p,editingItem:r,communicationType:i,inlineContent:d,filteredInlineContent:v,handleAddNewAction:m,handleWidgetSave:c,handleWidgetCancel:b,handleEditItem:y,handleDeleteItem:S}=Fl({store:h.storeAdapter,taskId:s,getTabForItemType:Vl,isOverviewModalAction:Y=>l.value==="overview"&&h.addNewConfig.overviewActions.includes(Y)}),q=Y=>{const G=m(Y);G&&G.modalAction&&(a.value=G.modalAction,u.value=!0)},I=()=>{u.value=!1,a.value=null},F=async Y=>{await c(Y),I()},U=T(()=>{const Y=[...h.storeAdapter.currentActivities.value,...d.value],G=Y.length,X=Y.filter(Z=>["call","email","sms","whatsapp","communication"].includes(Z.type)).length,se=Y.filter(Z=>Z.type==="note").length,ae=Y.filter(Z=>Z.type==="attachment").length;return[{key:"overview",label:"Overview",count:G},{key:"note",label:"Notes",count:se},{key:"communication",label:"Communication",count:X},{key:"attachment",label:"Attachments",count:ae}]}),oe=T(()=>[...h.storeAdapter.currentActivities.value,...d.value]);return(Y,G)=>(o(),n("div",Ll,[e("header",Ul,[e("div",El,[B(vs,{initials:t.task.customer.initials,name:t.task.customer.name,email:t.task.customer.email,phone:t.task.customer.phone,"third-field-value":t.task.customer.address,"avatar-color-class":t.type==="lead"?"bg-orange-100 text-orange-600":"bg-purple-100 text-purple-600","email-label":"Email","phone-label":"Phone","third-field-label":"Address"},{tags:xe(()=>[(o(!0),n(P,null,te(t.task.tags,X=>(o(),n("span",{key:X,class:"badge-ui bg-blue-50 border-blue-100 text-blue-700 font-semibold"},f(X),1))),128))]),_:1},8,["initials","name","email","phone","third-field-value","avatar-color-class"])])]),e("main",Bl,[e("div",Wl,[e("div",Pl,[B(ws,{modelValue:E(l),"onUpdate:modelValue":G[0]||(G[0]=X=>ct(l)?l.value=X:null),tabs:U.value,class:"mb-0 flex-1 min-w-0"},null,8,["modelValue","tabs"]),E(l)==="overview"&&t.addNewConfig.overviewActions.length?(o(),L(Te,{key:0,actions:t.addNewConfig.overviewActions,"active-tab":E(l),inline:!0,class:"hidden md:flex",onAction:q},null,8,["actions","active-tab"])):g("",!0)]),E(l)==="overview"&&t.addNewConfig.overviewActions.length?(o(),L(Te,{key:0,actions:t.addNewConfig.overviewActions,"active-tab":E(l),inline:!0,class:"flex md:hidden w-full",onAction:q},null,8,["actions","active-tab"])):g("",!0)]),E(l)==="overview"?(o(),n("div",zl,[B(Ms,{stage:t.task.stage,owner:t.task.assignee,source:t.task.source||"",probability:t.task.probability},null,8,["stage","owner","source","probability"])])):g("",!0),E(l)==="overview"?(o(),n("div",Yl,[(o(),L(pt(t.managementWidget),{lead:t.type==="lead"?t.task:void 0,opportunity:t.type==="opportunity"?t.task:void 0,activities:oe.value},null,8,["lead","opportunity","activities"])),be(Y.$slots,"pinned-extra",{task:t.task})])):g("",!0),E(l)!=="overview"?(o(),L(Te,{key:2,actions:t.addNewConfig.tabActions,"active-tab":E(l),onAction:q},null,8,["actions","active-tab"])):g("",!0),E(l)!=="overview"?(o(),n("div",Ql,[E(p)==="communication"?(o(),L(Zo,{key:0,type:E(i),"task-type":t.type,"task-id":t.task.id,onSave:E(c),onCancel:E(b)},null,8,["type","task-type","task-id","onSave","onCancel"])):g("",!0),E(p)==="note"?(o(),L(ol,{key:1,item:E(r),"task-type":t.type,"task-id":t.task.id,onSave:E(c),onCancel:E(b)},null,8,["item","task-type","task-id","onSave","onCancel"])):g("",!0),E(p)==="attachment"?(o(),L(pl,{key:2,item:E(r),"task-type":t.type,"task-id":t.task.id,onSave:E(c),onCancel:E(b)},null,8,["item","task-type","task-id","onSave","onCancel"])):g("",!0)])):g("",!0),E(v).length>0?(o(),n("div",Hl,[(o(!0),n(P,null,te(E(v),X=>(o(),L(Ho,{key:X.id,item:X,"task-type":t.type,"customer-initials":"SK",onEdit:E(y),onDelete:E(S)},null,8,["item","task-type","onEdit","onDelete"]))),128))])):g("",!0)]),(o(),L(ue,{to:"body"},[u.value?(o(),n("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",onClick:z(I,["self"])},[a.value==="financing"||a.value==="tradein"?(o(),n("div",Kl,[e("div",Jl,[e("div",Gl,[e("h5",Xl,f(a.value==="financing"?"Add Financing":"Add Trade-in"),1),e("button",{onClick:I,class:"text-gray-400 hover:text-gray-600"},[...G[1]||(G[1]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),a.value==="financing"?(o(),L(xl,{key:0,item:null,"task-type":t.type,"task-id":t.task.id,onSave:F,onCancel:I},null,8,["task-type","task-id"])):g("",!0),a.value==="tradein"?(o(),L(Dl,{key:1,item:null,"task-type":t.type,"task-id":t.task.id,onSave:F,onCancel:I},null,8,["task-type","task-id"])):g("",!0)])])):g("",!0),a.value==="purchase"?(o(),n("div",Zl,[B(Rl,{item:null,"task-type":t.type,"task-id":t.task.id,onSave:F,onCancel:I},null,8,["task-type","task-id"])])):g("",!0)])):g("",!0)]))]))}},ea={key:0,class:"mb-8"},ta={class:"flex items-center gap-2 mb-4"},sa={class:"font-bold text-gray-800 text-sm"},oa={class:"bg-white border border-gray-200 rounded-xl shadow-sm mb-6 overflow-hidden"},la={class:"p-4"},aa={key:0,class:"bg-gray-50 border border-gray-200 rounded-lg p-3 mb-4"},na={class:"text-sm text-slate-700 leading-snug"},ia={class:"flex items-center justify-between"},ra={class:"flex items-center gap-4"},da={class:"w-16 h-12 bg-gray-200 rounded-md overflow-hidden shrink-0 border border-gray-100"},ua=["src"],ca={key:1,class:"fa-solid fa-car text-3xl text-gray-400 w-full h-full flex items-center justify-center"},pa={class:"flex items-center gap-2"},ma={class:"font-bold text-slate-800 text-sm md:text-base"},ya={class:"mt-1.5"},ga={key:0,class:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-green-50 border border-green-100 text-green-700 text-[10px] font-semibold rounded-md"},fa={key:1,class:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-orange-50 border border-orange-100 text-orange-700 text-[10px] font-semibold rounded-md"},ba={class:"flex items-center gap-4"},va={key:0,class:"hidden sm:flex items-center gap-1.5 bg-gray-100 hover:bg-gray-200 border border-gray-200 text-slate-700 text-xs font-semibold px-3 py-1.5 rounded-full transition-colors group/btn"},xa={key:1,class:"text-right"},ha={class:"font-bold text-slate-800"},wa={class:"border-t border-gray-200"},ka={class:"font-medium"},Ca={key:0,class:"border-t border-gray-100 p-6 bg-gray-50/30 text-sm animate-fade-in"},$a={class:"mb-6"},Sa={class:"grid grid-cols-2 md:grid-cols-4 gap-y-4 gap-x-6"},Da={key:0},Aa={class:"font-medium text-slate-700"},Ta={key:1},qa={class:"font-medium text-slate-700"},Oa={key:2},Ia={class:"font-medium text-slate-700"},Na={class:"font-medium text-slate-700"},ja={class:"grid grid-cols-2 md:grid-cols-4 gap-y-4 gap-x-6"},Ma={key:0},Ra={class:"font-medium text-slate-700"},Va={key:1},Fa={class:"font-medium text-slate-700"},La={key:2},Ua={class:"font-medium text-slate-700"},Ea={key:3},Ba={class:"font-medium text-slate-700"},Wa={key:4},Pa={class:"font-mono text-xs bg-white border border-gray-200 px-2 py-1 rounded inline-block text-gray-600"},za={key:5},Ya={class:"font-medium text-slate-700"},Qa={key:0,class:"mt-6 flex justify-end"},Fe={__name:"VehicleWidget",props:{show:{type:Boolean,default:!0},label:{type:String,default:"Requested Car"},brand:{type:String,required:!0},model:{type:String,required:!0},year:{type:[Number,String],required:!0},image:{type:String,default:""},price:{type:Number,default:null},requestMessage:{type:String,default:""},requestType:{type:String,default:""},source:{type:String,default:""},dealership:{type:String,default:""},registration:{type:String,default:""},kilometers:{type:Number,default:null},fuelType:{type:String,default:""},gearType:{type:String,default:""},vin:{type:String,default:""},stockDays:{type:Number,default:null},showOpenAd:{type:Boolean,default:!0},showTechnicalSpecs:{type:Boolean,default:!0},channel:{type:String,default:"Email"},adCampaign:{type:String,default:""},expectedPurchaseDate:{type:String,default:""},fiscalEntity:{type:String,default:""},sourceDetails:{type:String,default:""},adMedium:{type:String,default:""},adSource:{type:String,default:""}},setup(t){const h=k(!1),s=a=>new Intl.NumberFormat("en-US").format(a),u=a=>new Intl.NumberFormat("en-US").format(a);return(a,l)=>t.show?(o(),n("div",ea,[e("div",ta,[l[1]||(l[1]=e("i",{class:"fa-solid fa-thumbtack text-gray-400 text-xs"},null,-1)),e("h3",sa,f(t.label),1)]),e("div",oa,[e("div",la,[t.requestMessage?(o(),n("div",aa,[l[2]||(l[2]=e("div",{class:"text-xs font-medium text-gray-500 mb-1"},"Request message",-1)),e("p",na,f(t.requestMessage),1)])):g("",!0),e("div",ia,[e("div",ra,[e("div",da,[t.image?(o(),n("img",{key:0,src:t.image,alt:"Car",class:"w-full h-full object-cover"},null,8,ua)):(o(),n("i",ca))]),e("div",null,[e("div",pa,[e("div",ma,f(t.brand)+" "+f(t.model)+" ("+f(t.year)+")",1)]),e("div",ya,[t.stockDays!==void 0&&t.stockDays!==null?(o(),n("div",ga,[l[3]||(l[3]=e("div",{class:"w-1 h-1 bg-green-500 rounded-full"},null,-1)),j(" In stock ("+f(t.stockDays)+" days) ",1)])):(o(),n("div",fa,[...l[4]||(l[4]=[e("div",{class:"w-1 h-1 bg-orange-500 rounded-full"},null,-1),j(" Out of stock ",-1)])]))])])]),e("div",ba,[t.showOpenAd&&t.price?(o(),n("button",va,[...l[5]||(l[5]=[j(" Open Ad ",-1),e("i",{class:"fa-solid fa-arrow-up-right-from-square text-[10px] text-gray-400 group-hover/btn:text-gray-800"},null,-1)])])):g("",!0),t.price?(o(),n("div",xa,[l[6]||(l[6]=e("div",{class:"text-xs text-gray-500 font-medium mb-0.5"},"Price",-1)),e("div",ha,"€ "+f(s(t.price)),1)])):g("",!0)])])]),e("div",wa,[e("button",{onClick:l[0]||(l[0]=p=>h.value=!h.value),class:"w-full p-3 flex items-center justify-center gap-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-50 transition-colors"},[e("span",ka,f(h.value?"Hide":"View")+" Details",1),e("i",{class:N(["fa-solid fa-chevron-down text-xs transition-transform duration-200",{"rotate-180":h.value}])},null,2)])]),h.value?(o(),n("div",Ca,[e("div",$a,[l[17]||(l[17]=e("h4",{class:"text-xs font-bold uppercase text-gray-500 tracking-wider mb-4"},"REQUEST DETAILS",-1)),e("div",Sa,[t.requestType?(o(),n("div",Da,[l[7]||(l[7]=e("div",{class:"text-xs text-gray-500 mb-1"},"Request type",-1)),e("div",Aa,f(t.requestType),1)])):g("",!0),t.source?(o(),n("div",Ta,[l[8]||(l[8]=e("div",{class:"text-xs text-gray-500 mb-1"},"Source",-1)),e("div",qa,f(t.source),1)])):g("",!0),e("div",null,[l[9]||(l[9]=e("div",{class:"text-xs text-gray-500 mb-1"},"Source details",-1)),e("div",{class:N(["font-medium",t.sourceDetails?"text-slate-700":"text-gray-400"])},f(t.sourceDetails||"--"),3)]),t.dealership?(o(),n("div",Oa,[l[10]||(l[10]=e("div",{class:"text-xs text-gray-500 mb-1"},"Dealership",-1)),e("div",Ia,f(t.dealership),1)])):g("",!0),e("div",null,[l[11]||(l[11]=e("div",{class:"text-xs text-gray-500 mb-1"},"Channel",-1)),e("div",Na,f(t.channel||"Email"),1)]),e("div",null,[l[12]||(l[12]=e("div",{class:"text-xs text-gray-500 mb-1"},"AdCampaign",-1)),e("div",{class:N(["font-medium",t.adCampaign?"text-slate-700":"text-gray-400"])},f(t.adCampaign||"--"),3)]),e("div",null,[l[13]||(l[13]=e("div",{class:"text-xs text-gray-500 mb-1"},"AdMedium",-1)),e("div",{class:N(["font-medium",t.adMedium?"text-slate-700":"text-gray-400"])},f(t.adMedium||"--"),3)]),e("div",null,[l[14]||(l[14]=e("div",{class:"text-xs text-gray-500 mb-1"},"AdSource",-1)),e("div",{class:N(["font-medium",t.adSource?"text-slate-700":"text-gray-400"])},f(t.adSource||"--"),3)]),e("div",null,[l[15]||(l[15]=e("div",{class:"text-xs text-gray-500 mb-1"},"Expected purchase date",-1)),e("div",{class:N(["font-medium",t.expectedPurchaseDate?"text-slate-700":"text-gray-400"])},f(t.expectedPurchaseDate||"--"),3)]),e("div",null,[l[16]||(l[16]=e("div",{class:"text-xs text-gray-500 mb-1"},"Fiscal entity",-1)),e("div",{class:N(["font-medium",t.fiscalEntity?"text-slate-700":"text-gray-400"])},f(t.fiscalEntity||"--"),3)])])]),l[26]||(l[26]=e("div",{class:"border-t border-gray-200 my-4"},null,-1)),e("div",null,[l[25]||(l[25]=e("div",{class:"flex justify-between items-center mb-4"},[e("h4",{class:"text-xs font-bold uppercase text-gray-500 tracking-wider"},"VEHICLE DETAILS")],-1)),e("div",ja,[t.registration?(o(),n("div",Ma,[l[18]||(l[18]=e("div",{class:"text-xs text-gray-500 mb-1"},"Registration",-1)),e("div",Ra,f(t.registration),1)])):g("",!0),t.kilometers!==void 0&&t.kilometers!==null?(o(),n("div",Va,[l[19]||(l[19]=e("div",{class:"text-xs text-gray-500 mb-1"},"Kilometers",-1)),e("div",Fa,f(u(t.kilometers))+" Km",1)])):g("",!0),t.fuelType?(o(),n("div",La,[l[20]||(l[20]=e("div",{class:"text-xs text-gray-500 mb-1"},"Fuel type",-1)),e("div",Ua,f(t.fuelType),1)])):g("",!0),t.gearType?(o(),n("div",Ea,[l[21]||(l[21]=e("div",{class:"text-xs text-gray-500 mb-1"},"Gear type",-1)),e("div",Ba,f(t.gearType),1)])):g("",!0),t.vin?(o(),n("div",Wa,[l[22]||(l[22]=e("div",{class:"text-xs text-gray-500 mb-1"},"VIN Number",-1)),e("div",Pa,f(t.vin),1)])):g("",!0),t.dealership?(o(),n("div",za,[l[23]||(l[23]=e("div",{class:"text-xs text-gray-500 mb-1"},"Dealership",-1)),e("div",Ya,f(t.dealership),1)])):g("",!0)]),t.showTechnicalSpecs?(o(),n("div",Qa,[...l[24]||(l[24]=[e("button",{class:"bg-white border border-gray-200 text-slate-700 hover:text-blue-600 hover:border-blue-200 font-medium px-4 py-2 rounded-lg text-xs transition-colors flex items-center gap-2 group"},[e("i",{class:"fa-solid fa-list-check text-gray-400 group-hover:text-blue-500"}),j(" View technical specs ")],-1)])])):g("",!0)])])):g("",!0)])])):g("",!0)}},Ha={key:0,class:"border-t border-gray-200 p-5 bg-white transition-all"},Ka={class:"grid grid-cols-3 gap-3 mb-4"},Ja={class:"flex gap-3 mb-4"},Pe={__name:"RescheduleWidget",props:{show:{type:Boolean,default:!1}},emits:["close","confirm"],setup(t,{emit:h}){const s=h,u=k(null),a=k(""),l=k(""),p=d=>{u.value=d;const v=new Date;if(d==="later-today"){const m=new Date(v.getTime()+72e5);a.value=m.toISOString().split("T")[0],l.value=m.toTimeString().slice(0,5)}else if(d==="tomorrow"){const m=new Date(v);m.setDate(m.getDate()+1),a.value=m.toISOString().split("T")[0],l.value="09:00"}else if(d==="next-week"){const m=new Date(v);m.setDate(m.getDate()+(7-m.getDay()+1)),a.value=m.toISOString().split("T")[0],l.value="09:00"}},r=()=>{s("confirm",{date:a.value,time:l.value,option:u.value}),s("close"),u.value=null,a.value="",l.value=""},i=()=>{s("close"),u.value=null,a.value="",l.value=""};return(d,v)=>t.show?(o(),n("div",Ha,[v[8]||(v[8]=e("h5",{class:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3"},"Reschedule to...",-1)),e("div",Ka,[e("button",{onClick:v[0]||(v[0]=m=>p("later-today")),class:N(["flex flex-col items-center justify-center p-2 border border-gray-200 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-all group",{"border-blue-400 bg-blue-50":u.value==="later-today"}])},[...v[5]||(v[5]=[e("span",{class:"text-xs font-semibold text-slate-700 group-hover:text-blue-700"},"Later Today",-1),e("span",{class:"text-[10px] text-gray-400"},"+2 Hours",-1)])],2),e("button",{onClick:v[1]||(v[1]=m=>p("tomorrow")),class:N(["flex flex-col items-center justify-center p-2 border border-gray-200 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-all group",{"border-blue-400 bg-blue-50":u.value==="tomorrow"}])},[...v[6]||(v[6]=[e("span",{class:"text-xs font-semibold text-slate-700 group-hover:text-blue-700"},"Tomorrow",-1),e("span",{class:"text-[10px] text-gray-400"},"09:00 AM",-1)])],2),e("button",{onClick:v[2]||(v[2]=m=>p("next-week")),class:N(["flex flex-col items-center justify-center p-2 border border-gray-200 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-all group",{"border-blue-400 bg-blue-50":u.value==="next-week"}])},[...v[7]||(v[7]=[e("span",{class:"text-xs font-semibold text-slate-700 group-hover:text-blue-700"},"Next Week",-1),e("span",{class:"text-[10px] text-gray-400"},"Mon, 9 AM",-1)])],2)]),e("div",Ja,[O(e("input",{"onUpdate:modelValue":v[3]||(v[3]=m=>a.value=m),type:"date",class:"flex-1 bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 text-sm text-slate-700 focus:border-blue-500 focus:outline-none"},null,512),[[R,a.value]]),O(e("input",{"onUpdate:modelValue":v[4]||(v[4]=m=>l.value=m),type:"time",class:"w-1/3 bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 text-sm text-slate-700 focus:border-blue-500 focus:outline-none"},null,512),[[R,l.value]])]),e("div",{class:"flex gap-3"},[e("button",{onClick:i,class:"flex-1 bg-white hover:bg-gray-50 border border-gray-200 text-gray-700 font-medium py-2 rounded-lg text-sm transition-colors"}," Cancel "),e("button",{onClick:r,class:"flex-1 bg-slate-800 hover:bg-slate-900 text-white font-medium py-2 rounded-lg text-sm transition-colors"}," Confirm New Time ")])])):g("",!0)}},Ga={key:0,class:"space-y-4 animate-fade-in"},Xa={key:0,class:"animate-fade-in"},Za={class:"grid grid-cols-4 gap-2"},_a=["onClick"],ze={__name:"ScheduleAppointmentWidget",props:{show:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(t,{emit:h}){const s=t,u=h,a=k(""),l=k("Michael Thomas (Me)"),p=k(""),r=k(!1),i=k("");ne(()=>s.show,c=>{c||d()});const d=()=>{a.value="",l.value="Michael Thomas (Me)",p.value="",r.value=!1,i.value=""},v=()=>{!a.value||!p.value||!i.value||(u("confirm",{type:a.value,assignee:l.value,date:p.value,time:i.value}),d())},m=()=>{d(),u("cancel")};return(c,b)=>t.show?(o(),n("div",Ga,[e("div",null,[b[5]||(b[5]=e("label",{class:"block text-xs font-medium text-gray-500 mb-1.5"},"Appointment Type",-1)),O(e("select",{"onUpdate:modelValue":b[0]||(b[0]=y=>a.value=y),class:"w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2.5 text-sm text-slate-700 focus:border-blue-500 focus:bg-white focus:outline-none appearance-none cursor-pointer transition-colors shadow-sm"},[...b[4]||(b[4]=[e("option",{value:"",disabled:""},"Select type...",-1),e("option",null,"Showroom Visit",-1),e("option",null,"Test Drive",-1),e("option",null,"Video Call",-1),e("option",null,"Home Visit",-1),e("option",null,"Closing Meeting",-1)])],512),[[de,a.value]])]),e("div",null,[b[7]||(b[7]=e("label",{class:"block text-xs font-medium text-gray-500 mb-1.5"},"Assign to Salesman",-1)),O(e("select",{"onUpdate:modelValue":b[1]||(b[1]=y=>l.value=y),class:"w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2.5 text-sm text-slate-700 focus:border-blue-500 focus:bg-white focus:outline-none appearance-none cursor-pointer transition-colors shadow-sm"},[...b[6]||(b[6]=[e("option",null,"Michael Thomas (Me)",-1),e("option",null,"Sarah Jenkins",-1),e("option",null,"David Miller",-1),e("option",null,"Jessica Lee",-1)])],512),[[de,l.value]])]),e("div",null,[b[8]||(b[8]=e("label",{class:"block text-xs font-medium text-gray-500 mb-1.5"},"Select Date",-1)),O(e("input",{type:"date","onUpdate:modelValue":b[2]||(b[2]=y=>p.value=y),onChange:b[3]||(b[3]=y=>r.value=!0),class:"w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2.5 text-sm text-slate-700 focus:border-blue-500 focus:bg-white focus:outline-none shadow-sm transition-colors cursor-pointer"},null,544),[[R,p.value]])]),r.value?(o(),n("div",Xa,[b[9]||(b[9]=e("label",{class:"block text-xs font-medium text-gray-500 mb-2"},"Available Slots",-1)),e("div",Za,[(o(),n(P,null,te(["09:00","10:30","11:00","14:30","15:00","16:30"],y=>e("button",{key:y,onClick:S=>i.value=y,class:N(["py-2 border border-gray-200 rounded-lg text-xs font-medium transition-all",i.value===y?"border-blue-500 bg-blue-50 text-blue-600":"text-slate-600 hover:border-blue-500 hover:bg-blue-50 hover:text-blue-600"])},f(y),11,_a)),64))])])):g("",!0),e("div",{class:"flex gap-3 pt-2"},[e("button",{onClick:m,class:"flex-1 bg-white hover:bg-gray-50 border border-gray-200 text-gray-700 font-medium py-2.5 rounded-lg text-sm transition-colors"}," Cancel "),e("button",{onClick:v,class:"flex-1 bg-green-600 hover:bg-green-700 text-white font-medium py-2.5 rounded-lg text-sm transition-colors shadow-sm shadow-green-100 flex items-center justify-center gap-2"},[...b[10]||(b[10]=[j(" Confirm Appointment ",-1),e("i",{class:"fa-solid fa-arrow-right"},null,-1)])])])])):g("",!0)}},en={class:"bg-white rounded-xl shadow-2xl w-full max-w-md mx-4 overflow-hidden animate-fade-in"},tn={class:"p-6 space-y-6"},sn={class:"flex gap-6"},on={class:"flex items-center gap-2 cursor-pointer"},ln={class:"flex items-center gap-2 cursor-pointer"},an={class:"p-6 bg-gray-50 flex justify-between gap-3 border-t border-gray-100"},nn=["disabled"],rn={__name:"DisqualifyModal",props:{show:{type:Boolean,required:!0}},emits:["confirm","cancel"],setup(t,{emit:h}){const s=t,u=h,a=k("Not Interested"),l=k("");ne(()=>s.show,i=>{i&&(a.value="Not Interested",l.value="")});const p=()=>{u("confirm",{category:a.value,reason:l.value})},r=()=>{u("cancel")};return(i,d)=>(o(),L(ue,{to:"body"},[t.show?(o(),n("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:z(r,["self"])},[e("div",en,[d[8]||(d[8]=e("div",{class:"p-6 border-b border-gray-100"},[e("h3",{class:"font-bold text-2xl text-gray-900"},"Disqualify Lead"),e("p",{class:"text-sm text-gray-500 mt-1"},"Please select a reason for disqualification.")],-1)),e("div",tn,[e("div",null,[d[5]||(d[5]=e("label",{class:"block label-upper mb-3"},"Category",-1)),e("div",sn,[e("label",on,[O(e("input",{type:"radio","onUpdate:modelValue":d[0]||(d[0]=v=>a.value=v),value:"Not Valid",class:"w-5 h-5 text-blue-600 focus:ring-blue-500 border-gray-300"},null,512),[[we,a.value]]),d[3]||(d[3]=e("span",{class:"text-base text-gray-700"},"Not Valid",-1))]),e("label",ln,[O(e("input",{type:"radio","onUpdate:modelValue":d[1]||(d[1]=v=>a.value=v),value:"Not Interested",class:"w-5 h-5 text-blue-600 focus:ring-blue-500 border-gray-300"},null,512),[[we,a.value]]),d[4]||(d[4]=e("span",{class:"text-base text-gray-700"},"Not Interested",-1))])])]),e("div",null,[d[7]||(d[7]=e("label",{class:"block label-upper mb-3"},"Failure Reason",-1)),O(e("select",{"onUpdate:modelValue":d[2]||(d[2]=v=>l.value=v),class:"w-full bg-white border-2 border-red-500 rounded-lg px-4 py-3 text-base text-gray-700 focus:outline-none focus:border-red-600 transition-colors"},[...d[6]||(d[6]=[e("option",{value:""},"Select a reason...",-1),e("option",{value:"Data cleanup"},"Data cleanup",-1),e("option",{value:"Unreachable"},"Unreachable",-1),e("option",{value:"Purchase postponed"},"Purchase postponed",-1),e("option",{value:"Vehicle sold"},"Vehicle sold",-1),e("option",{value:"Out of budget"},"Out of budget",-1),e("option",{value:"Financing rejected"},"Financing rejected",-1),e("option",{value:"Duplicate"},"Duplicate",-1),e("option",{value:"Bought elsewhere"},"Bought elsewhere",-1)])],512),[[de,l.value]])])]),e("div",an,[e("button",{onClick:r,class:"text-gray-700 font-medium px-6 py-3 rounded-lg text-base hover:bg-gray-100 transition-colors"}," Cancel "),e("button",{onClick:p,disabled:!a.value||!l.value,class:"bg-red-600 hover:bg-red-700 disabled:bg-red-300 disabled:cursor-not-allowed text-white font-medium px-6 py-3 rounded-lg text-base transition-colors"}," Confirm Disqualification ",8,nn)])])])):g("",!0)]))}},dn={key:0,class:"bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden"},un={class:"p-5 space-y-6"},cn={class:"bg-blue-50/50 border border-blue-100 rounded-lg p-4 relative transition-all duration-300"},pn={class:"flex justify-between items-start mb-3"},mn={class:"text-xs text-gray-500 mt-0.5"},yn={class:"flex items-center gap-2 text-orange-600 bg-white border border-orange-100 px-2 py-1 rounded text-xs font-semibold shadow-sm transition-colors"},gn={key:0},fn={key:1},bn={class:"flex gap-3 flex-wrap"},vn={key:0,class:"mt-4 bg-slate-900 border border-slate-700 rounded-lg p-4 shadow-inner relative overflow-hidden"},xn={class:"flex justify-between items-center mb-3 border-b border-slate-700 pb-2"},hn={class:"flex items-center gap-1.5"},wn={class:"text-xs font-mono text-red-400"},kn={class:"space-y-2 h-32 overflow-y-auto flex flex-col justify-end scrollbar-hide"},Cn={class:"font-bold"},$n={key:1,class:"mt-3 space-y-2"},Sn={class:"text-xs text-slate-600 leading-relaxed"},Dn={key:2,class:"mt-3 relative z-10"},An={class:"relative"},Tn=["onKeyup"],qn={key:3,class:"mt-4 bg-blue-50 border border-blue-200 rounded-lg p-4"},On=["disabled"],In={key:0,class:"fa-solid fa-spinner fa-spin"},Nn={key:1,class:"fa-solid fa-magic"},jn={class:"bg-gray-50 border-t border-gray-200"},Mn={class:"p-4 flex justify-end gap-3"},Rn={key:0,class:"border-t border-gray-200 p-5 bg-white transition-all"},Vn={class:"mb-5"},Fn={class:"flex flex-col gap-2"},Ln={class:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors bg-white shadow-sm"},Un=["checked"],En={__name:"LeadManagementWidget",props:{lead:{type:Object,required:!0}},setup(t){const h=t,s=Oe(),u=Ue(),a=qe(),l=k(!1),p=k(!1),r=k(!1),i=k(!1),d=k([]),v=k(0),m=k([]),c=k(""),b=k("qualify"),y=k(null),S=k(null),q=k(0),I=k(!1),F=k([]),U=k(!1),oe=[{speaker:"Sales",text:"Good morning, am I speaking with Mr. Adams?"},{speaker:"Lead",text:"Yes, this is Josh Adams speaking."},{speaker:"Sales",text:"Hi Josh, Michael here regarding your Audi A6 inquiry."},{speaker:"Lead",text:"Oh, hi Michael! Yes, I was waiting for your call."},{speaker:"Sales",text:"Great. I see you're interested in the Allroad. Do you have a vehicle you'd like to trade in?"},{speaker:"Lead",text:"Yes, I actually have a BMW X3, 2018 model with about 45,000 km.",action:{type:"tradein",data:{brand:"BMW",model:"X3",year:"2018",km:"45,000",auto:!0}}},{speaker:"Sales",text:"Excellent, we can certainly evaluate that. And regarding payment?"},{speaker:"Lead",text:"I'd like to put down €5,000 and finance the rest over 3 years.",action:{type:"financing",data:{product:"Standard Loan",provider:"Audi Financial",total:"14,000",monthly:"420",auto:!0}}},{speaker:"Sales",text:"Understood. I'll note that down and prepare the proposal.",action:{type:"note",data:"Customer requests 3-year financing with €5k deposit."}},{speaker:"Lead",text:"Sounds amazing. Let's proceed with the paperwork."}],Y=M=>{const $=Math.floor(M/60),H=M%60;return`${$.toString().padStart(2,"0")}:${H.toString().padStart(2,"0")}`},G=()=>{i.value=!i.value,i.value?(v.value=0,q.value=0,m.value=[],I.value=!1,F.value=[],y.value=setInterval(()=>{v.value++},1e3),S.value=setInterval(()=>{if(q.value<oe.length){const M=oe[q.value];m.value.push({speaker:M.speaker,text:M.text}),q.value++,m.value.length>4&&m.value.shift()}else clearInterval(S.value),clearInterval(y.value),I.value=!0,X()},2500)):(y.value&&clearInterval(y.value),S.value&&clearInterval(S.value),I.value=!1,d.value.length>0&&X())},X=async()=>{for(const M of d.value)await u.addActivity(h.lead.id,{type:"note",user:"You",action:"added a note",content:M});d.value=[]},se=async()=>{U.value=!0,await new Promise(M=>setTimeout(M,800));for(let M=0;M<oe.length;M++){const $=oe[M];$.action&&!F.value.includes(M)&&($.action.type==="tradein"?A($.action.data):$.action.type==="financing"?W($.action.data):$.action.type==="note"&&D($.action.data),F.value.push(M))}U.value=!1,i.value=!1,I.value=!1},ae=()=>{navigator.clipboard.writeText(h.lead.customer.phone)},Z=()=>{c.value.trim()&&(d.value.push(c.value),c.value="")},D=M=>{u.addActivity(h.lead.id,{type:"note",user:"You",action:"added a note",content:M,data:{autoDetected:!0}})},A=M=>{u.addActivity(h.lead.id,{type:"tradein",user:"You",action:"added a trade-in",data:{...M,autoDetected:M.auto||!1}})},W=M=>{u.addActivity(h.lead.id,{type:"financing",user:"You",action:"added a financing proposal",data:{...M,autoDetected:M.auto||!1}})},x=()=>{l.value=!l.value,p.value=!1},Q=()=>{p.value=!p.value,l.value=!1},ge=M=>{l.value=!1},he=M=>{b.value="qualify",p.value=!1},ke=async()=>{try{const M=await u.convertLeadToOpportunity(h.lead.id);p.value=!1,a.canAccessOpportunities()?s.push({path:`/tasks/${M}`,query:{type:"opportunity"}}):s.push("/tasks/1")}catch(M){console.error("Failed to convert lead to opportunity:",M)}},Ce=async()=>{try{await u.requalifyLead(h.lead.id),await u.loadLeadById(h.lead.id)}catch(M){console.error("Failed to requalify lead:",M)}},$e=async M=>{try{await u.modifyLead(h.lead.id,{isDisqualified:!0,disqualifyReason:M.reason,status:"Disqualified"}),await u.addActivity(h.lead.id,{type:"note",user:"You",action:"disqualified lead",content:`Lead disqualified - Category: ${M.category}, Reason: ${M.reason}`}),r.value=!1,await u.loadLeadById(h.lead.id)}catch($){console.error("Failed to disqualify lead:",$)}};return(M,$)=>t.lead?(o(),n("div",dn,[$[28]||($[28]=Ee('<div class="p-4 border-b border-gray-100 bg-gray-50/50 flex justify-between items-center"><div class="flex items-center gap-2"><i class="fa-solid fa-thumbtack text-gray-400 text-xs"></i><h3 class="font-bold text-slate-800 text-sm">Manage Next steps</h3></div><span class="text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded font-medium">Task pending</span></div>',1)),e("div",un,[e("div",cn,[e("div",pn,[e("div",null,[$[8]||($[8]=e("h4",{class:"font-bold text-slate-800 text-sm"},"Initial Contact",-1)),e("p",mn," Call customer to discuss "+f(t.lead.requestedCar.brand)+" "+f(t.lead.requestedCar.model)+" interest. ",1)]),e("div",yn,[i.value?(o(),n("span",fn,[...$[10]||($[10]=[j("In Call ",-1),e("i",{class:"fa-solid fa-phone-volume animate-pulse"},null,-1)])])):(o(),n("span",gn,[...$[9]||($[9]=[j("To be contacted ",-1),e("i",{class:"fa-regular fa-clock"},null,-1)])]))])]),e("div",bn,[e("button",{onClick:G,class:"bg-slate-700 hover:bg-slate-800 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"},[j(f(t.lead.customer.phone)+" Call ",1),$[11]||($[11]=e("i",{class:"fa-solid fa-phone text-xs"},null,-1))]),e("button",{onClick:ae,class:"bg-white hover:bg-gray-50 border border-gray-200 text-slate-700 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"},[...$[12]||($[12]=[j(" Copy number ",-1),e("i",{class:"fa-regular fa-copy text-xs"},null,-1)])])]),i.value&&!I.value?(o(),n("div",vn,[e("div",xn,[$[14]||($[14]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fa-solid fa-wave-square text-blue-400 text-xs"}),e("span",{class:"text-[10px] font-bold uppercase text-slate-400 tracking-wider"},"Transcribing")],-1)),e("div",hn,[$[13]||($[13]=e("span",{class:"relative flex h-2 w-2"},[e("span",{class:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),e("span",{class:"relative inline-flex rounded-full h-2 w-2 bg-red-500"})],-1)),e("span",wn,"REC "+f(Y(v.value)),1)])]),e("div",kn,[(o(!0),n(P,null,te(m.value,(H,ve)=>(o(),n("div",{key:ve,class:N(["text-xs font-mono transition-all duration-500",H.speaker==="Sales"?"text-gray-400":"text-slate-300"])},[e("span",Cn,f(H.speaker)+":",1),$[15]||($[15]=j()),e("span",null,f(H.text),1)],2))),128))])])):g("",!0),i.value&&!I.value&&d.value.length>0?(o(),n("div",$n,[(o(!0),n(P,null,te(d.value,(H,ve)=>(o(),n("div",{key:ve,class:"bg-white border border-gray-200 rounded-lg p-3 shadow-sm animate-fade-in"},[$[16]||($[16]=e("div",{class:"flex items-center gap-2 mb-1"},[e("div",{class:"w-5 h-5 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center text-[10px] font-bold"},"MT"),e("span",{class:"text-[10px] font-bold text-slate-700"},"You"),e("span",{class:"text-[10px] text-gray-400"},"• Just now")],-1)),e("p",Sn,f(H),1)]))),128))])):g("",!0),i.value&&!I.value?(o(),n("div",Dn,[e("div",An,[O(e("textarea",{"onUpdate:modelValue":$[0]||($[0]=H=>c.value=H),onKeyup:mt(z(Z,["ctrl"]),["enter"]),placeholder:"Add a quick note about this call...",rows:"3",class:"w-full bg-white border border-gray-300 rounded-md pl-3 pr-8 py-2 text-xs text-slate-700 focus:outline-none focus:border-blue-500 placeholder-gray-400 transition-colors shadow-sm resize-none"},null,40,Tn),[[R,c.value]]),e("button",{onClick:Z,class:"absolute right-2 bottom-2 text-gray-400 hover:text-gray-600 p-1.5 transition-colors",title:"Save Note"},[...$[17]||($[17]=[e("i",{class:"fa-solid fa-paper-plane text-xs"},null,-1)])])])])):g("",!0),i.value&&I.value?(o(),n("div",qn,[$[18]||($[18]=e("div",{class:"flex items-center justify-between mb-3"},[e("div",null,[e("h4",{class:"font-bold text-slate-800 text-sm"},"Call Ended"),e("p",{class:"text-xs text-gray-500 mt-0.5"},"Extract information from the transcription")])],-1)),e("button",{onClick:se,disabled:U.value,class:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white font-medium px-4 py-2.5 rounded-lg text-sm transition-colors flex items-center justify-center gap-2"},[U.value?(o(),n("i",In)):(o(),n("i",Nn)),e("span",null,f(U.value?"Extracting...":"Extract information from transcription"),1)],8,On)])):g("",!0)])]),e("div",jn,[e("div",Mn,[t.lead.isDisqualified?(o(),n("button",{key:0,onClick:Ce,class:"bg-green-600 hover:bg-green-700 text-white font-medium px-6 py-2.5 rounded-lg text-sm shadow-lg shadow-green-200 transition-colors flex items-center gap-2"},[...$[19]||($[19]=[j(" Requalify ",-1),e("i",{class:"fa-solid fa-rotate-left"},null,-1)])])):(o(),n(P,{key:1},[e("button",{onClick:$[1]||($[1]=H=>r.value=!0),class:"bg-white hover:bg-red-50 text-slate-700 hover:text-red-600 border border-gray-200 hover:border-red-200 font-medium px-4 py-2.5 rounded-lg text-sm shadow-sm transition-colors flex items-center gap-2"},[...$[20]||($[20]=[j(" Disqualify ",-1),e("i",{class:"fa-solid fa-ban"},null,-1)])]),e("button",{onClick:x,class:"bg-white hover:bg-gray-50 text-slate-700 border border-gray-200 font-medium px-4 py-2.5 rounded-lg text-sm shadow-sm transition-colors flex items-center gap-2"},[...$[21]||($[21]=[j(" Postpone ",-1),e("i",{class:"fa-regular fa-clock"},null,-1)])]),e("button",{onClick:Q,class:"bg-green-600 hover:bg-green-700 text-white font-medium px-6 py-2.5 rounded-lg text-sm shadow-lg shadow-green-200 transition-colors flex items-center gap-2"},[...$[22]||($[22]=[j(" Qualify ",-1),e("i",{class:"fa-solid fa-check"},null,-1)])])],64))]),B(Pe,{show:l.value,onClose:$[2]||($[2]=H=>l.value=!1),onConfirm:ge},null,8,["show"]),p.value?(o(),n("div",Rn,[$[27]||($[27]=e("h5",{class:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-4"},"Qualify",-1)),e("div",Vn,[$[25]||($[25]=e("label",{class:"block text-xs font-medium text-gray-500 mb-2"},"Next Step",-1)),e("div",Fn,[e("label",Ln,[O(e("input",{type:"radio","onUpdate:modelValue":$[3]||($[3]=H=>b.value=H),value:"qualify",class:"w-4 h-4 text-green-600 focus:ring-green-500 border-gray-300"},null,512),[[we,b.value]]),$[23]||($[23]=e("div",{class:"flex flex-col"},[e("span",{class:"text-sm font-medium text-slate-700"},"Qualify without appointment"),e("span",{class:"text-[10px] text-gray-400"},"Proceed directly to opportunity stage")],-1))]),e("label",{onClick:$[5]||($[5]=z(H=>b.value=b.value==="schedule"?"qualify":"schedule",["prevent"])),class:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors bg-white shadow-sm"},[e("input",{type:"radio",checked:b.value==="schedule",class:"w-4 h-4 text-green-600 focus:ring-green-500 border-gray-300",onClick:$[4]||($[4]=z(()=>{},["stop"]))},null,8,Un),$[24]||($[24]=e("div",{class:"flex flex-col"},[e("span",{class:"text-sm font-medium text-slate-700"},"Schedule Appointment"),e("span",{class:"text-[10px] text-gray-400"},"Book a meeting or test drive")],-1))])])]),b.value==="schedule"?(o(),L(ze,{key:0,show:b.value==="schedule",onConfirm:he,onCancel:$[6]||($[6]=H=>b.value="qualify")},null,8,["show"])):g("",!0),b.value!=="schedule"?(o(),n("button",{key:1,onClick:ke,class:"w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2.5 rounded-lg text-sm transition-colors shadow-md shadow-green-100 flex items-center justify-center gap-2 mt-4"},[...$[26]||($[26]=[j(" Qualify ",-1),e("i",{class:"fa-solid fa-check"},null,-1)])])):g("",!0)])):g("",!0)]),B(rn,{show:r.value,onConfirm:$e,onCancel:$[7]||($[7]=H=>r.value=!1)},null,8,["show"])])):g("",!0)}},Bn={class:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4 overflow-hidden"},Wn={class:"px-6 py-4 border-b border-gray-200 flex items-center justify-between"},Pn={class:"text-lg font-bold text-gray-900"},zn={__name:"ComingSoonModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Coming Soon"}},emits:["close"],setup(t,{emit:h}){const s=h,u=()=>{s("close")};return(a,l)=>(o(),L(ue,{to:"body"},[t.show?(o(),n("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:z(u,["self"])},[e("div",Bn,[e("div",Wn,[e("h3",Pn,f(t.title),1),e("button",{onClick:u,class:"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors"},[...l[0]||(l[0]=[e("i",{class:"fa-solid fa-times text-sm"},null,-1)])])]),l[1]||(l[1]=e("div",{class:"px-6 py-12 flex items-center justify-center"},[e("p",{class:"text-gray-600 text-lg font-medium"},"Coming soon")],-1)),e("div",{class:"px-6 py-4 border-t border-gray-200 flex justify-end"},[e("button",{onClick:u,class:"bg-gray-800 hover:bg-gray-900 text-white font-medium px-6 py-2 rounded-lg text-sm transition-colors"}," Close ")])])])):g("",!0)]))}},Yn={class:"bg-white rounded-xl shadow-2xl w-full max-w-md mx-4 overflow-hidden animate-fade-in"},Qn={class:"p-5 space-y-4"},Hn={class:"p-4 bg-gray-50 flex justify-end gap-3 border-t border-gray-100"},Kn=["disabled"],Jn={__name:"CloseAsLostModal",props:{show:{type:Boolean,required:!0}},emits:["confirm","cancel"],setup(t,{emit:h}){const s=t,u=h,a=k(""),l=k("");ne(()=>s.show,i=>{i&&(a.value="",l.value="")});const p=()=>{a.value&&u("confirm",{reason:a.value,notes:l.value})},r=()=>{u("cancel")};return(i,d)=>(o(),L(ue,{to:"body"},[t.show?(o(),n("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:z(r,["self"])},[e("div",Yn,[d[5]||(d[5]=e("div",{class:"p-5 border-b border-gray-100 bg-gray-50/50"},[e("h3",{class:"font-bold text-lg text-gray-900"},"Close as Lost"),e("p",{class:"text-xs text-gray-500 mt-1"},"Document why this opportunity didn't close")],-1)),e("div",Qn,[e("div",null,[d[3]||(d[3]=e("label",{class:"block label-upper mb-2"},"Reason",-1)),O(e("select",{"onUpdate:modelValue":d[0]||(d[0]=v=>a.value=v),class:"input"},[...d[2]||(d[2]=[e("option",{value:""},"Select a reason...",-1),e("option",{value:"Not interested"},"Not interested",-1),e("option",{value:"Budget constraints"},"Budget constraints",-1),e("option",{value:"Found better price"},"Found better price at competitor",-1),e("option",{value:"No response"},"Customer not responding",-1),e("option",{value:"Wrong timing"},"Timing not right",-1),e("option",{value:"Other"},"Other",-1)])],512),[[de,a.value]])]),e("div",null,[d[4]||(d[4]=e("label",{class:"block label-upper mb-2"},"Additional Notes",-1)),O(e("textarea",{"onUpdate:modelValue":d[1]||(d[1]=v=>l.value=v),rows:"4",placeholder:"Add any relevant details about why this opportunity was lost...",class:"input resize-none"},null,512),[[R,l.value]])])]),e("div",Hn,[e("button",{onClick:r,class:"btn-secondary text-sm"}," Cancel "),e("button",{onClick:p,disabled:!a.value,class:"bg-red-600 hover:bg-red-700 disabled:bg-red-300 disabled:cursor-not-allowed text-white font-medium px-4 py-2 rounded-lg text-sm transition-colors"}," Close as Lost ",8,Kn)])])])):g("",!0)]))}},Gn={class:"bg-white rounded-xl shadow-2xl w-full max-w-md mx-4 overflow-hidden animate-fade-in"},Xn={class:"p-5 space-y-4"},Zn=["max"],_n={class:"p-4 bg-gray-50 flex justify-end gap-3 border-t border-gray-100"},ei=["disabled"],ti={__name:"ContractDateModal",props:{show:{type:Boolean,required:!0}},emits:["confirm","cancel"],setup(t,{emit:h}){const s=t,u=h,a=k(""),l=k(""),p=k(""),r=T(()=>new Date().toISOString().split("T")[0]);ne(()=>s.show,v=>{if(v){const m=new Date;a.value=m.toISOString().split("T")[0],l.value=m.toTimeString().slice(0,5),p.value=""}});const i=()=>{if(!a.value)return;const v=l.value?`${a.value}T${l.value}:00`:`${a.value}T12:00:00`;u("confirm",{contractDate:v,notes:p.value})},d=()=>{u("cancel")};return(v,m)=>(o(),L(ue,{to:"body"},[t.show?(o(),n("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:z(d,["self"])},[e("div",Gn,[m[6]||(m[6]=e("div",{class:"p-5 border-b border-gray-100 bg-gray-50/50"},[e("h3",{class:"font-bold text-lg text-gray-900"},"Set Contract Signing Date"),e("p",{class:"text-xs text-gray-500 mt-1"},"Record when the contract was signed to track delivery timeline")],-1)),e("div",Xn,[e("div",null,[m[3]||(m[3]=e("label",{class:"block label-upper mb-2"},"Contract Date",-1)),O(e("input",{type:"date","onUpdate:modelValue":m[0]||(m[0]=c=>a.value=c),max:r.value,class:"input"},null,8,Zn),[[R,a.value]])]),e("div",null,[m[4]||(m[4]=e("label",{class:"block label-upper mb-2"},"Time (Optional)",-1)),O(e("input",{type:"time","onUpdate:modelValue":m[1]||(m[1]=c=>l.value=c),class:"input"},null,512),[[R,l.value]])]),e("div",null,[m[5]||(m[5]=e("label",{class:"block label-upper mb-2"},"Notes (Optional)",-1)),O(e("textarea",{"onUpdate:modelValue":m[2]||(m[2]=c=>p.value=c),rows:"3",placeholder:"Add any relevant notes about the contract signing...",class:"input resize-none"},null,512),[[R,p.value]])])]),e("div",_n,[e("button",{onClick:d,class:"btn-secondary text-sm"}," Cancel "),e("button",{onClick:i,disabled:!a.value,class:"bg-green-600 hover:bg-green-700 disabled:bg-green-300 disabled:cursor-not-allowed text-white font-medium px-4 py-2 rounded-lg text-sm transition-colors"}," Set Contract Date ",8,ei)])])])):g("",!0)]))}},si={class:"bg-white rounded-xl shadow-2xl w-full max-w-md mx-4 overflow-hidden animate-fade-in"},oi={class:"p-5 space-y-4"},li=["max"],ai={class:"p-4 bg-gray-50 flex justify-end gap-3 border-t border-gray-100"},ni=["disabled"],ii={__name:"DeliveryModal",props:{show:{type:Boolean,required:!0}},emits:["confirm","cancel"],setup(t,{emit:h}){const s=t,u=h,a=k(""),l=k(""),p=k(""),r=k(""),i=T(()=>new Date().toISOString().split("T")[0]);ne(()=>s.show,m=>{if(m){const c=new Date;a.value=c.toISOString().split("T")[0],l.value=c.toTimeString().slice(0,5),p.value="",r.value=""}});const d=()=>{if(!a.value||!p.value)return;const m=l.value?`${a.value}T${l.value}:00`:`${a.value}T12:00:00`;u("confirm",{deliveryDate:m,location:p.value,notes:r.value})},v=()=>{u("cancel")};return(m,c)=>(o(),L(ue,{to:"body"},[t.show?(o(),n("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:z(v,["self"])},[e("div",si,[c[9]||(c[9]=e("div",{class:"p-5 border-b border-gray-100 bg-gray-50/50"},[e("h3",{class:"font-bold text-lg text-gray-900"},"Mark as Delivered"),e("p",{class:"text-xs text-gray-500 mt-1"},"Record the vehicle delivery date and details")],-1)),e("div",oi,[e("div",null,[c[4]||(c[4]=e("label",{class:"block label-upper mb-2"},"Delivery Date",-1)),O(e("input",{type:"date","onUpdate:modelValue":c[0]||(c[0]=b=>a.value=b),max:i.value,class:"input"},null,8,li),[[R,a.value]])]),e("div",null,[c[5]||(c[5]=e("label",{class:"block label-upper mb-2"},"Time (Optional)",-1)),O(e("input",{type:"time","onUpdate:modelValue":c[1]||(c[1]=b=>l.value=b),class:"input"},null,512),[[R,l.value]])]),e("div",null,[c[7]||(c[7]=e("label",{class:"block label-upper mb-2"},"Delivery Location",-1)),O(e("select",{"onUpdate:modelValue":c[2]||(c[2]=b=>p.value=b),class:"input"},[...c[6]||(c[6]=[e("option",{value:""},"Select location...",-1),e("option",{value:"Dealership"},"At Dealership",-1),e("option",{value:"Customer Address"},"Customer Address",-1),e("option",{value:"Other"},"Other Location",-1)])],512),[[de,p.value]])]),e("div",null,[c[8]||(c[8]=e("label",{class:"block label-upper mb-2"},"Delivery Notes",-1)),O(e("textarea",{"onUpdate:modelValue":c[3]||(c[3]=b=>r.value=b),rows:"3",placeholder:"Add any relevant delivery details, customer feedback, etc...",class:"input resize-none"},null,512),[[R,r.value]])])]),e("div",ai,[e("button",{onClick:v,class:"btn-secondary text-sm"}," Cancel "),e("button",{onClick:d,disabled:!a.value||!p.value,class:"bg-green-600 hover:bg-green-700 disabled:bg-green-300 disabled:cursor-not-allowed text-white font-medium px-4 py-2 rounded-lg text-sm transition-colors"}," Mark as Delivered ",8,ni)])])])):g("",!0)]))}},ri={class:"bg-white rounded-xl shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto"},di={class:"p-6 border-t border-gray-200 flex justify-end gap-3"},ui={__name:"RequalifyAsLeadModal",props:{show:{type:Boolean,required:!0}},emits:["confirm","cancel"],setup(t){return(h,s)=>t.show?(o(),n("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",onClick:s[2]||(s[2]=z(u=>h.$emit("cancel"),["self"]))},[e("div",ri,[s[3]||(s[3]=Ee('<div class="p-6 border-b border-gray-200"><div class="flex items-start gap-4"><div class="flex-shrink-0"><div class="w-12 h-12 rounded-full bg-yellow-100 flex items-center justify-center"><i class="fa-solid fa-exclamation-triangle text-yellow-600 text-xl"></i></div></div><div class="flex-1"><h3 class="text-lg font-bold text-gray-900 mb-1">Requalify as Lead</h3><p class="text-sm text-gray-600"> This will convert the opportunity back to a lead. Some data will be lost. </p></div></div></div><div class="p-6 space-y-6"><div><h4 class="text-sm font-bold text-red-700 mb-3 flex items-center gap-2"><i class="fa-solid fa-times-circle"></i> What will be lost </h4><ul class="space-y-2 text-sm text-gray-700"><li class="flex items-start gap-2"><i class="fa-solid fa-minus text-red-500 text-xs mt-1"></i><span>Opportunity stage, probability, and expected close date</span></li><li class="flex items-start gap-2"><i class="fa-solid fa-minus text-red-500 text-xs mt-1"></i><span>Opportunity value and negotiation history</span></li><li class="flex items-start gap-2"><i class="fa-solid fa-minus text-red-500 text-xs mt-1"></i><span>Stock or configured vehicles added to the opportunity</span></li><li class="flex items-start gap-2"><i class="fa-solid fa-minus text-red-500 text-xs mt-1"></i><span>Offer history and negotiation data</span></li></ul></div><div><h4 class="text-sm font-bold text-green-700 mb-3 flex items-center gap-2"><i class="fa-solid fa-check-circle"></i> What will be kept </h4><ul class="space-y-2 text-sm text-gray-700"><li class="flex items-start gap-2"><i class="fa-solid fa-check text-green-500 text-xs mt-1"></i><span>Customer information and contact details</span></li><li class="flex items-start gap-2"><i class="fa-solid fa-check text-green-500 text-xs mt-1"></i><span>Original requested car details</span></li><li class="flex items-start gap-2"><i class="fa-solid fa-check text-green-500 text-xs mt-1"></i><span>All activities (notes, calls, emails, etc.)</span></li></ul></div><div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4"><p class="text-sm text-yellow-800"><i class="fa-solid fa-info-circle mr-2"></i> This action cannot be undone. The opportunity will be permanently removed and replaced with a new lead. </p></div></div>',2)),e("div",di,[e("button",{onClick:s[0]||(s[0]=u=>h.$emit("cancel")),class:"bg-white hover:bg-gray-50 text-gray-700 border border-gray-300 font-medium px-4 py-2 rounded-lg text-sm transition-colors"}," Cancel "),e("button",{onClick:s[1]||(s[1]=u=>h.$emit("confirm")),class:"bg-yellow-600 hover:bg-yellow-700 text-white font-medium px-6 py-2 rounded-lg text-sm transition-colors"}," Confirm Requalification ")])])])):g("",!0)}},ci={class:"bg-white rounded-xl p-5 mb-6 animate-fade-in relative"},pi={class:"flex justify-between items-center mb-4"},mi={class:"text-sm font-bold text-slate-800"},yi={key:0,class:"mb-4"},gi={class:"max-h-64 overflow-y-auto space-y-2 border border-gray-200 rounded-lg p-2"},fi={class:"w-16 h-16 bg-gray-200 rounded overflow-hidden flex-shrink-0"},bi=["src"],vi={key:1,class:"fa-solid fa-car text-gray-400 w-full h-full flex items-center justify-center"},xi={class:"flex-1 min-w-0"},hi={class:"flex items-center gap-2 flex-wrap"},wi={class:"font-bold text-sm text-gray-800 truncate"},ki={class:"text-xs text-gray-500"},Ci={key:0,class:"text-[10px] text-green-600 mt-0.5"},$i={key:1,class:"text-[10px] text-orange-600 mt-0.5"},Si=["onClick"],Di={class:"w-16 h-16 bg-gray-200 rounded overflow-hidden flex-shrink-0"},Ai=["src"],Ti={key:1,class:"fa-solid fa-car text-gray-400 w-full h-full flex items-center justify-center"},qi={class:"flex-1 min-w-0"},Oi={class:"flex items-center gap-2 flex-wrap"},Ii={class:"font-bold text-sm text-gray-800 truncate"},Ni={class:"text-xs text-gray-500"},ji={key:0,class:"text-[10px] text-green-600 mt-0.5"},Mi={key:1,class:"text-center py-4 text-gray-400 text-sm"},Ri={class:"mb-4"},Vi={key:0,class:"flex items-center gap-2 mb-2"},Fi={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Li={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4"},Ui={class:"mt-4"},Ei={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},Bi=["disabled"],Wi={__name:"OfferWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"opportunity"},taskId:{type:Number,required:!0},requestedCar:{type:Object,default:null},recommendedCars:{type:Array,default:()=>[]}},emits:["save","cancel"],setup(t,{emit:h}){const s=t,u=h,a=k(null),l=k(null),p=k({brand:"",model:"",year:"",price:"",image:""});ie(()=>{s.item&&s.item.data&&(p.value={brand:s.item.data.brand||"",model:s.item.data.model||"",year:s.item.data.year||"",price:s.item.data.price||"",image:s.item.data.image||""})});const r=m=>{if(a.value=m,s.requestedCar){const c=m.id&&s.requestedCar.id&&m.id===s.requestedCar.id||m.brand===s.requestedCar.brand&&m.model===s.requestedCar.model&&m.year===s.requestedCar.year;l.value=c?"requested":"recommended"}else l.value="recommended";p.value={brand:m.brand||"",model:m.model||"",year:m.year||new Date().getFullYear(),price:m.price||"",image:m.image||""}},i=T(()=>a.value||p.value.brand&&p.value.model&&p.value.price),d=m=>new Intl.NumberFormat("en-US").format(m),v=()=>{var c,b;const m=a.value||p.value;u("save",{id:((c=s.item)==null?void 0:c.id)||Date.now(),type:"offer",action:s.item?"updated an offer":"added an offer",data:{brand:m.brand,model:m.model,year:m.year||new Date().getFullYear(),price:m.price,image:m.image||"",isMainOffer:!1},timestamp:((b=s.item)==null?void 0:b.timestamp)||new Date().toISOString(),isEdit:!!s.item})};return(m,c)=>{var b,y;return o(),n("div",ci,[e("div",pi,[e("h5",mi,f(t.item?"Edit Offer":"Add Offer"),1),e("button",{onClick:c[0]||(c[0]=S=>m.$emit("cancel")),class:"text-gray-400 hover:text-gray-600"},[...c[8]||(c[8]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),t.item?g("",!0):(o(),n("div",yi,[c[11]||(c[11]=e("label",{class:"block text-xs font-medium text-slate-700 mb-2"},"Select a vehicle",-1)),e("div",gi,[t.requestedCar?(o(),n("div",{key:0,onClick:c[1]||(c[1]=S=>r(t.requestedCar)),class:N(["flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 cursor-pointer border border-transparent hover:border-gray-200 transition-colors",{"border-blue-400 bg-blue-50":((b=a.value)==null?void 0:b.id)===t.requestedCar.id}])},[e("div",fi,[t.requestedCar.image?(o(),n("img",{key:0,src:t.requestedCar.image,alt:"Car",class:"w-full h-full object-cover"},null,8,bi)):(o(),n("i",vi))]),e("div",xi,[e("div",hi,[e("h4",wi,f(t.requestedCar.brand)+" "+f(t.requestedCar.model)+" ("+f(t.requestedCar.year)+")",1),e("span",{class:N(["inline-flex px-2 py-0.5 rounded text-[10px] font-semibold shrink-0",(((y=a.value)==null?void 0:y.id)===t.requestedCar.id&&l.value==="requested","bg-blue-100 text-blue-700 border border-blue-200")])}," Requested ",2)]),e("p",ki,"€ "+f(d(t.requestedCar.price)),1),t.requestedCar.stockDays!==null&&t.requestedCar.stockDays!==void 0?(o(),n("div",Ci," In stock ("+f(t.requestedCar.stockDays)+" days) ",1)):(o(),n("div",$i," Out of stock "))]),c[9]||(c[9]=e("i",{class:"fa-solid fa-chevron-right text-gray-400"},null,-1))],2)):g("",!0),(o(!0),n(P,null,te(t.recommendedCars,S=>{var q,I;return o(),n("div",{key:S.id,onClick:F=>r(S),class:N(["flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 cursor-pointer border border-transparent hover:border-gray-200 transition-colors",{"border-blue-400 bg-blue-50":((q=a.value)==null?void 0:q.id)===S.id}])},[e("div",Di,[S.image?(o(),n("img",{key:0,src:S.image,alt:"Car",class:"w-full h-full object-cover"},null,8,Ai)):(o(),n("i",Ti))]),e("div",qi,[e("div",Oi,[e("h4",Ii,f(S.brand)+" "+f(S.model)+" ("+f(S.year)+")",1),e("span",{class:N(["inline-flex px-2 py-0.5 rounded text-[10px] font-semibold shrink-0",(((I=a.value)==null?void 0:I.id)===S.id&&l.value==="recommended","bg-purple-100 text-purple-700 border border-purple-200")])}," Recommended ",2)]),e("p",Ni,"€ "+f(d(S.price)),1),S.stockDays!==null&&S.stockDays!==void 0?(o(),n("div",ji," In stock ("+f(S.stockDays)+" days) ",1)):g("",!0)]),c[10]||(c[10]=e("i",{class:"fa-solid fa-chevron-right text-gray-400"},null,-1))],10,Si)}),128)),!t.requestedCar&&t.recommendedCars.length===0?(o(),n("div",Mi," No vehicles available ")):g("",!0)])])),e("div",Ri,[t.requestedCar||t.recommendedCars.length>0?(o(),n("div",Vi,[...c[12]||(c[12]=[e("div",{class:"flex-grow border-t border-gray-200"},null,-1),e("span",{class:"text-xs text-gray-400 uppercase font-semibold"},"Or create manually",-1),e("div",{class:"flex-grow border-t border-gray-200"},null,-1)])])):g("",!0),e("div",Fi,[e("div",null,[c[13]||(c[13]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Brand",-1)),O(e("input",{type:"text","onUpdate:modelValue":c[2]||(c[2]=S=>p.value.brand=S),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[R,p.value.brand]])]),e("div",null,[c[14]||(c[14]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Model",-1)),O(e("input",{type:"text","onUpdate:modelValue":c[3]||(c[3]=S=>p.value.model=S),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[R,p.value.model]])])]),e("div",Li,[e("div",null,[c[15]||(c[15]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Year",-1)),O(e("input",{type:"number","onUpdate:modelValue":c[4]||(c[4]=S=>p.value.year=S),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[R,p.value.year]])]),e("div",null,[c[16]||(c[16]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Price (€)",-1)),O(e("input",{type:"number","onUpdate:modelValue":c[5]||(c[5]=S=>p.value.price=S),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[R,p.value.price]])])]),e("div",Ui,[c[17]||(c[17]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Image URL (optional)",-1)),O(e("input",{type:"text","onUpdate:modelValue":c[6]||(c[6]=S=>p.value.image=S),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700",placeholder:"https://..."},null,512),[[R,p.value.image]])])]),e("div",Ei,[e("button",{onClick:c[7]||(c[7]=S=>m.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:v,disabled:!i.value,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save",8,Bi)])])}}},Pi={key:0,class:"mb-8"},zi={class:"relative"},Yi={class:"flex overflow-x-auto space-x-4 pb-4 scrollbar-hide scroll-smooth",style:{"scroll-behavior":"smooth"}},Qi={class:"w-full h-36 bg-gray-200 flex items-center justify-center overflow-hidden"},Hi=["src"],Ki={key:1,class:"fa-solid fa-car text-4xl text-gray-400"},Ji={class:"p-4"},Gi={class:"font-bold text-gray-800 text-sm mb-1"},Xi={class:"text-xs text-gray-500 mb-2"},Zi={key:0,class:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-green-50 border border-green-100 text-green-700 text-[10px] font-semibold rounded-md mb-2"},_i=["onClick"],er={__name:"RecommendedCarsSlider",emits:["add-to-opportunity"],setup(t,{emit:h}){const s=k([]);ie(()=>{s.value=Be.filter(a=>a.stockDays!==null&&a.stockDays!==void 0).slice(0,5)});const u=a=>new Intl.NumberFormat("en-US").format(a);return(a,l)=>s.value.length>0?(o(),n("div",Pi,[l[1]||(l[1]=e("h3",{class:"font-bold text-gray-800 text-sm mb-4"},"Recommended Cars",-1)),e("div",zi,[e("div",Yi,[(o(!0),n(P,null,te(s.value,p=>(o(),n("div",{key:p.id,class:"flex-none w-64 bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-shadow"},[e("div",Qi,[p.image?(o(),n("img",{key:0,src:p.image,alt:"Car",class:"w-full h-full object-cover"},null,8,Hi)):(o(),n("i",Ki))]),e("div",Ji,[e("h4",Gi,f(p.brand)+" "+f(p.model)+" ("+f(p.year)+")",1),e("p",Xi,"€ "+f(u(p.price)),1),p.stockDays!==null&&p.stockDays!==void 0?(o(),n("div",Zi,[l[0]||(l[0]=e("div",{class:"w-1 h-1 bg-green-500 rounded-full"},null,-1)),j(" In stock ("+f(p.stockDays)+" days) ",1)])):g("",!0),e("button",{onClick:r=>a.$emit("add-to-opportunity",p),class:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded-lg text-sm shadow-sm transition-colors mt-2"}," Add to opportunity ",8,_i)])]))),128))])])])):g("",!0)}},tr=yt(er,[["__scopeId","data-v-0d800814"]]),sr={class:"mt-1.5 border-t border-gray-200 pt-1.5"},or={key:1},lr={class:"flex items-center justify-between mb-1.5"},ar={class:"space-y-1.5"},nr={class:"block label-upper mb-1"},ir=["onUpdate:modelValue","placeholder"],rr=["onUpdate:modelValue"],dr=["value"],ur={key:2,class:"space-y-0.5"},cr=["onUpdate:modelValue","value"],ye={__name:"SurveyWidget",props:{questions:{type:Array,required:!0}},emits:["survey-completed","survey-refused","not-responding"],setup(t,{emit:h}){const s=t,u=h,a=k(!1),l=k({});ne(()=>s.questions,v=>{const m={};v.forEach(c=>{m[c.key]=""}),l.value=m},{immediate:!0});const p=()=>{u("survey-completed",{...l.value}),d()},r=()=>{u("survey-refused"),d()},i=()=>{u("not-responding"),d()},d=()=>{a.value=!1;const v={};s.questions.forEach(m=>{v[m.key]=""}),l.value=v};return(v,m)=>(o(),n("div",sr,[a.value?(o(),n("div",or,[e("div",lr,[m[4]||(m[4]=e("h5",{class:"text-xs font-semibold text-gray-700"},"Survey / Feedback",-1)),e("button",{onClick:m[1]||(m[1]=c=>a.value=!1),class:"text-xs text-gray-400 hover:text-gray-600 font-medium py-0.5"},[...m[3]||(m[3]=[e("i",{class:"fa-solid fa-chevron-up text-[10px]"},null,-1)])])]),e("div",ar,[(o(!0),n(P,null,te(t.questions,(c,b)=>(o(),n("div",{key:b,class:"bg-gray-50 rounded-md p-1.5"},[e("label",nr,f(c.label),1),c.type==="text"?O((o(),n("textarea",{key:0,"onUpdate:modelValue":y=>l.value[c.key]=y,placeholder:c.placeholder,rows:"2",class:"input resize-none text-xs py-1 px-2"},null,8,ir)),[[R,l.value[c.key]]]):c.type==="select"?O((o(),n("select",{key:1,"onUpdate:modelValue":y=>l.value[c.key]=y,class:"input text-xs py-1 px-2"},[m[5]||(m[5]=e("option",{value:""},"Select an option...",-1)),(o(!0),n(P,null,te(c.options,y=>(o(),n("option",{key:y,value:y},f(y),9,dr))),128))],8,rr)),[[de,l.value[c.key]]]):c.type==="radio"?(o(),n("div",ur,[(o(!0),n(P,null,te(c.options,y=>(o(),n("label",{key:y,class:"flex items-center text-xs"},[O(e("input",{type:"radio","onUpdate:modelValue":S=>l.value[c.key]=S,value:y,class:"mr-1"},null,8,cr),[[we,l.value[c.key]]]),j(" "+f(y),1)]))),128))])):g("",!0)]))),128)),e("div",{class:"flex gap-1.5 flex-wrap pt-0.5"},[e("button",{onClick:p,class:"bg-green-600 hover:bg-green-700 text-white font-medium px-2.5 py-1 rounded-md text-xs transition-colors"}," Complete Survey "),e("button",{onClick:r,class:"bg-white hover:bg-gray-50 border border-gray-200 text-slate-700 font-medium px-2.5 py-1 rounded-md text-xs transition-colors"}," Customer Refused "),e("button",{onClick:i,class:"bg-white hover:bg-gray-50 border border-gray-200 text-slate-700 font-medium px-2.5 py-1 rounded-md text-xs transition-colors"}," Not Responding ")])])])):(o(),n("button",{key:0,onClick:m[0]||(m[0]=c=>a.value=!0),class:"w-full flex items-center justify-between text-xs text-gray-500 hover:text-gray-700 py-0.5 transition-colors"},[...m[2]||(m[2]=[e("span",{class:"font-medium"},"Survey / Feedback",-1),e("i",{class:"fa-solid fa-chevron-down text-[10px]"},null,-1)])]))]))}},pr={class:"bg-orange-50/50 border border-orange-100 rounded-lg p-4 relative transition-all duration-300"},mr={class:"flex justify-between items-start mb-3"},yr={class:"text-xs text-gray-500 mt-0.5"},gr={__name:"OOFBWidget",props:{opportunity:{type:Object,required:!0}},emits:["create-offer","review","close-lost","survey-completed","survey-refused","not-responding"],setup(t,{emit:h}){const s=t,u=h,a=[{key:"offerStatus",label:"Why hasn't an offer been created?",type:"select",options:["Still gathering information","Awaiting customer response","Vehicle unavailable","Pricing concerns","Other"]},{key:"customerInterest",label:"Is customer still interested?",type:"radio",options:["Yes","Maybe","No"]},{key:"notes",label:"Additional notes",type:"text",placeholder:"Any relevant feedback or next steps..."}],l=T(()=>{if(!s.opportunity.createdAt)return 0;const c=new Date(s.opportunity.createdAt),y=Math.abs(new Date-c);return Math.ceil(y/(1e3*60*60*24))}),p=()=>{u("create-offer",s.opportunity)},r=()=>{u("review",s.opportunity)},i=()=>{u("close-lost",s.opportunity)},d=c=>{u("survey-completed",{opportunity:s.opportunity,responses:c})},v=()=>{u("survey-refused",{opportunity:s.opportunity})},m=()=>{u("not-responding",{opportunity:s.opportunity})};return(c,b)=>(o(),n("div",pr,[e("div",mr,[e("div",null,[b[0]||(b[0]=e("h4",{class:"font-bold text-slate-800 text-sm"},"Open Opportunity Feedback",-1)),e("p",yr,"This opportunity has been open for "+f(l.value)+" days without any offer. Consider creating an offer to move forward.",1)])]),e("div",{class:"flex gap-3 flex-wrap"},[e("button",{onClick:p,class:"bg-orange-600 hover:bg-orange-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Create Offer "),e("button",{onClick:r,class:"bg-white hover:bg-gray-50 border border-gray-200 text-slate-700 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"}," Review Opportunity "),e("button",{onClick:i,class:"bg-white hover:bg-red-50 border border-gray-200 text-slate-700 hover:text-red-600 hover:border-red-200 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"}," Close as Lost ")]),B(ye,{questions:a,onSurveyCompleted:d,onSurveyRefused:v,onNotResponding:m})]))}},fr={class:"bg-red-50/50 border border-red-100 rounded-lg p-4 relative transition-all duration-300"},br={class:"flex justify-between items-start mb-3"},vr={class:"text-xs text-gray-500 mt-0.5"},xr={__name:"UFBWidget",props:{opportunity:{type:Object,required:!0}},emits:["create-offer","mark-unsold","survey-completed","survey-refused","not-responding"],setup(t,{emit:h}){const s=t,u=h,a=[{key:"lostInterest",label:"Has customer lost interest?",type:"radio",options:["Yes","Maybe","No","Unknown"]},{key:"blockers",label:"What are the blockers?",type:"select",options:["Pricing","Availability","Financing","No response","Changed mind","Found competitor","Other"]},{key:"notes",label:"Additional feedback",type:"text",placeholder:"Describe the situation and any relevant details..."}],l=T(()=>{if(!s.opportunity.createdAt)return 0;const m=new Date(s.opportunity.createdAt),b=Math.abs(new Date-m);return Math.ceil(b/(1e3*60*60*24))}),p=()=>{u("create-offer",s.opportunity)},r=()=>{u("mark-unsold",s.opportunity)},i=m=>{u("survey-completed",{opportunity:s.opportunity,responses:m})},d=()=>{u("survey-refused",{opportunity:s.opportunity})},v=()=>{u("not-responding",{opportunity:s.opportunity})};return(m,c)=>(o(),n("div",fr,[e("div",br,[e("div",null,[c[0]||(c[0]=e("h4",{class:"font-bold text-slate-800 text-sm"},"Unsold Feedback",-1)),e("p",vr,"This opportunity has been open for "+f(l.value)+" days without any offer. This is a follow-up to ensure progress. Consider creating an offer or closing the opportunity.",1)])]),e("div",{class:"flex gap-3 flex-wrap"},[e("button",{onClick:p,class:"bg-red-600 hover:bg-red-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Create Offer "),e("button",{onClick:r,class:"bg-white hover:bg-gray-50 border border-gray-200 text-slate-700 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"}," Close as Lost ")]),B(ye,{questions:a,onSurveyCompleted:i,onSurveyRefused:d,onNotResponding:v})]))}},hr={class:"bg-blue-50/50 border border-blue-100 rounded-lg p-4 relative transition-all duration-300"},wr={class:"flex justify-between items-start mb-3"},kr={class:"text-xs text-gray-500 mt-0.5"},Cr={__name:"OFBWidget",props:{opportunity:{type:Object,required:!0}},emits:["create-contract","close-lost","survey-completed","survey-refused","not-responding"],setup(t,{emit:h}){const s=t,u=h,a=[{key:"customerFeedback",label:"Customer feedback on offer?",type:"select",options:["Positive","Neutral","Negative","No feedback yet"]},{key:"objections",label:"Any objections?",type:"text",placeholder:"Describe any concerns or objections raised by customer..."},{key:"nextSteps",label:"What are the next steps?",type:"select",options:["Waiting for customer decision","Revising offer","Scheduling closing meeting","Addressing objections","Other"]}],l=T(()=>{const m=s.opportunity.lastActivity||s.opportunity.createdAt;if(!m)return 0;const c=new Date(m),y=Math.abs(new Date-c);return Math.ceil(y/(1e3*60*60*24))}),p=()=>{u("create-contract",s.opportunity)},r=()=>{u("close-lost",s.opportunity)},i=m=>{u("survey-completed",{opportunity:s.opportunity,responses:m})},d=()=>{u("survey-refused",{opportunity:s.opportunity})},v=()=>{u("not-responding",{opportunity:s.opportunity})};return(m,c)=>(o(),n("div",hr,[e("div",wr,[e("div",null,[c[0]||(c[0]=e("h4",{class:"font-bold text-slate-800 text-sm"},"Offer Feedback",-1)),e("p",kr,"This opportunity has been in negotiation for "+f(l.value)+" days without a contract. Consider creating a contract to finalize the deal.",1)])]),e("div",{class:"flex gap-3 flex-wrap"},[e("button",{onClick:p,class:"bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Create Contract "),e("button",{onClick:r,class:"bg-white hover:bg-red-50 border border-gray-200 text-slate-700 hover:text-red-600 hover:border-red-200 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"}," Close as Lost ")]),B(ye,{questions:a,onSurveyCompleted:i,onSurveyRefused:d,onNotResponding:v})]))}},$r={class:"bg-purple-50/50 border border-purple-100 rounded-lg p-4 relative transition-all duration-300"},Sr={__name:"NFUWidget",props:{opportunity:{type:Object,required:!0}},emits:["close-lost","schedule-closing","survey-completed","survey-refused","not-responding"],setup(t,{emit:h}){const s=t,u=h,a=[{key:"appointmentStatus",label:"Why no appointment scheduled?",type:"select",options:["Customer delaying","Awaiting vehicle availability","Logistics issues","Customer not responding","Other"]},{key:"customerStatus",label:"Customer status?",type:"radio",options:["Still interested","Considering","Lost interest","Unknown"]},{key:"notes",label:"Additional information",type:"text",placeholder:"Any relevant details about the follow-up..."}],l=()=>{u("close-lost",s.opportunity)},p=()=>{u("schedule-closing",s.opportunity)},r=v=>{u("survey-completed",{opportunity:s.opportunity,responses:v})},i=()=>{u("survey-refused",{opportunity:s.opportunity})},d=()=>{u("not-responding",{opportunity:s.opportunity})};return(v,m)=>(o(),n("div",$r,[m[0]||(m[0]=e("div",{class:"flex justify-between items-start mb-3"},[e("div",null,[e("h4",{class:"font-bold text-slate-800 text-sm"},"Opportunity Follow-up"),e("p",{class:"text-xs text-gray-500 mt-0.5"},"No contract date exists. Push to close or schedule a closing meeting to finalize the deal.")])],-1)),e("div",{class:"flex gap-3 flex-wrap"},[e("button",{onClick:p,class:"bg-purple-600 hover:bg-purple-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Schedule Closing Meeting "),e("button",{onClick:l,class:"bg-white hover:bg-red-50 border border-gray-200 text-slate-700 hover:text-red-600 hover:border-red-200 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"}," Close as Lost ")]),B(ye,{questions:a,onSurveyCompleted:r,onSurveyRefused:i,onNotResponding:d})]))}},Dr={class:"bg-yellow-50/50 border border-yellow-100 rounded-lg p-4 relative transition-all duration-300"},Ar={class:"flex justify-between items-start mb-3"},Tr={class:"text-xs text-gray-500 mt-0.5"},qr={__name:"NSWidget",props:{opportunity:{type:Object,required:!0},scheduledAppointment:{type:Object,required:!0}},emits:["contact-customer","reschedule","close-lost","survey-completed","survey-refused","not-responding"],setup(t,{emit:h}){const s=t,u=h,a=[{key:"contactStatus",label:"Were you able to reach the customer?",type:"radio",options:["Yes","No","Left message"]},{key:"noShowReason",label:"Reason for no-show?",type:"select",options:["Emergency","Forgot","Changed mind","No response","Schedule conflict","Other"]},{key:"nextAction",label:"Next action?",type:"select",options:["Reschedule appointment","Customer will call back","Continue follow-up","Close as lost","Other"]},{key:"notes",label:"Additional notes",type:"text",placeholder:"Document the conversation and any relevant details..."}],l=T(()=>{var b;return(b=s.scheduledAppointment)!=null&&b.start?new Date(s.scheduledAppointment.start).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"unknown date"}),p=()=>{u("contact-customer",s.opportunity)},r=()=>{u("reschedule",s.opportunity)},i=()=>{u("close-lost",s.opportunity)},d=c=>{u("survey-completed",{opportunity:s.opportunity,responses:c})},v=()=>{u("survey-refused",{opportunity:s.opportunity})},m=()=>{u("not-responding",{opportunity:s.opportunity})};return(c,b)=>(o(),n("div",Dr,[e("div",Ar,[e("div",null,[b[0]||(b[0]=e("h4",{class:"font-bold text-slate-800 text-sm"},"No-Show Follow-up",-1)),e("p",Tr,"Appointment was scheduled for "+f(l.value)+" but customer did not show up. Follow up with customer to understand the situation.",1)])]),e("div",{class:"flex gap-3 flex-wrap"},[e("button",{onClick:p,class:"bg-yellow-600 hover:bg-yellow-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Contact Customer "),e("button",{onClick:r,class:"bg-white hover:bg-gray-50 border border-gray-200 text-slate-700 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"}," Reschedule "),e("button",{onClick:i,class:"bg-white hover:bg-red-50 border border-gray-200 text-slate-700 hover:text-red-600 hover:border-red-200 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"}," Close as Lost ")]),B(ye,{questions:a,onSurveyCompleted:d,onSurveyRefused:v,onNotResponding:m})]))}},Or={class:"bg-green-50/50 border border-green-100 rounded-lg p-4 relative transition-all duration-300"},Ir={class:"flex justify-between items-start mb-3"},Nr={class:"text-xs text-gray-500 mt-0.5"},jr={__name:"CFBWidget",props:{opportunity:{type:Object,required:!0}},emits:["prepare-delivery","pre-delivery-checklist","survey-completed","survey-refused","not-responding"],setup(t,{emit:h}){const s=t,u=h,a=[{key:"deliveryTimeline",label:"Delivery timeline confirmation?",type:"select",options:["On schedule","Delayed","Ahead of schedule","To be determined"]},{key:"concerns",label:"Any concerns?",type:"text",placeholder:"Document any concerns or special requests from customer..."},{key:"readiness",label:"Vehicle readiness status?",type:"select",options:["Ready","In preparation","Waiting for parts","Other"]}],l=T(()=>{var y;if(!((y=s.opportunity)!=null&&y.contractDate))return 0;const m=new Date(s.opportunity.contractDate),b=Math.abs(new Date-m);return Math.ceil(b/(1e3*60*60*24))}),p=()=>{u("prepare-delivery",s.opportunity)},r=()=>{u("pre-delivery-checklist",s.opportunity)},i=m=>{u("survey-completed",{opportunity:s.opportunity,responses:m})},d=()=>{u("survey-refused",{opportunity:s.opportunity})},v=()=>{u("not-responding",{opportunity:s.opportunity})};return(m,c)=>(o(),n("div",Or,[e("div",Ir,[e("div",null,[c[0]||(c[0]=e("h4",{class:"font-bold text-slate-800 text-sm"},"Contract Feedback",-1)),e("p",Nr,"Contract was signed "+f(l.value)+" days ago. Follow up on delivery status and collect customer feedback.",1)])]),e("div",{class:"flex gap-3 flex-wrap"},[e("button",{onClick:p,class:"bg-green-600 hover:bg-green-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Prepare for Delivery "),e("button",{onClick:r,class:"bg-white hover:bg-gray-50 border border-gray-200 text-slate-700 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"}," Pre-Delivery Checklist ")]),B(ye,{questions:a,onSurveyCompleted:i,onSurveyRefused:d,onNotResponding:v})]))}},Mr={class:"bg-teal-50/50 border border-teal-100 rounded-lg p-4 relative transition-all duration-300"},Rr={class:"flex justify-between items-start mb-3"},Vr={class:"text-xs text-gray-500 mt-0.5"},Fr={__name:"DFBWidget",props:{opportunity:{type:Object,required:!0},activities:{type:Array,default:()=>[]}},emits:["delivery-feedback","survey-completed","survey-refused","not-responding"],setup(t,{emit:h}){const s=t,u=h,a=[{key:"satisfaction",label:"Satisfaction with vehicle?",type:"radio",options:["Very satisfied","Satisfied","Neutral","Dissatisfied","Very dissatisfied"]},{key:"deliveryExperience",label:"Delivery experience rating",type:"select",options:["Excellent","Good","Average","Poor","Very poor"]},{key:"issues",label:"Any issues or concerns?",type:"text",placeholder:"Document any issues or positive feedback from customer..."}],l=T(()=>{const v=s.activities.find(y=>{var S;return y.type==="delivery"||((S=y.action)==null?void 0:S.toLowerCase().includes("delivered"))});if(!v||!v.timestamp)return 0;const m=new Date(v.timestamp),b=Math.abs(new Date-m);return Math.ceil(b/(1e3*60*60*24))}),p=()=>{u("delivery-feedback",s.opportunity)},r=v=>{u("survey-completed",{opportunity:s.opportunity,responses:v})},i=()=>{u("survey-refused",{opportunity:s.opportunity})},d=()=>{u("not-responding",{opportunity:s.opportunity})};return(v,m)=>(o(),n("div",Mr,[e("div",Rr,[e("div",null,[m[0]||(m[0]=e("h4",{class:"font-bold text-slate-800 text-sm"},"Delivery Feedback",-1)),e("p",Vr,"Vehicle was delivered "+f(l.value)+" days ago. Ask the customer if they're satisfied with the vehicle.",1)])]),e("button",{onClick:p,class:"bg-teal-600 hover:bg-teal-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Delivery Feedback "),B(ye,{questions:a,onSurveyCompleted:r,onSurveyRefused:i,onNotResponding:d})]))}},Lr={class:"bg-gray-50/50 border border-gray-200 rounded-lg p-4 relative transition-all duration-300"},Ur={__name:"CloseOpportunityWidget",props:{opportunity:{type:Object,required:!0}},emits:["close-won","close-lost"],setup(t,{emit:h}){const s=t,u=h,a=()=>{u("close-won",s.opportunity)},l=()=>{u("close-lost",s.opportunity)};return(p,r)=>(o(),n("div",Lr,[r[2]||(r[2]=e("div",{class:"flex justify-between items-start mb-3"},[e("div",null,[e("h4",{class:"font-bold text-slate-800 text-sm"},"Close Opportunity"),e("p",{class:"text-xs text-gray-500 mt-0.5"},"Mark this opportunity as won or lost to close the deal.")])],-1)),e("div",{class:"flex gap-3 flex-wrap"},[e("button",{onClick:a,class:"bg-green-600 hover:bg-green-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"},[...r[0]||(r[0]=[j(" Close as Won ",-1),e("i",{class:"fa-solid fa-check-circle"},null,-1)])]),e("button",{onClick:l,class:"bg-white hover:bg-red-50 border border-gray-200 text-slate-700 hover:text-red-600 hover:border-red-200 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"},[...r[1]||(r[1]=[j(" Close as Lost ",-1),e("i",{class:"fa-solid fa-times-circle"},null,-1)])])])]))}},Er={key:0,class:"bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden mb-8"},Br={class:"p-4 border-b border-gray-100 bg-gray-50/50 flex justify-between items-center"},Wr={class:"text-xs bg-purple-100 text-purple-700 px-2 py-0.5 rounded font-medium"},Pr={class:"p-5 space-y-6"},zr={key:0,class:"bg-green-50/50 border border-green-100 rounded-lg p-4 relative transition-all duration-300"},Yr={class:"flex gap-3"},Qr={key:1,class:"bg-yellow-50/50 border border-yellow-200 rounded-lg p-4 relative transition-all duration-300"},Hr={class:"flex items-start gap-3"},Kr={class:"flex-1"},Jr={class:"font-bold text-slate-800 text-sm mb-1"},Gr={key:0},Xr={key:1},Zr={class:"text-xs text-gray-600"},_r={key:0},ed={key:1},td={key:2},sd={class:"flex justify-between items-start mb-3"},od={class:"font-bold text-slate-800 text-sm"},ld={key:0},ad={key:1},nd={class:"text-xs text-gray-500 mt-0.5"},id={key:0},rd={key:1},dd={class:"flex gap-3 flex-wrap"},ud={key:0,class:"mt-4"},cd={class:"[&>div]:mb-0"},pd={key:3,class:"bg-blue-50/50 border border-blue-100 rounded-lg p-4 relative transition-all duration-300"},md={class:"flex justify-between items-start mb-3"},yd={class:"text-xs text-gray-500 mt-0.5"},gd={key:0,class:"pt-4"},fd={key:4,class:"bg-gray-50/50 border border-gray-100 rounded-lg p-4 relative transition-all duration-300"},bd={key:5,class:"bg-green-50/50 border border-green-100 rounded-lg p-4 relative transition-all duration-300"},vd={class:"flex justify-between items-start mb-3"},xd={class:"text-xs text-gray-500 mt-0.5"},hd={key:12,class:"bg-indigo-50/50 border border-indigo-100 rounded-lg p-4 relative transition-all duration-300"},wd={class:"bg-white rounded-xl shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"},kd={class:"p-6"},Cd={class:"bg-white rounded-xl shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"},$d={class:"p-6"},Sd={__name:"OpportunityManagementWidget",props:{opportunity:{type:Object,required:!0},scheduledAppointment:{type:Object,default:null},activities:{type:Array,default:()=>[]}},emits:["add-vehicle","add-vehicle-from-stock","configure-vehicle","create-offer","add-to-opportunity"],setup(t,{emit:h}){const s=t,u=h,a=T(()=>{var w,C,V;return((w=s.opportunity)==null?void 0:w.stage)==="Closed"||((C=s.opportunity)==null?void 0:C.stage)==="Closed Lost"||((V=s.opportunity)==null?void 0:V.stage)==="Registration"}),l=k(!1),p=k(!1),r=k(null),i=k(!1),d=k(""),v=k(!1),m=k(!1),c=k(!1),b=k(!1),y=k(!1),S=k([]),q=Oe(),I=We(),F=qe();ie(()=>{S.value=Be.filter(w=>w.stockDays!==null&&w.stockDays!==void 0).slice(0,5).map(w=>({id:w.id,brand:w.brand,model:w.model,year:w.year,price:w.price,image:w.image||"",stockDays:w.stockDays}))});const U=w=>{d.value=w,i.value=!0},oe=w=>w?new Date(w).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-",Y=w=>w?new Date(w).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"-",G=()=>{l.value=!l.value},X=w=>{l.value=!1},se=T(()=>{var K;if(!((K=s.opportunity)!=null&&K.createdAt))return 0;const w=new Date(s.opportunity.createdAt),V=Math.abs(new Date-w);return Math.ceil(V/(1e3*60*60*24))}),ae=T(()=>{var C,V;return s.activities.some(K=>K.type==="offer")||((C=s.opportunity)==null?void 0:C.stage)==="In Negotiation"||((V=s.opportunity)==null?void 0:V.stage)==="Closed"}),Z=T(()=>s.activities.some(w=>w.type==="appointment")),D=T(()=>{var V,K,J,le;const w=((V=s.opportunity)==null?void 0:V.contractDate)!==null&&((K=s.opportunity)==null?void 0:K.contractDate)!==void 0,C=s.activities.some(_=>{var ee,re;return((ee=_.action)==null?void 0:ee.toLowerCase().includes("won"))||((re=_.action)==null?void 0:re.toLowerCase().includes("contract"))});return w||C||((J=s.opportunity)==null?void 0:J.stage)==="Closed"&&((le=s.opportunity)==null?void 0:le.probability)===100}),A=T(()=>s.activities.some(w=>{var C,V;return w.type==="delivery"||((C=w.action)==null?void 0:C.toLowerCase().includes("delivered"))||((V=w.action)==null?void 0:V.toLowerCase().includes("delivery"))})),W=T(()=>{var C;if(((C=s.opportunity)==null?void 0:C.stage)!=="Qualified"||ae.value||s.scheduledAppointment||Z.value)return!1;const w=se.value;return w>=7&&w<14}),x=T(()=>{var C;return((C=s.opportunity)==null?void 0:C.stage)!=="Qualified"||ae.value||s.scheduledAppointment||Z.value?!1:se.value>=14}),Q=T(()=>{var C;return((C=s.opportunity)==null?void 0:C.stage)!=="Qualified"||ae.value||!s.scheduledAppointment?!1:se.value>=7}),ge=T(()=>{const w=se.value;return w>=14?"high":w>=7?"medium":null}),he=T(()=>{var J;if(((J=s.opportunity)==null?void 0:J.stage)!=="In Negotiation")return!1;const w=s.opportunity.lastActivity?new Date(s.opportunity.lastActivity):new Date(s.opportunity.createdAt),V=Math.abs(new Date-w),K=Math.ceil(V/(1e3*60*60*24));return!D.value&&K>=5}),ke=T(()=>{var ee,re,Me;if(((ee=s.opportunity)==null?void 0:ee.stage)!=="In Negotiation")return!1;const w=((re=s.opportunity)==null?void 0:re.contractDate)!==null&&((Me=s.opportunity)==null?void 0:Me.contractDate)!==void 0,C=s.scheduledAppointment&&new Date(s.scheduledAppointment.start)>new Date||Z.value&&s.activities.some(Ae=>{var Re;return Ae.type==="appointment"&&((Re=Ae.data)!=null&&Re.datetime)?new Date(Ae.data.datetime)>new Date:!1}),V=s.opportunity.lastActivity?new Date(s.opportunity.lastActivity):new Date(s.opportunity.createdAt),J=Math.abs(new Date-V);return Math.ceil(J/(1e3*60*60*24))>=5&&!w&&!C}),Ce=T(()=>{var _,ee,re;if(((_=s.opportunity)==null?void 0:_.stage)!=="Closed"&&((ee=s.opportunity)==null?void 0:ee.stage)!=="Registration")return!1;const w=(re=s.opportunity)==null?void 0:re.contractDate;if(!w||A.value)return!1;const C=new Date(w),K=Math.abs(new Date-C);return Math.ceil(K/(1e3*60*60*24))>=7}),$e=T(()=>{const w=s.activities.find(_=>{var ee;return _.type==="delivery"||((ee=_.action)==null?void 0:ee.toLowerCase().includes("delivered"))});if(!w)return!1;const C=new Date(w.timestamp),K=Math.abs(new Date-C);return Math.ceil(K/(1e3*60*60*24))>=3}),M=T(()=>{if(!s.scheduledAppointment||new Date(s.scheduledAppointment.start)>=new Date)return!1;const V=s.activities.some(J=>{var le,_,ee;return J.type==="appointment"&&(((le=J.data)==null?void 0:le.status)==="completed"||((_=J.action)==null?void 0:_.toLowerCase().includes("completed")))&&((ee=J.data)==null?void 0:ee.appointmentId)===s.scheduledAppointment.id}),K=s.scheduledAppointment.status==="no-show";return!V&&!K}),$=T(()=>!a.value),H=T(()=>{var w,C,V;return!(((w=s.opportunity)==null?void 0:w.stage)!=="In Negotiation"||!((C=s.opportunity)!=null&&C.contractDate)||((V=s.opportunity)==null?void 0:V.stage)==="Closed")}),ve=T(()=>{var J,le,_;if(((J=s.opportunity)==null?void 0:J.stage)!=="Closed"||!((le=s.opportunity)!=null&&le.contractDate)||A.value||((_=s.opportunity)==null?void 0:_.stage)==="Registration")return!1;const w=new Date(s.opportunity.contractDate),V=Math.abs(new Date-w);return Math.ceil(V/(1e3*60*60*24))>=7}),Ye=()=>{u("add-vehicle",s.opportunity)},Qe=()=>{U("Add Vehicle from Stock")},He=()=>{U("Configure Vehicle")},Se=()=>{v.value=!0},Ie=()=>{v.value=!1},Ke=w=>{v.value=!1,u("create-offer",{opportunity:s.opportunity,offerData:w})},Je=w=>{u("add-to-opportunity",w)},Ge=w=>{U("Review Opportunity")},Xe=w=>{c.value=!0},Ze=w=>{c.value=!1,console.log("Contract date set:",w)},Ne=w=>{p.value=!0,r.value=w},De=()=>{p.value=!1,r.value=null},_e=w=>{Ne("nfu")},et=w=>{De();const C={type:"appointment",user:"You",action:"scheduled an appointment",content:`Appointment scheduled: ${w.type} on ${w.date} at ${w.time}`,data:{type:w.type,assignee:w.assignee,date:w.date,time:w.time,datetime:`${w.date}T${w.time}:00`,status:"scheduled"},timestamp:new Date().toISOString()};u("appointment-created",C)},tt=w=>{b.value=!0},st=w=>{U("Pre-Delivery Checklist")},ot=w=>{b.value=!1,console.log("Vehicle marked as delivered:",w)},lt=w=>{U("Delivery Feedback")},at=()=>{je()},fe=()=>{m.value=!0},nt=w=>{m.value=!1,console.log("Closing opportunity as lost:",w)},it=()=>{U("Contact Customer")},ce=w=>{console.log("Survey completed:",w)},pe=w=>{console.log("Survey refused:",w)},me=w=>{console.log("Customer not responding:",w)},rt=async()=>{try{await I.reopenOpportunity(s.opportunity.id),await I.loadOpportunityById(s.opportunity.id)}catch(w){console.error("Failed to reopen opportunity:",w)}},dt=async()=>{try{y.value=!1;const w=await I.convertOpportunityToLead(s.opportunity.id);F.canAccessLeads()?q.push({path:`/tasks/${w}`,query:{type:"lead"}}):q.push("/tasks/1")}catch(w){console.error("Failed to convert opportunity to lead:",w),y.value=!1}},ut=async()=>{try{await I.markAsRegistration(s.opportunity.id),await I.loadOpportunityById(s.opportunity.id)}catch(w){console.error("Failed to mark as registration:",w)}},je=async()=>{try{await I.markAsClosedWon(s.opportunity.id),await I.loadOpportunityById(s.opportunity.id)}catch(w){console.error("Failed to mark as closed won:",w)}};return(w,C)=>t.opportunity?(o(),n("div",Er,[e("div",Br,[C[8]||(C[8]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fa-solid fa-thumbtack text-gray-400 text-xs"}),e("h3",{class:"font-bold text-slate-800 text-sm"},"Manage Next steps")],-1)),e("span",Wr,f(a.value?"Closed":"Active"),1)]),e("div",Pr,[a.value?(o(),n("div",zr,[C[11]||(C[11]=e("div",{class:"flex justify-between items-start mb-3"},[e("div",null,[e("h4",{class:"font-bold text-slate-800 text-sm"},"Opportunity Closed"),e("p",{class:"text-xs text-gray-500 mt-0.5"},"This opportunity has been closed. Reopen it to restart the management process, or requalify as a lead.")])],-1)),e("div",Yr,[e("button",{onClick:rt,class:"bg-green-600 hover:bg-green-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"},[...C[9]||(C[9]=[j(" Reopen ",-1),e("i",{class:"fa-solid fa-rotate-left"},null,-1)])]),e("button",{onClick:C[0]||(C[0]=V=>y.value=!0),class:"bg-white hover:bg-yellow-50 text-yellow-700 border border-yellow-300 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"},[...C[10]||(C[10]=[j(" Requalify as Lead ",-1),e("i",{class:"fa-solid fa-arrow-left"},null,-1)])])])])):g("",!0),Q.value?(o(),n("div",Qr,[e("div",Hr,[C[12]||(C[12]=e("div",{class:"flex-shrink-0 mt-0.5"},[e("i",{class:"fa-solid fa-exclamation-triangle text-yellow-600 text-sm"})],-1)),e("div",Kr,[e("h4",Jr,[ge.value==="high"?(o(),n("span",Gr,"High Risk")):(o(),n("span",Xr,"At Risk"))]),e("p",Zr,[ge.value==="high"?(o(),n("span",_r," This opportunity has been open for "+f(se.value)+" days. Even with a scheduled appointment, consider following up to ensure engagement. ",1)):(o(),n("span",ed," This opportunity has been open for "+f(se.value)+" days. Monitor closely to ensure the scheduled appointment proceeds as planned. ",1))])])])])):g("",!0),t.opportunity.stage==="Qualified"&&t.opportunity.vehicle?(o(),n("div",td,[e("div",{class:N([t.opportunity.vehicle.stockDays!==null&&t.opportunity.vehicle.stockDays!==void 0?"bg-green-50/50 border border-green-100":"bg-orange-50/50 border border-orange-100","rounded-lg p-4 relative transition-all duration-300"])},[e("div",sd,[e("div",null,[e("h4",od,[t.opportunity.vehicle.stockDays!==null&&t.opportunity.vehicle.stockDays!==void 0?(o(),n("span",ld," Add Vehicle ")):(o(),n("span",ad," Find Alternative "))]),e("p",nd,[t.opportunity.vehicle.stockDays!==null&&t.opportunity.vehicle.stockDays!==void 0?(o(),n("span",id," The requested vehicle is available. Add it to the opportunity to proceed. ")):(o(),n("span",rd," The requested vehicle is currently out of stock. Explore other options. "))])])]),e("div",dd,[t.opportunity.vehicle.stockDays!==null&&t.opportunity.vehicle.stockDays!==void 0?(o(),n("button",{key:0,onClick:Ye,class:"bg-green-600 hover:bg-green-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Add requested vehicle to opportunity ")):g("",!0),e("button",{onClick:Qe,class:"bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Add vehicle from stock "),e("button",{onClick:He,class:"bg-white hover:bg-gray-50 border border-gray-200 text-slate-700 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"}," Configure vehicle "),e("button",{onClick:Se,class:"bg-white hover:bg-gray-50 border border-gray-200 text-slate-700 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"}," Create offer ")]),t.opportunity.vehicle.stockDays===null||t.opportunity.vehicle.stockDays===void 0?(o(),n("div",ud,[e("div",cd,[B(tr,{onAddToOpportunity:Je})])])):g("",!0)],2)])):g("",!0),t.opportunity.stage==="Qualified"&&t.scheduledAppointment?(o(),n("div",pd,[e("div",md,[e("div",null,[C[13]||(C[13]=e("h4",{class:"font-bold text-slate-800 text-sm"},"Next Appointment",-1)),e("p",yd,f(t.scheduledAppointment.title)+" on "+f(oe(t.scheduledAppointment.start))+" at "+f(Y(t.scheduledAppointment.start)),1)])]),e("button",{onClick:G,class:"bg-white hover:bg-gray-50 border border-gray-200 text-gray-700 font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"}," Postpone "),l.value?(o(),n("div",gd,[B(Pe,{show:l.value,onClose:C[1]||(C[1]=V=>l.value=!1),onConfirm:X},null,8,["show"])])):g("",!0)])):t.opportunity.stage==="Qualified"&&!Z.value?(o(),n("div",fd,[C[14]||(C[14]=e("div",{class:"flex justify-between items-start mb-3"},[e("div",null,[e("h4",{class:"font-bold text-slate-800 text-sm"},"No Appointment Scheduled"),e("p",{class:"text-xs text-gray-500 mt-0.5"},"Schedule a new appointment to move the opportunity forward.")])],-1)),e("button",{onClick:C[2]||(C[2]=V=>Ne("no-appointment")),class:"bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Schedule appointment ")])):g("",!0),H.value?(o(),n("div",bd,[e("div",vd,[e("div",null,[C[15]||(C[15]=e("h4",{class:"font-bold text-slate-800 text-sm"},"Contract Signed",-1)),e("p",xd," Contract was signed on "+f(oe(t.opportunity.contractDate))+". Mark this opportunity as Closed Won to complete the deal. ",1)])]),e("button",{onClick:je,class:"bg-green-600 hover:bg-green-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"},[...C[16]||(C[16]=[j(" Mark as Closed Won ",-1),e("i",{class:"fa-solid fa-check-circle"},null,-1)])])])):g("",!0),M.value?(o(),L(qr,{key:6,opportunity:t.opportunity,"scheduled-appointment":t.scheduledAppointment,onContactCustomer:it,onReschedule:w.openRescheduleModal,onCloseLost:fe,onSurveyCompleted:ce,onSurveyRefused:pe,onNotResponding:me},null,8,["opportunity","scheduled-appointment","onReschedule"])):g("",!0),x.value?(o(),L(xr,{key:7,opportunity:t.opportunity,onCreateOffer:Se,onMarkUnsold:fe,onSurveyCompleted:ce,onSurveyRefused:pe,onNotResponding:me},null,8,["opportunity"])):g("",!0),W.value?(o(),L(gr,{key:8,opportunity:t.opportunity,onCreateOffer:Se,onReview:Ge,onCloseLost:fe,onSurveyCompleted:ce,onSurveyRefused:pe,onNotResponding:me},null,8,["opportunity"])):g("",!0),ke.value?(o(),L(Sr,{key:9,opportunity:t.opportunity,onCloseLost:fe,onScheduleClosing:_e,onSurveyCompleted:ce,onSurveyRefused:pe,onNotResponding:me},null,8,["opportunity"])):g("",!0),he.value?(o(),L(Cr,{key:10,opportunity:t.opportunity,onCreateContract:Xe,onCloseLost:fe,onSurveyCompleted:ce,onSurveyRefused:pe,onNotResponding:me},null,8,["opportunity"])):g("",!0),Ce.value?(o(),L(jr,{key:11,opportunity:t.opportunity,onPrepareDelivery:tt,onPreDeliveryChecklist:st,onSurveyCompleted:ce,onSurveyRefused:pe,onNotResponding:me},null,8,["opportunity"])):g("",!0),ve.value?(o(),n("div",hd,[C[18]||(C[18]=e("div",{class:"flex justify-between items-start mb-3"},[e("div",null,[e("h4",{class:"font-bold text-slate-800 text-sm"},"Administrative Phase"),e("p",{class:"text-xs text-gray-500 mt-0.5"},"Contract has been signed. Move to Registration stage to complete administrative processes before delivery.")])],-1)),e("button",{onClick:ut,class:"bg-indigo-600 hover:bg-indigo-700 text-white font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"},[...C[17]||(C[17]=[j(" Mark as Registration ",-1),e("i",{class:"fa-solid fa-file-contract"},null,-1)])])])):g("",!0),$e.value?(o(),L(Fr,{key:13,opportunity:t.opportunity,activities:t.activities,onDeliveryFeedback:lt,onSurveyCompleted:ce,onSurveyRefused:pe,onNotResponding:me},null,8,["opportunity","activities"])):g("",!0),$.value?(o(),L(Ur,{key:14,opportunity:t.opportunity,onCloseWon:at,onCloseLost:fe},null,8,["opportunity"])):g("",!0)]),B(zn,{show:i.value,title:d.value,onClose:C[3]||(C[3]=V=>i.value=!1)},null,8,["show","title"]),B(Jn,{show:m.value,onConfirm:nt,onCancel:C[4]||(C[4]=V=>m.value=!1)},null,8,["show"]),B(ui,{show:y.value,onConfirm:dt,onCancel:C[5]||(C[5]=V=>y.value=!1)},null,8,["show"]),B(ti,{show:c.value,onConfirm:Ze,onCancel:C[6]||(C[6]=V=>c.value=!1)},null,8,["show"]),B(ii,{show:b.value,onConfirm:ot,onCancel:C[7]||(C[7]=V=>b.value=!1)},null,8,["show"]),(o(),L(ue,{to:"body"},[v.value?(o(),n("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:z(Ie,["self"])},[e("div",wd,[e("div",kd,[B(Wi,{item:null,"task-type":"opportunity","task-id":t.opportunity.id,"requested-car":t.opportunity.vehicle||null,"recommended-cars":S.value,onSave:Ke,onCancel:Ie},null,8,["task-id","requested-car","recommended-cars"])])])])):g("",!0)])),(o(),L(ue,{to:"body"},[p.value?(o(),n("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:z(De,["self"])},[e("div",Cd,[e("div",$d,[B(ze,{show:p.value,onConfirm:et,onCancel:De},null,8,["show"])])])])):g("",!0)]))])):g("",!0)}},Dd={class:"h-full flex flex-col lg:flex-row overflow-hidden bg-gray-50"},Ad={class:"bg-gray-100 text-gray-600 text-[10px] font-bold uppercase px-2 py-0.5 rounded border border-gray-200"},Td={key:0,class:"bg-red-50 text-red-600 text-[10px] font-bold uppercase px-2 py-0.5 rounded border border-red-100 flex items-center gap-1"},qd={key:0,class:"fa-solid fa-clock text-[10px]"},Od={class:"text-[10px] font-bold uppercase tracking-wide"},Id={key:1,class:"text-right"},Nd={class:"text-sm font-bold text-gray-900"},jd={class:"mt-1.5"},Md={class:"w-20 h-1.5 bg-gray-200 rounded-full overflow-hidden"},Rd={class:"text-[10px] text-gray-500 mt-0.5"},Vd=["onClick"],Fd=["onClick"],Ld=["onClick"],Ud={class:"flex-1 flex flex-col overflow-hidden"},Ed={key:0,class:"lg:hidden xl:hidden fixed bottom-6 right-4 flex flex-col gap-3 z-30"},Bd={key:1,class:"flex-1 flex items-center justify-center"},Wd={key:0,class:"xl:hidden fixed inset-0 z-[60] bg-white"},Yd={__name:"TaskDetail",setup(t){const h=gt(),s=Oe(),u=Ue(),a=We(),l=qe(),p=k("all"),r=k(null),i=k(!1),d=k(!1),v=T(()=>{const D=u.leads.map(x=>({...x,type:"lead",compositeId:`lead-${x.id}`})),A=a.opportunities.map(x=>({...x,type:"opportunity",compositeId:`opportunity-${x.id}`}));let W=[];return l.isOperator()?W=D:l.isSalesman()?W=A:W=[...D,...A],W.sort((x,Q)=>{const ge=new Date(x.lastActivity||x.createdAt||0);return new Date(Q.lastActivity||Q.createdAt||0)-ge})}),m=T(()=>p.value==="all"?v.value:v.value.filter(D=>D.type===p.value)),c=T(()=>{const D=v.value.some(W=>W.type==="lead"),A=v.value.some(W=>W.type==="opportunity");return D&&A}),b=T(()=>{const D=parseInt(h.params.id),A=h.query.type;if(A)return v.value.find(Q=>Q.id===D&&Q.type===A)||null;const x=(p.value!=="all"?v.value.filter(Q=>Q.type===p.value):v.value).find(Q=>Q.id===D);return x||v.value.find(Q=>Q.id===D)||null}),y=T(()=>b.value?b.value.type==="lead"?u.currentLeadActivities:a.currentOpportunityActivities:[]),S=T(()=>b.value?b.value.type==="lead"?En:Sd:null),q=T(()=>b.value?b.value.type==="lead"?{currentActivities:T(()=>u.currentLeadActivities),addActivity:(D,A)=>u.addActivity(D,A),updateActivity:(D,A,W)=>u.updateActivity(D,A,W),deleteActivity:(D,A)=>u.deleteActivity(D,A)}:{currentActivities:T(()=>a.currentOpportunityActivities),addActivity:(D,A)=>a.addActivity(D,A),updateActivity:(D,A,W)=>a.updateActivity(D,A,W),deleteActivity:(D,A)=>a.deleteActivity(D,A)}:null),I=T(()=>b.value?b.value.type==="lead"?{overviewActions:["financing","tradein","purchase"],tabActions:["note","call","email","sms","whatsapp","attachment"]}:{overviewActions:["financing","tradein","purchase"],tabActions:["note","call","email","sms","whatsapp","attachment"]}:{overviewActions:[],tabActions:[]}),F=T(()=>D=>D.type==="lead"?"bg-white border border-gray-200 hover:border-blue-300":"bg-white border border-gray-200 hover:border-purple-300");ie(()=>{u.loadLeads(),a.loadOpportunities();const D=h.params.id;D&&U(D)}),ne(()=>h.params.id,D=>{D&&U(D)}),ne(b,D=>{D&&(D.type==="lead"?u.loadLeadById(D.id):a.loadOpportunityById(D.id))},{immediate:!0});const U=D=>{const A=parseInt(D),W=v.value.find(x=>x.id===A);W&&(W.type==="lead"?u.loadLeadById(A):a.loadOpportunityById(A))},oe=D=>{const[A,W]=D.split("-");s.push({path:`/tasks/${W}`,query:{type:A}}),i.value=!1},Y=D=>new Intl.NumberFormat("en-US").format(D),G=D=>{r.value=r.value===D?null:D},X=D=>{r.value=null},se=async D=>{r.value=null,D.type==="lead"?await u.modifyLead(D.id,{priority:"Hot"}):D.type==="opportunity"&&await a.modifyOpportunity(D.id,{priority:"Hot"})},ae=async D=>{r.value=null,D.type==="lead"?await u.modifyLead(D.id,{priority:"Normal"}):D.type==="opportunity"&&await a.modifyOpportunity(D.id,{priority:"Normal"})},Z=D=>({Open:"bg-blue-100 text-blue-700 border-blue-200","Open Opportunities":"bg-blue-100 text-blue-700 border-blue-200","Open opportunity":"bg-blue-100 text-blue-700 border-blue-200",Qualified:"bg-purple-100 text-purple-700 border-purple-200","In Negotiation":"bg-orange-100 text-orange-700 border-orange-200","Opportunity in negotiation":"bg-orange-100 text-orange-700 border-orange-200",Registration:"bg-indigo-100 text-indigo-700 border-indigo-200",Closed:"bg-gray-100 text-gray-700 border-gray-200","Closed opportunity":"bg-gray-100 text-gray-700 border-gray-200","Closed Lost":"bg-red-100 text-red-700 border-red-200",Won:"bg-green-100 text-green-700 border-green-200",Lost:"bg-red-100 text-red-700 border-red-200"})[D]||"bg-gray-100 text-gray-700 border-gray-200";return(D,A)=>{var W;return o(),n("div",Dd,[e("div",{class:N(["lg:relative lg:block",i.value?"fixed inset-0 z-[60] md:relative md:z-auto":"hidden lg:block"])},[B(Rt,{title:"Tasks",items:m.value,"selected-id":(W=b.value)==null?void 0:W.compositeId,"type-filter":p.value,"selected-class":x=>x.type==="lead"?"bg-white border-2 border-blue-500 shadow-md":"bg-white border-2 border-purple-500 shadow-md","unselected-class":F.value,"open-menu-id":r.value,getName:x=>x.customer.name,getInitials:x=>x.customer.initials,getVehicleInfo:x=>x.type==="lead"?`${x.requestedCar.brand} ${x.requestedCar.model}`:`${x.vehicle.brand} ${x.vehicle.model}`,avatarClass:x=>x.type==="lead"?"bg-orange-100 text-orange-600":"bg-purple-100 text-purple-600","show-mobile-close":!0,onSelect:oe,onMenuClick:G,onMenuClose:A[0]||(A[0]=x=>r.value=null),onClose:A[1]||(A[1]=x=>i.value=!1),"show-type-filter":c.value,onFilterChange:A[2]||(A[2]=x=>p.value=x)},{badges:xe(({item:x})=>[e("span",{class:N(["text-[10px] font-bold uppercase px-2 py-0.5 rounded border",x.type==="lead"?"bg-blue-50 text-blue-700 border-blue-200":"bg-purple-50 text-purple-700 border-purple-200"])},f(x.type==="lead"?"Lead":"Opportunity"),3),x.type==="lead"?(o(),n(P,{key:0},[e("span",Ad,f(x.status),1),x.priority==="Hot"?(o(),n("span",Td,[...A[6]||(A[6]=[e("i",{class:"fa-solid fa-fire text-[9px]"},null,-1),j(" Hot ",-1)])])):g("",!0)],64)):(o(),n("span",{key:1,class:N(["text-[10px] font-bold uppercase px-2 py-0.5 rounded border",Z(x.stage)])},f(x.stage),3))]),meta:xe(({item:x})=>[x.type==="lead"?(o(),n("div",{key:0,class:N(["flex items-center gap-1.5",x.priority==="Hot"?"text-red-500":"text-gray-400"])},[x.priority==="Hot"?(o(),n("i",qd)):g("",!0),e("span",Od," Due in "+f(x.nextActionDue),1)],2)):(o(),n("div",Id,[e("div",Nd,"€"+f(Y(x.value)),1),e("div",jd,[e("div",Md,[e("div",{class:N(["h-full rounded-full",x.probability>=70?"bg-green-500":x.probability>=40?"bg-blue-500":"bg-orange-500"]),style:Le({width:`${x.probability}%`})},null,6)]),e("div",Rd,f(x.probability)+"% PROB",1)])]))]),menu:xe(({item:x})=>[e("button",{onClick:z(Q=>X(x),["stop"]),class:"w-full text-left px-3 py-2 text-xs text-slate-700 hover:bg-gray-50 flex items-center gap-2"},[...A[7]||(A[7]=[e("i",{class:"fa-solid fa-share text-gray-400"},null,-1),j(" Reassign ",-1)])],8,Vd),x.priority!=="Hot"?(o(),n("button",{key:0,onClick:z(Q=>se(x),["stop"]),class:"w-full text-left px-3 py-2 text-xs text-slate-700 hover:bg-gray-50 flex items-center gap-2"},[...A[8]||(A[8]=[e("i",{class:"fa-solid fa-fire text-orange-500"},null,-1),j(" Mark as hot ",-1)])],8,Fd)):(o(),n("button",{key:1,onClick:z(Q=>ae(x),["stop"]),class:"w-full text-left px-3 py-2 text-xs text-slate-700 hover:bg-gray-50 flex items-center gap-2"},[...A[9]||(A[9]=[e("i",{class:"fa-regular fa-snowflake text-gray-400"},null,-1),j(" Unmark as hot ",-1)])],8,Ld))]),_:1},8,["items","selected-id","type-filter","selected-class","unselected-class","open-menu-id","getName","getInitials","getVehicleInfo","avatarClass","show-type-filter"])],2),e("div",Ud,[b.value?(o(),n("div",Ed,[e("button",{onClick:A[3]||(A[3]=x=>d.value=!d.value),class:"w-14 h-14 bg-purple-600 text-white rounded-full shadow-lg flex items-center justify-center hover:bg-purple-700 transition-all hover:scale-110",title:"Activity"},[...A[10]||(A[10]=[e("i",{class:"fa-solid fa-clock-rotate-left text-lg"},null,-1)])]),e("button",{onClick:A[4]||(A[4]=x=>i.value=!i.value),class:"w-14 h-14 bg-blue-600 text-white rounded-full shadow-lg flex items-center justify-center hover:bg-blue-700 transition-all hover:scale-110",title:"Tasks"},[...A[11]||(A[11]=[e("i",{class:"fa-solid fa-list text-lg"},null,-1)])])])):g("",!0),b.value?(o(),L(_l,{key:2,task:b.value,type:b.value.type,"management-widget":S.value,"store-adapter":q.value,"add-new-config":I.value},{"pinned-extra":xe(({task:x})=>[x.type==="lead"&&x.requestedCar?(o(),L(Fe,{key:0,brand:x.requestedCar.brand,model:x.requestedCar.model,year:x.requestedCar.year,image:x.requestedCar.image||"",price:x.requestedCar.price||null,"request-message":x.requestedCar.requestMessage||"","request-type":x.requestedCar.requestType||"",source:x.source||"",dealership:x.requestedCar.dealership||"",registration:x.requestedCar.registration||"",kilometers:x.requestedCar.kilometers||null,"fuel-type":x.requestedCar.fuelType||"","gear-type":x.requestedCar.gearType||"",vin:x.requestedCar.vin||"","stock-days":x.requestedCar.stockDays!==void 0?x.requestedCar.stockDays:null,channel:x.requestedCar.channel||"Email","ad-campaign":x.requestedCar.adCampaign||"","expected-purchase-date":x.requestedCar.expectedPurchaseDate||"","fiscal-entity":x.requestedCar.fiscalEntity||"","source-details":x.requestedCar.sourceDetails||"","ad-medium":x.requestedCar.adMedium||"","ad-source":x.requestedCar.adSource||"",label:"Requested Car"},null,8,["brand","model","year","image","price","request-message","request-type","source","dealership","registration","kilometers","fuel-type","gear-type","vin","stock-days","channel","ad-campaign","expected-purchase-date","fiscal-entity","source-details","ad-medium","ad-source"])):g("",!0),x.type==="opportunity"&&x.vehicle?(o(),L(Fe,{key:1,brand:x.vehicle.brand,model:x.vehicle.model,year:x.vehicle.year,image:x.vehicle.image||"",price:x.vehicle.price||null,"request-message":x.vehicle.requestMessage||"","request-type":x.vehicle.requestType||"",source:x.source||"",dealership:x.vehicle.dealership||"",registration:x.vehicle.registration||"",kilometers:x.vehicle.kilometers||null,"fuel-type":x.vehicle.fuelType||"","gear-type":x.vehicle.gearType||"",vin:x.vehicle.vin||"","stock-days":x.vehicle.stockDays!==void 0?x.vehicle.stockDays:null,channel:x.vehicle.channel||"Email","ad-campaign":x.vehicle.adCampaign||"","expected-purchase-date":x.vehicle.expectedPurchaseDate||"","fiscal-entity":x.vehicle.fiscalEntity||"","source-details":x.vehicle.sourceDetails||"","ad-medium":x.vehicle.adMedium||"","ad-source":x.vehicle.adSource||"",label:"Vehicle"},null,8,["brand","model","year","image","price","request-message","request-type","source","dealership","registration","kilometers","fuel-type","gear-type","vin","stock-days","channel","ad-campaign","expected-purchase-date","fiscal-entity","source-details","ad-medium","ad-source"])):g("",!0)]),_:1},8,["task","type","management-widget","store-adapter","add-new-config"])):(o(),n("div",Bd,[...A[12]||(A[12]=[e("div",{class:"text-center"},[e("i",{class:"fa-solid fa-tasks text-6xl text-gray-300 mb-4"}),e("p",{class:"text-gray-500"},"Select a task to view details")],-1)])]))]),d.value&&b.value?(o(),n("div",Wd,[B(Ve,{title:"Activity summary",activities:y.value,collapsed:!1,"show-collapse":!1,show:!0,"mobile-fullscreen":!0,onClose:A[5]||(A[5]=x=>d.value=!1),class:"flex w-full h-full"},null,8,["activities"])])):g("",!0),B(Ve,{title:"Activity summary",activities:y.value,collapsed:!1,"show-collapse":!1,show:!!b.value,class:"hidden xl:flex"},null,8,["activities","show"])])}}};export{Yd as default};
