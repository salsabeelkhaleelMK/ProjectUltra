const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ContactsTab-Bl3WkYOA.js","assets/index-RmfAtVPr.js","assets/index-CJykqWSa.css","assets/components-Cm9fzQLq.js","assets/toggle-group-item.vue_vue_type_script_setup_true_lang-Csij51_o-Dt8quB-6.js","assets/customers-FyK6SgfJ.js","assets/opportunities-CHZoo_KJ.js","assets/useCustomersTable-Cbc01_lo.js","assets/OpenLeadsTab-5buB9Su_.js","assets/formatters-DjeI4Z8-.js","assets/OpenOpportunitiesTab-DbaXjxNr.js","assets/InNegotiationTab-CPkpAz-1.js","assets/WonTab-DFDYUt2y.js","assets/LostTab-CRbaoYtd.js"])))=>i.map(i=>d[i]);
import{r as T,l as P,c as h,x as D,o as v,E as c,s as p,y as u,e as t,k as A,t as U,d as x,p as r,J as i,Q as S,u as W,D as j,a7 as w,F as B,i as M,a8 as F,h as q,a9 as C,n as H,z as Q,X as J}from"./index-RmfAtVPr.js";import{_ as K}from"./PageHeader-BdOwmn4o.js";import{z as X,F as G,L as Y,H as Z,j as ee,K as te,C as le,W as oe}from"./toggle-group-item.vue_vue_type_script_setup_true_lang-Csij51_o-Dt8quB-6.js";import{u as ae}from"./opportunities-CHZoo_KJ.js";import{u as ne}from"./customers-FyK6SgfJ.js";const se={class:"space-y-4"},re={key:0},ie={key:1},ue={key:2},pe={key:3},de=["placeholder"],me={__name:"AddCustomerModal",props:{show:{type:Boolean,default:!1},activeTab:{type:String,required:!0},initialData:{type:Object,default:()=>({})}},emits:["close","save"],setup(g,{emit:V}){const n=g,N=V,l=T({customerName:"",email:"",phone:"",company:"",vehicle:"",value:"",reason:""});P(()=>n.show,d=>{d&&(l.value={customerName:n.initialData.customerName||"",email:n.initialData.email||"",phone:n.initialData.phone||"",company:n.initialData.company||"",vehicle:n.initialData.vehicle||"",value:n.initialData.value||"",reason:n.initialData.reason||""})});const O=d=>{d||N("close")},y=h(()=>({contacts:"Add New Contact","open-leads":"Add New Lead","open-opportunities":"Add New Opportunity","in-negotiation":"Add Opportunity in Negotiation",won:"Add Won Opportunity",lost:"Add Lost Opportunity"})[n.activeTab]||"Add New Item"),L=h(()=>({contacts:"Contact","open-leads":"Lead","open-opportunities":"Opportunity","in-negotiation":"Opportunity",won:"Won Opportunity",lost:"Lost Opportunity"})[n.activeTab]||"Item"),f=()=>{N("save",{...l.value}),l.value={customerName:"",email:"",phone:"",company:"",vehicle:"",value:"",reason:""}};return(d,e)=>(v(),D(u(oe),{open:g.show,"onUpdate:open":O},{default:c(()=>[p(u(X),null,{default:c(()=>[p(u(G),{class:"fixed inset-0 z-50 bg-black/50"}),p(u(Y),{class:"w-full sm:max-w-md"},{default:c(()=>[p(u(Z),null,{default:c(()=>[p(u(ee),null,{default:c(()=>[A(U(y.value),1)]),_:1}),p(u(te),null,{default:c(()=>[...e[14]||(e[14]=[A("Fill in the details below",-1)])]),_:1})]),_:1}),t("div",se,[g.activeTab==="contacts"?(v(),x("div",re,[e[15]||(e[15]=t("label",{class:"block label-upper mb-2"},"Contact Name",-1)),r(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>l.value.customerName=o),type:"text",placeholder:"Enter contact name...",class:"input"},null,512),[[i,l.value.customerName]]),e[16]||(e[16]=t("label",{class:"block label-upper mb-2 mt-4"},"Email",-1)),r(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>l.value.email=o),type:"email",placeholder:"contact@example.com",class:"input"},null,512),[[i,l.value.email]]),e[17]||(e[17]=t("label",{class:"block label-upper mb-2 mt-4"},"Phone",-1)),r(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>l.value.phone=o),type:"tel",placeholder:"+49...",class:"input"},null,512),[[i,l.value.phone]]),e[18]||(e[18]=t("label",{class:"block label-upper mb-2 mt-4"},"Company (optional)",-1)),r(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>l.value.company=o),type:"text",placeholder:"Company name...",class:"input"},null,512),[[i,l.value.company]])])):g.activeTab==="open-leads"?(v(),x("div",ie,[e[19]||(e[19]=t("label",{class:"block label-upper mb-2"},"Customer Name",-1)),r(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>l.value.customerName=o),type:"text",placeholder:"Enter customer name...",class:"input"},null,512),[[i,l.value.customerName]]),e[20]||(e[20]=t("label",{class:"block label-upper mb-2 mt-4"},"Email",-1)),r(t("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>l.value.email=o),type:"email",placeholder:"customer@example.com",class:"input"},null,512),[[i,l.value.email]]),e[21]||(e[21]=t("label",{class:"block label-upper mb-2 mt-4"},"Requested Vehicle",-1)),r(t("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>l.value.vehicle=o),type:"text",placeholder:"e.g., Volkswagen ID.4",class:"input"},null,512),[[i,l.value.vehicle]])])):g.activeTab==="open-opportunities"||g.activeTab==="in-negotiation"?(v(),x("div",ue,[e[22]||(e[22]=t("label",{class:"block label-upper mb-2"},"Customer Name",-1)),r(t("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>l.value.customerName=o),type:"text",placeholder:"Enter customer name...",class:"input"},null,512),[[i,l.value.customerName]]),e[23]||(e[23]=t("label",{class:"block label-upper mb-2 mt-4"},"Vehicle",-1)),r(t("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>l.value.vehicle=o),type:"text",placeholder:"e.g., Porsche Taycan",class:"input"},null,512),[[i,l.value.vehicle]]),e[24]||(e[24]=t("label",{class:"block label-upper mb-2 mt-4"},"Opportunity Value",-1)),r(t("input",{"onUpdate:modelValue":e[9]||(e[9]=o=>l.value.value=o),type:"number",placeholder:"0",class:"input"},null,512),[[i,l.value.value]])])):(v(),x("div",pe,[e[25]||(e[25]=t("label",{class:"block label-upper mb-2"},"Customer Name",-1)),r(t("input",{"onUpdate:modelValue":e[10]||(e[10]=o=>l.value.customerName=o),type:"text",placeholder:"Enter customer name...",class:"input"},null,512),[[i,l.value.customerName]]),e[26]||(e[26]=t("label",{class:"block label-upper mb-2 mt-4"},"Vehicle",-1)),r(t("input",{"onUpdate:modelValue":e[11]||(e[11]=o=>l.value.vehicle=o),type:"text",placeholder:"Vehicle model",class:"input"},null,512),[[i,l.value.vehicle]]),e[27]||(e[27]=t("label",{class:"block label-upper mb-2 mt-4"},"Reason",-1)),r(t("textarea",{"onUpdate:modelValue":e[12]||(e[12]=o=>l.value.reason=o),rows:"3",placeholder:`Reason for ${g.activeTab==="won"?"win":"loss"}...`,class:"input resize-none"},null,8,de),[[i,l.value.reason]])]))]),p(u(le),{class:"flex flex-col sm:flex-row justify-end items-stretch sm:items-center gap-3"},{default:c(()=>[p(u(S),{label:"Cancel",variant:"outline",size:"small",class:"rounded-sm w-full sm:w-auto",onClick:e[13]||(e[13]=o=>d.$emit("close"))}),p(u(S),{label:`Create ${L.value}`,variant:"primary",size:"small",class:"rounded-sm w-full sm:w-auto !bg-brand-red !hover:bg-brand-red-dark !text-white !border-brand-red",onClick:f},null,8,["label"])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]))}},be={class:"page-container"},ce={class:"p-4 md:p-8"},ve={class:"flex items-center gap-3 mb-6 overflow-x-auto pb-2 scrollbar-hide"},ge=["onClick"],ye={class:"heading-tab whitespace-nowrap"},he={__name:"Customers",setup(g){const V=q(),n=W(),N=j(),l=ae(),O=ne(),y=h(()=>{const m=N.leads.filter(b=>!b.isDisqualified),a=l.opportunities.filter(b=>b.stage!=="Closed Won"&&b.stage!=="Closed Lost"),s=l.opportunities.filter(b=>b.stage==="In Negotiation"||b.stage==="In negotiation"),k=l.opportunities.filter(b=>b.stage==="Closed Won"),E=l.opportunities.filter(b=>b.stage==="Closed Lost");return{contacts:O.totalCustomers,openLeads:m.length,openOpportunities:a.length-s.length,inNegotiation:s.length,won:k.length,lost:E.length}}),f=T(n.isOperator()?"open-leads":n.isManager()||n.isSalesman()?"in-negotiation":"contacts"),d=T(!1),e=T({customerName:"",email:"",phone:"",company:"",vehicle:"",value:"",reason:""}),o={contacts:w(()=>C(()=>import("./ContactsTab-Bl3WkYOA.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),"open-leads":w(()=>C(()=>import("./OpenLeadsTab-5buB9Su_.js"),__vite__mapDeps([8,1,2,3,4,9,7]))),"open-opportunities":w(()=>C(()=>import("./OpenOpportunitiesTab-DbaXjxNr.js"),__vite__mapDeps([10,1,2,3,4,6,9,7]))),"in-negotiation":w(()=>C(()=>import("./InNegotiationTab-CPkpAz-1.js"),__vite__mapDeps([11,1,2,3,4,6,9,7]))),won:w(()=>C(()=>import("./WonTab-DFDYUt2y.js"),__vite__mapDeps([12,1,2,3,4,6,9,7]))),lost:w(()=>C(()=>import("./LostTab-CRbaoYtd.js"),__vite__mapDeps([13,1,2,3,4,6,9,7])))},$=h(()=>o[f.value]||o.contacts),I=h(()=>{const m=[{key:"contacts",label:"Customers",count:y.value.contacts,borderColor:"border-t-purple-600",badgeColor:"bg-purple-600 text-white"},{key:"open-leads",label:"Open Leads",count:y.value.openLeads,borderColor:"border-t-blue-600",badgeColor:"bg-blue-600 text-white"},{key:"open-opportunities",label:"Open opportunities",count:y.value.openOpportunities,borderColor:"border-t-orange-500",badgeColor:"bg-orange-500 text-white"},{key:"in-negotiation",label:"In negotiation",count:y.value.inNegotiation,borderColor:"border-t-blue-500",badgeColor:"bg-blue-500 text-white"},{key:"won",label:"Won",count:y.value.won,borderColor:"border-t-green-500",badgeColor:"bg-green-500 text-white"},{key:"lost",label:"Lost",count:y.value.lost,borderColor:"border-t-red-500",badgeColor:"bg-red-500 text-white"}];return n.isOperator()?m.filter(a=>a.key==="contacts"||a.key==="open-leads"):n.isSalesman()?m.filter(a=>a.key!=="open-leads"):m}),R=()=>{e.value={customerName:"",email:"",phone:"",company:"",vehicle:"",value:"",reason:""},d.value=!1},_=m=>{f.value=m},z=(m,a)=>{if(!a||!m)return"gray";const k={contacts:"gray","open-leads":"blue","open-opportunities":"blue","in-negotiation":"blue",won:"green",lost:"red"}[m]||"gray";return["blue","green","red","gray"].includes(k)?k:"gray"};return(m,a)=>(v(),x("div",be,[p(K,{title:"Customers"},{actions:c(()=>[t("button",{onClick:a[0]||(a[0]=s=>u(V).push("/add-new")),class:"group flex items-center gap-2 rounded-2xl border border px-4 py-2 text-sm font-medium text-body hover:border-red-100 hover:bg-red-50 hover:text-brand-red transition-all"},[...a[2]||(a[2]=[t("i",{class:"fa-solid fa-plus text-gray-400 group-hover:text-brand-red"},null,-1),t("span",{class:"hidden sm:inline"},"Add new",-1)])])]),_:1}),t("div",ce,[t("div",ve,[(v(!0),x(B,null,M(I.value,s=>(v(),x("button",{key:s.key,onClick:k=>_(s.key),class:H(["flex items-center justify-between gap-3 px-4 py-3 bg-surface border border-border rounded-lg cursor-pointer hover:shadow-sm transition-all shrink-0 min-w-40 border-t-4",f.value===s.key?s.borderColor:"border-t-border"])},[t("span",ye,U(s.label),1),p(u(Q),{text:String(s.count),size:"small",theme:z(s.key,f.value===s.key)},null,8,["text","theme"])],10,ge))),128))]),(v(),D(F,null,{fallback:c(()=>[...a[3]||(a[3]=[t("div",{class:"flex items-center justify-center py-12"},[t("div",{class:"text-center"},[t("i",{class:"fa-solid fa-spinner fa-spin text-gray-400 text-2xl mb-2"}),t("p",{class:"text-meta"},"Loading...")])],-1)])]),default:c(()=>[(v(),D(J($.value),{key:f.value}))]),_:1}))]),p(me,{show:d.value,"active-tab":f.value,"initial-data":e.value,onClose:a[1]||(a[1]=s=>d.value=!1),onSave:R},null,8,["show","active-tab","initial-data"])]))}};export{he as default};
