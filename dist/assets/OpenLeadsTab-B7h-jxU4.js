import{y as M}from"./components-Ci9ddle2.js";import{C as T,r as a,c as I,m as V,d as $,o as Q,s as R,B as z,e as n,y as i}from"./index-Db_3peLd.js";import{g as E,c as G,f as K}from"./ComingSoonModal-ClD5EuQ6.js";import{u as W}from"./useCustomersTable-CD9F3w9b.js";import"./toggle-group-item.vue_vue_type_script_setup_true_lang-Csij51_o-BDHqZScF.js";import"./opportunities-CySWWyzd.js";import"./sparkles-CCfcFWX8.js";import"./vehicles-ygxbygEI.js";const _={class:"table-wrapper w-full"},et={__name:"OpenLeadsTab",emits:["row-click"],setup(j,{emit:q}){const o=T(),w=a(!1),r=a({pageIndex:0,pageSize:10}),u=a(""),l=a([]),c=a([]),d=e=>e?new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}):"-",A=e=>({Valid:"bg-green-100 text-green-700","Not valid":"bg-red-100 text-red-700",Qualified:"bg-surfaceSecondary text-body","Not interested":"bg-red-100 text-red-700",Open:"bg-blue-100 text-blue-700"})[e]||"bg-surfaceSecondary text-body",m=I(()=>{let e=o.leads;return w.value?e=o.leads.filter(t=>t.isDisqualified===!0):e=o.leads.filter(t=>!t.isDisqualified),e.map(t=>{var s,g,f,y,b,x,D,C,v,k,F,S;return{id:`lead-${t.id}`,stageKey:"open-leads",customer:((s=t.customer)==null?void 0:s.name)||"Unknown",email:((g=t.customer)==null?void 0:g.email)||"",initials:((f=t.customer)==null?void 0:f.initials)||((b=(y=t.customer)==null?void 0:y.name)==null?void 0:b.slice(0,2).toUpperCase())||"?",nextAction:K(t.nextActionDue)||"No due date",nextActionFull:G(t.nextActionDue),deadlineStatus:E(t.nextActionDue),car:`${((x=t.requestedCar)==null?void 0:x.brand)||""} ${((D=t.requestedCar)==null?void 0:D.model)||""}`.trim()||"N/A",carStatus:((C=t.requestedCar)==null?void 0:C.stockDays)!==void 0&&((v=t.requestedCar)==null?void 0:v.stockDays)!==null?"In Stock":"Out of Stock",carStatusClass:((k=t.requestedCar)==null?void 0:k.stockDays)!==void 0&&((F=t.requestedCar)==null?void 0:F.stockDays)!==null?"bg-green-100 text-green-700":"bg-surfaceSecondary text-body",requestType:((S=t.requestedCar)==null?void 0:S.requestType)||"Quotation",source:t.source||"Marketing",assignee:t.assignee,assigneeInitials:t.assignee?t.assignee.slice(0,2).toUpperCase():"NA",createdAt:d(t.createdAt),lastActivity:d(t.lastActivity),status:t.status,statusClass:A(t.status),priority:t.priority||"Normal"}})}),N=q,p=e=>{e.id.startsWith("lead-")&&N("row-click",e)},O=a("open-leads"),{columns:U,filterDefinitions:B,tableMeta:L}=W(O,p);return V(async()=>{await o.fetchLeads()}),(e,t)=>(Q(),$("div",_,[R(i(M),{data:m.value,columns:i(U),meta:i(L),onRowClick:p,columnFiltersOptions:{filterDefs:i(B)},pagination:r.value,"onUpdate:pagination":t[0]||(t[0]=s=>r.value=s),globalFilter:u.value,"onUpdate:globalFilter":t[1]||(t[1]=s=>u.value=s),sorting:l.value,"onUpdate:sorting":t[2]||(t[2]=s=>l.value=s),columnFilters:c.value,"onUpdate:columnFilters":t[3]||(t[3]=s=>c.value=s),paginationOptions:{rowCount:m.value.length},globalFilterOptions:{debounce:300}},{"empty-state":z(()=>[...t[4]||(t[4]=[n("div",{class:"empty-state"},[n("i",{class:"fa-solid fa-inbox empty-state-icon"}),n("p",{class:"empty-state-text"},"No records found")],-1)])]),_:1},8,["data","columns","meta","columnFiltersOptions","pagination","globalFilter","sorting","columnFilters","paginationOptions"])]))}};export{et as default};
