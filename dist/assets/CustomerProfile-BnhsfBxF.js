import{H as fe,h as je,d as n,o as s,e,n as z,w as Te,s as l,y as a,ai as gt,t as m,F as G,i as Z,x as P,af as un,g as u,B as k,$ as cn,I as Ka,r as E,c as A,aj as mn,Y as zt,k as q,C as Qa,l as De,m as ht,J as Ja,p as re,j as Na,K as Oe,a4 as fn,v as Ea,a8 as Ze,E as vn,O as pn,G as yn,L as Et,P as at,W as Pa,a5 as Za,ak as Bt,al as Ot,am as gn,an as xn,ao as hn}from"./index-BcuDIK-O.js";import{u as Xa}from"./opportunities-Bp4brFAh.js";import{u as en,_ as bn,f as kn}from"./UnifiedAddForm-C0R5iG7G.js";import{z as ce,n as U,b as wn,Z as $n,a as Cn,e as Be,J as _e,Y as ze,$ as tn,Q as J,c as le,W as Xe,U as et,H as tt,j as ae,G as st,f as Wt,F as Ht,L as Yt,g as Gt,h as Kt,o as An,C as Qt,d as Jt,t as ot}from"./toggle-group-item.vue_vue_type_script_setup_true_lang-Csij51_o-Oem9_7mP.js";import{N as Sn,R as Ra,S as Fa,U as Ua,i as Pt,j as Rt,T as In,_ as Tn,P as Dn,o as jn,p as Vn,k as qn,l as Mn,m as Ln,n as Ne,z as On,A as Nn,I as Ba,V as Nt,W as xt,X as nt,y as lt,h as sn,r as an,B as nn,Y as me,Z as Ue,C as En}from"./OfferCarousel-CZ6ElooH.js";import{_ as Pn}from"./ReassignUserModal-Binh7mf4.js";import{a as Rn,_ as Fn}from"./CreateEventModal-BENhAlSk.js";import{u as Un,b as Bn,c as _n,d as zn}from"./users-D37oaAzL.js";import{fetchTasksByCustomerId as Wn,fetchContactsByAccountId as Hn,fetchLeadsByCustomerId as Yn,fetchOpportunitiesByCustomerId as Gn,fetchCustomerCars as Kn}from"./contacts-Deg_Cdvm.js";/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qn=fe("ActivityIcon",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=fe("ArrowRightIcon",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jn=fe("BriefcaseIcon",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _a=fe("Building2Icon",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zn=fe("CalendarCheckIcon",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=fe("DollarSignIcon",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xn=fe("HandshakeIcon",[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=fe("HashIcon",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const el=fe("InboxIcon",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=fe("LightbulbIcon",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=fe("MapPinIcon",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=fe("MessageSquareIcon",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tl=fe("SmartphoneIcon",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dn=fe("StarIcon",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sl=fe("UserPlusIcon",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),al={class:"page-header-main"},nl={class:"page-header-content"},ll={class:"flex items-center gap-3 min-w-0 flex-1"},ol={class:"min-w-0 flex-1 flex flex-col justify-center"},il={class:"flex items-center gap-2 flex-wrap"},rl={class:"text-lg font-semibold text-foreground truncate leading-tight"},dl={class:"flex items-center gap-1.5"},ul={class:"page-header-actions"},cl={__name:"CustomerContactHeader",props:{initials:{type:String,required:!0},name:{type:String,required:!0},avatarColorClass:{type:String,default:"bg-orange-100 text-orange-600"},email:{type:String,default:""},phone:{type:String,default:""},thirdFieldValue:{type:String,default:""},emailLabel:{type:String,default:"Email"},phoneLabel:{type:String,default:"Phone"},thirdFieldLabel:{type:String,default:"Expected Close"},taskType:{type:String,default:"lead"},customerId:{type:[Number,String],default:null},tags:{type:Array,default:()=>[]},showCloseButton:{type:Boolean,default:!1}},emits:["add-tag","close"],setup(t,{emit:o}){const v=t,C=o,j=je(),$=()=>C("add-tag"),f=()=>{v.customerId&&j.push(`/customer/${v.customerId}`)};return(c,w)=>(s(),n("div",al,[e("div",nl,[e("div",ll,[e("button",{onClick:Te(f,["stop"]),class:z(["w-10 h-10 rounded-lg bg-primary text-white flex items-center justify-center cursor-pointer hover:opacity-90 transition-opacity shrink-0 shadow-sm",{"cursor-pointer":t.customerId}])},[l(a(gt),{class:"w-5 h-5"})],2),e("div",ol,[e("div",il,[e("h1",rl,m(t.name),1),e("div",dl,[(s(!0),n(G,null,Z(t.tags,h=>(s(),P(a(ce),{key:h,text:h,size:"small",theme:"blue"},null,8,["text"]))),128)),e("button",{onClick:Te($,["stop"]),class:"text-xs text-muted-foreground hover:text-primary font-medium hover:underline flex items-center gap-1 transition-colors whitespace-nowrap"},[l(a(un),{class:"w-3 h-3"}),w[1]||(w[1]=e("span",null,"tag",-1))])])])])]),e("div",ul,[t.showCloseButton?(s(),P(a(U),{key:0,variant:"secondary",size:"icon",onClick:w[0]||(w[0]=Te(h=>c.$emit("close"),["stop"]))},{default:k(()=>[l(a(cn),{size:16,class:"text-muted-foreground"})]),_:1})):u("",!0)])])]))}},ml={key:1,class:"absolute bottom-0 left-0 right-0 h-[2px] bg-primary z-10"},fl={__name:"Tabs",props:{modelValue:{type:String,required:!0},tabs:{type:Array,required:!0}},emits:["update:modelValue"],setup(t){return(o,v)=>(s(),P(a(Cn),{"model-value":t.modelValue,"onUpdate:modelValue":v[0]||(v[0]=C=>o.$emit("update:modelValue",C))},{default:k(()=>[l(a(wn),{class:"flex shrink-0 border-b border-border bg-white rounded-none w-full relative h-full"},{default:k(()=>[(s(!0),n(G,null,Z(t.tabs,C=>(s(),P(a($n),{key:C.key,value:C.key,class:z(["flex items-center gap-2 text-sm font-medium transition-all relative flex-1 justify-center bg-transparent outline-none h-full",t.modelValue===C.key?"text-foreground":"text-muted-foreground hover:text-muted-foreground"])},{default:k(()=>[e("span",null,m(C.label),1),C.count!==void 0&&C.count>0?(s(),n("span",{key:0,class:z(["flex items-center justify-center min-w-5 h-5 px-1.5 rounded-full text-xs font-bold leading-none",t.modelValue===C.key?"bg-primary text-white":"bg-gray-200 text-foreground"])},m(C.count),3)):u("",!0),t.modelValue===C.key?(s(),n("span",ml)):u("",!0)]),_:2},1032,["value","class"]))),128))]),_:1})]),_:1},8,["model-value"]))}},za=Ka(fl,[["__scopeId","data-v-b3f135ea"]]),vl={class:"flex flex-row items-center justify-between gap-2 md:gap-4"},pl={key:0,class:"flex items-center gap-2 shrink-0 flex-wrap"},yl={class:"flex items-center gap-1.5"},gl={key:1},xl={class:"flex items-center gap-2"},hl={key:0,class:"space-y-4"},bl={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},kl={class:"flex items-center gap-4"},wl={class:"w-20 h-14 bg-surfaceTertiary rounded-lg overflow-hidden shrink-0 border border-border"},$l=["src"],Cl={key:1,class:"fa-solid fa-car text-3xl text-muted-foreground w-full h-full flex items-center justify-center"},Al={class:"font-bold text-foreground text-base md:text-lg mb-2"},Sl={class:"flex items-center gap-2 flex-wrap"},Il={key:0,class:"inline-flex items-center gap-1.5 px-2 py-1 bg-green-50 border border-green-100 text-green-700 text-xs font-semibold rounded-md"},Tl={key:1,class:"inline-flex items-center gap-1.5 px-2 py-1 bg-orange-50 border border-orange-100 text-orange-700 text-xs font-semibold rounded-md"},Dl={key:2,class:"inline-flex items-center gap-1.5 px-2 py-1 bg-muted border border-border text-muted-foreground text-xs font-semibold rounded-md"},jl={class:"text-xs font-bold text-foreground"},Vl={key:0,class:"text-right"},ql={class:"font-bold text-foreground text-lg"},Ml={key:0,class:"pt-2"},Ll={class:"bg-muted border border-border rounded-lg p-3"},Ol={class:"text-sm text-muted-foreground leading-relaxed"},Nl={key:1,class:"space-y-3"},El={key:0,class:"flex items-center gap-2"},Pl={class:"text-sm font-semibold text-foreground"},Rl={key:1,class:"bg-muted border border-border rounded-lg p-3"},Fl={class:"text-sm text-muted-foreground leading-relaxed"},Ul={key:2,class:"border-t border-border"},Bl={class:"font-medium"},_l={key:3,class:"border-t border-border p-6 bg-muted/30 text-sm animate-fade-in"},zl={class:"mb-6"},Wl={class:"grid grid-cols-2 md:grid-cols-4 gap-y-4 gap-x-6"},Hl={key:0},Yl={class:"font-medium text-muted-foreground"},Gl={key:1},Kl={class:"font-medium text-muted-foreground"},Ql={key:2},Jl={class:"font-medium text-muted-foreground"},Zl={class:"font-medium text-muted-foreground"},Xl={key:0},eo={class:"grid grid-cols-2 md:grid-cols-4 gap-y-4 gap-x-6"},to={key:0},so={class:"font-medium text-muted-foreground"},ao={key:1},no={class:"font-medium text-muted-foreground"},lo={key:2},oo={class:"font-medium text-muted-foreground"},io={key:3},ro={class:"font-medium text-muted-foreground"},uo={key:4},co={class:"font-mono text-xs bg-surface border border-border px-2 py-1 rounded inline-block text-muted-foreground"},mo={key:5},fo={class:"font-medium text-muted-foreground"},vo={key:0,class:"mt-6 flex justify-end"},po={__name:"Request",props:{stage:{type:String,required:!0},owner:{type:String,required:!0},source:{type:String,default:""},deliverySubstatus:{type:String,default:null},activities:{type:Array,default:()=>[]},entityType:{type:String,default:"opportunity"},requestType:{type:String,default:""},requestMessage:{type:String,default:""},requestedCar:{type:Object,default:null},task:{type:Object,default:null}},emits:["reassign"],setup(t){const o=t,v=E(!1);A(()=>o.deliverySubstatus?mn(o.deliverySubstatus):"");const C=A(()=>o.deliverySubstatus?o.deliverySubstatus==="Delivered"?"green":o.deliverySubstatus==="Awaiting Delivery"?"blue":"gray":"gray"),j=A(()=>zt(o.stage,o.entityType));function $(O){return!O||O.length===0?null:O.filter(xe=>xe.type==="offer").sort((xe,be)=>new Date(be.timestamp)-new Date(xe.timestamp))[0]||null}function f(O){if(!O)return 0;const N=new Date(O),be=Math.abs(new Date-N);return Math.ceil(be/(1e3*60*60*24))}const c=A(()=>{if(o.stage!=="In Negotiation")return null;const O=$(o.activities);if(!O)return null;const N=f(O.timestamp);return N<1?{label:"New Offer",theme:"orange"}:N<3?{label:"Active",theme:"yellow"}:null}),w=A(()=>o.requestedCar&&o.requestedCar.brand&&o.requestedCar.model),h=A(()=>o.requestType||o.requestMessage||w.value),d=A(()=>{var O;return((O=o.requestedCar)==null?void 0:O.brand)||""}),i=A(()=>{var O;return((O=o.requestedCar)==null?void 0:O.model)||""}),x=A(()=>{var O;return((O=o.requestedCar)==null?void 0:O.year)||""}),D=A(()=>{var O;return((O=o.requestedCar)==null?void 0:O.image)||""}),I=A(()=>{var O;return((O=o.requestedCar)==null?void 0:O.price)||null}),p=A(()=>{var O;return((O=o.requestedCar)==null?void 0:O.stockDays)!==void 0?o.requestedCar.stockDays:null}),r=A(()=>{var O,N;return((O=o.requestedCar)==null?void 0:O.dealership)||((N=o.task)==null?void 0:N.dealership)||""}),g=A(()=>{var O;return((O=o.requestedCar)==null?void 0:O.registration)||""}),y=A(()=>{var O;return((O=o.requestedCar)==null?void 0:O.kilometers)!==void 0?o.requestedCar.kilometers:null}),V=A(()=>{var O;return((O=o.requestedCar)==null?void 0:O.fuelType)||""}),Y=A(()=>{var O;return((O=o.requestedCar)==null?void 0:O.gearType)||""}),ee=A(()=>{var O;return((O=o.requestedCar)==null?void 0:O.vin)||""}),se=A(()=>"Email"),X=A(()=>{var O,N;return((O=o.task)==null?void 0:O.sourceDetails)||((N=o.requestedCar)==null?void 0:N.adCampaign)||""}),ne=A(()=>{var O;return((O=o.requestedCar)==null?void 0:O.expectedPurchaseDate)||""}),L=A(()=>{var O;return((O=o.task)==null?void 0:O.fiscalEntity)||""}),te=A(()=>{var O;return((O=o.task)==null?void 0:O.sourceDetails)||""}),ge=A(()=>{var O;return((O=o.requestedCar)==null?void 0:O.adMedium)||""}),$e=A(()=>{var O;return((O=o.requestedCar)==null?void 0:O.adSource)||""});A(()=>!0);const de=A(()=>!0),W=A(()=>w.value||o.requestType||o.source||te.value||X.value||ne.value||L.value||ge.value||$e.value),T=O=>new Intl.NumberFormat("en-US").format(O),F=O=>new Intl.NumberFormat("en-US").format(O);return(O,N)=>(s(),P(a(ze),{class:"w-full mb-6 shadow-mk-dashboard-card"},{default:k(()=>[l(a(Be),{class:"px-4 md:px-6 py-3 border-b border-border"},{default:k(()=>[e("div",vl,[h.value?(s(),n("div",pl,[N[2]||(N[2]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fa-solid fa-thumbtack text-muted-foreground text-xs"}),e("h3",{class:"font-bold text-foreground text-sm"},"Request")],-1)),e("div",yl,[e("span",{class:z(["px-2 py-0.5 rounded text-xs font-medium border",t.entityType==="lead"?"bg-blue-50 text-blue-700 border-blue-200":"bg-purple-50 text-purple-700 border-purple-200"])},m(t.entityType==="lead"?"Lead":"Opportunity"),3),e("span",{class:z(["px-2 py-0.5 rounded text-xs font-medium border",j.value])},m(t.stage),3),t.deliverySubstatus?(s(),P(a(ce),{key:0,text:t.deliverySubstatus,size:"small",theme:C.value},null,8,["text","theme"])):u("",!0),c.value?(s(),P(a(ce),{key:1,text:c.value.label,size:"small",theme:c.value.theme},null,8,["text","theme"])):u("",!0)])])):(s(),n("div",gl)),e("div",xl,[N[3]||(N[3]=e("span",{class:"hidden md:inline text-xs text-muted-foreground font-medium"},"Owner",-1)),l(a(U),{onClick:N[0]||(N[0]=xe=>O.$emit("reassign")),variant:"link",size:"small",class:"text-xs font-bold"},{default:k(()=>[q(m(t.owner),1)]),_:1})])])]),_:1}),h.value?(s(),P(a(_e),{key:0,class:"p-4 md:p-6"},{default:k(()=>[w.value?(s(),n("div",hl,[e("div",bl,[e("div",kl,[e("div",wl,[D.value?(s(),n("img",{key:0,src:D.value,alt:"Car",class:"w-full h-full object-cover"},null,8,$l)):(s(),n("i",Cl))]),e("div",null,[e("div",Al,m(d.value)+" "+m(i.value)+" ("+m(x.value)+")",1),e("div",Sl,[p.value!==void 0&&p.value!==null?(s(),n("div",Il,[N[4]||(N[4]=e("div",{class:"w-1.5 h-1.5 bg-green-500 rounded-full"},null,-1)),q(" In stock ("+m(p.value)+" days) ",1)])):w.value?(s(),n("div",Tl,[...N[5]||(N[5]=[e("div",{class:"w-1.5 h-1.5 bg-orange-500 rounded-full"},null,-1),q(" Out of stock ",-1)])])):u("",!0),t.source?(s(),n("div",Dl,[N[6]||(N[6]=e("span",{class:"text-xs text-muted-foreground font-medium"},"Source:",-1)),e("span",jl,m(t.source),1)])):u("",!0)])])]),I.value?(s(),n("div",Vl,[N[7]||(N[7]=e("div",{class:"text-xs text-muted-foreground font-medium mb-1"},"Price",-1)),e("div",ql,"€ "+m(T(I.value)),1)])):u("",!0)]),t.requestMessage?(s(),n("div",Ml,[N[8]||(N[8]=e("div",{class:"text-xs text-muted-foreground font-medium mb-2"},"Request Message",-1)),e("div",Ll,[e("p",Ol,m(t.requestMessage),1)])])):u("",!0)])):(s(),n("div",Nl,[t.requestType?(s(),n("div",El,[N[9]||(N[9]=e("span",{class:"text-xs text-muted-foreground font-medium"},"Request Type:",-1)),e("span",Pl,m(t.requestType),1)])):u("",!0),t.requestMessage?(s(),n("div",Rl,[N[10]||(N[10]=e("div",{class:"text-xs text-muted-foreground font-medium mb-2"},"Request Message",-1)),e("p",Fl,m(t.requestMessage),1)])):u("",!0)])),W.value?(s(),n("div",Ul,[e("button",{onClick:N[1]||(N[1]=xe=>v.value=!v.value),class:"w-full p-3 flex items-center justify-center gap-2 text-sm text-muted-foreground hover:text-foreground hover:bg-muted transition-colors"},[e("span",Bl,m(v.value?"Hide":"View")+" Details",1),e("i",{class:z(["fa-solid fa-chevron-down text-xs transition-transform duration-200",{"rotate-180":v.value}])},null,2)])])):u("",!0),v.value&&W.value?(s(),n("div",_l,[e("div",zl,[N[21]||(N[21]=e("h4",{class:"text-xs font-bold uppercase text-muted-foreground tracking-wider mb-4"},"REQUEST DETAILS",-1)),e("div",Wl,[t.requestType?(s(),n("div",Hl,[N[11]||(N[11]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Request type",-1)),e("div",Yl,m(t.requestType),1)])):u("",!0),t.source?(s(),n("div",Gl,[N[12]||(N[12]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Source",-1)),e("div",Kl,m(t.source),1)])):u("",!0),e("div",null,[N[13]||(N[13]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Source details",-1)),e("div",{class:z(["font-medium",(te.value,"text-muted-foreground")])},m(te.value||"--"),3)]),r.value?(s(),n("div",Ql,[N[14]||(N[14]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Dealership",-1)),e("div",Jl,m(r.value),1)])):u("",!0),e("div",null,[N[15]||(N[15]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Channel",-1)),e("div",Zl,m(se.value||"Email"),1)]),e("div",null,[N[16]||(N[16]=e("div",{class:"text-xs text-muted-foreground mb-1"},"AdCampaign",-1)),e("div",{class:z(["font-medium",(X.value,"text-muted-foreground")])},m(X.value||"--"),3)]),e("div",null,[N[17]||(N[17]=e("div",{class:"text-xs text-muted-foreground mb-1"},"AdMedium",-1)),e("div",{class:z(["font-medium",(ge.value,"text-muted-foreground")])},m(ge.value||"--"),3)]),e("div",null,[N[18]||(N[18]=e("div",{class:"text-xs text-muted-foreground mb-1"},"AdSource",-1)),e("div",{class:z(["font-medium",($e.value,"text-muted-foreground")])},m($e.value||"--"),3)]),e("div",null,[N[19]||(N[19]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Expected purchase date",-1)),e("div",{class:z(["font-medium",(ne.value,"text-muted-foreground")])},m(ne.value||"--"),3)]),e("div",null,[N[20]||(N[20]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Fiscal entity",-1)),e("div",{class:z(["font-medium",(L.value,"text-muted-foreground")])},m(L.value||"--"),3)])])]),w.value?(s(),n("div",Xl,[N[30]||(N[30]=e("div",{class:"border-t border my-4"},null,-1)),e("div",null,[N[29]||(N[29]=e("div",{class:"flex justify-between items-center mb-4"},[e("h4",{class:"text-xs font-bold uppercase text-muted-foreground tracking-wider"},"VEHICLE DETAILS")],-1)),e("div",eo,[g.value?(s(),n("div",to,[N[22]||(N[22]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Registration",-1)),e("div",so,m(g.value),1)])):u("",!0),y.value!==void 0&&y.value!==null?(s(),n("div",ao,[N[23]||(N[23]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Kilometers",-1)),e("div",no,m(F(y.value))+" Km",1)])):u("",!0),V.value?(s(),n("div",lo,[N[24]||(N[24]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Fuel type",-1)),e("div",oo,m(V.value),1)])):u("",!0),Y.value?(s(),n("div",io,[N[25]||(N[25]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Gear type",-1)),e("div",ro,m(Y.value),1)])):u("",!0),ee.value?(s(),n("div",uo,[N[26]||(N[26]=e("div",{class:"text-xs text-muted-foreground mb-1"},"VIN Number",-1)),e("div",co,m(ee.value),1)])):u("",!0),r.value?(s(),n("div",mo,[N[27]||(N[27]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Dealership",-1)),e("div",fo,m(r.value),1)])):u("",!0)]),de.value?(s(),n("div",vo,[l(a(U),{variant:"outline",size:"small",class:"flex items-center gap-2"},{default:k(()=>[...N[28]||(N[28]=[e("i",{class:"fa-solid fa-list-check text-xs"},null,-1),q(" View technical specs ",-1)])]),_:1})])):u("",!0)])])):u("",!0)])):u("",!0)]),_:1})):u("",!0)]),_:1}))}},yo={class:"rounded-lg flex flex-col h-full bg-muted"},go={class:"px-4 py-4 flex items-center justify-between shrink-0"},xo={class:"flex items-center gap-2"},ho={class:"bg-white rounded-lg p-4 shadow-nsc-card flex flex-col flex-1"},bo={class:"flex items-center gap-2 flex-wrap mb-3"},ko={key:0,class:"space-y-3"},wo={class:"flex items-center gap-3"},$o={class:"w-16 h-12 bg-surfaceTertiary rounded-lg overflow-hidden shrink-0"},Co=["src"],Ao={key:1,class:"fa-solid fa-car text-2xl text-muted-foreground w-full h-full flex items-center justify-center"},So={class:"flex-1 min-w-0"},Io={class:"font-bold text-foreground text-sm mb-1"},To={class:"flex items-center gap-2 flex-wrap"},Do={key:0,class:"inline-flex items-center gap-1 px-2 py-0.5 bg-green-50 text-green-700 text-xs font-semibold rounded"},jo={key:1,class:"inline-flex items-center gap-1 px-2 py-0.5 bg-orange-50 text-orange-700 text-xs font-semibold rounded"},Vo={key:0,class:"text-right"},qo={class:"font-bold text-foreground text-sm"},Mo={class:"flex justify-end pt-2"},Lo={key:1,class:"flex flex-col items-center justify-center py-8 text-center"},Oo={class:"mt-3 pt-3 space-y-2"},No={key:0,class:"flex items-center justify-between text-xs"},Eo={class:"text-foreground font-medium"},Po={key:1,class:"flex items-center justify-between text-xs"},Ro={class:"text-foreground font-medium"},Fo={key:2,class:"pt-2"},Uo={class:"bg-muted rounded-lg p-2"},Bo={class:"text-xs text-muted-foreground leading-relaxed line-clamp-3"},Wa={__name:"TaskRequestOverviewTab",props:{task:{type:Object,required:!0},entityType:{type:String,default:"opportunity"},activities:{type:Array,default:()=>[]}},emits:["reassign","add-requested-car"],setup(t){const o=t,v=A(()=>o.task.requestedCar&&o.task.requestedCar.brand&&o.task.requestedCar.model),C=A(()=>{var r;return((r=o.task.requestedCar)==null?void 0:r.brand)||""}),j=A(()=>{var r;return((r=o.task.requestedCar)==null?void 0:r.model)||""}),$=A(()=>{var r;return((r=o.task.requestedCar)==null?void 0:r.year)||""}),f=A(()=>{var r;return((r=o.task.requestedCar)==null?void 0:r.image)||""}),c=A(()=>{var r;return((r=o.task.requestedCar)==null?void 0:r.price)||null}),w=A(()=>{var r;return((r=o.task.requestedCar)==null?void 0:r.stockDays)!==void 0?o.task.requestedCar.stockDays:null}),h=A(()=>{var r;return((r=o.task.requestedCar)==null?void 0:r.requestMessage)||""}),d=A(()=>zt(o.task.displayStage||o.task.stage,o.entityType)),i=A(()=>o.task.deliverySubstatus?o.task.deliverySubstatus==="Delivered"?"green":o.task.deliverySubstatus==="Awaiting Delivery"?"blue":"gray":"gray");function x(r){return!r||r.length===0?null:r.filter(y=>y.type==="offer").sort((y,V)=>new Date(V.timestamp)-new Date(y.timestamp))[0]||null}function D(r){if(!r)return 0;const g=new Date(r),V=Math.abs(new Date-g);return Math.ceil(V/(1e3*60*60*24))}const I=A(()=>{if((o.task.displayStage||o.task.stage)!=="In Negotiation")return null;const r=x(o.activities);if(!r)return null;const g=D(r.timestamp);return g<1?{label:"New Offer",theme:"orange"}:g<3?{label:"Active",theme:"yellow"}:null}),p=r=>new Intl.NumberFormat("en-US").format(r);return(r,g)=>{var y,V;return s(),n("div",yo,[e("div",go,[g[4]||(g[4]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fa-solid fa-car text-foreground"}),e("h2",{class:"text-base font-medium text-foreground leading-6"},"Requested Car")],-1)),e("div",xo,[g[3]||(g[3]=e("span",{class:"text-xs text-muted-foreground font-medium"},"Owner:",-1)),e("button",{onClick:g[0]||(g[0]=Y=>r.$emit("reassign")),class:"text-xs font-bold text-blue-600 hover:text-blue-700 hover:underline transition-colors"},m(t.task.assignee),1)])]),e("div",ho,[e("div",bo,[e("span",{class:z(["px-2 py-1 rounded text-xs font-medium border",t.entityType==="lead"?"bg-blue-50 text-blue-700 border-blue-200":"bg-purple-50 text-purple-700 border-purple-200"])},m(t.entityType==="lead"?"Lead":"Opportunity"),3),e("span",{class:z(["px-2 py-1 rounded text-xs font-medium border",d.value])},m(t.task.displayStage||t.task.stage),3),t.task.deliverySubstatus?(s(),P(a(ce),{key:0,text:t.task.deliverySubstatus,size:"small",theme:i.value},null,8,["text","theme"])):u("",!0),I.value?(s(),P(a(ce),{key:1,text:I.value.label,size:"small",theme:I.value.theme},null,8,["text","theme"])):u("",!0)]),v.value?(s(),n("div",ko,[e("div",wo,[e("div",$o,[f.value?(s(),n("img",{key:0,src:f.value,alt:"Car",class:"w-full h-full object-cover"},null,8,Co)):(s(),n("i",Ao))]),e("div",So,[e("div",Io,m(C.value)+" "+m(j.value)+" ("+m($.value)+")",1),e("div",To,[w.value!==void 0&&w.value!==null?(s(),n("div",Do,[g[5]||(g[5]=e("div",{class:"w-1 h-1 bg-green-500 rounded-full"},null,-1)),q(" In stock ("+m(w.value)+" days) ",1)])):(s(),n("div",jo,[...g[6]||(g[6]=[e("div",{class:"w-1 h-1 bg-orange-500 rounded-full"},null,-1),q(" Out of stock ",-1)])]))])]),c.value?(s(),n("div",Vo,[g[7]||(g[7]=e("div",{class:"text-xs text-muted-foreground font-medium"},"Price",-1)),e("div",qo,"€ "+m(p(c.value)),1)])):u("",!0)]),e("div",Mo,[l(a(U),{label:(t.task.requestedCar,"+ Add or update"),variant:"outline",size:"small",onClick:g[1]||(g[1]=Y=>r.$emit("add-requested-car")),class:"text-xs"},null,8,["label"])])])):(s(),n("div",Lo,[g[8]||(g[8]=e("i",{class:"fa-solid fa-car text-4xl text-muted-foreground mb-3"},null,-1)),g[9]||(g[9]=e("p",{class:"text-sm text-muted-foreground mb-4"},"No requested car added yet",-1)),l(a(U),{label:"+ Add or update",variant:"outline",size:"small",onClick:g[2]||(g[2]=Y=>r.$emit("add-requested-car"))})])),e("div",Oo,[t.task.source?(s(),n("div",No,[g[10]||(g[10]=e("span",{class:"text-muted-foreground"},"Source",-1)),e("span",Eo,m(t.task.source),1)])):u("",!0),t.task.requestType||(y=t.task.requestedCar)!=null&&y.requestType?(s(),n("div",Po,[g[11]||(g[11]=e("span",{class:"text-muted-foreground"},"Request Type",-1)),e("span",Ro,m(t.task.requestType||((V=t.task.requestedCar)==null?void 0:V.requestType)),1)])):u("",!0),h.value?(s(),n("div",Fo,[g[12]||(g[12]=e("div",{class:"text-xs text-muted-foreground mb-1"},"Message",-1)),e("div",Uo,[e("p",Bo,m(h.value),1)])])):u("",!0)])])])}}},_o={class:"rounded-lg flex flex-col h-full bg-muted"},zo={class:"px-4 py-2.5 flex items-center justify-between shrink-0"},Wo={class:"flex items-center gap-2"},Ho={key:0,class:"ml-1 px-2 py-0.5 bg-brand-blue/10 text-brand-blue text-xs font-bold rounded-full"},Yo={class:"bg-white rounded-lg p-3 shadow-nsc-card flex flex-col flex-1 min-h-0"},Go={key:0,class:"text-center py-6 text-muted-foreground"},Ko={key:1,class:"space-y-2 overflow-y-auto flex-1"},Qo=["onClick"],Jo={class:"flex items-start justify-between gap-2"},Zo={class:"flex-1 min-w-0"},Xo={class:"flex items-center gap-2 mb-1 flex-wrap"},ei={key:0,class:"hidden sm:flex items-center gap-1 text-xs text-muted-foreground"},ti={class:"flex flex-wrap items-center gap-x-3 gap-y-0.5"},si={key:0,class:"flex sm:hidden items-center gap-1 text-xs text-muted-foreground"},ai={key:1,class:"flex items-center gap-1 text-xs text-muted-foreground"},ni={key:2,class:"flex items-center gap-1 text-xs text-muted-foreground"},li={class:"truncate max-w-[150px]"},oi={key:3,class:"flex items-center gap-1 text-xs"},ii={class:"font-bold text-foreground"},ri={key:2,class:"text-center py-8 text-muted-foreground"},Ha={__name:"CustomerRelatedTasksWidget",props:{task:{type:Object,required:!0},entityType:{type:String,required:!0}},setup(t){const o=t,v=je(),C=Qa(),j=Xa(),$=E(!1),f=E([]),c=E([]),w=A(()=>{var p;return o.task.customerId||((p=o.task.customer)==null?void 0:p.id)||null}),h=async()=>{if(w.value){$.value=!0;try{await Promise.all([C.fetchLeads(),j.fetchOpportunities()]),f.value=C.leads||[],c.value=j.opportunities||[]}catch(p){console.error("Error fetching related tasks:",p)}finally{$.value=!1}}},d=A(()=>{if(!w.value)return[];const p=[];return f.value.forEach(r=>{r.customerId===w.value&&!(r.id===o.task.id&&o.entityType==="lead")&&p.push({...r,type:"lead"})}),c.value.forEach(r=>{r.customerId===w.value&&!(r.id===o.task.id&&o.entityType==="opportunity")&&p.push({...r,type:"opportunity"})}),p.sort((r,g)=>{const y=new Date(r.createdAt||0);return new Date(g.createdAt||0)-y})}),i=p=>{const r=p.requestedCar||p.vehicle;return r&&r.brand&&r.model?`${r.brand} ${r.model}`:null},x=p=>p?new Intl.NumberFormat("en-US").format(p):"0",D=p=>{if(!p)return"";const r=new Date(p),y=new Date-r,V=Math.floor(y/(1e3*60*60*24));return V===0?"Today":V===1?"Yesterday":V<7?`${V} days ago`:V<30?`${Math.floor(V/7)} weeks ago`:r.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},I=p=>{v.push({path:`/tasks/${p.id}`,query:{type:p.type}})};return De(()=>o.task.id,()=>{h()},{immediate:!0}),ht(()=>{h()}),(p,r)=>(s(),n("div",_o,[e("div",zo,[e("div",Wo,[r[0]||(r[0]=e("i",{class:"fa-solid fa-list text-foreground text-xs"},null,-1)),r[1]||(r[1]=e("h2",{class:"text-xs font-medium text-foreground"},"Other Tasks for This Customer",-1)),d.value.length>0?(s(),n("span",Ho,m(d.value.length),1)):u("",!0)])]),e("div",Yo,[$.value?(s(),n("div",Go,[...r[2]||(r[2]=[e("i",{class:"fa-solid fa-spinner fa-spin text-xl mb-2"},null,-1),e("p",{class:"text-xs"},"Loading related tasks...",-1)])])):d.value.length>0?(s(),n("div",Ko,[(s(!0),n(G,null,Z(d.value,g=>(s(),n("div",{key:`${g.type}-${g.id}`,class:"flex flex-col p-2 border border-border rounded-lg hover:bg-muted transition-colors cursor-pointer group",onClick:y=>I(g)},[e("div",Jo,[e("div",Zo,[e("div",Xo,[e("span",{class:z(["px-1 py-0.5 rounded text-xs font-bold border leading-none uppercase",g.type==="lead"?"bg-blue-50 text-blue-700 border-blue-200":"bg-purple-50 text-purple-700 border-purple-200"])},m(g.type==="lead"?"Lead":"Opp"),3),e("span",{class:z(["px-1 py-0.5 rounded text-xs font-bold border leading-none uppercase",a(zt)(g.displayStage||g.stage,g.type)])},m(g.displayStage||g.stage),3),g.createdAt?(s(),n("div",ei,[e("span",null,m(D(g.createdAt)),1)])):u("",!0)]),e("div",ti,[g.createdAt?(s(),n("div",si,[r[3]||(r[3]=e("i",{class:"fa-solid fa-calendar opacity-70"},null,-1)),e("span",null,m(D(g.createdAt)),1)])):u("",!0),g.assignee?(s(),n("div",ai,[r[4]||(r[4]=e("i",{class:"fa-solid fa-user opacity-70"},null,-1)),e("span",null,m(g.assignee),1)])):u("",!0),i(g)?(s(),n("div",ni,[r[5]||(r[5]=e("i",{class:"fa-solid fa-car opacity-70"},null,-1)),e("span",li,m(i(g)),1)])):u("",!0),g.type==="opportunity"&&g.value?(s(),n("div",oi,[r[6]||(r[6]=e("i",{class:"fa-solid fa-tag text-muted-foreground opacity-70"},null,-1)),e("span",ii,"€ "+m(x(g.value)),1)])):u("",!0)])]),r[7]||(r[7]=e("div",{class:"w-6 h-6 flex items-center justify-center bg-surface border border-border rounded hover:bg-white hover:border-brand-blue/30 text-muted-foreground hover:text-brand-blue transition-all shrink-0 self-center"},[e("i",{class:"fa-solid fa-external-link text-xs"})],-1))])],8,Qo))),128))])):(s(),n("div",ri,[...r[8]||(r[8]=[e("i",{class:"fa-solid fa-inbox text-2xl mb-2 opacity-30"},null,-1),e("p",{class:"text-xs"},"No other tasks for this customer",-1)])]))])]))}},di={key:0,class:"flex-grow border-t border"},ui={key:0,class:"ml-1.5 text-muted-foreground"},ci={key:0,class:"absolute top-full right-0 md:left-1/2 md:-translate-x-1/2 mt-2 z-50"},mi={key:1,class:"flex-grow border-t border"},Ya={__name:"AddNewButton",props:{show:{type:Boolean,default:!0},actions:{type:Array,default:()=>["note","financing","tradein","attachment","email","whatsapp","sms"]},activeTab:{type:String,default:"overview"},inline:{type:Boolean,default:!1}},emits:["action"],setup(t,{emit:o}){const v=t,C=o,j=E(!1),$={note:"data",tradein:"data",purchase:"data",attachment:"attachment",email:"communication",whatsapp:"communication",sms:"communication"},f=A(()=>{if(!v.activeTab||v.activeTab==="overview")return v.actions.filter(p=>!$[p]);const I=Object.entries($).filter(([,p])=>p===v.activeTab).map(([p])=>p);return v.actions.filter(p=>I.includes(p))}),c=A(()=>v.activeTab==="communication"?!0:f.value.length===1),w=A(()=>{if(v.activeTab==="communication")return"add communication";if(!c.value||f.value.length!==1)return"";const I=f.value[0];return{note:"add note",attachment:"add attachment"}[I]||""}),h=A(()=>v.activeTab==="communication"?!1:f.value.length>1),d=A(()=>{const I={addVehicle:"Add Vehicle",configureVehicle:"Configure Vehicle",note:"Note",financing:"Financing",tradein:"Trade-in",requestedCar:"Requested car",purchase:"Purchase Method",attachment:"Attachment",email:"Send Email",whatsapp:"Send WhatsApp",sms:"Send SMS"};return f.value.map(p=>({key:p,label:I[p]||p,onClick:()=>x(p)}))}),i=A(()=>{if(v.inline)return"bg-surface hover:bg-muted text-muted-foreground font-medium w-9 h-9 rounded-full shadow-sm transition-all flex items-center justify-center z-20 relative border border-border";const I="bg-surface hover:bg-muted text-muted-foreground font-medium rounded-full text-sm shadow-sm transition-all flex items-center justify-center z-20 relative border border-border";return c.value?`${I} px-4 py-2 h-9`:`${I} w-9 h-9`});A(()=>f.value.some(I=>["email","whatsapp","sms"].includes(I))),A(()=>f.value.some(I=>["addVehicle","configureVehicle"].includes(I))),A(()=>f.value.some(I=>["note","financing","tradein","attachment","requestedCar","purchase"].includes(I)));const x=I=>{j.value=!1,C("action",I)},D=()=>{if(v.activeTab==="communication"){x("call");return}c.value&&f.value.length===1?x(f.value[0]):j.value=!j.value};return(I,p)=>{const r=Ja("click-outside");return t.show?(s(),n("div",{key:0,class:z(["relative flex items-center",t.inline?"justify-end mb-0 py-0":"py-1 mb-4"])},[t.inline?u("",!0):(s(),n("div",di)),e("div",{class:z(["relative",t.inline?"mx-0":"mx-4"])},[e("button",{onClick:Te(D,["stop"]),class:z(i.value)},[p[0]||(p[0]=e("i",{class:"fa-solid fa-plus text-xs text-muted-foreground"},null,-1)),c.value?(s(),n("span",ui,m(w.value),1)):u("",!0)],2),j.value&&h.value?re((s(),n("div",ci,[l(a(tn),{items:d.value,className:"w-48"},null,8,["items"])])),[[r,()=>j.value=!1]]):u("",!0)],2),t.inline?u("",!0):(s(),n("div",mi))],2)):u("",!0)}}},fi={class:"bg-purple-50/50 border border-purple-100 rounded-lg p-4"},vi={class:"flex items-start gap-3"},pi={class:"flex-1 min-w-0"},yi={class:"font-bold text-sm text-foreground mb-2"},gi={class:"space-y-1.5 text-xs text-gray-600"},xi={class:"flex items-center gap-2"},hi={class:"flex items-center gap-2"},bi={class:"flex items-center gap-2"},ki={key:0,class:"mt-2"},wi={__name:"AppointmentWidget",props:{appointmentData:{type:Object,required:!0}},setup(t){const o=t,v=A(()=>o.appointmentData.date?new Date(o.appointmentData.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""),C=A(()=>o.appointmentData.time?o.appointmentData.time:""),j=$=>({scheduled:"bg-blue-100 text-blue-700 border border-blue-200",confirmed:"bg-green-100 text-green-700 border border-green-200",pending:"bg-yellow-100 text-yellow-700 border border-yellow-200",cancelled:"bg-red-100 text-red-700 border border-red-200"})[$==null?void 0:$.toLowerCase()]||"bg-muted text-muted-foreground border border-border";return($,f)=>(s(),n("div",fi,[e("div",vi,[f[3]||(f[3]=e("div",{class:"w-10 h-10 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center shrink-0"},[e("i",{class:"fa-solid fa-calendar text-sm"})],-1)),e("div",pi,[e("h4",yi,m(t.appointmentData.type),1),e("div",gi,[e("div",xi,[f[0]||(f[0]=e("i",{class:"fa-regular fa-calendar text-gray-400"},null,-1)),e("span",null,m(v.value),1)]),e("div",hi,[f[1]||(f[1]=e("i",{class:"fa-regular fa-clock text-gray-400"},null,-1)),e("span",null,m(C.value),1)]),e("div",bi,[f[2]||(f[2]=e("i",{class:"fa-solid fa-user text-gray-400"},null,-1)),e("span",null,m(t.appointmentData.assignee),1)])]),t.appointmentData.status?(s(),n("div",ki,[e("span",{class:z(["inline-flex px-2 py-0.5 rounded text-xs font-semibold",j(t.appointmentData.status)])},m(t.appointmentData.status),3)])):u("",!0)])])]))}},$i={class:"bg-white border border-border rounded-xl p-4 shadow-nsc-card flex gap-4 animate-fade-in mb-4 feed-item"},Ci={class:"flex-1"},Ai={class:"flex items-center gap-2 mb-1"},Si={class:"text-sm font-bold text-foreground"},Ii={class:"text-sm text-muted-foreground"},Ti={class:"text-sm text-muted-foreground"},Di={key:0,class:"bg-blue-50 text-blue-600 text-sm px-1 py-0.5 rounded border border-blue-100"},ji={class:"ml-auto relative"},Vi={key:0,class:"absolute right-0 top-full mt-1 z-10"},qi={key:0,class:"text-sm text-muted-foreground"},Mi={key:1,class:"text-sm text-muted-foreground flex items-center gap-2"},Li={key:2,class:"mt-2"},Oi={key:0},Ni={key:1,class:"bg-white border border-border rounded-lg p-3"},Ei={key:0},Pi={class:"text-sm font-bold text-foreground"},Ri={key:0,class:"text-sm text-muted-foreground mt-0.5"},Fi={class:"grid grid-cols-2 gap-x-4 gap-y-1 text-sm text-muted-foreground mt-2"},Ui={key:0},Bi={key:1},_i={key:2},zi={key:3},Wi={key:4},Hi={key:1},Yi={class:"text-sm font-bold text-foreground mb-2"},Gi={class:"grid grid-cols-2 gap-x-4 gap-y-2 text-sm text-muted-foreground"},Ki={key:0},Qi={class:"text-muted-foreground font-medium ml-1"},Ji={key:1},Zi={class:"text-muted-foreground font-medium ml-1"},Xi={key:2},er={class:"text-muted-foreground font-medium ml-1"},tr={key:3},sr={class:"text-muted-foreground font-medium ml-1"},ar={key:4},nr={class:"text-muted-foreground font-medium ml-1"},lr={key:5},or={class:"text-muted-foreground font-medium ml-1"},ir={key:2},rr={key:0,class:"inline-block mt-2 bg-purple-600 text-white text-xs font-bold px-1 py-0.5 rounded"},dr={key:3,class:"flex items-center gap-3"},ur={class:"flex-1"},cr={class:"text-sm font-bold text-foreground"},mr={class:"text-sm text-muted-foreground"},fr={key:0,class:"text-sm text-muted-foreground mt-1"},vr={key:1,class:"text-sm text-muted-foreground mt-1"},pr={key:4},yr={class:"text-sm font-bold text-foreground mb-2"},gr={class:"grid grid-cols-2 gap-x-4 gap-y-2 text-sm text-muted-foreground"},xr={key:0},hr={class:"text-muted-foreground font-medium ml-1"},br={key:1},kr={class:"text-muted-foreground font-medium ml-1"},wr={key:2},$r={class:"text-muted-foreground font-medium ml-1"},Cr={key:3},Ar={class:"text-muted-foreground font-medium ml-1"},Sr={key:4},Ir={class:"text-muted-foreground font-medium ml-1"},Tr={key:5},Dr={class:"text-muted-foreground font-medium ml-1"},jr={key:0,class:"flex flex-wrap gap-2 mt-2"},Vr={key:0,class:"bg-green-50 text-green-700 text-xs px-2 py-0.5 rounded border border-green-100"},qr={key:1,class:"bg-blue-50 text-blue-700 text-xs px-2 py-0.5 rounded border border-blue-100"},Mr={key:2,class:"bg-purple-50 text-purple-700 text-xs px-2 py-0.5 rounded border border-purple-100"},Ft={__name:"FeedItemCard",props:{item:{type:Object,required:!0},taskType:{type:String,default:"lead"},customerInitials:{type:String,required:!0}},emits:["edit","delete"],setup(t,{emit:o}){const v=t,C=o,j=E(!1),$=A(()=>[{key:"edit",label:"Edit",onClick:i},{key:"delete",label:"Delete",onClick:x}]),f=D=>({note:"fa-regular fa-note-sticky",communication:"fa-solid fa-comment-dots",email:"fa-regular fa-envelope",whatsapp:"fa-brands fa-whatsapp",sms:"fa-solid fa-comment-dots",attachment:"fa-solid fa-paperclip",tradein:"fa-solid fa-car-side",financing:"fa-solid fa-file-invoice-dollar",offer:"fa-solid fa-handshake",purchase:"fa-solid fa-shopping-cart","purchase-method":"fa-solid fa-credit-card",appointment:"fa-solid fa-calendar"})[D]||"fa-solid fa-circle",c=D=>({note:"bg-orange-100 text-orange-600 border-orange-200",communication:"bg-muted text-muted-foreground border",email:"bg-blue-100 text-blue-600 border-blue-200",whatsapp:"bg-green-100 text-green-600 border-green-200",sms:"bg-muted text-muted-foreground border",attachment:"bg-blue-50 text-blue-600 border-blue-100",tradein:"bg-green-50 text-green-600 border-green-100",financing:"bg-purple-50 text-purple-600 border-purple-100",offer:"bg-indigo-50 text-indigo-600 border-indigo-100",purchase:"bg-teal-50 text-teal-600 border-teal-100","purchase-method":"bg-amber-50 text-amber-600 border-amber-100",appointment:"bg-purple-100 text-purple-600 border-purple-200"})[D]||"bg-muted text-muted-foreground border",w=D=>{if(!D)return"Just now";const I=new Date(D),r=new Date-I,g=Math.floor(r/6e4),y=Math.floor(g/60),V=Math.floor(y/24);return g<1?"Just now":g<60?`${g} minutes ago`:y<24?`${y} hours ago`:V===1?"Yesterday":V<7?`${V} days ago`:I.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},h=D=>D?new Intl.NumberFormat("en-US").format(D):"0",d=D=>D?new Date(D).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",i=()=>{j.value=!1,C("edit",v.item)},x=()=>{j.value=!1,confirm("Are you sure you want to delete this item?")&&C("delete",v.item)};return(D,I)=>{const p=Ja("click-outside");return s(),n("div",$i,[e("div",{class:z(["w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold shrink-0 border",c(t.item.type)])},[e("i",{class:z([f(t.item.type),"text-sm"])},null,2)],2),e("div",Ci,[e("div",Ai,[e("span",Si,m(t.customerInitials),1),e("span",Ii,m(t.item.action||"added"),1),e("span",Ti,"• "+m(w(t.item.timestamp)),1),t.item.autoDetected?(s(),n("span",Di,"Auto-detected")):u("",!0),e("div",ji,[e("button",{onClick:I[0]||(I[0]=Te(r=>j.value=!j.value,["stop"])),class:"text-gray-400 hover:text-muted-foreground transition-colors p-1",title:"More actions"},[...I[1]||(I[1]=[e("i",{class:"fa-solid fa-ellipsis-vertical text-sm"},null,-1)])]),j.value?re((s(),n("div",Vi,[l(a(tn),{items:$.value,className:"w-32"},null,8,["items"])])),[[p,()=>j.value=!1]]):u("",!0)])]),t.item.content?(s(),n("div",qi,m(t.item.content),1)):u("",!0),t.item.fileName?(s(),n("div",Mi,[I[2]||(I[2]=e("i",{class:"fa-solid fa-paperclip text-gray-400"},null,-1)),e("span",null,m(t.item.fileName),1)])):u("",!0),t.item.data?(s(),n("div",Li,[t.item.type==="appointment"?(s(),n("div",Oi,[l(wi,{"appointment-data":t.item.data},null,8,["appointment-data"])])):(s(),n("div",Ni,[t.item.type==="tradein"?(s(),n("div",Ei,[e("h4",Pi,m(t.item.data.brand)+" "+m(t.item.data.model),1),t.item.data.version?(s(),n("p",Ri,m(t.item.data.version),1)):u("",!0),e("div",Fi,[t.item.data.year?(s(),n("div",Ui,[I[3]||(I[3]=e("i",{class:"fa-regular fa-calendar mr-1"},null,-1)),q(m(t.item.data.year),1)])):u("",!0),t.item.data.km?(s(),n("div",Bi,[I[4]||(I[4]=e("i",{class:"fa-solid fa-road mr-1"},null,-1)),q(m(t.item.data.km)+" km ",1)])):u("",!0),t.item.data.plate?(s(),n("div",_i,[I[5]||(I[5]=e("i",{class:"fa-solid fa-id-card mr-1"},null,-1)),q(m(t.item.data.plate),1)])):u("",!0),t.item.data.date?(s(),n("div",zi,[I[6]||(I[6]=e("i",{class:"fa-regular fa-calendar-check mr-1"},null,-1)),q(m(d(t.item.data.date)),1)])):u("",!0),t.item.data.class?(s(),n("div",Wi,[I[7]||(I[7]=e("i",{class:"fa-solid fa-car mr-1"},null,-1)),q(m(t.item.data.class),1)])):u("",!0)])])):t.item.type==="financing"?(s(),n("div",Hi,[e("h4",Yi,m(t.item.data.product),1),e("div",Gi,[t.item.data.provider?(s(),n("div",Ki,[I[8]||(I[8]=e("span",{class:"text-muted-foreground"},"Provider:",-1)),e("span",Qi,m(t.item.data.provider),1)])):u("",!0),t.item.data.total?(s(),n("div",Ji,[I[9]||(I[9]=e("span",{class:"text-muted-foreground"},"Total:",-1)),e("span",Zi,"€"+m(h(t.item.data.total)),1)])):u("",!0),t.item.data.monthly?(s(),n("div",Xi,[I[10]||(I[10]=e("span",{class:"text-muted-foreground"},"Monthly:",-1)),e("span",er,"€"+m(h(t.item.data.monthly)),1)])):u("",!0),t.item.data.deposit?(s(),n("div",tr,[I[11]||(I[11]=e("span",{class:"text-muted-foreground"},"Deposit:",-1)),e("span",sr,"€"+m(h(t.item.data.deposit)),1)])):u("",!0),t.item.data.startDate?(s(),n("div",ar,[I[12]||(I[12]=e("span",{class:"text-muted-foreground"},"Start:",-1)),e("span",nr,m(d(t.item.data.startDate)),1)])):u("",!0),t.item.data.expDate?(s(),n("div",lr,[I[13]||(I[13]=e("span",{class:"text-muted-foreground"},"Expires:",-1)),e("span",or,m(d(t.item.data.expDate)),1)])):u("",!0)])])):t.item.type==="offer"?(s(),n("div",ir,[l(Sn,{offers:[t.item.data],"opportunity-id":t.item.opportunityId||t.item.leadId||""},null,8,["offers","opportunity-id"]),t.item.data.isMainOffer?(s(),n("span",rr,"Main Offer")):u("",!0)])):t.item.type==="purchase"?(s(),n("div",dr,[e("div",ur,[e("h4",cr,m(t.item.data.brand)+" "+m(t.item.data.model)+" ("+m(t.item.data.year)+")",1),e("p",mr,"€ "+m(h(t.item.data.price)),1),t.item.data.purchaseDate?(s(),n("p",fr,"Purchased: "+m(d(t.item.data.purchaseDate)),1)):u("",!0),t.item.data.notes?(s(),n("p",vr,m(t.item.data.notes),1)):u("",!0)])])):t.item.type==="purchase-method"?(s(),n("div",pr,[e("h4",yr,m(t.item.data.typeLabel||t.item.data.type),1),e("div",gr,[t.item.data.monthlyInstalment?(s(),n("div",xr,[I[14]||(I[14]=e("span",{class:"text-muted-foreground"},"Monthly:",-1)),e("span",hr,"€"+m(h(t.item.data.monthlyInstalment)),1)])):u("",!0),t.item.data.duration?(s(),n("div",br,[I[15]||(I[15]=e("span",{class:"text-muted-foreground"},"Duration:",-1)),e("span",kr,m(t.item.data.duration)+" months",1)])):u("",!0),t.item.data.downPayment?(s(),n("div",wr,[I[16]||(I[16]=e("span",{class:"text-muted-foreground"},"Down Payment:",-1)),e("span",$r,"€"+m(h(t.item.data.downPayment)),1)])):u("",!0),t.item.data.interestRate?(s(),n("div",Cr,[I[17]||(I[17]=e("span",{class:"text-muted-foreground"},"Interest Rate:",-1)),e("span",Ar,m(t.item.data.interestRate)+"%",1)])):u("",!0),t.item.data.mileageLimit?(s(),n("div",Sr,[I[18]||(I[18]=e("span",{class:"text-muted-foreground"},"Mileage Limit:",-1)),e("span",Ir,m(h(t.item.data.mileageLimit))+" km/year",1)])):u("",!0),t.item.data.customerType?(s(),n("div",Tr,[I[19]||(I[19]=e("span",{class:"text-muted-foreground"},"Customer Type:",-1)),e("span",Dr,m(t.item.data.customerType),1)])):u("",!0)]),t.item.data.insuranceIncluded||t.item.data.maintenanceIncluded||t.item.data.registrationTaxesIncluded?(s(),n("div",jr,[t.item.data.insuranceIncluded?(s(),n("span",Vr,"Insurance")):u("",!0),t.item.data.maintenanceIncluded?(s(),n("span",qr,"Maintenance")):u("",!0),t.item.data.registrationTaxesIncluded?(s(),n("span",Mr,"Registration/Taxes")):u("",!0)])):u("",!0)])):u("",!0)]))])):u("",!0)])])}}},Lr={class:"space-y-3"},Or={class:"space-y-2"},Nr={class:"flex-1"},Er={class:"text-xs text-muted-foreground uppercase"},Pr={class:"flex justify-end gap-2 pt-3 border-t border-border"},Ga={__name:"CallForm",props:{phoneNumber:{type:String,required:!0}},emits:["call","cancel"],setup(t,{emit:o}){const v=t,C=o,j=E(""),$=f=>{f==="copy"&&navigator.clipboard.writeText(v.phoneNumber),C("call",{type:"call",option:f,phoneNumber:v.phoneNumber,notes:j.value})};return(f,c)=>(s(),n("div",Lr,[e("div",Or,[c[10]||(c[10]=e("label",{class:"block text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Choose Call Method",-1)),e("button",{onClick:c[0]||(c[0]=w=>$("outbound")),class:"w-full px-4 py-3 text-left border border-border rounded-lg hover:bg-muted transition-all flex items-center gap-3 group"},[...c[5]||(c[5]=[Na('<div class="w-10 h-10 rounded-lg bg-brand-blue/10 flex items-center justify-center group-hover:bg-brand-blue/20 transition-colors"><i class="fa-solid fa-phone text-brand-blue"></i></div><div class="flex-1"><p class="font-bold text-sm text-foreground uppercase tracking-tight">Call with Outbound</p><p class="text-xs text-muted-foreground uppercase">Use external calling system</p></div><i class="fa-solid fa-chevron-right text-xs text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity"></i>',3)])]),e("button",{onClick:c[1]||(c[1]=w=>$("pbx")),class:"w-full px-4 py-3 text-left border border-border rounded-lg hover:bg-muted transition-all flex items-center gap-3 group"},[...c[6]||(c[6]=[Na('<div class="w-10 h-10 rounded-lg bg-brand-slate/10 flex items-center justify-center group-hover:bg-brand-slate/20 transition-colors"><i class="fa-solid fa-phone-volume text-brand-slate"></i></div><div class="flex-1"><p class="font-bold text-sm text-foreground uppercase tracking-tight">Call with PBX</p><p class="text-xs text-muted-foreground uppercase">Use internal phone system</p></div><i class="fa-solid fa-chevron-right text-xs text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity"></i>',3)])]),e("button",{onClick:c[2]||(c[2]=w=>$("copy")),class:"w-full px-4 py-3 text-left border border-border rounded-lg hover:bg-muted transition-all flex items-center gap-3 group"},[c[8]||(c[8]=e("div",{class:"w-10 h-10 rounded-lg bg-gray-100 flex items-center justify-center group-hover:bg-gray-200 transition-colors"},[e("i",{class:"fa-solid fa-copy text-gray-600"})],-1)),e("div",Nr,[c[7]||(c[7]=e("p",{class:"font-bold text-sm text-foreground uppercase tracking-tight"},"Copy Number",-1)),e("p",Er,m(t.phoneNumber),1)]),c[9]||(c[9]=e("i",{class:"fa-solid fa-chevron-right text-xs text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity"},null,-1))])]),e("div",null,[c[11]||(c[11]=e("label",{class:"block text-xs font-medium text-muted-foreground mb-1"},"Call Notes",-1)),re(e("textarea",{"onUpdate:modelValue":c[3]||(c[3]=w=>j.value=w),class:"input",rows:"4",placeholder:"Add notes about the call..."},null,512),[[Oe,j.value]])]),e("div",Pr,[l(a(U),{label:"Cancel",variant:"outline",size:"small",onClick:c[4]||(c[4]=w=>f.$emit("cancel"))})])]))}},Rr={key:0,class:"space-y-4"},Fr={class:"grid grid-cols-4 gap-2"},Ur=["onClick"],Br={class:"text-xs font-bold uppercase tracking-wider"},_r={key:1,class:"space-y-4"},zr={class:"grid grid-cols-4 gap-2"},Wr=["onClick"],Hr={class:"text-xs font-bold uppercase tracking-wider"},Yr={key:0},Gr={__name:"CommunicationWidget",props:{type:{type:String,default:null},taskType:{type:String,default:"lead"},taskId:{type:[Number,String],default:null},phoneNumber:{type:String,default:""},showArrow:{type:Boolean,default:!0},inline:{type:Boolean,default:!1},initialTemplate:{type:String,default:""},initialMessage:{type:String,default:""}},emits:["save","cancel","send"],setup(t,{emit:o}){const v=t,C=o,j=[{id:"call",label:"Call",icon:"fa-solid fa-phone"},{id:"whatsapp",label:"WhatsApp",icon:"fa-brands fa-whatsapp"},{id:"email",label:"Email",icon:"fa-solid fa-envelope"},{id:"sms",label:"SMS",icon:"fa-solid fa-message"}],$=E(v.type);De(()=>v.type,d=>{d?$.value=d:$.value=null}),De(()=>v.taskId,()=>{$.value=null});const f=A(()=>d=>`bg-surface border-2 rounded-lg h-12 flex flex-col items-center justify-center gap-1 transition-all ${$.value===d?"border-brand-dark bg-muted text-brand-dark shadow-nsc-card":"border-border text-muted-foreground hover:border-brand-dark/30 hover:bg-muted/30 hover:text-muted-foreground"}`),c=d=>{C("save",{type:"communication",action:`sent via ${d.type}`,content:d.message,communicationType:d.type,template:d.template,subject:d.subject}),C("send",d)},w=d=>{C("save",{type:"communication",action:`called via ${d.option}`,content:d.notes||"Call attempt logged",communicationType:"call",callOption:d.option}),C("send",{type:"call",option:d.option,phoneNumber:d.phoneNumber,notes:d.notes})},h=()=>{$.value=null,C("cancel")};return(d,i)=>t.inline?(s(),n("div",_r,[e("div",zr,[(s(),n(G,null,Z(j,x=>e("button",{key:x.id,onClick:D=>$.value=x.id,class:z(f.value(x.id))},[e("i",{class:z([x.icon,"text-sm"])},null,2),e("span",Hr,m(x.label),1)],10,Wr)),64))]),$.value?(s(),n("div",Yr,[$.value==="email"?(s(),P(Ra,{key:0,"initial-template":t.initialTemplate,"initial-message":t.initialMessage,onSend:c,onCancel:h},null,8,["initial-template","initial-message"])):$.value==="sms"?(s(),P(Fa,{key:1,"initial-template":t.initialTemplate,"initial-message":t.initialMessage,onSend:c,onCancel:h},null,8,["initial-template","initial-message"])):$.value==="whatsapp"?(s(),P(Ua,{key:2,"initial-template":t.initialTemplate,"initial-message":t.initialMessage,onSend:c,onCancel:h},null,8,["initial-template","initial-message"])):$.value==="call"?(s(),P(Ga,{key:3,"phone-number":t.phoneNumber,onCall:w,onCancel:h},null,8,["phone-number"])):u("",!0)])):u("",!0)])):(s(),n("div",Rr,[e("div",Fr,[(s(),n(G,null,Z(j,x=>e("button",{key:x.id,onClick:D=>$.value=x.id,class:z(f.value(x.id))},[e("i",{class:z([x.icon,"text-sm"])},null,2),e("span",Br,m(x.label),1)],10,Ur)),64))]),e("div",null,[$.value==="email"?(s(),P(Ra,{key:0,"initial-template":t.initialTemplate,"initial-message":t.initialMessage,onSend:c,onCancel:h},null,8,["initial-template","initial-message"])):$.value==="sms"?(s(),P(Fa,{key:1,"initial-template":t.initialTemplate,"initial-message":t.initialMessage,onSend:c,onCancel:h},null,8,["initial-template","initial-message"])):$.value==="whatsapp"?(s(),P(Ua,{key:2,"initial-template":t.initialTemplate,"initial-message":t.initialMessage,onSend:c,onCancel:h},null,8,["initial-template","initial-message"])):$.value==="call"?(s(),P(Ga,{key:3,"phone-number":t.phoneNumber,onCall:w,onCancel:h},null,8,["phone-number"])):u("",!0)])]))}},Kr={key:0,class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-surface border-t border-l border-border rotate-45"},Qr={key:1,class:"flex justify-between items-center mb-4"},Jr={class:"text-sm font-semibold text-foreground"},Zr={class:"space-y-4"},Xr={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ed={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},td={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},sd={class:"border border-border rounded-lg bg-muted"},ad={key:0,class:"px-4 pb-4 space-y-4 border-t border-border pt-4"},nd={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ld={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},od={key:2,class:"flex justify-end gap-2 mt-6 border-t border-border pt-4"},id={__name:"TradeInWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0},hideActions:{type:Boolean,default:!1},hideHeader:{type:Boolean,default:!1}},emits:["save","cancel"],setup(t,{expose:o,emit:v}){const C=t,j=v,$=E(!1),f=E({brand:"",model:"",year:"",version:"",vin:"",plates:"",fuelType:"",gearType:"",kilometers:"",registration:""}),c=E({tradeInPrice:null,evaluationRangeLow:null,evaluationRangeHigh:null,provider:"",evaluationDate:""}),w=A(()=>!!f.value.brand&&!!f.value.model&&!!f.value.year);ht(()=>{C.item&&C.item.data&&(f.value={brand:C.item.data.brand||"",model:C.item.data.model||"",year:C.item.data.year||"",version:C.item.data.version||"",vin:C.item.data.vin||"",plates:C.item.data.plate||C.item.data.plates||"",fuelType:C.item.data.fuelType||"",gearType:C.item.data.gearType||"",kilometers:C.item.data.km||C.item.data.kilometers||"",registration:C.item.data.date||C.item.data.registration||""},C.item.data.tradeInPrice!==void 0&&(c.value={tradeInPrice:C.item.data.tradeInPrice||null,evaluationRangeLow:C.item.data.evaluationRangeLow||null,evaluationRangeHigh:C.item.data.evaluationRangeHigh||null,provider:C.item.data.provider||"",evaluationDate:C.item.data.evaluationDate||""},$.value=!0))});const h=()=>{var i,x;if(!w.value)return;const d={id:((i=C.item)==null?void 0:i.id)||Date.now(),type:"tradein",action:C.item?"updated a trade-in":"added a trade-in",timestamp:((x=C.item)==null?void 0:x.timestamp)||new Date().toISOString(),isEdit:!!C.item,data:{brand:f.value.brand,model:f.value.model,year:parseInt(f.value.year)||null,version:f.value.version||null,vin:f.value.vin||null,plate:f.value.plates||null,plates:f.value.plates||null,fuelType:f.value.fuelType||null,gearType:f.value.gearType||null,km:parseInt(f.value.kilometers)||0,kilometers:parseInt(f.value.kilometers)||0,date:f.value.registration||null,registration:f.value.registration||null,tradeInPrice:c.value.tradeInPrice,evaluationRangeLow:c.value.evaluationRangeLow,evaluationRangeHigh:c.value.evaluationRangeHigh,provider:c.value.provider||null,evaluationDate:c.value.evaluationDate||null}};j("save",d)};return o({submit:h,canSubmit:()=>w.value}),(d,i)=>(s(),n("div",{class:z(["animate-fade-in relative",{"bg-surface border border-border rounded-xl p-5 shadow-nsc-card mb-6":!t.hideHeader}])},[t.hideHeader?u("",!0):(s(),n("div",Kr)),t.hideHeader?u("",!0):(s(),n("div",Qr,[e("h5",Jr,m(t.item?"Edit Trade-In":"Add Trade-In"),1),e("button",{onClick:i[0]||(i[0]=x=>d.$emit("cancel")),class:"text-muted-foreground hover:text-muted-foreground"},[...i[18]||(i[18]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])])),e("div",Zr,[e("div",Xr,[e("div",null,[l(a(J),{class:"text-xs font-medium text-muted-foreground mb-1"},{default:k(()=>[...i[19]||(i[19]=[q("Brand ",-1),e("span",{class:"text-brand-red"},"*",-1)])]),_:1}),l(a(le),{modelValue:f.value.brand,"onUpdate:modelValue":i[1]||(i[1]=x=>f.value.brand=x),type:"text",placeholder:"e.g., Volkswagen",required:""},null,8,["modelValue"])]),e("div",null,[l(a(J),{class:"text-xs font-medium text-muted-foreground mb-1"},{default:k(()=>[...i[20]||(i[20]=[q("Model ",-1),e("span",{class:"text-brand-red"},"*",-1)])]),_:1}),l(a(le),{modelValue:f.value.model,"onUpdate:modelValue":i[2]||(i[2]=x=>f.value.model=x),type:"text",placeholder:"e.g., ID.4",required:""},null,8,["modelValue"])]),e("div",null,[l(a(J),{class:"text-xs font-medium text-muted-foreground mb-1"},{default:k(()=>[...i[21]||(i[21]=[q("Year ",-1),e("span",{class:"text-brand-red"},"*",-1)])]),_:1}),l(a(le),{modelValue:f.value.year,"onUpdate:modelValue":i[3]||(i[3]=x=>f.value.year=x),type:"number",placeholder:"e.g., 2024",min:"1900",max:new Date().getFullYear()+1,required:""},null,8,["modelValue","max"])])]),e("div",null,[l(a(J),{class:"text-xs font-medium text-muted-foreground mb-1"},{default:k(()=>[...i[22]||(i[22]=[q("Version/Trim",-1)])]),_:1}),l(a(le),{modelValue:f.value.version,"onUpdate:modelValue":i[4]||(i[4]=x=>f.value.version=x),type:"text",placeholder:"e.g., Premium Plus"},null,8,["modelValue"])]),e("div",ed,[e("div",null,[l(a(J),{class:"text-xs font-medium text-muted-foreground mb-1"},{default:k(()=>[...i[23]||(i[23]=[q("VIN",-1)])]),_:1}),l(a(le),{modelValue:f.value.vin,"onUpdate:modelValue":i[5]||(i[5]=x=>f.value.vin=x),type:"text",placeholder:"Vehicle Identification Number"},null,8,["modelValue"])]),e("div",null,[l(a(J),{class:"text-xs font-medium text-muted-foreground mb-1"},{default:k(()=>[...i[24]||(i[24]=[q("Plates",-1)])]),_:1}),l(a(le),{modelValue:f.value.plates,"onUpdate:modelValue":i[6]||(i[6]=x=>f.value.plates=x),type:"text",placeholder:"License plate number"},null,8,["modelValue"])])]),e("div",td,[e("div",null,[l(a(J),{class:"text-xs font-medium text-muted-foreground mb-1"},{default:k(()=>[...i[25]||(i[25]=[q("Fuel Type",-1)])]),_:1}),l(a(st),{modelValue:f.value.fuelType,"onUpdate:modelValue":i[7]||(i[7]=x=>f.value.fuelType=x)},{default:k(()=>[l(a(Xe),{class:"w-full h-10"},{default:k(()=>[l(a(et),{placeholder:"Select fuel type..."})]),_:1}),l(a(tt),null,{default:k(()=>[l(a(ae),{value:"Petrol"},{default:k(()=>[...i[26]||(i[26]=[q("Petrol",-1)])]),_:1}),l(a(ae),{value:"Diesel"},{default:k(()=>[...i[27]||(i[27]=[q("Diesel",-1)])]),_:1}),l(a(ae),{value:"Electric"},{default:k(()=>[...i[28]||(i[28]=[q("Electric",-1)])]),_:1}),l(a(ae),{value:"Hybrid"},{default:k(()=>[...i[29]||(i[29]=[q("Hybrid",-1)])]),_:1}),l(a(ae),{value:"Plug-in Hybrid"},{default:k(()=>[...i[30]||(i[30]=[q("Plug-in Hybrid",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),e("div",null,[l(a(J),{class:"text-xs font-medium text-muted-foreground mb-1"},{default:k(()=>[...i[31]||(i[31]=[q("Gear Type",-1)])]),_:1}),l(a(st),{modelValue:f.value.gearType,"onUpdate:modelValue":i[8]||(i[8]=x=>f.value.gearType=x)},{default:k(()=>[l(a(Xe),{class:"w-full h-10"},{default:k(()=>[l(a(et),{placeholder:"Select gear type..."})]),_:1}),l(a(tt),null,{default:k(()=>[l(a(ae),{value:"Manual"},{default:k(()=>[...i[32]||(i[32]=[q("Manual",-1)])]),_:1}),l(a(ae),{value:"Automatic"},{default:k(()=>[...i[33]||(i[33]=[q("Automatic",-1)])]),_:1}),l(a(ae),{value:"CVT"},{default:k(()=>[...i[34]||(i[34]=[q("CVT",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),e("div",null,[l(a(J),{class:"text-xs font-medium text-muted-foreground mb-1"},{default:k(()=>[...i[35]||(i[35]=[q("Mileage (km)",-1)])]),_:1}),l(a(le),{modelValue:f.value.kilometers,"onUpdate:modelValue":i[9]||(i[9]=x=>f.value.kilometers=x),modelModifiers:{number:!0},type:"number",placeholder:"0",min:"0"},null,8,["modelValue"])])]),e("div",null,[l(a(J),{class:"text-xs font-medium text-muted-foreground mb-1"},{default:k(()=>[...i[36]||(i[36]=[q("Registration Year/Month",-1)])]),_:1}),l(a(le),{modelValue:f.value.registration,"onUpdate:modelValue":i[10]||(i[10]=x=>f.value.registration=x),type:"text",placeholder:"MM/YYYY (e.g., 01/2024)"},null,8,["modelValue"])]),e("div",sd,[e("button",{type:"button",onClick:i[11]||(i[11]=x=>$.value=!$.value),class:"w-full flex items-center justify-between p-4 text-left hover:bg-surface transition-colors rounded-lg"},[i[37]||(i[37]=e("h3",{class:"text-sm font-medium text-foreground"},"Valuation Information",-1)),e("i",{class:z(["fa-solid transition-transform duration-200 text-muted-foreground",$.value?"fa-chevron-up":"fa-chevron-down"])},null,2)]),$.value?(s(),n("div",ad,[e("div",null,[l(a(J),{class:"text-xs font-medium text-muted-foreground mb-1"},{default:k(()=>[...i[38]||(i[38]=[q("Trade-In Price (€)",-1)])]),_:1}),l(a(le),{modelValue:c.value.tradeInPrice,"onUpdate:modelValue":i[12]||(i[12]=x=>c.value.tradeInPrice=x),modelModifiers:{number:!0},type:"number",placeholder:"0.00",min:"0",step:"0.01"},null,8,["modelValue"])]),e("div",nd,[e("div",null,[l(a(J),{class:"text-xs font-medium text-muted-foreground mb-1"},{default:k(()=>[...i[39]||(i[39]=[q("Evaluation Range - Low (€)",-1)])]),_:1}),l(a(le),{modelValue:c.value.evaluationRangeLow,"onUpdate:modelValue":i[13]||(i[13]=x=>c.value.evaluationRangeLow=x),modelModifiers:{number:!0},type:"number",placeholder:"0.00",min:"0",step:"0.01"},null,8,["modelValue"])]),e("div",null,[l(a(J),{class:"text-xs font-medium text-muted-foreground mb-1"},{default:k(()=>[...i[40]||(i[40]=[q("Evaluation Range - High (€)",-1)])]),_:1}),l(a(le),{modelValue:c.value.evaluationRangeHigh,"onUpdate:modelValue":i[14]||(i[14]=x=>c.value.evaluationRangeHigh=x),modelModifiers:{number:!0},type:"number",placeholder:"0.00",min:"0",step:"0.01"},null,8,["modelValue"])])]),e("div",ld,[e("div",null,[l(a(J),{class:"text-xs font-medium text-muted-foreground mb-1"},{default:k(()=>[...i[41]||(i[41]=[q("Provider",-1)])]),_:1}),l(a(st),{modelValue:c.value.provider,"onUpdate:modelValue":i[15]||(i[15]=x=>c.value.provider=x)},{default:k(()=>[l(a(Xe),{class:"w-full h-10"},{default:k(()=>[l(a(et),{placeholder:"Select provider..."})]),_:1}),l(a(tt),null,{default:k(()=>[l(a(ae),{value:"Eurotax"},{default:k(()=>[...i[42]||(i[42]=[q("Eurotax",-1)])]),_:1}),l(a(ae),{value:"Infocar"},{default:k(()=>[...i[43]||(i[43]=[q("Infocar",-1)])]),_:1}),l(a(ae),{value:"Manual"},{default:k(()=>[...i[44]||(i[44]=[q("Manual",-1)])]),_:1}),l(a(ae),{value:"Other"},{default:k(()=>[...i[45]||(i[45]=[q("Other",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),e("div",null,[l(a(J),{class:"text-xs font-medium text-muted-foreground mb-1"},{default:k(()=>[...i[46]||(i[46]=[q("Evaluation Date",-1)])]),_:1}),l(a(le),{modelValue:c.value.evaluationDate,"onUpdate:modelValue":i[16]||(i[16]=x=>c.value.evaluationDate=x),type:"date"},null,8,["modelValue"])])])])):u("",!0)])]),t.hideActions?u("",!0):(s(),n("div",od,[l(a(U),{label:"Cancel",variant:"outline",size:"small",class:"rounded-sm",onClick:i[17]||(i[17]=x=>d.$emit("cancel"))}),l(a(U),{label:"Save",variant:"primary",size:"small",class:"rounded-sm !bg-brand-red !hover:bg-brand-red-dark !text-white !border-brand-red",disabled:!w.value,onClick:h},null,8,["disabled"])]))],2))}},rd={key:0,class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-surface border-t border-l border-border rotate-45"},dd={key:1,class:"flex justify-between items-center mb-4"},ud={class:"text-sm font-semibold text-foreground"},cd={class:"flex gap-2"},md=["value"],fd={key:0,class:"space-y-4"},vd={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},pd={class:"relative"},yd={key:0,class:"text-xs text-red-600 mt-1"},gd={class:"relative"},xd={key:0,class:"text-xs text-red-600 mt-1"},hd={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},bd=["value"],kd={key:0,class:"text-xs text-red-600 mt-1"},wd={key:0},$d={class:"relative"},Cd={key:1},Ad={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Sd={class:"relative"},Id={class:"relative"},Td={class:"flex items-center gap-2"},Dd={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},jd={class:"relative"},Vd={class:"bg-muted p-4 rounded-lg border border-border"},qd={class:"flex justify-between items-center"},Md={class:"text-lg font-bold text-foreground"},Ld={class:"flex flex-col gap-2"},Od={class:"flex items-center gap-2"},Nd={class:"flex items-center gap-2"},Ed={key:0,class:"text-xs text-red-600 mt-1"},Pd={class:"bg-muted p-4 rounded-lg border border-border"},Rd={class:"flex justify-between items-center"},Fd={class:"text-lg font-bold text-foreground"},Ud={class:"flex flex-col gap-2"},Bd={class:"flex items-center gap-2"},_d={class:"flex items-center gap-2"},zd={class:"flex items-center gap-2"},Wd={key:2,class:"flex justify-end gap-2 mt-6 border-t border-border pt-4"},Hd={__name:"PurchaseMethodWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0},hideActions:{type:Boolean,default:!1},hideHeader:{type:Boolean,default:!1}},emits:["save","cancel"],setup(t,{expose:o,emit:v}){const C=t,j=v,$=E({}),f=[{value:"FIN",label:"FIN"},{value:"LEA",label:"LEA"},{value:"LTR",label:"LTR"}],c=E({type:"",fields:{monthlyInstalment:null,downPayment:null,duration:null,interestRate:null,effectiveInterestRate:null,gfv:null,mileageLimit:null,finalInstalment:null,customerType:"",insuranceIncluded:!1,maintenanceIncluded:!1,registrationTaxesIncluded:!1}}),w=A(()=>{if(c.value.type!=="LEA")return 0;const g=parseFloat(c.value.fields.monthlyInstalment)||0,y=parseInt(c.value.fields.duration)||0,V=parseFloat(c.value.fields.downPayment)||0,Y=parseFloat(c.value.fields.finalInstalment)||0;return g*y+V+Y}),h=A(()=>{if(c.value.type!=="LTR")return 0;const g=parseFloat(c.value.fields.monthlyInstalment)||0,y=parseInt(c.value.fields.duration)||0,V=parseFloat(c.value.fields.downPayment)||0;return g*y+V}),d=g=>g==="FIN"?[12,24,36,48,60]:g==="LEA"?[24,36,48,60]:g==="LTR"?[12,24,36,48,60]:[],i=g=>({FIN:"Captive Financing",LEA:"Leasing",LTR:"Long-Term Rental"})[g]||g,x=g=>g?new Intl.NumberFormat("en-US").format(g):"0",D=g=>{delete $.value[g]},I=A(()=>!c.value.type||!c.value.fields.monthlyInstalment||c.value.fields.monthlyInstalment<=0||c.value.fields.downPayment===null||c.value.fields.downPayment===void 0||c.value.fields.downPayment<0||!c.value.fields.duration||c.value.fields.duration<12||c.value.fields.duration>60||c.value.type==="LTR"&&!c.value.fields.customerType?!1:Object.keys($.value).length===0),p=()=>{c.value.type!=="FIN"&&(c.value.fields.effectiveInterestRate=null,c.value.fields.gfv=null),c.value.type!=="LEA"&&(c.value.fields.finalInstalment=null),c.value.type!=="LTR"&&(c.value.fields.customerType="",c.value.fields.registrationTaxesIncluded=!1),c.value.type!=="LEA"&&c.value.type!=="LTR"&&(c.value.fields.mileageLimit=null,c.value.fields.maintenanceIncluded=!1),$.value={}};ht(()=>{C.item&&C.item.data&&(c.value={type:C.item.data.type||"",fields:{monthlyInstalment:C.item.data.monthlyInstalment||null,downPayment:C.item.data.downPayment||null,duration:C.item.data.duration||null,interestRate:C.item.data.interestRate||null,effectiveInterestRate:C.item.data.effectiveInterestRate||null,gfv:C.item.data.gfv||null,mileageLimit:C.item.data.mileageLimit||null,finalInstalment:C.item.data.finalInstalment||null,customerType:C.item.data.customerType||"",insuranceIncluded:C.item.data.insuranceIncluded||!1,maintenanceIncluded:C.item.data.maintenanceIncluded||!1,registrationTaxesIncluded:C.item.data.registrationTaxesIncluded||!1}})});const r=()=>{var ee,se;if(!I.value)return;const g=i(c.value.type),y=c.value.fields.monthlyInstalment||0,V=c.value.fields.duration||0,Y={id:((ee=C.item)==null?void 0:ee.id)||Date.now(),type:"purchase-method",action:C.item?"updated a purchase method":"added a purchase method",content:`${g}: €${x(y)}/month for ${V} months`,timestamp:((se=C.item)==null?void 0:se.timestamp)||new Date().toISOString(),isEdit:!!C.item,data:{type:c.value.type,typeLabel:g,monthlyInstalment:c.value.fields.monthlyInstalment,downPayment:c.value.fields.downPayment,duration:c.value.fields.duration,interestRate:c.value.fields.interestRate,effectiveInterestRate:c.value.fields.effectiveInterestRate,gfv:c.value.fields.gfv,mileageLimit:c.value.fields.mileageLimit,finalInstalment:c.value.fields.finalInstalment,customerType:c.value.fields.customerType,insuranceIncluded:c.value.fields.insuranceIncluded,maintenanceIncluded:c.value.fields.maintenanceIncluded,registrationTaxesIncluded:c.value.fields.registrationTaxesIncluded,totalLeasingAmount:w.value,totalRentalAmount:h.value}};j("save",Y)};return o({submit:r,canSubmit:()=>I.value}),(g,y)=>(s(),n("div",{class:z(["animate-fade-in relative",{"bg-surface border border-border rounded-xl p-5 shadow-nsc-card mb-6":!t.hideHeader}])},[t.hideHeader?u("",!0):(s(),n("div",rd)),t.hideHeader?u("",!0):(s(),n("div",dd,[e("h5",ud,m(t.item?"Edit Purchase Method":"Add Purchase Method"),1),e("button",{onClick:y[0]||(y[0]=V=>g.$emit("cancel")),class:"text-muted-foreground hover:text-muted-foreground"},[...y[23]||(y[23]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])])),e("form",{onSubmit:Te(r,["prevent"]),class:"space-y-4"},[e("div",null,[y[24]||(y[24]=e("label",{class:"block text-xs font-medium text-muted-foreground mb-2"},[q("Purchase Method Type "),e("span",{class:"text-brand-red"},"*")],-1)),e("div",cd,[(s(),n(G,null,Z(f,V=>e("label",{key:V.value,class:"flex-1 cursor-pointer"},[re(e("input",{type:"radio",value:V.value,"onUpdate:modelValue":y[1]||(y[1]=Y=>c.value.type=Y),class:"sr-only",onChange:p},null,40,md),[[fn,c.value.type]]),e("div",{class:z(["px-4 py-3 rounded-btn border-2 text-center text-sm font-medium transition-colors",c.value.type===V.value?"border-brand-red bg-brand-red/5 text-brand-red":"border-D1D5DB bg-white text-muted-foreground hover:border-brand-slate"])},m(V.label),3)])),64))])]),c.value.type?(s(),n("div",fd,[e("div",vd,[e("div",null,[y[26]||(y[26]=e("label",{class:"block text-xs font-medium text-muted-foreground mb-1"},[q(" Monthly Instalment "),e("span",{class:"text-brand-red"},"*")],-1)),e("div",pd,[y[25]||(y[25]=e("span",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground"},"€",-1)),re(e("input",{"onUpdate:modelValue":y[2]||(y[2]=V=>c.value.fields.monthlyInstalment=V),type:"number",step:"0.01",min:"0",placeholder:"0.00",class:z(["input pl-8",{"border-red-500":$.value.monthlyInstalment}]),onInput:y[3]||(y[3]=V=>D("monthlyInstalment"))},null,34),[[Oe,c.value.fields.monthlyInstalment,void 0,{number:!0}]])]),$.value.monthlyInstalment?(s(),n("p",yd,m($.value.monthlyInstalment),1)):u("",!0)]),e("div",null,[y[28]||(y[28]=e("label",{class:"block text-xs font-medium text-muted-foreground mb-1"},[q(" Down Payment "),e("span",{class:"text-brand-red"},"*")],-1)),e("div",gd,[y[27]||(y[27]=e("span",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground"},"€",-1)),re(e("input",{"onUpdate:modelValue":y[4]||(y[4]=V=>c.value.fields.downPayment=V),type:"number",step:"0.01",min:"0",placeholder:"0.00",class:z(["input pl-8",{"border-red-500":$.value.downPayment}]),onInput:y[5]||(y[5]=V=>D("downPayment"))},null,34),[[Oe,c.value.fields.downPayment,void 0,{number:!0}]])]),$.value.downPayment?(s(),n("p",xd,m($.value.downPayment),1)):u("",!0)])]),e("div",hd,[e("div",null,[y[30]||(y[30]=e("label",{class:"block text-xs font-medium text-muted-foreground mb-1"},[q(" Duration (months) "),e("span",{class:"text-brand-red"},"*")],-1)),re(e("select",{"onUpdate:modelValue":y[6]||(y[6]=V=>c.value.fields.duration=V),class:z(["input",{"border-red-500":$.value.duration}]),onChange:y[7]||(y[7]=V=>D("duration"))},[y[29]||(y[29]=e("option",{value:""},"Select duration...",-1)),(s(!0),n(G,null,Z(d(c.value.type),V=>(s(),n("option",{key:V,value:V},m(V)+" months ",9,bd))),128))],34),[[Ea,c.value.fields.duration,void 0,{number:!0}]]),$.value.duration?(s(),n("p",kd,m($.value.duration),1)):u("",!0)]),c.value.type==="FIN"||c.value.type==="LEA"?(s(),n("div",wd,[y[32]||(y[32]=e("label",{class:"block text-xs font-medium text-muted-foreground mb-1"},"Interest Rate / APR (%)",-1)),e("div",$d,[re(e("input",{"onUpdate:modelValue":y[8]||(y[8]=V=>c.value.fields.interestRate=V),type:"number",step:"0.01",min:"0",max:"99.99",placeholder:"0.00",class:"input pr-8",onInput:y[9]||(y[9]=V=>D("interestRate"))},null,544),[[Oe,c.value.fields.interestRate,void 0,{number:!0}]]),y[31]||(y[31]=e("span",{class:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground"},"%",-1))])])):u("",!0),c.value.type==="LEA"||c.value.type==="LTR"?(s(),n("div",Cd,[y[33]||(y[33]=e("label",{class:"block text-xs font-medium text-muted-foreground mb-1"},"Mileage Limit (annual km)",-1)),re(e("input",{"onUpdate:modelValue":y[10]||(y[10]=V=>c.value.fields.mileageLimit=V),type:"number",min:"0",placeholder:"0",class:"input"},null,512),[[Oe,c.value.fields.mileageLimit,void 0,{number:!0}]])])):u("",!0)]),c.value.type==="FIN"?(s(),n(G,{key:0},[e("div",Ad,[e("div",null,[y[35]||(y[35]=e("label",{class:"block text-xs font-medium text-muted-foreground mb-1"},"Effective Interest Rate / TAEG (%)",-1)),e("div",Sd,[re(e("input",{"onUpdate:modelValue":y[11]||(y[11]=V=>c.value.fields.effectiveInterestRate=V),type:"number",step:"0.01",min:"0",max:"99.99",placeholder:"0.00",class:"input pr-8"},null,512),[[Oe,c.value.fields.effectiveInterestRate,void 0,{number:!0}]]),y[34]||(y[34]=e("span",{class:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground"},"%",-1))])]),e("div",null,[y[37]||(y[37]=e("label",{class:"block text-xs font-medium text-muted-foreground mb-1"},"Guaranteed Future Value / GFV (€)",-1)),e("div",Id,[y[36]||(y[36]=e("span",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground"},"€",-1)),re(e("input",{"onUpdate:modelValue":y[12]||(y[12]=V=>c.value.fields.gfv=V),type:"number",step:"0.01",min:"0",placeholder:"0.00",class:"input pl-8"},null,512),[[Oe,c.value.fields.gfv,void 0,{number:!0}]])])])]),e("div",Td,[re(e("input",{type:"checkbox",id:"fin-insurance","onUpdate:modelValue":y[13]||(y[13]=V=>c.value.fields.insuranceIncluded=V),class:"w-4 h-4 rounded border-D1D5DB"},null,512),[[Ze,c.value.fields.insuranceIncluded]]),y[38]||(y[38]=e("label",{for:"fin-insurance",class:"text-sm text-muted-foreground cursor-pointer"}," Insurance Included ",-1))])],64)):u("",!0),c.value.type==="LEA"?(s(),n(G,{key:1},[e("div",Dd,[e("div",null,[y[40]||(y[40]=e("label",{class:"block text-xs font-medium text-muted-foreground mb-1"},"Final Instalment (€)",-1)),e("div",jd,[y[39]||(y[39]=e("span",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground"},"€",-1)),re(e("input",{"onUpdate:modelValue":y[14]||(y[14]=V=>c.value.fields.finalInstalment=V),type:"number",step:"0.01",min:"0",placeholder:"0.00",class:"input pl-8"},null,512),[[Oe,c.value.fields.finalInstalment,void 0,{number:!0}]])])])]),e("div",Vd,[e("div",qd,[y[41]||(y[41]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Total Leasing Amount:",-1)),e("span",Md,"€ "+m(x(w.value)),1)]),y[42]||(y[42]=e("p",{class:"text-xs text-muted-foreground mt-1"}," (Monthly × Duration + Down Payment + Final Instalment) ",-1))]),e("div",Ld,[e("div",Od,[re(e("input",{type:"checkbox",id:"lea-insurance","onUpdate:modelValue":y[15]||(y[15]=V=>c.value.fields.insuranceIncluded=V),class:"w-4 h-4 rounded border-D1D5DB"},null,512),[[Ze,c.value.fields.insuranceIncluded]]),y[43]||(y[43]=e("label",{for:"lea-insurance",class:"text-sm text-muted-foreground cursor-pointer"}," Insurance Included ",-1))]),e("div",Nd,[re(e("input",{type:"checkbox",id:"lea-maintenance","onUpdate:modelValue":y[16]||(y[16]=V=>c.value.fields.maintenanceIncluded=V),class:"w-4 h-4 rounded border-D1D5DB"},null,512),[[Ze,c.value.fields.maintenanceIncluded]]),y[44]||(y[44]=e("label",{for:"lea-maintenance",class:"text-sm text-muted-foreground cursor-pointer"}," Maintenance Included ",-1))])])],64)):u("",!0),c.value.type==="LTR"?(s(),n(G,{key:2},[e("div",null,[y[46]||(y[46]=e("label",{class:"block text-xs font-medium text-muted-foreground mb-1"},[q(" Customer Type "),e("span",{class:"text-brand-red"},"*")],-1)),re(e("select",{"onUpdate:modelValue":y[17]||(y[17]=V=>c.value.fields.customerType=V),class:z(["input",{"border-red-500":$.value.customerType}]),onChange:y[18]||(y[18]=V=>D("customerType"))},[...y[45]||(y[45]=[e("option",{value:""},"Select customer type...",-1),e("option",{value:"Private"},"Private",-1),e("option",{value:"Business"},"Business",-1),e("option",{value:"Fleet"},"Fleet",-1)])],34),[[Ea,c.value.fields.customerType]]),$.value.customerType?(s(),n("p",Ed,m($.value.customerType),1)):u("",!0)]),e("div",Pd,[e("div",Rd,[y[47]||(y[47]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Total Rental Amount:",-1)),e("span",Fd,"€ "+m(x(h.value)),1)]),y[48]||(y[48]=e("p",{class:"text-xs text-muted-foreground mt-1"}," (Monthly × Duration + Down Payment) ",-1))]),e("div",Ud,[e("div",Bd,[re(e("input",{type:"checkbox",id:"ltr-insurance","onUpdate:modelValue":y[19]||(y[19]=V=>c.value.fields.insuranceIncluded=V),class:"w-4 h-4 rounded border-D1D5DB"},null,512),[[Ze,c.value.fields.insuranceIncluded]]),y[49]||(y[49]=e("label",{for:"ltr-insurance",class:"text-sm text-muted-foreground cursor-pointer"}," Insurance Included ",-1))]),e("div",_d,[re(e("input",{type:"checkbox",id:"ltr-maintenance","onUpdate:modelValue":y[20]||(y[20]=V=>c.value.fields.maintenanceIncluded=V),class:"w-4 h-4 rounded border-D1D5DB"},null,512),[[Ze,c.value.fields.maintenanceIncluded]]),y[50]||(y[50]=e("label",{for:"ltr-maintenance",class:"text-sm text-muted-foreground cursor-pointer"}," Maintenance Included ",-1))]),e("div",zd,[re(e("input",{type:"checkbox",id:"ltr-registration","onUpdate:modelValue":y[21]||(y[21]=V=>c.value.fields.registrationTaxesIncluded=V),class:"w-4 h-4 rounded border-D1D5DB"},null,512),[[Ze,c.value.fields.registrationTaxesIncluded]]),y[51]||(y[51]=e("label",{for:"ltr-registration",class:"text-sm text-muted-foreground cursor-pointer"}," Registration/Taxes Included ",-1))])])],64)):u("",!0)])):u("",!0)],32),t.hideActions?u("",!0):(s(),n("div",Wd,[l(a(U),{label:"Cancel",variant:"outline",size:"small",onClick:y[22]||(y[22]=V=>g.$emit("cancel"))}),l(a(U),{label:"Save",variant:"primary",size:"small",disabled:!I.value,onClick:r},null,8,["disabled"])]))],2))}},Yd={class:"flex-1 overflow-y-auto px-6 py-4 w-full space-y-6"},Gd={class:"space-y-2"},Kd={class:"space-y-2"},Qd={class:"space-y-2"},Jd={class:"space-y-2"},Zd={class:"relative"},Xd={class:"space-y-2"},eu={class:"space-y-2"},tu={class:"space-y-2"},su={class:"border-t border pt-4"},au={key:0,class:"mt-4 space-y-6"},nu={class:"space-y-2"},lu={class:"space-y-2"},ou={class:"space-y-2"},iu={class:"space-y-2"},ru={__name:"AddRequestedCarModal",props:{show:{type:Boolean,default:!1},task:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:[String,Number],default:null}},emits:["close","save"],setup(t,{emit:o}){const v=t,C=o,j=h=>{h||C("close")},$=E(!1),f=E({brand:"",model:"",year:new Date().getFullYear(),price:null,requestType:"Quotation",requestMessage:"",image:"",dealership:"",fuelType:"",gearType:"",kilometers:null});De(()=>v.show,h=>{var d;if(h&&((d=v.task)!=null&&d.requestedCar)){const i=v.task.requestedCar;f.value={brand:i.brand||"",model:i.model||"",year:i.year||new Date().getFullYear(),price:i.price||null,requestType:i.requestType||"Quotation",requestMessage:i.requestMessage||"",image:i.image||"",dealership:i.dealership||"",fuelType:i.fuelType||"",gearType:i.gearType||"",kilometers:i.kilometers||null}}else h&&(f.value={brand:"",model:"",year:new Date().getFullYear(),price:null,requestType:"Quotation",requestMessage:"",image:"",dealership:"",fuelType:"",gearType:"",kilometers:null})});const c=A(()=>f.value.brand.trim()&&f.value.model.trim()&&f.value.year>1900),w=()=>{if(!c.value)return;const h={brand:f.value.brand.trim(),model:f.value.model.trim(),year:f.value.year,requestType:f.value.requestType};f.value.price&&(h.price=f.value.price),f.value.requestMessage&&(h.requestMessage=f.value.requestMessage.trim()),f.value.image&&(h.image=f.value.image.trim()),f.value.dealership&&(h.dealership=f.value.dealership.trim()),f.value.fuelType&&(h.fuelType=f.value.fuelType),f.value.gearType&&(h.gearType=f.value.gearType),f.value.kilometers!==null&&(h.kilometers=f.value.kilometers),C("save",h)};return(h,d)=>(s(),P(a(Jt),{open:t.show,"onUpdate:open":j},{default:k(()=>[l(a(Wt),null,{default:k(()=>[l(a(Ht),{class:"fixed inset-0 z-50 bg-black/50"}),l(a(Yt),{class:"w-full sm:max-w-2xl max-h-[calc(100vh-4rem)] flex flex-col"},{default:k(()=>[l(a(Gt),{class:"flex-shrink-0"},{default:k(()=>[l(a(Kt),null,{default:k(()=>{var i;return[q(m((i=t.task)!=null&&i.requestedCar?"Edit Requested Car":"Add Requested Car"),1)]}),_:1})]),_:1}),e("div",Yd,[e("div",Gd,[l(a(J),{class:"block text-sm font-semibold text-foreground"},{default:k(()=>[...d[13]||(d[13]=[q("Brand ",-1),e("span",{class:"text-brand-red"},"*",-1)])]),_:1}),l(a(le),{modelValue:f.value.brand,"onUpdate:modelValue":d[0]||(d[0]=i=>f.value.brand=i),type:"text",required:"",placeholder:"e.g., BMW, Mercedes-Benz, Audi",class:"w-full h-10"},null,8,["modelValue"])]),e("div",Kd,[l(a(J),{class:"block text-sm font-semibold text-foreground"},{default:k(()=>[...d[14]||(d[14]=[q("Model ",-1),e("span",{class:"text-brand-red"},"*",-1)])]),_:1}),l(a(le),{modelValue:f.value.model,"onUpdate:modelValue":d[1]||(d[1]=i=>f.value.model=i),type:"text",required:"",placeholder:"e.g., 3 Series, C-Class, A4",class:"w-full h-10"},null,8,["modelValue"])]),e("div",Qd,[l(a(J),{class:"block text-sm font-semibold text-foreground"},{default:k(()=>[...d[15]||(d[15]=[q("Year ",-1),e("span",{class:"text-brand-red"},"*",-1)])]),_:1}),l(a(le),{modelValue:f.value.year,"onUpdate:modelValue":d[2]||(d[2]=i=>f.value.year=i),modelModifiers:{number:!0},type:"number",required:"",min:"1900",max:new Date().getFullYear()+1,placeholder:"e.g., 2024",class:"w-full h-10"},null,8,["modelValue","max"])]),e("div",Jd,[l(a(J),{class:"block text-sm font-semibold text-foreground"},{default:k(()=>[...d[16]||(d[16]=[q("Price (Optional)",-1)])]),_:1}),e("div",Zd,[d[17]||(d[17]=e("span",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground"},"€",-1)),l(a(le),{modelValue:f.value.price,"onUpdate:modelValue":d[3]||(d[3]=i=>f.value.price=i),modelModifiers:{number:!0},type:"number",min:"0",step:"1000",placeholder:"45000",class:"w-full h-10 pl-8"},null,8,["modelValue"])])]),e("div",Xd,[l(a(J),{class:"block text-sm font-semibold text-foreground"},{default:k(()=>[...d[18]||(d[18]=[q("Request Type",-1)])]),_:1}),l(a(st),{modelValue:f.value.requestType,"onUpdate:modelValue":d[4]||(d[4]=i=>f.value.requestType=i)},{default:k(()=>[l(a(Xe),{class:"w-full h-10"},{default:k(()=>[l(a(et),{placeholder:"Select request type..."})]),_:1}),l(a(tt),null,{default:k(()=>[l(a(ae),{value:"Quotation"},{default:k(()=>[...d[19]||(d[19]=[q("Quotation",-1)])]),_:1}),l(a(ae),{value:"Test Drive"},{default:k(()=>[...d[20]||(d[20]=[q("Test Drive",-1)])]),_:1}),l(a(ae),{value:"Generic Sales"},{default:k(()=>[...d[21]||(d[21]=[q("Generic Sales",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),e("div",eu,[l(a(J),{class:"block text-sm font-semibold text-foreground"},{default:k(()=>[...d[22]||(d[22]=[q("Request Message (Optional)",-1)])]),_:1}),l(a(An),{modelValue:f.value.requestMessage,"onUpdate:modelValue":d[5]||(d[5]=i=>f.value.requestMessage=i),rows:"5",placeholder:"Customer's message or notes about the vehicle request...",class:"w-full min-h-[120px] resize-none"},null,8,["modelValue"])]),e("div",tu,[l(a(J),{class:"block text-sm font-semibold text-foreground"},{default:k(()=>[...d[23]||(d[23]=[q("Image URL (Optional)",-1)])]),_:1}),l(a(le),{modelValue:f.value.image,"onUpdate:modelValue":d[6]||(d[6]=i=>f.value.image=i),type:"url",placeholder:"https://example.com/car-image.jpg",class:"w-full h-10"},null,8,["modelValue"]),d[24]||(d[24]=e("p",{class:"text-xs text-muted-foreground mt-1"},"Enter a URL to an image of the vehicle",-1))]),e("div",su,[e("button",{type:"button",onClick:d[7]||(d[7]=i=>$.value=!$.value),class:"flex items-center gap-2 text-sm font-medium text-muted-foreground hover:text-foreground transition-colors"},[e("i",{class:z(["fa-solid",$.value?"fa-chevron-down":"fa-chevron-right"])},null,2),d[25]||(d[25]=q(" Advanced Details (Optional) ",-1))]),$.value?(s(),n("div",au,[e("div",nu,[l(a(J),{class:"block text-sm font-semibold text-foreground"},{default:k(()=>[...d[26]||(d[26]=[q("Dealership",-1)])]),_:1}),l(a(le),{modelValue:f.value.dealership,"onUpdate:modelValue":d[8]||(d[8]=i=>f.value.dealership=i),type:"text",placeholder:"e.g., Milano, Berlin",class:"w-full h-10"},null,8,["modelValue"])]),e("div",lu,[l(a(J),{class:"block text-sm font-semibold text-foreground"},{default:k(()=>[...d[27]||(d[27]=[q("Fuel Type",-1)])]),_:1}),l(a(st),{modelValue:f.value.fuelType,"onUpdate:modelValue":d[9]||(d[9]=i=>f.value.fuelType=i)},{default:k(()=>[l(a(Xe),{class:"w-full h-10"},{default:k(()=>[l(a(et),{placeholder:"Select fuel type"})]),_:1}),l(a(tt),null,{default:k(()=>[l(a(ae),{value:"Petrol"},{default:k(()=>[...d[28]||(d[28]=[q("Petrol",-1)])]),_:1}),l(a(ae),{value:"Diesel"},{default:k(()=>[...d[29]||(d[29]=[q("Diesel",-1)])]),_:1}),l(a(ae),{value:"Electric"},{default:k(()=>[...d[30]||(d[30]=[q("Electric",-1)])]),_:1}),l(a(ae),{value:"Hybrid"},{default:k(()=>[...d[31]||(d[31]=[q("Hybrid",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),e("div",ou,[l(a(J),{class:"block text-sm font-semibold text-foreground"},{default:k(()=>[...d[32]||(d[32]=[q("Gear Type",-1)])]),_:1}),l(a(st),{modelValue:f.value.gearType,"onUpdate:modelValue":d[10]||(d[10]=i=>f.value.gearType=i)},{default:k(()=>[l(a(Xe),{class:"w-full h-10"},{default:k(()=>[l(a(et),{placeholder:"Select gear type"})]),_:1}),l(a(tt),null,{default:k(()=>[l(a(ae),{value:"Manual"},{default:k(()=>[...d[33]||(d[33]=[q("Manual",-1)])]),_:1}),l(a(ae),{value:"Automatic"},{default:k(()=>[...d[34]||(d[34]=[q("Automatic",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),e("div",iu,[l(a(J),{class:"block text-sm font-semibold text-foreground"},{default:k(()=>[...d[35]||(d[35]=[q("Kilometers",-1)])]),_:1}),l(a(le),{modelValue:f.value.kilometers,"onUpdate:modelValue":d[11]||(d[11]=i=>f.value.kilometers=i),modelModifiers:{number:!0},type:"number",min:"0",placeholder:"e.g., 50000",class:"w-full h-10"},null,8,["modelValue"])])])):u("",!0)])]),l(a(Qt),{class:"flex-shrink-0 flex flex-col sm:flex-row justify-end items-stretch sm:items-center gap-3"},{default:k(()=>{var i;return[l(a(U),{label:"Cancel",variant:"outline",size:"small",class:"rounded-sm w-full sm:w-auto",onClick:d[12]||(d[12]=x=>h.$emit("close"))}),l(a(U),{label:(i=t.task)!=null&&i.requestedCar?"Update Car":"Add Car",variant:"primary",size:"small",class:"rounded-sm w-full sm:w-auto !bg-brand-red !hover:bg-brand-red-dark !text-white !border-brand-red",disabled:!c.value,onClick:w},null,8,["label","disabled"])]}),_:1})]),_:1})]),_:1})]),_:1},8,["open"]))}},du={class:"flex-1 overflow-y-auto px-6 py-4 w-full space-y-6"},uu={class:"space-y-2"},cu={key:0,class:"space-y-2"},mu={class:"flex flex-wrap gap-2"},fu=["onClick"],vu={__name:"AddTagModal",props:{show:{type:Boolean,required:!0},existingTags:{type:Array,default:()=>[]}},emits:["close","add"],setup(t,{emit:o}){const v=t,C=o,j=E(""),$=c=>{c||C("close")};De(()=>v.show,c=>{c&&(j.value="")});const f=()=>{const c=j.value.trim();c&&(v.existingTags.includes(c)||(C("add",c),j.value=""))};return(c,w)=>(s(),P(a(Jt),{open:t.show,"onUpdate:open":$},{default:k(()=>[l(a(Wt),null,{default:k(()=>[l(a(Ht),{class:"fixed inset-0 z-50 bg-black/50"}),l(a(Yt),{class:"w-full sm:max-w-md max-h-[calc(100vh-4rem)] flex flex-col"},{default:k(()=>[l(a(Gt),{class:"flex-shrink-0"},{default:k(()=>[l(a(Kt),null,{default:k(()=>[...w[2]||(w[2]=[q("Add Tag",-1)])]),_:1})]),_:1}),e("div",du,[e("div",uu,[l(a(J),{class:"block text-sm font-semibold text-foreground"},{default:k(()=>[...w[3]||(w[3]=[q("Tag Name",-1)])]),_:1}),l(a(le),{modelValue:j.value,"onUpdate:modelValue":w[0]||(w[0]=h=>j.value=h),onKeyup:vn(f,["enter"]),type:"text",placeholder:"Enter tag name",class:"w-full h-10",autofocus:""},null,8,["modelValue"])]),t.existingTags.length>0?(s(),n("div",cu,[l(a(J),{class:"block text-sm font-semibold text-foreground"},{default:k(()=>[...w[4]||(w[4]=[q("Existing Tags",-1)])]),_:1}),e("div",mu,[(s(!0),n(G,null,Z(t.existingTags,h=>(s(),n("button",{key:h,onClick:d=>j.value=h,class:"px-3 py-1 bg-blue-50 border border-blue-100 text-blue-700 rounded-lg text-sm font-medium hover:bg-blue-100 transition-colors"},m(h),9,fu))),128))])])):u("",!0)]),l(a(Qt),{class:"flex-shrink-0 flex flex-col sm:flex-row justify-end items-stretch sm:items-center gap-3"},{default:k(()=>[l(a(U),{label:"Cancel",variant:"outline",size:"small",class:"rounded-sm w-full sm:w-auto",onClick:w[1]||(w[1]=h=>c.$emit("close"))}),l(a(U),{label:"Add Tag",variant:"primary",size:"small",class:"rounded-sm w-full sm:w-auto !bg-brand-red !hover:bg-brand-red-dark !text-white !border-brand-red",disabled:!j.value.trim(),onClick:f},null,8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]))}},Ut={note:"data",communication:"communication",email:"communication",call:"communication",sms:"communication",whatsapp:"communication",attachment:"attachment",document:"attachment",file:"attachment",tradein:"tradein","trade-in":"tradein",financing:"financing",offer:"offers",purchase:"offers",appointment:"appointments",survey:"surveys",default:"overview"};function pu(t){if(!t)return Ut.default;const o=t.toLowerCase().trim();return Ut[o]||Ut.default}function yu({store:t,taskId:o,getTabForItemType:v,isOverviewModalAction:C}){const j=E(null),$=E(null),f=E("overview"),c=E(null),w=E([]);De(f,()=>{j.value=null,$.value=null});const h=A(()=>{var r;return[...((r=t.currentActivities)==null?void 0:r.value)||[],...(w.value||[]).filter(g=>g!=null&&!g.activityId)].filter(g=>g!=null&&g.id!=null&&g.type!=null).filter(g=>{const y=v(g.type);return f.value==="overview"?y==="overview":y===f.value}).sort((g,y)=>{const V=new Date(g.timestamp||0);return new Date(y.timestamp||0)-V})}),d=p=>($.value=null,f.value==="overview"&&C&&C(p)?{type:"overview-modal",action:p}:(["email","sms","whatsapp","call"].includes(p)?(c.value=p,j.value="communication"):j.value=p,null)),i=async p=>{var r;if(p.isEdit){const g=w.value.findIndex(y=>y.id===p.id);g>-1&&(w.value[g]={...w.value[g],...p}),(r=$.value)!=null&&r.activityId&&await t.updateActivity(o.value,$.value.activityId,{type:p.communicationType||p.type,user:"You",action:p.action,content:p.content,fileName:p.fileName,data:p.data})}else{const g=p.communicationType||p.type,y=await t.addActivity(o.value,{type:g,user:"You",action:p.action,content:p.content,fileName:p.fileName,data:p.data});w.value.push({id:y.id,type:g==="email"||g==="whatsapp"||g==="sms"?"communication":g,action:p.action,content:p.content,fileName:p.fileName,data:p.data,timestamp:y.timestamp,activityId:y.id})}j.value=null,$.value=null},x=()=>{j.value=null,$.value=null},D=p=>{v(p.type)&&(j.value=p.type==="email"||p.type==="whatsapp"||p.type==="sms"||p.type==="communication"?"communication":p.type,$.value=p)},I=async p=>{try{await t.deleteActivity(o.value,p)}catch(r){throw console.error("Error deleting item:",r),r}};return{activeTab:f,showInlineWidget:j,inlineWidgetType:A(()=>j.value),editingItem:$,isEditing:A(()=>$.value!==null),communicationType:c,inlineContent:w,filteredInlineContent:h,handleAddNewAction:d,handleWidgetSave:i,handleWidgetCancel:x,handleEditItem:D,handleDeleteItem:I}}const gu={class:"flex-1 flex flex-col overflow-hidden h-full"},xu={key:1,class:"flex-1 flex flex-row overflow-hidden"},hu={class:"flex-1 flex flex-col overflow-hidden min-w-0"},bu={class:"flex-1 overflow-y-auto p-4 md:p-8 scrollbar-hide"},ku={class:"mb-4 -mt-1 pb-2"},wu={key:0},$u={key:0},Cu={key:1,class:"mb-6"},Au={key:2,class:"space-y-4 mb-6 px-1"},Su={key:1},Iu={key:0},Tu={key:1},Du={class:"relative flex items-center py-1 mb-4"},ju={class:"relative mx-4"},Vu={key:0,class:"animate-fade-in relative bg-surface border border-border rounded-xl p-5 shadow-nsc-card mb-6"},qu={class:"flex justify-between items-center mb-4"},Mu={key:0,class:"space-y-4 mb-6 px-1"},Lu={class:"hidden lg:flex flex-col overflow-hidden border-l border-border shrink-0 w-80 h-full"},Ou={key:2,class:"flex-1 flex flex-row overflow-hidden"},Nu={class:"flex-1 flex flex-col overflow-hidden min-w-0"},Eu={class:"flex-1 overflow-y-auto p-4 md:p-8 scrollbar-hide"},Pu={key:0,class:"grid grid-cols-1 lg:grid-cols-[80%_20%] gap-6 items-start"},Ru={class:"space-y-6"},Fu={key:0},Uu={key:0,class:"lg:col-span-1 space-y-6"},Bu={key:1,class:"grid grid-cols-1 lg:grid-cols-2 gap-6 items-start"},_u={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 lg:col-span-2"},zu={class:"rounded-lg flex flex-col bg-muted"},Wu={class:"bg-white rounded-lg p-4 shadow-nsc-card flex flex-col flex-1 min-h-0"},Hu={class:"relative flex-1 min-h-0"},Yu={key:0,class:"absolute left-5 top-0 bottom-0 w-0.5 bg-border z-0"},Gu={key:1,class:"text-center py-6 text-muted-foreground"},Ku={key:2,class:"space-y-6 h-full overflow-y-auto pr-2"},Qu={key:1,class:"flex-1 min-w-0"},Ju={class:"text-sm text-muted-foreground leading-snug"},Zu={class:"font-bold"},Xu={key:0,class:"mt-2 bg-orange-50/50 border border-orange-100 p-3 rounded-lg text-sm text-muted-foreground"},ec={class:"text-xs text-muted-foreground mt-1"},tc={key:2},sc={key:0,class:"space-y-4 mt-4"},ac={key:1,class:"text-center py-12 text-muted-foreground"},nc={__name:"EntityDetailLayout",props:{task:{type:Object,required:!0},type:{type:String,required:!0},managementWidget:{type:Object,required:!0},storeAdapter:{type:Object,required:!0},addNewConfig:{type:Object,required:!0},showCloseButton:{type:Boolean,default:!1}},emits:["car-added","convert-to-lead","convert-to-opportunity","tag-updated","appointment-created","close"],setup(t,{emit:o}){const v=t,C=o,j=pn(),$=je(),f=en(),c=Un(),w=A(()=>v.task.id),h=A(()=>j.path.startsWith("/tasks")&&!j.path.startsWith("/customer")),d=E("manage"),i=[{key:"manage",label:"Manage"},{key:"request",label:"Request"},{key:"data",label:"Note"}];E(!1);const x=E(null),D=E(null),I=["note","attachment","tradein","purchase"],p=A(()=>{var ue,he;const b=[],S=new Set,_=["note","attachment","tradein","purchase","purchase-method","financing"];return(he=(ue=v.storeAdapter)==null?void 0:ue.currentActivities)!=null&&he.value&&v.storeAdapter.currentActivities.value.filter(Q=>Q!=null&&Q.id!=null&&_.includes(Q==null?void 0:Q.type)).forEach(Q=>{S.has(Q.id)||(S.add(Q.id),b.push(Q))}),v.task.activities&&v.task.activities.filter(Q=>Q!=null&&Q.id!=null&&_.includes(Q==null?void 0:Q.type)).forEach(Q=>{S.has(Q.id)||(S.add(Q.id),b.push(Q))}),(Ce.value||[]).filter(M=>M!=null&&M.id!=null&&_.includes(M==null?void 0:M.type)).forEach(M=>{S.has(M.id)||(S.add(M.id),b.push(M))}),b.filter(M=>M!=null&&M.id!=null).sort((M,Q)=>{const Re=new Date(M.timestamp||0);return new Date(Q.timestamp||0)-Re})}),r=b=>{D.value=null,x.value=b},g=async b=>{try{await v.storeAdapter.addActivity(v.task.id,{type:b.type,action:b.action,content:b.content,data:b.data,fileName:b.fileName,timestamp:b.timestamp||new Date().toISOString()}),Ce.value.push({id:b.id||Date.now(),type:b.type,action:b.action,content:b.content,data:b.data,fileName:b.fileName,timestamp:b.timestamp||new Date().toISOString()}),x.value=null,D.value=null}catch(S){console.error("Error saving enrich data:",S)}},y=()=>{x.value=null,D.value=null},V=b=>{D.value=b,x.value=b.type==="purchase-method"?"purchase":b.type},Y=async b=>{try{await v.storeAdapter.deleteActivity(v.task.id,b.id);const S=Ce.value.findIndex(_=>_.id===b.id);S!==-1&&Ce.value.splice(S,1)}catch(S){console.error("Error deleting enrich item:",S)}};A(()=>v.task.activities?v.task.activities.filter(b=>b.type==="note"):[]),A(()=>v.task.activities?v.task.activities.filter(b=>["email","call","sms","whatsapp"].includes(b.type)):[]),A(()=>v.task.activities?v.task.activities.filter(b=>b.type==="attachment"):[]),A(()=>v.task.activities?v.task.activities.filter(b=>b.type==="purchase"):[]),A(()=>v.task.activities?v.task.activities.filter(b=>b.type==="tradein"):[]);const ee=A(()=>v.type==="contact"?"bg-blue-100 text-blue-600":v.type==="lead"?"bg-orange-100 text-orange-600":"bg-purple-100 text-purple-600"),se=E(j.path.startsWith("/tasks")&&!j.path.startsWith("/customer"));De(()=>j.path,b=>{se.value=b.startsWith("/tasks")&&!b.startsWith("/customer")});const X=()=>{$.push({path:`/customer/${v.task.id}`,query:{type:v.type}})};async function ne(b){var vt,pt;const S=((vt=v.task.customer)==null?void 0:vt.id)??v.task.id,_=b.time||"10:00",K=_.length===5?`${_}:00`:_,ie=`${b.date}T${K}`,[ue,he]=_.split(":").map(Number),M=ue+1,Q=`${b.date}T${String(M).padStart(2,"0")}:${String(he||0).padStart(2,"0")}:00`;let Re=null,Fe="user",ft=null,Qe="",Je=null;if(b.assignee){if(b.assignee.startsWith("user-")){const Se=parseInt(b.assignee.replace("user-",""),10),Ie=c.getUserById(Se);Re=Se,Fe="user",Qe=(Ie==null?void 0:Ie.name)||""}else if(b.assignee.startsWith("team-")){const Se=parseInt(b.assignee.replace("team-",""),10),Ie=c.getTeamById(Se);ft=Se,Fe="team",Je=(Ie==null?void 0:Ie.name)||"",Qe=Je}}const Lt={type:b.type,title:b.title||`${b.type} - ${b.customer||"Customer"}`,customer:b.customer||((pt=v.task.customer)==null?void 0:pt.name)||"",customerId:S,start:ie,end:Q,assignee:Qe,assigneeId:Re,assigneeType:Fe,teamId:ft,team:Je,dealership:b.dealership||"",status:"confirmed"};try{await _n(Lt)}catch(Se){console.error("Failed to create appointment:",Se);return}T.value=!1,F.value=!1,C("appointment-created")}const L=()=>{O.value=!0},te=async b=>{var _,K,ie,ue;const S=b.name;v.type==="lead"?await((K=(_=v.storeAdapter).updateLead)==null?void 0:K.call(_,v.task.id,{assignee:S,assigneeType:b.type,teamId:b.type==="team"?b.id:null})):v.type==="opportunity"&&await((ue=(ie=v.storeAdapter).updateOpportunity)==null?void 0:ue.call(ie,v.task.id,{assignee:S,assigneeType:b.type,teamId:b.type==="team"?b.id:null})),O.value=!1},ge=()=>{xe.value=!0},$e=async b=>{var S,_,K,ie;try{v.type==="lead"?await((_=(S=v.storeAdapter).updateLead)==null?void 0:_.call(S,v.task.id,{requestedCar:b})):v.type==="opportunity"&&await((ie=(K=v.storeAdapter).updateOpportunity)==null?void 0:ie.call(K,v.task.id,{requestedCar:b})),xe.value=!1}catch(ue){console.error("Error saving requested car:",ue)}},de=E(!1),W=E(null),T=E(!1),F=E(!1),O=E(!1),N=E(!1),xe=E(!1),be=E([]),ke=E(!1),We=E(!1),Pe=E(!1),He=E(!1),Ye=E(!1),it=E(!1),R=E({}),{activeTab:H,showInlineWidget:B,editingItem:ve,communicationType:we,inlineContent:Ce,filteredInlineContent:pe,handleAddNewAction:Ge,handleWidgetSave:Ae,handleWidgetCancel:Le,handleEditItem:Ve,handleDeleteItem:oe}=yu({store:v.storeAdapter,taskId:w,getTabForItemType:pu,isOverviewModalAction:b=>H.value==="overview"&&v.addNewConfig.overviewActions.includes(b)});De(()=>v.task.id,()=>{H.value="overview"}),De(H,b=>{b!=="appointments"&&(F.value=!1)});const ye=A(()=>new Date().toISOString().slice(0,10));ht(async()=>{if(!h.value)try{const b=await Bn();be.value=b.dealerships||[]}catch(b){console.error("Failed to fetch calendar filter options:",b)}});const rt=()=>{h.value?d.value="request":H.value="overview"},Ke=b=>{const S=Ge(b);S&&S.modalAction&&(W.value=S.modalAction,de.value=!0)},dt=b=>{if(b==="appointment"){T.value=!0;return}if(b==="call"){it.value=!0;return}if(b==="note"){ke.value=!0;return}if(b==="attachment"){We.value=!0;return}if(b==="whatsapp"){Pe.value=!0;return}if(b==="sms"){He.value=!0;return}if(b==="email"){Ye.value=!0;return}const S={call:"communication",appointment:"overview"};if(["financing","tradein","purchase"].includes(b))W.value=b,de.value=!0;else{const _=S[b];_?(H.value=_,setTimeout(()=>{Ke(b),setTimeout(()=>{try{const K=document.querySelector(".animate-fade-in");K&&K.parentNode&&K.scrollIntoView({behavior:"smooth",block:"start"})}catch{}},100)},50)):Ke(b)}},qe=()=>{de.value=!1,W.value=null},bt=async b=>{var S,_;try{const K=b.type==="FIN"?"Captive Financing":b.type==="LEA"?"Leasing":"Long-Term Rental",ie=((S=b.fields)==null?void 0:S.monthlyInstalment)||0;await Ae({type:"purchase-method",action:`added a ${K} purchase method`,content:`${K}: €${ie.toLocaleString()}/month for ${((_=b.fields)==null?void 0:_.duration)||0} months`,data:{purchaseMethodId:b.id,type:b.type,...b.fields}}),qe()}catch(K){console.error("Error saving purchase method:",K)}},ut=async b=>{if(W.value==="tradein")try{const{saveTradeInVehicle:S}=On(),_=await S(v.type,v.task.id,b.vehicle,b.valuation||{});Ce.value.push({id:_.activity.id,type:"tradein",action:"added a trade-in",vehicleId:_.vehicle.id,data:_.activity.data,timestamp:_.activity.timestamp,activityId:_.activity.id}),qe()}catch(S){console.error("Error saving trade-in:",S)}else W.value==="purchase"&&(await Ae(b),qe())},kt=async b=>{try{await v.storeAdapter.addActivity(v.task.id,{type:"note",content:b.content||b.message,message:b.content||b.message,timestamp:new Date().toISOString()}),ke.value=!1}catch(S){console.error("Error saving note:",S)}},wt=async b=>{try{await v.storeAdapter.addActivity(v.task.id,{type:"attachment",fileName:b.fileName,file:b.file,content:`Attachment: ${b.fileName}`,timestamp:new Date().toISOString()}),We.value=!1}catch(S){console.error("Error saving attachment:",S)}},$t=async b=>{try{await v.storeAdapter.addActivity(v.task.id,{type:"whatsapp",message:b.message,content:b.message,template:b.template,timestamp:new Date().toISOString()}),Pe.value=!1}catch(S){console.error("Error saving WhatsApp:",S)}},Ct=async b=>{try{await v.storeAdapter.addActivity(v.task.id,{type:"sms",message:b.message,content:b.message,template:b.template,timestamp:new Date().toISOString()}),He.value=!1}catch(S){console.error("Error saving SMS:",S)}},At=async b=>{try{await v.storeAdapter.addActivity(v.task.id,{type:"email",subject:b.subject,message:b.message,content:b.message,template:b.template,timestamp:new Date().toISOString()}),Ye.value=!1}catch(S){console.error("Error saving email:",S)}},St=()=>{},It=b=>{R.value[b]=!R.value[b]},Tt=b=>{dt(b)},Dt=A(()=>{const b=[{key:"overview",label:"Overview"},{key:"data",label:"Note"},{key:"communication",label:"Communication"},{key:"attachment",label:"Attachments"}];return v.type==="contact"?[{key:"overview",label:"Overview"},{key:"negotiations",label:"Negotiations"},...b.slice(1),{key:"appointments",label:"Appointments"}]:b}),Me=A(()=>{var S,_;return[...((_=(S=v.storeAdapter)==null?void 0:S.currentActivities)==null?void 0:_.value)||[],...Ce.value||[]].filter(K=>K!=null&&K.id!=null)});A(()=>W.value==="financing"?"Add Financing":W.value==="tradein"?"Add Trade-in":W.value==="purchase"?"Create Purchase Offer":"");const ct=async b=>{if(v.type==="opportunity")try{await v.storeAdapter.addVehicle(v.task.id,b.vehicleData),v.storeAdapter.loadOpportunityById&&await v.storeAdapter.loadOpportunityById(v.task.id)}catch(S){console.error("Error selecting vehicle:",S)}},mt=async b=>{if(v.type==="opportunity")try{await v.storeAdapter.createOffer(v.task.id,b.offerData),v.storeAdapter.loadOpportunityById&&await v.storeAdapter.loadOpportunityById(v.task.id)}catch(S){console.error("Error creating offer:",S)}},jt=async b=>{var K,ie,ue,he;const S=v.task.tags||[];if(S.includes(b)){N.value=!1;return}const _=[...S,b];try{if(v.type==="lead")await((ie=(K=v.storeAdapter).updateLead)==null?void 0:ie.call(K,v.task.id,{tags:_})),v.storeAdapter.loadLeadById&&await v.storeAdapter.loadLeadById(v.task.id);else if(v.type==="opportunity")await((he=(ue=v.storeAdapter).updateOpportunity)==null?void 0:he.call(ue,v.task.id,{tags:_})),v.storeAdapter.loadOpportunityById&&await v.storeAdapter.loadOpportunityById(v.task.id);else if(v.type==="contact"){const M=j.query.type==="account"?"account":"contact";await f.updateCustomer(v.task.id,{tags:_},M),await f.fetchCustomerById(v.task.id,M),C("tag-updated")}N.value=!1}catch(M){console.error("Error adding tag:",M)}},Vt=b=>{const S={call:"fa-solid fa-phone text-blue-600",email:"fa-solid fa-envelope text-green-600",note:"fa-solid fa-sticky-note text-yellow-600",meeting:"fa-solid fa-calendar text-purple-600",task:"fa-solid fa-check-circle text-indigo-600",attachment:"fa-solid fa-paperclip text-muted-foreground",status:"fa-solid fa-tag text-orange-600",default:"fa-solid fa-circle text-muted-foreground"};return S[b]||S.default},qt=b=>{const S={call:"bg-blue-100 text-blue-600",email:"bg-green-100 text-green-600",note:"bg-yellow-100 text-yellow-600",meeting:"bg-purple-100 text-purple-600",task:"bg-indigo-100 text-indigo-600",attachment:"bg-muted text-muted-foreground",status:"bg-orange-100 text-orange-600",default:"bg-muted text-muted-foreground"};return S[b]||S.default},Mt=b=>b?new Date(b).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"";return(b,S)=>{var _,K,ie,ue,he;return s(),n("div",gu,[h.value?u("",!0):(s(),P(cl,{key:0,initials:t.task.customer.initials,name:t.task.customer.name,email:t.task.customer.email,phone:t.task.customer.phone,"third-field-value":t.task.customer.address,"avatar-color-class":ee.value,"task-type":t.type,"customer-id":((_=t.task.customer)==null?void 0:_.id)||t.task.customerId||t.task.id,tags:t.task.tags||[],"show-close-button":t.showCloseButton,"email-label":"Email","phone-label":"Phone","third-field-label":"Address",onAddTag:S[0]||(S[0]=M=>N.value=!0),onClose:S[1]||(S[1]=M=>b.$emit("close"))},{"name-action":k(()=>[h.value?(s(),n("button",{key:0,onClick:X,class:"w-6 h-6 flex items-center justify-center bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-lg text-blue-600 hover:text-blue-700 transition-colors shrink-0",title:"Open in new page","aria-label":"Open customer page"},[...S[24]||(S[24]=[e("i",{class:"fa-solid fa-external-link text-xs"},null,-1)])])):u("",!0)]),_:1},8,["initials","name","email","phone","third-field-value","avatar-color-class","task-type","customer-id","tags","show-close-button"])),h.value?h.value?(s(),n("div",Ou,[e("div",Nu,[e("div",Eu,[l(za,{modelValue:d.value,"onUpdate:modelValue":S[9]||(S[9]=M=>d.value=M),tabs:i,class:"mb-6"},null,8,["modelValue"]),d.value==="manage"?(s(),n("div",Pu,[e("div",Ru,[t.managementWidget?(s(),n("div",Fu,[(s(),P(at(t.managementWidget),{lead:t.type==="lead"?t.task:void 0,opportunity:t.type==="opportunity"?t.task:void 0,contact:t.type==="contact"?t.task:void 0,activities:Me.value,onCarAdded:S[10]||(S[10]=M=>b.$emit("car-added",M)),onConvertToLead:S[11]||(S[11]=M=>b.$emit("convert-to-lead")),onConvertToOpportunity:S[12]||(S[12]=M=>b.$emit("convert-to-opportunity")),onVehicleSelected:ct,onCreateOffer:mt,onViewHistory:rt},null,40,["lead","opportunity","contact","activities"]))])):u("",!0)]),t.type!=="contact"?(s(),n("div",Uu,[l(Wa,{task:t.task,"entity-type":t.type,activities:t.task.activities||[],onReassign:L,onAddRequestedCar:ge},null,8,["task","entity-type","activities"]),l(Ha,{task:t.task,"entity-type":t.type},null,8,["task","entity-type"])])):u("",!0)])):u("",!0),d.value==="request"?(s(),n("div",Bu,[e("div",_u,[t.type!=="contact"?(s(),P(Wa,{key:0,task:t.task,"entity-type":t.type,activities:t.task.activities||[],onReassign:L,onAddRequestedCar:ge},null,8,["task","entity-type","activities"])):u("",!0),l(Tn,{task:t.task,"task-type":t.type,"customer-id":((he=t.task.customer)==null?void 0:he.id)||t.task.customerId||t.task.id,onAction:dt,onAddTag:S[13]||(S[13]=M=>N.value=!0)},null,8,["task","task-type","customer-id"])]),t.type!=="contact"?(s(),P(Ha,{key:0,task:t.task,"entity-type":t.type},null,8,["task","entity-type"])):u("",!0),e("div",zu,[S[32]||(S[32]=e("div",{class:"px-4 py-4 flex items-center justify-between shrink-0"},[e("div",{class:"flex items-center gap-2"},[e("i",{class:"fa-solid fa-clock text-foreground"}),e("h2",{class:"text-sm font-semibold text-foreground leading-5"},"Activity Summary")])],-1)),e("div",Wu,[e("div",Hu,[Me.value.length>0?(s(),n("div",Yu)):u("",!0),Me.value.length===0?(s(),n("div",Gu,[...S[31]||(S[31]=[e("i",{class:"fa-solid fa-clock text-2xl mb-2"},null,-1),e("p",{class:"text-sm text-muted-foreground"},"No activities yet",-1)])])):(s(),n("div",Ku,[(s(!0),n(G,null,Z(Me.value,M=>(s(),n("div",{key:(M==null?void 0:M.id)||`activity-${(M==null?void 0:M.timestamp)||Date.now()}`,class:"flex gap-4 relative"},[M&&M.type?(s(),n("div",{key:0,class:z(["w-10 h-10 rounded-full flex items-center justify-center shrink-0 z-10 relative bg-surface",qt(M.type)])},[e("i",{class:z([Vt(M.type),"text-sm"])},null,2)],2)):u("",!0),M?(s(),n("div",Qu,[e("div",Ju,[e("span",Zu,m(M.user),1),q(" "+m(M.action),1)]),M.content?(s(),n("div",Xu,m(M.content),1)):u("",!0),e("div",ec,m(Mt(M.timestamp)),1)])):u("",!0)]))),128))]))])])])])):u("",!0),d.value==="data"?(s(),n("div",tc,[l(Ya,{actions:I,"active-tab":"data",onAction:r}),e("div",null,[x.value==="note"?(s(),P(Pt,{key:0,item:D.value,"task-type":t.type,"task-id":t.task.id,onSave:g,onCancel:y},null,8,["item","task-type","task-id"])):u("",!0),x.value==="attachment"?(s(),P(Rt,{key:1,item:D.value,"task-type":t.type,"task-id":t.task.id,onSave:g,onCancel:y},null,8,["item","task-type","task-id"])):u("",!0),x.value==="tradein"?(s(),P(id,{key:2,item:D.value,"task-type":t.type,"task-id":t.task.id,onSave:g,onCancel:y},null,8,["item","task-type","task-id"])):u("",!0),x.value==="purchase"?(s(),P(Hd,{key:3,item:D.value,"task-type":t.type,"task-id":t.task.id,onSave:g,onCancel:y},null,8,["item","task-type","task-id"])):u("",!0)]),p.value.length>0?(s(),n("div",sc,[(s(!0),n(G,null,Z(p.value,M=>{var Q;return s(),P(Ft,{key:(M==null?void 0:M.id)||`enrich-${(M==null?void 0:M.timestamp)||Date.now()}`,item:M,"task-type":t.type,"customer-initials":((Q=t.task.customer)==null?void 0:Q.initials)||"SK",onEdit:V,onDelete:Y},null,8,["item","task-type","customer-initials"])}),128))])):x.value?u("",!0):(s(),n("div",ac,[...S[33]||(S[33]=[e("i",{class:"fa-solid fa-folder-open text-4xl mb-3"},null,-1),e("p",{class:"text-sm text-muted-foreground"},"No enrichment data yet",-1),e("p",{class:"text-xs text-muted-foreground mt-1"},"Click the + button above to add notes, attachments, trade-ins, or purchase methods",-1)])]))])):u("",!0)])])])):u("",!0):(s(),n("div",xu,[e("div",hu,[e("main",bu,[e("div",ku,[l(za,{modelValue:a(H),"onUpdate:modelValue":S[2]||(S[2]=M=>yn(H)?H.value=M:null),tabs:Dt.value,class:"mb-0"},null,8,["modelValue","tabs"])]),a(H)==="overview"?(s(),n("div",wu,[t.type!=="contact"?(s(),n("div",$u,[l(po,{stage:t.task.displayStage||t.task.stage,owner:t.task.assignee,source:t.task.source||"","delivery-substatus":t.task.deliverySubstatus,activities:t.task.activities||[],"entity-type":t.type,"request-type":t.task.requestType||((K=t.task.requestedCar)==null?void 0:K.requestType)||"","request-message":((ie=t.task.requestedCar)==null?void 0:ie.requestMessage)||"","requested-car":t.task.requestedCar,task:t.task,onReassign:L},null,8,["stage","owner","source","delivery-substatus","activities","entity-type","request-type","request-message","requested-car","task"])])):u("",!0),Et(b.$slots,"pinned-extra",{task:t.task}),t.managementWidget?(s(),n("div",Cu,[(s(),P(at(t.managementWidget),{lead:t.type==="lead"?t.task:void 0,opportunity:t.type==="opportunity"?t.task:void 0,contact:t.type==="contact"?t.task:void 0,activities:Me.value,onCarAdded:S[3]||(S[3]=M=>b.$emit("car-added",M)),onConvertToLead:S[4]||(S[4]=M=>b.$emit("convert-to-lead")),onConvertToOpportunity:S[5]||(S[5]=M=>b.$emit("convert-to-opportunity")),onViewHistory:rt,onVehicleSelected:ct,onCreateOffer:mt},null,40,["lead","opportunity","contact","activities"]))])):u("",!0),a(pe).length>0?(s(),n("div",Au,[(s(!0),n(G,null,Z(a(pe),M=>(s(),P(Ft,{key:(M==null?void 0:M.id)||`feed-${(M==null?void 0:M.timestamp)||Date.now()}`,item:M,"task-type":t.type,"customer-initials":"SK",onEdit:a(Ve),onDelete:a(oe)},null,8,["item","task-type","onEdit","onDelete"]))),128))])):u("",!0)])):(s(),n("div",Su,[t.type==="contact"&&a(H)==="negotiations"?(s(),n("div",Iu,[Et(b.$slots,"tab-negotiations")])):t.type==="contact"&&a(H)==="appointments"?(s(),n("div",Tu,[e("div",Du,[S[26]||(S[26]=e("div",{class:"flex-grow border-t border"},null,-1)),e("div",ju,[F.value?u("",!0):(s(),n("button",{key:0,onClick:S[6]||(S[6]=Te(M=>F.value=!0,["stop"])),class:"bg-surface hover:bg-muted text-muted-foreground font-medium rounded-full text-sm shadow-sm transition-all flex items-center justify-center px-4 py-2 h-9 border border-border"},[...S[25]||(S[25]=[e("i",{class:"fa-solid fa-plus text-xs text-muted-foreground"},null,-1),e("span",{class:"ml-1.5 text-muted-foreground"},"add appointment",-1)])]))]),S[27]||(S[27]=e("div",{class:"flex-grow border-t border"},null,-1))]),F.value?(s(),n("div",Vu,[S[30]||(S[30]=e("div",{class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-surface border-t border-l border-border rotate-45"},null,-1)),e("div",qu,[S[29]||(S[29]=e("h5",{class:"text-sm font-semibold text-foreground"},"Add Appointment",-1)),e("button",{type:"button",onClick:S[7]||(S[7]=M=>F.value=!1),class:"text-muted-foreground hover:text-muted-foreground"},[...S[28]||(S[28]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),(s(),P(Rn,{key:"inline-appointment",customer:t.task.customer,assignee:t.task.assignee,"disabled-fields":["customer"],"initial-date":ye.value,dealerships:be.value,"show-actions":!0,"reset-trigger":F.value,onCreate:ne,onCancel:S[8]||(S[8]=M=>F.value=!1)},null,8,["customer","assignee","initial-date","dealerships","reset-trigger"]))])):u("",!0),Et(b.$slots,"tab-appointments")])):(s(),n(G,{key:2},[l(Ya,{actions:t.addNewConfig.tabActions,"active-tab":a(H),onAction:Ke},null,8,["actions","active-tab"]),e("div",null,[a(B)==="communication"?(s(),P(Gr,{key:0,type:a(we),"task-type":t.type,"task-id":t.task.id,"phone-number":((ue=t.task.customer)==null?void 0:ue.phone)||"",item:a(ve),onSave:a(Ae),onCancel:a(Le)},null,8,["type","task-type","task-id","phone-number","item","onSave","onCancel"])):u("",!0),a(H)==="data"&&a(B)==="note"?(s(),P(Pt,{key:1,item:a(ve),"task-type":t.type,"task-id":t.task.id,onSave:a(Ae),onCancel:a(Le)},null,8,["item","task-type","task-id","onSave","onCancel"])):u("",!0),a(B)==="attachment"?(s(),P(Rt,{key:2,item:a(ve),"task-type":t.type,"task-id":t.task.id,onSave:a(Ae),onCancel:a(Le)},null,8,["item","task-type","task-id","onSave","onCancel"])):u("",!0)]),a(pe).length>0?(s(),n("div",Mu,[(s(!0),n(G,null,Z(a(pe),M=>(s(),P(Ft,{key:(M==null?void 0:M.id)||`feed-${(M==null?void 0:M.timestamp)||Date.now()}`,item:M,"task-type":t.type,"customer-initials":"SK",onEdit:a(Ve),onDelete:a(oe)},null,8,["item","task-type","onEdit","onDelete"]))),128))])):u("",!0)],64))]))])]),e("div",Lu,[l(In,{activities:Me.value,"expanded-summaries":R.value,onActivityClick:St,onToggleSummaryExpanded:It,onAddActivity:Tt},null,8,["activities","expanded-summaries"])])])),l(Dn,{show:W.value==="financing"&&de.value,"task-type":t.type,"task-id":t.task.id,onSave:bt,onClose:qe},null,8,["show","task-type","task-id"]),l(jn,{show:W.value==="tradein"&&de.value,mode:"tradein",item:null,"task-type":t.type,"task-id":t.task.id,onSave:ut,onClose:qe},null,8,["show","task-type","task-id"]),l(Vn,{show:W.value==="purchase"&&de.value,item:null,"task-type":t.type,"task-id":t.task.id,"requested-car":t.type==="lead"?t.task.requestedCar:null,customer:t.task.customer,"recommended-cars":[],onSave:ut,onClose:qe},null,8,["show","task-type","task-id","requested-car","customer"]),l(Pn,{show:O.value,onClose:S[14]||(S[14]=M=>O.value=!1),onConfirm:te},null,8,["show"]),l(ru,{show:xe.value,task:t.task,"task-type":t.type,"task-id":t.task.id,onClose:S[15]||(S[15]=M=>xe.value=!1),onSave:$e},null,8,["show","task","task-type","task-id"]),l(Pt,{modal:"",show:ke.value,"task-type":t.type,"task-id":t.task.id,onSave:kt,onClose:S[16]||(S[16]=M=>ke.value=!1)},null,8,["show","task-type","task-id"]),l(Rt,{modal:"",show:We.value,"task-type":t.type,"task-id":t.task.id,onSave:wt,onClose:S[17]||(S[17]=M=>We.value=!1)},null,8,["show","task-type","task-id"]),l(qn,{show:Pe.value,onSave:$t,onClose:S[18]||(S[18]=M=>Pe.value=!1)},null,8,["show"]),l(Mn,{show:He.value,onSave:Ct,onClose:S[19]||(S[19]=M=>He.value=!1)},null,8,["show"]),l(Ln,{show:Ye.value,onSave:At,onClose:S[20]||(S[20]=M=>Ye.value=!1)},null,8,["show"]),l(Ne,{show:it.value,title:"Call Feature",onClose:S[21]||(S[21]=M=>it.value=!1)},null,8,["show"]),T.value?(s(),P(Fn,{key:3,show:T.value,customer:t.task.customer,assignee:t.task.assignee,"disabled-fields":["customer"],dealerships:be.value,onCreate:ne,onCancel:S[22]||(S[22]=M=>T.value=!1)},null,8,["show","customer","assignee","dealerships"])):u("",!0),l(vu,{show:N.value,"existing-tags":t.task.tags||[],onClose:S[23]||(S[23]=M=>N.value=!1),onAdd:jt},null,8,["show","existing-tags"])])}}},lc={class:"flex items-center justify-between mb-4 px-1"},oc={class:"flex items-center gap-2"},ic={key:0,class:"space-y-4 mb-6 px-1"},rc=["onClick"],dc={class:"flex-1 min-w-0"},uc={class:"flex items-center gap-2 mb-1"},cc={class:"text-xs font-bold text-foreground"},mc={class:"ml-auto relative"},fc=["onClick"],vc={class:"text-sm text-muted-foreground"},pc={class:"flex flex-wrap items-center gap-x-3 gap-y-1 text-xs text-muted-foreground mb-2"},yc={key:0,class:"flex items-center gap-1"},gc={key:1,class:"flex items-center gap-1"},xc={key:0,class:"mt-2 space-y-1.5 border-t border-gray-100 pt-2"},hc={class:"flex items-center gap-2 min-w-0"},bc={class:"text-xs text-muted-foreground font-medium truncate"},kc={key:1,class:"text-center py-8 text-muted-foreground mb-6"},wc={__name:"CustomerLeadsWidget",props:{leads:{type:Array,default:()=>[]},allTasks:{type:Array,default:()=>[]}},emits:["add-lead"],setup(t,{emit:o}){const v=t,C=je(),j=w=>{if(!w)return 0;const h=new Date(w),i=Math.abs(new Date-h);return Math.ceil(i/(1e3*60*60*24))},$=w=>{const h=[];return v.allTasks&&v.allTasks.length>0&&v.allTasks.filter(i=>i.leadId===w.id).forEach(i=>{h.push({id:i.id,type:i.title||"Task",description:i.description||i.title})}),w.stage==="Open"&&j(w.createdAt)>=0&&h.push({id:`lead-${w.id}-lq`,type:"LQ",description:"Call to Verify Contact Details"}),h},f=w=>w==="Open"||w==="Validated"||w==="Contacted"?"blue":"gray",c=w=>{const h=C.resolve({path:`/tasks/${w.id}`,query:{type:"lead"}});window.open(h.href,"_blank")};return(w,h)=>(s(),n("div",null,[e("div",lc,[e("div",oc,[h[1]||(h[1]=e("i",{class:"fa-solid fa-user-circle text-foreground"},null,-1)),h[2]||(h[2]=e("h2",{class:"text-sm font-semibold text-foreground leading-5"},"Leads",-1)),l(a(ce),{text:String(t.leads.length),size:"small",theme:"blue"},null,8,["text"])]),e("button",{onClick:h[0]||(h[0]=d=>w.$emit("add-lead")),class:"text-xs text-primary hover:text-primary/80 font-medium flex items-center gap-1 transition-colors"},[...h[3]||(h[3]=[e("i",{class:"fa-solid fa-plus text-xs"},null,-1),e("span",null,"Add Lead",-1)])])]),t.leads.length>0?(s(),n("div",ic,[(s(!0),n(G,null,Z(t.leads,d=>(s(),n("div",{key:d.id,class:"bg-white border border-border rounded-xl p-4 shadow-nsc-card flex gap-4 animate-fade-in feed-item cursor-pointer transition-shadow",onClick:i=>c(d)},[h[8]||(h[8]=e("div",{class:"w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold shrink-0 border bg-orange-100 text-orange-600 border-orange-200"},[e("i",{class:"fa-solid fa-user-circle text-sm"})],-1)),e("div",dc,[e("div",uc,[e("span",cc,"Lead #"+m(d.id),1),l(a(ce),{text:d.stage,size:"small",theme:f(d.stage)},null,8,["text","theme"]),e("div",mc,[e("button",{onClick:Te(i=>c(d),["stop"]),class:"text-gray-400 hover:text-muted-foreground transition-colors p-1",title:"Open in new tab"},[...h[4]||(h[4]=[e("i",{class:"fa-solid fa-external-link text-sm"},null,-1)])],8,fc)])]),e("div",vc,[e("div",pc,[d.assignee?(s(),n("span",yc,[h[5]||(h[5]=e("i",{class:"fa-solid fa-user text-xs"},null,-1)),q(" "+m(d.assignee),1)])):u("",!0),d.requestedCar?(s(),n("span",gc,[h[6]||(h[6]=e("i",{class:"fa-solid fa-car text-xs"},null,-1)),q(" "+m(d.requestedCar.brand)+" "+m(d.requestedCar.model),1)])):u("",!0)]),$(d).length>0?(s(),n("div",xc,[(s(!0),n(G,null,Z($(d),i=>(s(),n("div",{key:i.id,class:"flex items-center justify-between p-2 bg-muted/50 border border-border rounded-md"},[e("div",hc,[l(a(ce),{text:i.type,size:"small",theme:i.type==="LQ"?"blue":"gray"},null,8,["text","theme"]),e("span",bc,m(i.description),1)]),h[7]||(h[7]=e("i",{class:"fa-solid fa-chevron-right text-xs text-muted-foreground opacity-50"},null,-1))]))),128))])):u("",!0)])])],8,rc))),128))])):(s(),n("div",kc,[...h[9]||(h[9]=[e("i",{class:"fa-solid fa-inbox text-2xl mb-2 opacity-30"},null,-1),e("p",{class:"text-xs"},"No leads associated with this customer",-1)])]))]))}},$c={class:"flex items-center justify-between mb-4 px-1"},Cc={class:"flex items-center gap-2"},Ac={key:0,class:"space-y-4 mb-6 px-1"},Sc=["onClick"],Ic={class:"flex-1 min-w-0"},Tc={class:"flex items-center gap-2 mb-1"},Dc={class:"text-xs font-bold text-foreground"},jc={class:"ml-auto relative"},Vc=["onClick"],qc={class:"text-sm text-muted-foreground"},Mc={class:"flex flex-wrap items-center gap-x-3 gap-y-1 text-xs text-muted-foreground mb-2"},Lc={key:0,class:"flex items-center gap-1"},Oc={key:1,class:"flex items-center gap-1"},Nc={key:2,class:"flex items-center gap-1"},Ec={key:0,class:"mt-2 space-y-1.5 border-t border-gray-100 pt-2"},Pc={class:"flex items-center gap-2 min-w-0"},Rc={class:"text-xs text-muted-foreground font-medium truncate"},Fc={key:1,class:"text-center py-8 text-muted-foreground mb-6"},Uc={__name:"CustomerOpportunitiesWidget",props:{opportunities:{type:Array,default:()=>[]},allTasks:{type:Array,default:()=>[]},activities:{type:Array,default:()=>[]}},emits:["add-opportunity"],setup(t,{emit:o}){const v=t,C=je(),j=h=>{const d=[];v.allTasks&&v.allTasks.length>0&&v.allTasks.filter(p=>p.opportunityId===h.id).forEach(p=>{d.push({id:p.id,type:p.title||"Task",description:p.description||p.title})});const i=v.activities.filter(I=>I.opportunityId===h.id),x={opportunity:h,scheduledAppointment:h.scheduledAppointment||null,activities:i,hasOffers:i.some(I=>I.type==="offer")||!1,stage:h.displayStage||h.stage,deliverySubstatus:h.deliverySubstatus||null},D=Nn(x.stage,x);if(D){const I={OOFB:"Open Opportunity Feedback",UFB:"Unsold Feedback",NFU:"No Follow-Up",OFB:"Offer Feedback",CFB:"Contract Feedback",DFB:"Delivery Feedback",NS:"No-Show Follow-up"};d.push({id:`opp-${h.id}-${D}`,type:D,description:I[D]||D})}return d},$=h=>({OOFB:"blue",UFB:"gray",NFU:"red",OFB:"blue",CFB:"green",DFB:"blue",NS:"red"})[h]||"gray",f=h=>h==="Qualified"||h==="In Negotiation"?"blue":h==="Closed Won"?"green":h==="Closed Lost"?"red":"gray",c=h=>new Intl.NumberFormat("en-US").format(h),w=h=>{const d=C.resolve({path:`/tasks/${h.id}`,query:{type:"opportunity"}});window.open(d.href,"_blank")};return(h,d)=>(s(),n("div",null,[e("div",$c,[e("div",Cc,[d[1]||(d[1]=e("i",{class:"fa-solid fa-briefcase text-foreground"},null,-1)),d[2]||(d[2]=e("h2",{class:"text-sm font-semibold text-foreground leading-5"},"Opportunities",-1)),l(a(ce),{text:String(t.opportunities.length),size:"small",theme:"blue"},null,8,["text"])]),e("button",{onClick:d[0]||(d[0]=i=>h.$emit("add-opportunity")),class:"text-xs text-primary hover:text-primary/80 font-medium flex items-center gap-1 transition-colors"},[...d[3]||(d[3]=[e("i",{class:"fa-solid fa-plus text-xs"},null,-1),e("span",null,"Add Opportunity",-1)])])]),t.opportunities.length>0?(s(),n("div",Ac,[(s(!0),n(G,null,Z(t.opportunities,i=>(s(),n("div",{key:i.id,class:"bg-white border border-border rounded-xl p-4 shadow-nsc-card flex gap-4 animate-fade-in feed-item cursor-pointer transition-shadow",onClick:x=>w(i)},[d[9]||(d[9]=e("div",{class:"w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold shrink-0 border bg-purple-100 text-purple-600 border-purple-200"},[e("i",{class:"fa-solid fa-briefcase text-sm"})],-1)),e("div",Ic,[e("div",Tc,[e("span",Dc,"Opp #"+m(i.id),1),l(a(ce),{text:i.displayStage||i.stage,size:"small",theme:f(i.displayStage||i.stage)},null,8,["text","theme"]),e("div",jc,[e("button",{onClick:Te(x=>w(i),["stop"]),class:"text-gray-400 hover:text-muted-foreground transition-colors p-1",title:"Open in new tab"},[...d[4]||(d[4]=[e("i",{class:"fa-solid fa-external-link text-sm"},null,-1)])],8,Vc)])]),e("div",qc,[e("div",Mc,[i.assignee?(s(),n("span",Lc,[d[5]||(d[5]=e("i",{class:"fa-solid fa-user text-xs"},null,-1)),q(" "+m(i.assignee),1)])):u("",!0),i.value?(s(),n("span",Oc,[d[6]||(d[6]=e("i",{class:"fa-solid fa-tag text-xs"},null,-1)),q(" € "+m(c(i.value)),1)])):u("",!0),i.vehicle?(s(),n("span",Nc,[d[7]||(d[7]=e("i",{class:"fa-solid fa-car text-xs"},null,-1)),q(" "+m(i.vehicle.brand)+" "+m(i.vehicle.model),1)])):u("",!0)]),j(i).length>0?(s(),n("div",Ec,[(s(!0),n(G,null,Z(j(i),x=>(s(),n("div",{key:x.id,class:"flex items-center justify-between p-2 bg-muted/50 border border-border rounded-md"},[e("div",Pc,[l(a(ce),{text:x.type,size:"small",theme:$(x.type)},null,8,["text","theme"]),e("span",Rc,m(x.description),1)]),d[8]||(d[8]=e("i",{class:"fa-solid fa-chevron-right text-xs text-muted-foreground opacity-50"},null,-1))]))),128))])):u("",!0)])])],8,Sc))),128))])):(s(),n("div",Fc,[...d[10]||(d[10]=[e("i",{class:"fa-solid fa-inbox text-2xl mb-2 opacity-30"},null,-1),e("p",{class:"text-xs"},"No opportunities associated with this customer",-1)])]))]))}},Bc={key:0,class:"space-y-4 mb-6 px-1"},_c=["onClick"],zc={class:"flex-1 min-w-0"},Wc={class:"flex items-center gap-2 mb-1"},Hc={class:"text-xs font-bold text-foreground"},Yc={class:"text-xs text-muted-foreground"},Gc={class:"ml-auto relative"},Kc=["onClick"],Qc={class:"text-sm text-muted-foreground"},Jc={class:"flex items-center gap-2 mb-1 flex-wrap"},Zc={class:"text-sm font-medium text-foreground mb-1"},Xc={class:"flex flex-wrap items-center gap-x-3 gap-y-1 text-xs text-muted-foreground"},em={class:"flex items-center gap-1"},tm={key:0,class:"flex items-center gap-1"},sm={key:1,class:"flex items-center gap-1"},am={key:1,class:"text-center py-8 text-muted-foreground"},nm={__name:"CustomerAppointmentsWidget",props:{appointments:{type:Array,default:()=>[]}},setup(t){const o=je(),v=E({}),C={appointment:"Dealership Visit","test-drive":"Test Drive",meeting:"Meeting",call:"Call",delivery:"Delivery",offsite:"Offsite Visit",workshop:"Workshop"},j=i=>C[i]||i||"Appointment",$=i=>({appointment:"bg-blue-50 text-blue-600 border-blue-100","test-drive":"bg-green-50 text-green-600 border-green-100",meeting:"bg-purple-50 text-purple-600 border-purple-100",call:"bg-amber-50 text-amber-600 border-amber-100",delivery:"bg-teal-50 text-teal-600 border-teal-100",offsite:"bg-slate-50 text-slate-600 border-slate-100",workshop:"bg-orange-50 text-orange-600 border-orange-100"})[i]||"bg-muted text-muted-foreground border-gray-100",f=i=>{const x=(i||"").toLowerCase();return x==="confirmed"?"bg-green-50 text-green-600":x==="cancelled"?"bg-red-50 text-red-600":x==="no-show"?"bg-amber-50 text-amber-600":"bg-muted text-muted-foreground"},c=i=>{if(!i)return"";const x=new Date(i);return x.toLocaleDateString("en-US",{month:"short",day:"numeric",year:x.getFullYear()!==new Date().getFullYear()?"numeric":void 0,hour:"2-digit",minute:"2-digit"})},w=i=>{if(!i)return"Just now";const x=new Date(i),I=new Date-x,p=Math.floor(I/6e4),r=Math.floor(p/60),g=Math.floor(r/24);return p<1?"Just now":p<60?`${p} minutes ago`:r<24?`${r} hours ago`:g===1?"Yesterday":g<7?`${g} days ago`:x.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},h=i=>{var x;return i.customerInitials?i.customerInitials:(x=i.customer)!=null&&x.initials?i.customer.initials:"SK"},d=i=>{i.opportunityId?o.push({path:`/tasks/${i.opportunityId}`,query:{type:"opportunity"}}):i.leadId?o.push({path:`/tasks/${i.leadId}`,query:{type:"lead"}}):o.push({path:"/calendar"})};return(i,x)=>(s(),n("div",null,[t.appointments.length>0?(s(),n("div",Bc,[(s(!0),n(G,null,Z(t.appointments,D=>(s(),n("div",{key:D.id,class:"bg-white border border-border rounded-xl p-4 shadow-nsc-card flex gap-4 animate-fade-in feed-item cursor-pointer transition-shadow",onClick:I=>d(D)},[x[5]||(x[5]=e("div",{class:"w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold shrink-0 border bg-purple-100 text-purple-600 border-purple-200"},[e("i",{class:"fa-solid fa-calendar text-sm"})],-1)),e("div",zc,[e("div",Wc,[e("span",Hc,m(h(D)),1),x[1]||(x[1]=e("span",{class:"text-xs text-muted-foreground"},"scheduled",-1)),e("span",Yc,"• "+m(w(D.start)),1),e("div",Gc,[e("button",{onClick:Te(I=>v.value[D.id]=!v.value[D.id],["stop"]),class:"text-gray-400 hover:text-muted-foreground transition-colors p-1",title:"More actions"},[...x[0]||(x[0]=[e("i",{class:"fa-solid fa-ellipsis-vertical text-sm"},null,-1)])],8,Kc)])]),e("div",Qc,[e("div",Jc,[e("span",{class:z(["text-xs px-1.5 py-0.5 rounded font-bold uppercase tracking-tighter border",$(D.type)])},m(j(D.type)),3),D.status?(s(),n("span",{key:0,class:z(["text-xs px-1.5 py-0.5 rounded font-medium capitalize",f(D.status)])},m(D.status),3)):u("",!0)]),e("div",Zc,m(D.title||"Appointment"),1),e("div",Xc,[e("span",em,[x[2]||(x[2]=e("i",{class:"fa-solid fa-clock text-xs"},null,-1)),q(" "+m(c(D.start)),1)]),D.assignee?(s(),n("span",tm,[x[3]||(x[3]=e("i",{class:"fa-solid fa-user text-xs"},null,-1)),q(" "+m(D.assignee),1)])):u("",!0),D.vehicle?(s(),n("span",sm,[x[4]||(x[4]=e("i",{class:"fa-solid fa-car text-xs"},null,-1)),q(" "+m(D.vehicle),1)])):u("",!0)])])])],8,_c))),128))])):(s(),n("div",am,[...x[6]||(x[6]=[e("i",{class:"fa-solid fa-calendar-xmark text-2xl mb-2 opacity-30"},null,-1),e("p",{class:"text-xs"},"No appointments for this customer",-1)])]))]))}},lm={key:0,class:"mb-8"},om={class:"relative"},im={class:"flex overflow-x-auto space-x-4 pb-4 scrollbar-hide scroll-smooth snap-x snap-mandatory",style:{"scrollbar-width":"thin"}},rm=["onClick"],dm={class:"w-full h-36 bg-surfaceTertiary flex items-center justify-center overflow-hidden"},um=["src"],cm={key:1,class:"fa-solid fa-car text-4xl text-muted-foreground"},mm={class:"p-6"},fm={class:"font-bold text-foreground text-sm mb-1"},vm={key:0,class:"text-xs text-muted-foreground mb-2"},pm={key:1,class:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-green-50 border border-green-100 text-green-700 text-xs font-semibold rounded-md mb-2"},ym={__name:"VehiclesCarousel",props:{cars:{type:Array,default:()=>[]}},emits:["car-click"],setup(t,{emit:o}){const v=o,C=E(!1),j=w=>new Intl.NumberFormat("en-US").format(w),$=w=>({owned:"Owned",requested:"Requested",offered:"Offered",drove:"Drove",purchased:"Purchased"})[w]||"Car",f=w=>({owned:"bg-orange-600",requested:"bg-blue-600",offered:"bg-purple-600",drove:"bg-green-600",purchased:"bg-teal-600"})[w]||"bg-gray-600",c=w=>{v("car-click",w),C.value=!0};return(w,h)=>t.cars.length>0?(s(),n("div",lm,[h[2]||(h[2]=e("div",{class:"flex items-center gap-2 mb-4"},[e("i",{class:"fa-solid fa-thumbtack text-muted-foreground text-xs"}),e("h3",{class:"font-bold text-foreground text-sm"},"Cars")],-1)),e("div",om,[e("div",im,[(s(!0),n(G,null,Z(t.cars,(d,i)=>(s(),n("div",{key:d.id,class:"flex-none w-64 snap-start bg-surface border border-border rounded-lg shadow-nsc-card overflow-hidden transition-shadow cursor-pointer relative",onClick:x=>c(d)},[e("div",{class:z(["absolute top-2 right-2 z-10 text-white text-xs font-bold px-2 py-1 rounded-md shadow-sm",f(d.type)])},m($(d.type)),3),e("div",dm,[d.image?(s(),n("img",{key:0,src:d.image,alt:"Car",class:"w-full h-full object-cover"},null,8,um)):(s(),n("i",cm))]),e("div",mm,[e("h4",fm,m(d.brand)+" "+m(d.model)+" ("+m(d.year)+")",1),d.price?(s(),n("p",vm,"€ "+m(j(d.price)),1)):u("",!0),d.stockDays!==null&&d.stockDays!==void 0?(s(),n("div",pm,[h[1]||(h[1]=e("div",{class:"w-1 h-1 bg-green-500 rounded-full"},null,-1)),q(" In stock ("+m(d.stockDays)+" days) ",1)])):u("",!0)])],8,rm))),128))])]),l(Ne,{show:C.value,title:"Car Details",onClose:h[0]||(h[0]=d=>C.value=!1)},null,8,["show"])])):u("",!0)}},gm=Ka(ym,[["__scopeId","data-v-8d3d6751"]]),xm={class:"flex-1 overflow-y-auto px-6 py-4 w-full"},hm={__name:"AddLeadOpportunityModal",props:{show:{type:Boolean,default:!1},type:{type:String,required:!0},contact:{type:Object,required:!0}},emits:["close","save"],setup(t,{emit:o}){const v=t,C=o,j=E(null),$=A(()=>v.type==="lead"?"Add New Lead":"Add New Opportunity");A(()=>`Create a ${v.type} for ${v.contact.name}`);const f=w=>{w||C("close")},c=w=>{C("save",w)};return(w,h)=>(s(),P(a(Jt),{open:t.show,"onUpdate:open":f},{default:k(()=>[l(a(Wt),null,{default:k(()=>[l(a(Ht),{class:"fixed inset-0 z-50 bg-black/50"}),l(a(Yt),{class:"w-full sm:max-w-lg max-h-[calc(100vh-4rem)] flex flex-col"},{default:k(()=>[l(a(Gt),{class:"flex-shrink-0"},{default:k(()=>[l(a(Kt),null,{default:k(()=>[q(m($.value),1)]),_:1})]),_:1}),e("div",xm,[l(bn,{ref_key:"formRef",ref:j,"initial-contact":t.contact,"hide-contact-selection":!0,"force-type":t.type,onSubmit:c},null,8,["initial-contact","force-type"])]),l(a(Qt),{class:"flex-shrink-0 flex flex-col sm:flex-row justify-end items-stretch sm:items-center gap-3"},{default:k(()=>{var d,i,x,D;return[l(a(U),{label:"Cancel",variant:"outline",size:"small",class:"rounded-sm w-full sm:w-auto",onClick:h[0]||(h[0]=I=>w.$emit("close"))}),l(a(U),{label:(d=j.value)!=null&&d.isSubmitting?"Saving...":"Save",variant:"primary",size:"small",class:"rounded-sm w-full sm:w-auto !bg-brand-red !hover:bg-brand-red-dark !text-white !border-brand-red",disabled:((i=j.value)==null?void 0:i.isSubmitting)||!((x=j.value)!=null&&x.canSubmit),onClick:(D=j.value)==null?void 0:D.submit},null,8,["label","disabled","onClick"])]}),_:1})]),_:1})]),_:1})]),_:1},8,["open"]))}},bm={class:"flex items-center gap-2"},km={key:0,class:"space-y-3 animate-pulse"},wm={key:1,class:"divide-y divide-border"},$m={class:"py-3"},Cm={key:0,class:"text-sm text-muted-foreground leading-relaxed whitespace-pre-line"},Am={key:1,class:"flex items-center gap-3 py-1 text-muted-foreground"},Sm={key:0,class:"py-3"},Im={class:"flex flex-wrap gap-2"},Tm={__name:"CustomerSummaryWidget",props:{summary:{type:String,default:null},preferences:{type:Array,default:()=>[]},customerData:{type:Object,default:null},loading:{type:Boolean,default:!1}},setup(t){const o=t,v=j=>({"fa-solid fa-car":sn,"fa-brands fa-whatsapp":xt,"fa-solid fa-phone":lt,"fa-solid fa-envelope":nt,"fa-solid fa-message":rn,"fa-solid fa-comment":xt,"fa-solid fa-clock":Nt,"fa-solid fa-dollar-sign":ln})[j]||Ba,C=A(()=>{if(o.preferences&&o.preferences.length>0)return o.preferences;const j=[],$=o.customerData;if(!$)return j;if($.preferredVehicleType&&j.push({icon:"fa-solid fa-car",label:`Prefers ${$.preferredVehicleType}s`}),$.preferredChannel){const f={whatsapp:"fa-brands fa-whatsapp",phone:"fa-solid fa-phone",email:"fa-solid fa-envelope",sms:"fa-solid fa-message"};j.push({icon:f[$.preferredChannel.toLowerCase()]||"fa-solid fa-comment",label:`Prefers ${$.preferredChannel}`})}return $.preferredContactTime&&j.push({icon:"fa-solid fa-clock",label:$.preferredContactTime}),$.budgetRange&&j.push({icon:"fa-solid fa-dollar-sign",label:$.budgetRange}),j});return(j,$)=>(s(),P(a(ze),{class:"h-full"},{default:k(()=>[l(a(Be),null,{default:k(()=>[e("div",bm,[l(a(_t),{class:"w-4 h-4 text-foreground"}),l(a(ot),{class:"text-sm font-semibold leading-5"},{default:k(()=>[...$[0]||($[0]=[q("Customer Insights",-1)])]),_:1})])]),_:1}),l(a(_e),null,{default:k(()=>[t.loading?(s(),n("div",km,[...$[1]||($[1]=[e("div",{class:"space-y-2"},[e("div",{class:"h-4 bg-muted rounded w-3/4"}),e("div",{class:"h-4 bg-muted rounded w-full"}),e("div",{class:"h-4 bg-muted rounded w-5/6"})],-1),e("div",{class:"flex flex-wrap gap-2 pt-3"},[e("div",{class:"h-6 bg-muted rounded w-24"}),e("div",{class:"h-6 bg-muted rounded w-32"}),e("div",{class:"h-6 bg-muted rounded w-20"})],-1)])])):(s(),n("div",wm,[e("div",$m,[t.summary?(s(),n("p",Cm,m(t.summary),1)):(s(),n("div",Am,[l(a(Ba),{class:"w-4 h-4 opacity-20"}),$[2]||($[2]=e("p",{class:"text-xs italic"},"No customer insights available yet. Insights will appear as we learn more about this customer's preferences and behavior.",-1))]))]),C.value&&C.value.length>0?(s(),n("div",Sm,[e("div",Im,[(s(!0),n(G,null,Z(C.value,(f,c)=>(s(),P(a(ce),{key:c,variant:"outline",class:"text-xs font-semibold uppercase tracking-wider"},{default:k(()=>[(s(),P(at(v(f.icon)),{class:"w-3 h-3 mr-1.5 text-primary"})),q(" "+m(f.label),1)]),_:2},1024))),128))])])):u("",!0)]))]),_:1})]),_:1}))}},Dm={class:"flex items-center gap-2"},jm={key:0,class:"space-y-3 animate-pulse"},Vm={key:1,class:"divide-y divide-border"},qm={class:"py-3"},Mm={class:"text-sm text-muted-foreground leading-relaxed break-words"},Lm={key:0,class:"text-muted-foreground"},Om={class:"font-medium text-foreground"},Nm={class:"text-xs text-muted-foreground ml-1"},Em={class:"py-3"},Pm={class:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2"},Rm={__name:"SuggestedNextAction",props:{leads:{type:Array,default:()=>[]},opportunities:{type:Array,default:()=>[]},activities:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},setup(t){const o=t,v=d=>_t,C=je(),j=A(()=>{if(!o.leads||o.leads.length===0)return null;const d=o.leads.filter(x=>{if(x.isDisqualified)return!1;const D=Pa(x,"lead");return D!=="Closed - Invalid"&&D!=="Closed - Not Interested"&&D!=="Closed - Duplicate"});if(d.length===0)return null;const i={Hot:3,Medium:2,Low:1};return d.sort((x,D)=>{const I=i[x.priority]||0,p=i[D.priority]||0;if(I!==p)return p-I;const r=new Date(x.updatedAt||x.createdAt||0);return new Date(D.updatedAt||D.createdAt||0)-r}),d[0]}),$=A(()=>{if(!o.opportunities||o.opportunities.length===0)return null;const d=o.opportunities.filter(x=>{const D=x.displayStage||x.stage;return D!=="Closed Won"&&D!=="Closed Lost"&&D!=="Abandoned"});if(d.length===0)return null;const i={Hot:3,Medium:2,Low:1};return d.sort((x,D)=>{const I=i[x.priority]||0,p=i[D.priority]||0;if(I!==p)return p-I;const r=new Date(x.updatedAt||x.createdAt||0);return new Date(D.updatedAt||D.createdAt||0)-r}),d[0]}),f=A(()=>{if(!j.value)return null;const d=j.value,i={lead:d,displayStage:Pa(d,"lead")},x=an(i);return x?{...x,type:"lead",entityId:d.id,entity:d}:null}),c=A(()=>{if(!$.value)return null;const d=$.value,i=o.activities.filter(I=>I.opportunityId===d.id),x={opportunity:d,scheduledAppointment:d.scheduledAppointment||null,activities:i,hasOffers:i.some(I=>I.type==="offer")||!1,stage:d.displayStage||d.stage,deliverySubstatus:d.deliverySubstatus||null,formatDateTime:I=>{if(!I)return"";const p=new Date(I);return p.toLocaleDateString()+" "+p.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}},D=nn(x.stage,x);return D?{...D,type:"opportunity",entityId:d.id,entity:d}:null}),w=A(()=>{const d=[];f.value&&d.push({...f.value,id:`lead-${f.value.entityId}`}),c.value&&d.push({...c.value,id:`opp-${c.value.entityId}`});const i={Hot:3,Medium:2,Low:1};return d.sort((x,D)=>{const I=x.entity,p=D.entity,r=i[I==null?void 0:I.priority]||0,g=i[p==null?void 0:p.priority]||0;return r!==g?g-r:x.type==="lead"&&D.type==="opportunity"?-1:x.type==="opportunity"&&D.type==="lead"?1:0}),d}),h=d=>{d.type==="lead"?C.push({path:`/tasks/${d.entityId}`,query:{type:"lead"}}):d.type==="opportunity"&&C.push({path:`/tasks/${d.entityId}`,query:{type:"opportunity"}})};return(d,i)=>t.loading||w.value.length>0?(s(),P(a(ze),{key:0,class:"h-full"},{default:k(()=>[l(a(Be),null,{default:k(()=>[e("div",Dm,[l(a(_t),{class:"w-4 h-4 text-foreground"}),l(a(ot),{class:"text-sm font-semibold leading-5"},{default:k(()=>[...i[2]||(i[2]=[q("Suggested Next Action",-1)])]),_:1})])]),_:1}),l(a(_e),null,{default:k(()=>[t.loading?(s(),n("div",jm,[...i[3]||(i[3]=[e("div",{class:"h-4 bg-muted rounded w-full"},null,-1),e("div",{class:"flex flex-col sm:flex-row gap-2 pt-3"},[e("div",{class:"h-10 bg-muted rounded w-full sm:w-32"}),e("div",{class:"h-10 bg-muted rounded w-full sm:w-32"})],-1)])])):w.value.length>0?(s(),n("div",Vm,[e("div",qm,[e("p",Mm,[(s(!0),n(G,null,Z(w.value,(x,D)=>(s(),n(G,{key:x.id},[D>0?(s(),n("span",Lm," or ")):u("",!0),e("span",Om,m(x.title),1),e("span",Nm," ("+m(x.type==="lead"?"Lead":"Opp")+" #"+m(x.entityId)+") ",1)],64))),128))])]),e("div",Em,[e("div",Pm,[w.value.length>0?(s(),P(a(U),{key:0,onClick:i[0]||(i[0]=x=>h(w.value[0])),variant:"default",class:"w-full sm:w-auto"},{default:k(()=>[(s(),P(at(v(w.value[0].icon)),{class:"w-4 h-4 mr-2"})),q(" "+m(w.value[0].label),1)]),_:1})):u("",!0),w.value.length>1?(s(),P(a(U),{key:1,onClick:i[1]||(i[1]=x=>h(w.value[1])),variant:"outline",class:"w-full sm:w-auto"},{default:k(()=>[(s(),P(at(v(w.value[1].icon)),{class:"w-4 h-4 mr-2"})),q(" "+m(w.value[1].label),1)]),_:1})):u("",!0)])])])):u("",!0)]),_:1})]),_:1})):u("",!0)}},Fm={class:"flex items-center gap-2"},Um={key:0,class:"space-y-3 animate-pulse"},Bm={class:"divide-y divide-border"},_m={key:0,class:"flex items-center justify-between gap-3 p-3 hover:bg-muted transition-colors rounded-md group"},zm={class:"flex items-center gap-3 min-w-0"},Wm={class:"w-8 h-8 rounded bg-primary/10 flex items-center justify-center shrink-0"},Hm={class:"min-w-0"},Ym={class:"text-sm text-muted-foreground truncate"},Gm={class:"text-xs text-muted-foreground truncate"},Km={key:1,class:"flex items-center justify-between gap-3 p-3 hover:bg-muted transition-colors rounded-md group"},Qm={class:"flex items-center gap-3 min-w-0"},Jm={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},Zm={class:"min-w-0"},Xm={class:"text-sm text-muted-foreground truncate"},ef={class:"text-xs text-muted-foreground truncate"},tf={key:2,class:"flex items-center justify-between gap-3 p-3 hover:bg-muted transition-colors rounded-md group"},sf={class:"flex items-center gap-3 min-w-0"},af={class:"w-8 h-8 rounded bg-primary/10 flex items-center justify-center shrink-0"},nf={class:"min-w-0"},lf={class:"text-sm text-muted-foreground truncate"},of={class:"text-xs text-muted-foreground truncate"},rf={key:3,class:"flex items-center justify-between gap-3 p-3 hover:bg-muted transition-colors rounded-md group"},df={class:"flex items-center gap-3 min-w-0"},uf={class:"w-8 h-8 rounded bg-primary/10 flex items-center justify-center shrink-0"},cf={class:"min-w-0"},mf={class:"text-sm text-muted-foreground truncate"},ff={class:"text-xs text-muted-foreground truncate"},vf={key:0,class:"text-center py-6 text-muted-foreground"},pf={__name:"RecentActivitiesWidget",props:{nextAppointment:{type:Object,default:null},activities:{type:Array,default:()=>[]},leads:{type:Array,default:()=>[]},opportunities:{type:Array,default:()=>[]},customerId:{type:[Number,String],default:null},loading:{type:Boolean,default:!1}},setup(t){const o=t,v=je(),C=A(()=>{const r=["email","sms","whatsapp","call"],g=o.activities.filter(y=>r.includes(y.type)).sort((y,V)=>new Date(V.timestamp)-new Date(y.timestamp));return g.length>0?g[0]:null}),j=A(()=>{const r=o.leads.filter(g=>{var y;return!g.isDisqualified&&g.status!=="Disqualified"&&!((y=g.stage)!=null&&y.includes("Closed"))});return r.length>0?r[0]:null}),$=A(()=>{if(!j.value)return null;try{return an({lead:j.value,displayStage:j.value.stage})}catch(r){return console.error("Error getting lead next action:",r),null}}),f=A(()=>{const r=o.opportunities.filter(g=>g.stage!=="Closed Won"&&g.stage!=="Closed Lost");return r.length>0?r[0]:null}),c=A(()=>{if(!f.value)return null;try{const r=o.activities.filter(y=>y.opportunityId===f.value.id)||[];return nn(f.value.stage,{opportunity:f.value,scheduledAppointment:f.value.scheduledAppointment||null,activities:r,hasOffers:r.some(y=>y.type==="offer")||!1,stage:f.value.stage,deliverySubstatus:f.value.deliverySubstatus||null,formatDateTime:y=>y?new Date(y).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):""})}catch(r){return console.error("Error getting opportunity next action:",r),null}}),w=r=>({email:nt,sms:rn,whatsapp:xt,call:lt})[r]||xt,h=r=>r.type==="call"?r.content||`Call with ${r.user||"customer"}`:r.type==="email"?r.subject||r.content||"Email communication":r.type==="sms"||r.type==="whatsapp"?r.content||`${r.type.toUpperCase()} message`:r.content||"Communication",d=r=>{if(!r)return"";const g=new Date(r),y=new Date,V=Math.abs(y-g),Y=Math.ceil(V/(1e3*60*60*24));return Y===1?"Today":Y===2?"Yesterday":Y<=7?`${Y-1} days ago`:g.toLocaleDateString("en-US",{month:"short",day:"numeric",year:g.getFullYear()!==y.getFullYear()?"numeric":void 0})},i=r=>{if(!r)return"";const g=new Date(r),y=new Date;if(g.toDateString()===y.toDateString())return`Today at ${g.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}`;const Y=new Date(y);return Y.setDate(Y.getDate()+1),g.toDateString()===Y.toDateString()?`Tomorrow at ${g.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}`:g.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},x=()=>{var r,g;(r=o.nextAppointment)!=null&&r.opportunityId?v.push({path:`/tasks/${o.nextAppointment.opportunityId}`,query:{type:"opportunity"}}):(g=o.nextAppointment)!=null&&g.leadId?v.push({path:`/tasks/${o.nextAppointment.leadId}`,query:{type:"lead"}}):v.push({path:"/calendar"})},D=()=>{var r,g;(r=C.value)!=null&&r.opportunityId?v.push({path:`/tasks/${C.value.opportunityId}`,query:{type:"opportunity"}}):(g=C.value)!=null&&g.leadId&&v.push({path:`/tasks/${C.value.leadId}`,query:{type:"lead"}})},I=()=>{var r;(r=j.value)!=null&&r.id&&v.push({path:`/tasks/${j.value.id}`,query:{type:"lead"}})},p=()=>{var r;(r=f.value)!=null&&r.id&&v.push({path:`/tasks/${f.value.id}`,query:{type:"opportunity"}})};return(r,g)=>(s(),P(a(ze),{class:"h-full"},{default:k(()=>[l(a(Be),null,{default:k(()=>[e("div",Fm,[l(a(Nt),{class:"w-4 h-4 text-foreground"}),l(a(ot),{class:"text-sm font-semibold leading-5"},{default:k(()=>[...g[0]||(g[0]=[q("Recent Activities",-1)])]),_:1})])]),_:1}),l(a(_e),null,{default:k(()=>{var y,V,Y,ee,se,X;return[t.loading?(s(),n("div",Um,[(s(),n(G,null,Z(3,ne=>e("div",{key:`skeleton-${ne}`,class:"flex items-center gap-3 p-3"},[...g[1]||(g[1]=[e("div",{class:"w-8 h-8 bg-muted rounded-full"},null,-1),e("div",{class:"flex-1 space-y-2"},[e("div",{class:"h-3 bg-muted rounded w-1/4"}),e("div",{class:"h-4 bg-muted rounded w-3/4"}),e("div",{class:"h-3 bg-muted rounded w-1/2"})],-1),e("div",{class:"w-8 h-8 bg-muted rounded"},null,-1)])])),64))])):(s(),n(G,{key:1},[e("div",Bm,[t.nextAppointment?(s(),n("div",_m,[e("div",zm,[e("div",Wm,[l(a(Zn),{class:"w-4 h-4 text-primary"})]),e("div",Hm,[g[2]||(g[2]=e("div",{class:"text-xs font-semibold text-foreground uppercase tracking-wider mb-0.5"},"Next Appointment",-1)),e("div",Ym,m(i(t.nextAppointment.start)),1),e("div",Gm,m(t.nextAppointment.title||"Appointment"),1)])]),l(a(U),{onClick:x,variant:"outline",size:"icon",title:"View Details"},{default:k(()=>[l(a(yt),{class:"w-4 h-4"})]),_:1})])):u("",!0),C.value?(s(),n("div",Km,[e("div",Qm,[e("div",Jm,[(s(),P(at(w(C.value.type)),{class:"w-4 h-4 text-muted-foreground"}))]),e("div",Zm,[g[3]||(g[3]=e("div",{class:"text-xs font-semibold text-foreground uppercase tracking-wider mb-0.5"},"Last Communication",-1)),e("div",Xm,m(h(C.value)),1),e("div",ef,m(d(C.value.timestamp)),1)])]),l(a(U),{onClick:D,variant:"outline",size:"icon",title:"View Details"},{default:k(()=>[l(a(yt),{class:"w-4 h-4"})]),_:1})])):u("",!0),j.value?(s(),n("div",tf,[e("div",sf,[e("div",af,[l(a(gt),{class:"w-4 h-4 text-primary"})]),e("div",nf,[g[4]||(g[4]=e("div",{class:"text-xs font-semibold text-foreground uppercase tracking-wider mb-0.5"},"Active Lead Request",-1)),e("div",lf,m(((y=$.value)==null?void 0:y.label)||"No action defined"),1),e("div",of,m((V=j.value.requestedCar)==null?void 0:V.brand)+" "+m((Y=j.value.requestedCar)==null?void 0:Y.model),1)])]),l(a(U),{onClick:I,variant:"outline",size:"icon",title:"View Details"},{default:k(()=>[l(a(yt),{class:"w-4 h-4"})]),_:1})])):u("",!0),f.value?(s(),n("div",rf,[e("div",df,[e("div",uf,[l(a(Xn),{class:"w-4 h-4 text-primary"})]),e("div",cf,[g[5]||(g[5]=e("div",{class:"text-xs font-semibold text-foreground uppercase tracking-wider mb-0.5"},"Active Opportunity",-1)),e("div",mf,m(((ee=c.value)==null?void 0:ee.label)||"No action defined"),1),e("div",ff,m((se=f.value.vehicle)==null?void 0:se.brand)+" "+m((X=f.value.vehicle)==null?void 0:X.model)+" - "+m(f.value.stage),1)])]),l(a(U),{onClick:p,variant:"outline",size:"icon",title:"View Details"},{default:k(()=>[l(a(yt),{class:"w-4 h-4"})]),_:1})])):u("",!0)]),!t.nextAppointment&&!C.value&&!j.value&&!f.value?(s(),n("div",vf,[l(a(el),{class:"w-8 h-8 mx-auto mb-2 opacity-30"}),g[6]||(g[6]=e("p",{class:"text-xs"},"No recent activities available",-1))])):u("",!0)],64))]}),_:1})]),_:1}))}},yf={class:"flex items-center justify-between"},gf={key:0,class:"space-y-3 animate-pulse"},xf={key:0,class:"mb-4 pb-4 border-b border-border"},hf={class:"flex items-center gap-2 mb-1"},bf={key:0,class:"text-sm text-muted-foreground"},kf={key:1,class:"text-xs text-muted-foreground mt-1"},wf={class:"space-y-4"},$f={key:0,class:"space-y-2"},Cf={class:"space-y-2"},Af={key:0,class:"flex items-center gap-3"},Sf={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},If={class:"flex-1 min-w-0"},Tf={class:"text-sm text-foreground"},Df={key:1,class:"flex items-center gap-3"},jf={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},Vf={class:"flex-1 min-w-0"},qf={class:"text-sm text-foreground"},Mf={key:2,class:"flex items-center gap-3"},Lf={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},Of={class:"flex-1 min-w-0"},Nf={class:"text-sm text-foreground"},Ef={key:3,class:"flex items-center gap-3"},Pf={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},Rf={class:"flex-1 min-w-0"},Ff={class:"text-sm text-foreground"},Uf={key:1,class:"space-y-2"},Bf={class:"space-y-2"},_f={key:0,class:"flex items-center gap-3 group"},zf={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},Wf={class:"flex-1 min-w-0"},Hf=["href"],Yf={key:1,class:"flex items-center gap-3 group"},Gf={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},Kf={class:"flex-1 min-w-0"},Qf=["href"],Jf={key:2,class:"flex items-center gap-3 group"},Zf={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},Xf={class:"flex-1 min-w-0"},ev=["href"],tv={key:3,class:"flex items-center gap-3 group"},sv={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},av={class:"flex-1 min-w-0"},nv=["href"],lv={key:4,class:"flex items-center gap-3 group"},ov={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},iv={class:"flex-1 min-w-0"},rv=["href"],dv={key:2,class:"space-y-2"},uv={class:"space-y-2"},cv={key:0,class:"flex items-center gap-3 group"},mv={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},fv={class:"flex-1 min-w-0"},vv={class:"text-sm text-foreground"},pv={key:1,class:"flex items-center gap-3"},yv={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},gv={class:"flex-1 min-w-0"},xv={class:"text-sm text-foreground"},hv={key:2,class:"flex items-center gap-3"},bv={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},kv={class:"flex-1 min-w-0"},wv={class:"text-sm text-foreground"},$v={key:0},Cv={key:1},Av={key:2},Sv={key:3},Iv={key:4},Tv={key:5},Dv={key:6},jv={key:3,class:"flex items-center gap-3 group"},Vv={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},qv={class:"flex-1 min-w-0"},Mv={class:"text-sm text-foreground"},Lv={key:3,class:"space-y-2"},Ov={class:"space-y-1.5"},Nv={key:0,class:"flex items-center gap-2"},Ev={class:"text-xs text-foreground font-medium"},Pv={key:1,class:"flex items-center gap-2 group"},Rv={class:"text-xs text-foreground font-mono"},Fv={key:2,class:"flex items-center gap-2"},Uv={class:"text-xs text-foreground"},Bv={key:3,class:"flex items-center gap-2"},_v={class:"text-xs text-foreground"},zv={class:"text-xs text-muted-foreground"},Wv={class:"text-xs text-foreground truncate"},Hv={key:4,class:"text-center py-6 text-muted-foreground"},Yv={__name:"CustomerContactDetailsCard",props:{firstName:{type:String,default:""},lastName:{type:String,default:""},name:{type:String,default:""},initials:{type:String,default:""},title:{type:String,default:""},salutation:{type:String,default:""},jobTitle:{type:String,default:""},birthDate:{type:String,default:""},gender:{type:String,default:""},placeOfBirth:{type:String,default:""},email:{type:[String,Object],default:()=>""},secondaryEmail:{type:String,default:""},phone:{type:[String,Object],default:()=>""},secondaryPhone:{type:String,default:""},mobilePhone:{type:String,default:""},preferredContactMethod:{type:String,default:""},preferredChannel:{type:String,default:""},address:{type:[String,Object],default:()=>""},streetAddress1:{type:String,default:""},streetAddress2:{type:String,default:""},city:{type:String,default:""},postalCode:{type:String,default:""},region:{type:String,default:""},country:{type:String,default:""},contactCustomFields:{type:Object,default:()=>({})},externalId:{type:String,default:""},createdAt:{type:String,default:""},createdDate:{type:String,default:""},updatedAt:{type:String,default:""},lastUpdatedDate:{type:String,default:""},lastActivityDate:{type:String,default:""},isMasterContact:{type:Boolean,default:!1},accountName:{type:String,default:""},loading:{type:Boolean,default:!1}},setup(t){const o=t,v=Za(),C=E(!1),j=A(()=>o.firstName||o.lastName?`${o.firstName||""} ${o.lastName||""}`.trim():o.name||""),$=A(()=>typeof o.email=="object"&&o.email!==null?o.email.primary||"":o.email||""),f=A(()=>typeof o.email=="object"&&o.email!==null?o.email.secondary||"":o.secondaryEmail||""),c=A(()=>typeof o.phone=="object"&&o.phone!==null?o.phone.primary||"":o.phone||""),w=A(()=>typeof o.phone=="object"&&o.phone!==null?o.phone.secondary||"":o.secondaryPhone||""),h=A(()=>typeof o.phone=="object"&&o.phone!==null?o.phone.mobile||"":o.mobilePhone||""),d=A(()=>typeof o.address=="object"&&o.address!==null?o.address.streetLine1||"":o.streetAddress1||o.streetAddress||""),i=A(()=>typeof o.address=="object"&&o.address!==null?o.address.streetLine2||"":o.streetAddress2||""),x=A(()=>typeof o.address=="object"&&o.address!==null?o.address.city||"":o.city||""),D=A(()=>typeof o.address=="object"&&o.address!==null?o.address.postalCode||"":o.postalCode||o.zipCode||""),I=A(()=>typeof o.address=="object"&&o.address!==null?o.address.region||"":o.region||o.state||o.county||""),p=A(()=>typeof o.address=="object"&&o.address!==null?o.address.country||"":o.country||""),r=A(()=>typeof o.address=="string"?o.address:""),g=A(()=>!!(d.value||x.value||D.value||I.value||p.value)),y=A(()=>o.createdAt||o.createdDate||""),V=A(()=>o.updatedAt||o.lastUpdatedDate||""),Y=A(()=>!!(o.title||o.jobTitle||$.value||f.value||c.value||w.value||h.value||ee.value||g.value||r.value||o.birthDate||o.gender||o.placeOfBirth||o.externalId||y.value||V.value||o.contactCustomFields&&Object.keys(o.contactCustomFields).length>0)),ee=A(()=>o.preferredContactMethod||o.preferredChannel||""),se=ne=>{if(!ne)return"";try{return new Date(ne).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return ne}},X=async(ne,L)=>{try{await navigator.clipboard.writeText(ne);const te=L==="email"?"Email":L==="phone"?"Phone":L==="address"?"Address":L;v.pushToast("success",`${te} copied!`)}catch{v.pushToast("error","Failed to copy")}};return(ne,L)=>(s(),P(a(ze),{class:"h-full"},{default:k(()=>[l(a(Be),null,{default:k(()=>[e("div",yf,[l(a(ot),{class:"text-sm font-semibold leading-5"},{default:k(()=>[q(m(j.value||"Contact Details"),1)]),_:1}),l(a(U),{onClick:L[0]||(L[0]=te=>C.value=!0),variant:"ghost",size:"sm",class:"text-xs"},{default:k(()=>[...L[10]||(L[10]=[q(" Edit Contact ",-1)])]),_:1})])]),_:1}),l(a(_e),null,{default:k(()=>[t.loading?(s(),n("div",gf,[...L[11]||(L[11]=[e("div",{class:"h-4 bg-muted rounded w-3/4"},null,-1),e("div",{class:"h-4 bg-muted rounded w-2/3"},null,-1),e("div",{class:"h-4 bg-muted rounded w-4/5"},null,-1)])])):(s(),n(G,{key:1},[t.jobTitle||t.isMasterContact?(s(),n("div",xf,[e("div",hf,[t.isMasterContact?(s(),P(a(ce),{key:0,variant:"outline",class:"text-xs px-1.5 py-0"},{default:k(()=>[l(a(dn),{class:"w-3 h-3 mr-1"}),L[12]||(L[12]=q(" Master Contact ",-1))]),_:1})):u("",!0)]),t.jobTitle?(s(),n("div",bf,m(t.jobTitle),1)):u("",!0),t.accountName&&t.isMasterContact?(s(),n("div",kf," at "+m(t.accountName),1)):u("",!0)])):u("",!0),e("div",wf,[t.title||t.birthDate||t.gender||t.placeOfBirth?(s(),n("div",$f,[L[17]||(L[17]=e("h4",{class:"text-xs font-semibold text-muted-foreground uppercase tracking-wide"},"Personal Info",-1)),e("div",Cf,[t.title?(s(),n("div",Af,[e("div",Sf,[l(a(gt),{class:"w-4 h-4 text-muted-foreground"})]),e("div",If,[L[13]||(L[13]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Title",-1)),e("div",Tf,m(t.title),1)])])):u("",!0),t.birthDate?(s(),n("div",Df,[e("div",jf,[l(a(Bt),{class:"w-4 h-4 text-muted-foreground"})]),e("div",Vf,[L[14]||(L[14]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Birth Date",-1)),e("div",qf,m(se(t.birthDate)),1)])])):u("",!0),t.gender?(s(),n("div",Mf,[e("div",Lf,[l(a(gt),{class:"w-4 h-4 text-muted-foreground"})]),e("div",Of,[L[15]||(L[15]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Gender",-1)),e("div",Nf,m(t.gender),1)])])):u("",!0),t.placeOfBirth?(s(),n("div",Ef,[e("div",Pf,[l(a(Ee),{class:"w-4 h-4 text-muted-foreground"})]),e("div",Rf,[L[16]||(L[16]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Place of Birth",-1)),e("div",Ff,m(t.placeOfBirth),1)])])):u("",!0)])])):u("",!0),$.value||f.value||c.value||w.value||h.value?(s(),n("div",Uf,[L[23]||(L[23]=e("h4",{class:"text-xs font-semibold text-muted-foreground uppercase tracking-wide"},"Contact Methods",-1)),e("div",Bf,[$.value?(s(),n("div",_f,[e("div",zf,[l(a(nt),{class:"w-4 h-4 text-muted-foreground"})]),e("div",Wf,[L[18]||(L[18]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Primary Email",-1)),e("a",{href:`mailto:${$.value}`,class:"text-sm text-primary hover:underline truncate block"},m($.value),9,Hf)]),l(a(U),{onClick:L[1]||(L[1]=te=>X($.value,"email")),variant:"ghost",size:"icon",class:"opacity-0 group-hover:opacity-100 transition-opacity shrink-0",title:"Copy email"},{default:k(()=>[l(a(me),{class:"w-4 h-4"})]),_:1})])):u("",!0),f.value?(s(),n("div",Yf,[e("div",Gf,[l(a(nt),{class:"w-4 h-4 text-muted-foreground"})]),e("div",Kf,[L[19]||(L[19]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Secondary Email",-1)),e("a",{href:`mailto:${f.value}`,class:"text-sm text-primary hover:underline truncate block"},m(f.value),9,Qf)]),l(a(U),{onClick:L[2]||(L[2]=te=>X(f.value,"email")),variant:"ghost",size:"icon",class:"opacity-0 group-hover:opacity-100 transition-opacity shrink-0",title:"Copy email"},{default:k(()=>[l(a(me),{class:"w-4 h-4"})]),_:1})])):u("",!0),c.value?(s(),n("div",Jf,[e("div",Zf,[l(a(lt),{class:"w-4 h-4 text-muted-foreground"})]),e("div",Xf,[L[20]||(L[20]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Primary Phone",-1)),e("a",{href:`tel:${c.value}`,class:"text-sm text-primary hover:underline"},m(c.value),9,ev)]),l(a(U),{onClick:L[3]||(L[3]=te=>X(c.value,"phone")),variant:"ghost",size:"icon",class:"opacity-0 group-hover:opacity-100 transition-opacity shrink-0",title:"Copy phone"},{default:k(()=>[l(a(me),{class:"w-4 h-4"})]),_:1})])):u("",!0),w.value?(s(),n("div",tv,[e("div",sv,[l(a(lt),{class:"w-4 h-4 text-muted-foreground"})]),e("div",av,[L[21]||(L[21]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Secondary Phone",-1)),e("a",{href:`tel:${w.value}`,class:"text-sm text-primary hover:underline"},m(w.value),9,nv)]),l(a(U),{onClick:L[4]||(L[4]=te=>X(w.value,"phone")),variant:"ghost",size:"icon",class:"opacity-0 group-hover:opacity-100 transition-opacity shrink-0",title:"Copy phone"},{default:k(()=>[l(a(me),{class:"w-4 h-4"})]),_:1})])):u("",!0),h.value?(s(),n("div",lv,[e("div",ov,[l(a(tl),{class:"w-4 h-4 text-muted-foreground"})]),e("div",iv,[L[22]||(L[22]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Mobile Phone",-1)),e("a",{href:`tel:${h.value}`,class:"text-sm text-primary hover:underline"},m(h.value),9,rv)]),l(a(U),{onClick:L[5]||(L[5]=te=>X(h.value,"phone")),variant:"ghost",size:"icon",class:"opacity-0 group-hover:opacity-100 transition-opacity shrink-0",title:"Copy phone"},{default:k(()=>[l(a(me),{class:"w-4 h-4"})]),_:1})])):u("",!0)])])):u("",!0),g.value||r.value?(s(),n("div",dv,[L[26]||(L[26]=e("h4",{class:"text-xs font-semibold text-muted-foreground uppercase tracking-wide"},"Address",-1)),e("div",uv,[d.value?(s(),n("div",cv,[e("div",mv,[l(a(Ee),{class:"w-4 h-4 text-muted-foreground"})]),e("div",fv,[L[24]||(L[24]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Street Address",-1)),e("div",vv,m(d.value),1)]),l(a(U),{onClick:L[6]||(L[6]=te=>X(d.value,"address")),variant:"ghost",size:"icon",class:"opacity-0 group-hover:opacity-100 transition-opacity shrink-0",title:"Copy address"},{default:k(()=>[l(a(me),{class:"w-4 h-4"})]),_:1})])):u("",!0),i.value?(s(),n("div",pv,[e("div",yv,[l(a(Ee),{class:"w-4 h-4 text-muted-foreground opacity-0"})]),e("div",gv,[e("div",xv,m(i.value),1)])])):u("",!0),x.value||D.value||I.value||p.value?(s(),n("div",hv,[e("div",bv,[l(a(Ee),{class:"w-4 h-4 text-muted-foreground opacity-0"})]),e("div",kv,[e("div",wv,[x.value?(s(),n("span",$v,m(x.value),1)):u("",!0),x.value&&D.value?(s(),n("span",Cv,", ")):u("",!0),D.value?(s(),n("span",Av,m(D.value),1)):u("",!0),(x.value||D.value)&&I.value?(s(),n("span",Sv,", ")):u("",!0),I.value?(s(),n("span",Iv,m(I.value),1)):u("",!0),(x.value||D.value||I.value)&&p.value?(s(),n("span",Tv,", ")):u("",!0),p.value?(s(),n("span",Dv,m(p.value),1)):u("",!0)])])])):u("",!0),r.value&&!g.value?(s(),n("div",jv,[e("div",Vv,[l(a(Ee),{class:"w-4 h-4 text-muted-foreground"})]),e("div",qv,[L[25]||(L[25]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Address",-1)),e("div",Mv,m(r.value),1)]),l(a(U),{onClick:L[7]||(L[7]=te=>X(r.value,"address")),variant:"ghost",size:"icon",class:"opacity-0 group-hover:opacity-100 transition-opacity shrink-0",title:"Copy address"},{default:k(()=>[l(a(me),{class:"w-4 h-4"})]),_:1})])):u("",!0)])])):u("",!0),t.externalId||y.value||V.value||ee.value||t.contactCustomFields&&Object.keys(t.contactCustomFields).length>0?(s(),n("div",Lv,[L[31]||(L[31]=e("h4",{class:"text-xs font-semibold text-muted-foreground uppercase tracking-wide"},"Metadata",-1)),e("div",Ov,[ee.value?(s(),n("div",Nv,[l(a(xt),{class:"w-3.5 h-3.5 text-muted-foreground shrink-0"}),L[27]||(L[27]=e("span",{class:"text-xs text-muted-foreground"},"Preferred Method:",-1)),e("span",Ev,m(ee.value),1)])):u("",!0),t.externalId?(s(),n("div",Pv,[l(a(on),{class:"w-3.5 h-3.5 text-muted-foreground shrink-0"}),L[28]||(L[28]=e("span",{class:"text-xs text-muted-foreground"},"External ID:",-1)),e("span",Rv,m(t.externalId),1),l(a(U),{onClick:L[8]||(L[8]=te=>X(t.externalId,"External ID")),variant:"ghost",size:"icon",class:"opacity-0 group-hover:opacity-100 transition-opacity shrink-0 h-5 w-5 ml-auto",title:"Copy External ID"},{default:k(()=>[l(a(me),{class:"w-3 h-3"})]),_:1})])):u("",!0),y.value?(s(),n("div",Fv,[l(a(Bt),{class:"w-3.5 h-3.5 text-muted-foreground shrink-0"}),L[29]||(L[29]=e("span",{class:"text-xs text-muted-foreground"},"Created:",-1)),e("span",Uv,m(se(y.value)),1)])):u("",!0),V.value?(s(),n("div",Bv,[l(a(Nt),{class:"w-3.5 h-3.5 text-muted-foreground shrink-0"}),L[30]||(L[30]=e("span",{class:"text-xs text-muted-foreground"},"Last Updated:",-1)),e("span",_v,m(se(V.value)),1)])):u("",!0),t.contactCustomFields&&Object.keys(t.contactCustomFields).length>0?(s(!0),n(G,{key:4},Z(t.contactCustomFields,(te,ge)=>(s(),n("div",{key:ge,class:"flex items-center gap-2"},[l(a(Ue),{class:"w-3.5 h-3.5 text-muted-foreground shrink-0"}),e("span",zv,m(ge)+":",1),e("span",Wv,m(te),1)]))),128)):u("",!0)])])):u("",!0),Y.value?u("",!0):(s(),n("div",Hv,[...L[32]||(L[32]=[e("p",{class:"text-xs"},"No contact details available",-1)])]))])],64))]),_:1}),l(Ne,{show:C.value,title:"Edit Contact",onClose:L[9]||(L[9]=te=>C.value=!1)},null,8,["show"])]),_:1}))}},Gv={class:"flex items-center justify-between"},Kv={key:0,class:"space-y-3 animate-pulse"},Qv={key:1,class:"space-y-4"},Jv={class:"space-y-2"},Zv={class:"space-y-2"},Xv={key:0,class:"flex items-center gap-3"},ep={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},tp={class:"flex-1 min-w-0"},sp={class:"text-sm font-medium text-foreground"},ap={key:1,class:"flex items-center gap-3"},np={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},lp={class:"flex-1 min-w-0"},op={class:"text-sm text-foreground"},ip={key:2,class:"flex items-center gap-3"},rp={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},dp={class:"flex-1 min-w-0"},up={key:3,class:"flex items-center gap-3"},cp={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},mp={class:"flex-1 min-w-0"},fp={class:"text-sm text-foreground"},vp={key:4,class:"flex items-center gap-3"},pp={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},yp={class:"flex-1 min-w-0"},gp={class:"text-sm text-foreground"},xp={key:5,class:"flex items-center gap-3 group"},hp={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},bp={class:"flex-1 min-w-0"},kp=["href"],wp={key:6,class:"flex items-center gap-3 group"},$p={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},Cp={class:"flex-1 min-w-0"},Ap=["href"],Sp={key:7,class:"flex items-center gap-3 group"},Ip={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},Tp={class:"flex-1 min-w-0"},Dp=["href"],jp={key:0,class:"space-y-2"},Vp={class:"space-y-2"},qp={key:0,class:"flex items-center gap-3 group"},Mp={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},Lp={class:"flex-1 min-w-0"},Op={class:"text-sm text-foreground"},Np={key:1,class:"flex items-center gap-3 group"},Ep={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},Pp={class:"flex-1 min-w-0"},Rp={class:"text-sm text-foreground"},Fp={key:2,class:"flex items-center gap-3"},Up={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},Bp={class:"flex-1 min-w-0"},_p={class:"text-sm text-foreground"},zp={key:3,class:"flex items-center gap-3"},Wp={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},Hp={class:"flex-1 min-w-0"},Yp={class:"text-sm text-foreground"},Gp={key:4,class:"flex items-center gap-3"},Kp={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},Qp={class:"flex-1 min-w-0"},Jp={class:"text-sm text-foreground"},Zp={key:1,class:"space-y-2"},Xp={class:"space-y-2"},ey={key:0,class:"flex items-center gap-3 group"},ty={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},sy={class:"flex-1 min-w-0"},ay={class:"text-sm text-foreground"},ny={key:1,class:"flex items-center gap-3"},ly={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},oy={class:"flex-1 min-w-0"},iy={class:"text-sm text-foreground"},ry={key:2,class:"flex items-center gap-3"},dy={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},uy={class:"flex-1 min-w-0"},cy={class:"text-sm text-foreground"},my={key:0},fy={key:1},vy={key:2},py={key:3},yy={key:4},gy={key:5},xy={key:6},hy={key:2,class:"space-y-2"},by={class:"space-y-2"},ky={key:0,class:"flex items-center justify-between gap-3 p-2 hover:bg-muted/50 rounded-md transition-colors"},wy={class:"flex items-center gap-3 flex-1 min-w-0"},$y={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},Cy={class:"flex-1 min-w-0"},Ay={class:"text-sm font-medium text-foreground"},Sy={key:1,class:"flex items-center justify-between gap-3 p-2 hover:bg-muted/50 rounded-md transition-colors"},Iy={class:"flex items-center gap-3 flex-1 min-w-0"},Ty={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},Dy={class:"flex-1 min-w-0"},jy={class:"text-sm font-medium text-foreground"},Vy={key:2,class:"flex items-center justify-between gap-3 p-2 hover:bg-muted/50 rounded-md transition-colors"},qy={class:"flex items-center gap-3 flex-1 min-w-0"},My={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},Ly={class:"flex-1 min-w-0"},Oy={class:"text-sm font-medium text-foreground"},Ny={key:3,class:"flex items-center justify-between gap-3 p-2 hover:bg-muted/50 rounded-md transition-colors"},Ey={class:"flex items-center gap-3 flex-1 min-w-0"},Py={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},Ry={class:"flex-1 min-w-0"},Fy={class:"text-sm font-medium text-foreground"},Uy={key:3,class:"space-y-2"},By={class:"flex items-start gap-3"},_y={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},zy={class:"flex-1 min-w-0"},Wy={class:"text-sm text-foreground whitespace-pre-line"},Hy={key:4,class:"space-y-2"},Yy={class:"flex flex-wrap gap-1.5"},Gy={key:5,class:"space-y-2"},Ky={class:"space-y-2"},Qy={key:0,class:"flex items-center gap-3 group"},Jy={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},Zy={class:"flex-1 min-w-0"},Xy={class:"text-sm text-foreground font-mono"},eg={key:1,class:"flex items-center gap-3"},tg={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},sg={class:"flex-1 min-w-0"},ag={class:"text-sm text-foreground"},ng={key:2,class:"flex items-center gap-3"},lg={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},og={class:"flex-1 min-w-0"},ig={class:"text-sm text-foreground"},rg={key:3,class:"flex items-center gap-3"},dg={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},ug={class:"flex-1 min-w-0"},cg={class:"text-sm text-foreground"},mg={key:4,class:"space-y-1"},fg={class:"w-8 h-8 rounded bg-muted flex items-center justify-center shrink-0"},vg={class:"flex-1 min-w-0"},pg={class:"text-xs text-muted-foreground mb-0.5"},yg={class:"text-sm text-foreground"},gg={key:6,class:"text-center py-6 text-muted-foreground"},xg={__name:"AccountDetailsCard",props:{accountData:{type:Object,default:null},currentContactId:{type:[Number,String],default:null},accountStatus:{type:String,default:"Active"},companyWebsite:{type:String,default:""},companyPhone:{type:String,default:""},companyEmail:{type:String,default:""},companyAddress:{type:[String,Object],default:()=>""},companyStreetAddress1:{type:String,default:""},companyStreetAddress2:{type:String,default:""},companyCity:{type:String,default:""},companyPostalCode:{type:String,default:""},companyRegion:{type:String,default:""},companyCountry:{type:String,default:""},fiscalEntity:{type:[String,Object],default:()=>""},accountExternalId:{type:String,default:""},accountCustomFields:{type:Object,default:()=>({})},accountCreatedAt:{type:String,default:""},createdDate:{type:String,default:""},accountUpdatedAt:{type:String,default:""},lastUpdatedDate:{type:String,default:""},lastActivity:{type:String,default:""},lastActivityDate:{type:String,default:""},relatedContactsCount:{type:[Number,Object],default:void 0},relatedLeadsCount:{type:[Number,Object],default:void 0},relatedOpportunitiesCount:{type:[Number,Object],default:void 0},relatedVehiclesCount:{type:[Number,Object],default:void 0},accountTags:{type:Array,default:()=>[]},paymentTerms:{type:String,default:""},creditLimit:{type:String,default:""},loading:{type:Boolean,default:!1}},setup(t){const o=t,v=Za(),C=E(!1),j=E(!1),$=E(!1),f=E(!1),c=E(!1),w=A(()=>typeof o.fiscalEntity=="object"&&o.fiscalEntity!==null?o.fiscalEntity.name||"":o.fiscalEntity||""),h=A(()=>typeof o.companyAddress=="object"&&o.companyAddress!==null?o.companyAddress.streetLine1||"":o.companyStreetAddress1||""),d=A(()=>typeof o.companyAddress=="object"&&o.companyAddress!==null?o.companyAddress.streetLine2||"":o.companyStreetAddress2||""),i=A(()=>typeof o.companyAddress=="object"&&o.companyAddress!==null?o.companyAddress.city||"":o.companyCity||""),x=A(()=>typeof o.companyAddress=="object"&&o.companyAddress!==null?o.companyAddress.postalCode||"":o.companyPostalCode||""),D=A(()=>typeof o.companyAddress=="object"&&o.companyAddress!==null?o.companyAddress.region||"":o.companyRegion||""),I=A(()=>typeof o.companyAddress=="object"&&o.companyAddress!==null?o.companyAddress.country||"":o.companyCountry||""),p=A(()=>typeof o.relatedContactsCount=="object"&&o.relatedContactsCount!==null?o.relatedContactsCount.count||0:o.relatedContactsCount??0),r=A(()=>typeof o.relatedLeadsCount=="object"&&o.relatedLeadsCount!==null?o.relatedLeadsCount.count||0:o.relatedLeadsCount??0),g=A(()=>typeof o.relatedOpportunitiesCount=="object"&&o.relatedOpportunitiesCount!==null?o.relatedOpportunitiesCount.count||0:o.relatedOpportunitiesCount??0),y=A(()=>typeof o.relatedVehiclesCount=="object"&&o.relatedVehiclesCount!==null?o.relatedVehiclesCount.count||0:o.relatedVehiclesCount??0),V=A(()=>o.accountCreatedAt||o.createdDate||""),Y=A(()=>o.accountUpdatedAt||o.lastUpdatedDate||""),ee=A(()=>o.lastActivity||o.lastActivityDate||""),se=A(()=>{var W,T,F,O;return!!((W=o.accountData)!=null&&W.vat||(T=o.accountData)!=null&&T.vatNumber||(F=o.accountData)!=null&&F.taxCode||(O=o.accountData)!=null&&O.fiscalCode||w.value)}),X=A(()=>!!(h.value||i.value||x.value||D.value||I.value)),ne=A(()=>p.value!==void 0&&p.value!==null||r.value!==void 0&&r.value!==null||g.value!==void 0&&g.value!==null||y.value!==void 0&&y.value!==null),L=A(()=>!!(o.accountExternalId||o.accountCreatedAt||o.accountUpdatedAt||o.lastActivity||o.accountCustomFields&&Object.keys(o.accountCustomFields).length>0)),te=A(()=>{var W,T,F,O;return!!((W=o.accountData)!=null&&W.name||(T=o.accountData)!=null&&T.companyName||se.value||X.value||ne.value||(F=o.accountData)!=null&&F.description||(O=o.accountData)!=null&&O.notes||o.accountTags&&o.accountTags.length>0||L.value)}),ge=W=>W?typeof W=="string"?W:W.name?W.name:W.firstName&&W.lastName?`${W.firstName} ${W.lastName}`:"Unknown":"Not assigned",$e=W=>{if(!W)return"";try{return new Date(W).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return W}},de=async(W,T)=>{try{await navigator.clipboard.writeText(W),v.pushToast("success",`${T} copied!`)}catch{v.pushToast("error","Failed to copy")}};return(W,T)=>t.accountData||t.loading?(s(),P(a(ze),{key:0,class:"h-full"},{default:k(()=>[l(a(Be),null,{default:k(()=>[e("div",Gv,[l(a(ot),{class:"text-sm font-semibold leading-5"},{default:k(()=>[...T[17]||(T[17]=[q("Account Details",-1)])]),_:1}),l(a(U),{onClick:T[0]||(T[0]=F=>C.value=!0),variant:"ghost",size:"sm",class:"text-xs"},{default:k(()=>[...T[18]||(T[18]=[q(" Edit Account ",-1)])]),_:1})])]),_:1}),l(a(_e),null,{default:k(()=>[t.loading?(s(),n("div",Kv,[...T[19]||(T[19]=[e("div",{class:"h-4 bg-muted rounded w-3/4"},null,-1),e("div",{class:"h-4 bg-muted rounded w-2/3"},null,-1),e("div",{class:"h-4 bg-muted rounded w-4/5"},null,-1),e("div",{class:"h-4 bg-muted rounded w-1/2"},null,-1)])])):t.accountData?(s(),n("div",Qv,[e("div",Jv,[T[28]||(T[28]=e("h4",{class:"text-xs font-semibold text-muted-foreground uppercase tracking-wide"},"Company Info",-1)),e("div",Zv,[t.accountData.name||t.accountData.companyName?(s(),n("div",Xv,[e("div",ep,[l(a(_a),{class:"w-4 h-4 text-muted-foreground"})]),e("div",tp,[T[20]||(T[20]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Company Name",-1)),e("div",sp,m(t.accountData.name||t.accountData.companyName),1)]),t.accountData.type?(s(),P(a(ce),{key:0,variant:"outline",class:"text-xs"},{default:k(()=>[q(m(t.accountData.type),1)]),_:1})):u("",!0)])):u("",!0),t.accountData.type?(s(),n("div",ap,[e("div",np,[l(a(Ue),{class:"w-4 h-4 text-muted-foreground"})]),e("div",lp,[T[21]||(T[21]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Account Type",-1)),e("div",op,m(t.accountData.type==="Company"?"Company Account":"Private Account"),1)])])):u("",!0),t.accountStatus?(s(),n("div",ip,[e("div",rp,[l(a(En),{class:"w-4 h-4 text-muted-foreground"})]),e("div",dp,[T[22]||(T[22]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Account Status",-1)),l(a(ce),{variant:t.accountStatus==="Active"?"default":"outline",class:"text-xs"},{default:k(()=>[q(m(t.accountStatus),1)]),_:1},8,["variant"])])])):u("",!0),t.accountData.accountOwner||t.accountData.owner?(s(),n("div",up,[e("div",cp,[l(a(gt),{class:"w-4 h-4 text-muted-foreground"})]),e("div",mp,[T[23]||(T[23]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Account Owner",-1)),e("div",fp,m(ge(t.accountData.accountOwner||t.accountData.owner)),1)])])):u("",!0),t.accountData.type==="Company"&&t.accountData.numberOfEmployees?(s(),n("div",vp,[e("div",pp,[l(a(Ot),{class:"w-4 h-4 text-muted-foreground"})]),e("div",yp,[T[24]||(T[24]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Employees",-1)),e("div",gp,m(t.accountData.numberOfEmployees),1)])])):u("",!0),t.companyWebsite?(s(),n("div",xp,[e("div",hp,[l(a(gn),{class:"w-4 h-4 text-muted-foreground"})]),e("div",bp,[T[25]||(T[25]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Website",-1)),e("a",{href:t.companyWebsite.startsWith("http")?t.companyWebsite:`https://${t.companyWebsite}`,target:"_blank",rel:"noopener noreferrer",class:"text-sm text-primary hover:underline truncate block"},m(t.companyWebsite),9,kp)]),l(a(U),{onClick:T[1]||(T[1]=F=>de(t.companyWebsite,"Website")),variant:"ghost",size:"icon",class:"opacity-0 group-hover:opacity-100 transition-opacity shrink-0",title:"Copy website"},{default:k(()=>[l(a(me),{class:"w-4 h-4"})]),_:1})])):u("",!0),t.companyPhone?(s(),n("div",wp,[e("div",$p,[l(a(lt),{class:"w-4 h-4 text-muted-foreground"})]),e("div",Cp,[T[26]||(T[26]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Company Phone",-1)),e("a",{href:`tel:${t.companyPhone}`,class:"text-sm text-primary hover:underline"},m(t.companyPhone),9,Ap)]),l(a(U),{onClick:T[2]||(T[2]=F=>de(t.companyPhone,"Phone")),variant:"ghost",size:"icon",class:"opacity-0 group-hover:opacity-100 transition-opacity shrink-0",title:"Copy phone"},{default:k(()=>[l(a(me),{class:"w-4 h-4"})]),_:1})])):u("",!0),t.companyEmail?(s(),n("div",Sp,[e("div",Ip,[l(a(nt),{class:"w-4 h-4 text-muted-foreground"})]),e("div",Tp,[T[27]||(T[27]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Company Email",-1)),e("a",{href:`mailto:${t.companyEmail}`,class:"text-sm text-primary hover:underline truncate block"},m(t.companyEmail),9,Dp)]),l(a(U),{onClick:T[3]||(T[3]=F=>de(t.companyEmail,"Email")),variant:"ghost",size:"icon",class:"opacity-0 group-hover:opacity-100 transition-opacity shrink-0",title:"Copy email"},{default:k(()=>[l(a(me),{class:"w-4 h-4"})]),_:1})])):u("",!0)])]),se.value?(s(),n("div",jp,[T[34]||(T[34]=e("h4",{class:"text-xs font-semibold text-muted-foreground uppercase tracking-wide"},"Legal/Business",-1)),e("div",Vp,[t.accountData.vat||t.accountData.vatNumber?(s(),n("div",qp,[e("div",Mp,[l(a(Ue),{class:"w-4 h-4 text-muted-foreground"})]),e("div",Lp,[T[29]||(T[29]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"VAT Number",-1)),e("div",Op,m(t.accountData.vat||t.accountData.vatNumber),1)]),l(a(U),{onClick:T[4]||(T[4]=F=>de(t.accountData.vat||t.accountData.vatNumber,"VAT")),variant:"ghost",size:"icon",class:"opacity-0 group-hover:opacity-100 transition-opacity shrink-0",title:"Copy VAT"},{default:k(()=>[l(a(me),{class:"w-4 h-4"})]),_:1})])):u("",!0),t.accountData.taxCode||t.accountData.fiscalCode?(s(),n("div",Np,[e("div",Ep,[l(a(Ue),{class:"w-4 h-4 text-muted-foreground"})]),e("div",Pp,[T[30]||(T[30]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Tax Code",-1)),e("div",Rp,m(t.accountData.taxCode||t.accountData.fiscalCode),1)]),l(a(U),{onClick:T[5]||(T[5]=F=>de(t.accountData.taxCode||t.accountData.fiscalCode,"Tax Code")),variant:"ghost",size:"icon",class:"opacity-0 group-hover:opacity-100 transition-opacity shrink-0",title:"Copy Tax Code"},{default:k(()=>[l(a(me),{class:"w-4 h-4"})]),_:1})])):u("",!0),w.value?(s(),n("div",Fp,[e("div",Up,[l(a(_a),{class:"w-4 h-4 text-muted-foreground"})]),e("div",Bp,[T[31]||(T[31]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Fiscal Entity",-1)),e("div",_p,m(w.value),1)])])):u("",!0),t.paymentTerms?(s(),n("div",zp,[e("div",Wp,[l(a(Ue),{class:"w-4 h-4 text-muted-foreground"})]),e("div",Hp,[T[32]||(T[32]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Payment Terms",-1)),e("div",Yp,m(t.paymentTerms),1)])])):u("",!0),t.creditLimit?(s(),n("div",Gp,[e("div",Kp,[l(a(ln),{class:"w-4 h-4 text-muted-foreground"})]),e("div",Qp,[T[33]||(T[33]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Credit Limit",-1)),e("div",Jp,m(t.creditLimit),1)])])):u("",!0)])])):u("",!0),X.value?(s(),n("div",Zp,[T[36]||(T[36]=e("h4",{class:"text-xs font-semibold text-muted-foreground uppercase tracking-wide"},"Address",-1)),e("div",Xp,[h.value?(s(),n("div",ey,[e("div",ty,[l(a(Ee),{class:"w-4 h-4 text-muted-foreground"})]),e("div",sy,[T[35]||(T[35]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Street Address",-1)),e("div",ay,m(h.value),1)]),l(a(U),{onClick:T[6]||(T[6]=F=>de(h.value,"Address")),variant:"ghost",size:"icon",class:"opacity-0 group-hover:opacity-100 transition-opacity shrink-0",title:"Copy address"},{default:k(()=>[l(a(me),{class:"w-4 h-4"})]),_:1})])):u("",!0),d.value?(s(),n("div",ny,[e("div",ly,[l(a(Ee),{class:"w-4 h-4 text-muted-foreground opacity-0"})]),e("div",oy,[e("div",iy,m(d.value),1)])])):u("",!0),i.value||x.value||D.value||I.value?(s(),n("div",ry,[e("div",dy,[l(a(Ee),{class:"w-4 h-4 text-muted-foreground opacity-0"})]),e("div",uy,[e("div",cy,[i.value?(s(),n("span",my,m(i.value),1)):u("",!0),i.value&&x.value?(s(),n("span",fy,", ")):u("",!0),x.value?(s(),n("span",vy,m(x.value),1)):u("",!0),(i.value||x.value)&&D.value?(s(),n("span",py,", ")):u("",!0),D.value?(s(),n("span",yy,m(D.value),1)):u("",!0),(i.value||x.value||D.value)&&I.value?(s(),n("span",gy,", ")):u("",!0),I.value?(s(),n("span",xy,m(I.value),1)):u("",!0)])])])):u("",!0)])])):u("",!0),ne.value?(s(),n("div",hy,[T[45]||(T[45]=e("h4",{class:"text-xs font-semibold text-muted-foreground uppercase tracking-wide"},"Relationships",-1)),e("div",by,[p.value!==void 0&&p.value!==null?(s(),n("div",ky,[e("div",wy,[e("div",$y,[l(a(Ot),{class:"w-4 h-4 text-muted-foreground"})]),e("div",Cy,[T[37]||(T[37]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Related Contacts",-1)),e("div",Ay,m(p.value),1)])]),l(a(U),{onClick:T[7]||(T[7]=F=>j.value=!0),variant:"ghost",size:"sm",class:"text-xs shrink-0"},{default:k(()=>[...T[38]||(T[38]=[q(" View All ",-1)])]),_:1})])):u("",!0),r.value!==void 0&&r.value!==null?(s(),n("div",Sy,[e("div",Iy,[e("div",Ty,[l(a(sl),{class:"w-4 h-4 text-muted-foreground"})]),e("div",Dy,[T[39]||(T[39]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Related Leads",-1)),e("div",jy,m(r.value),1)])]),l(a(U),{onClick:T[8]||(T[8]=F=>$.value=!0),variant:"ghost",size:"sm",class:"text-xs shrink-0"},{default:k(()=>[...T[40]||(T[40]=[q(" View All ",-1)])]),_:1})])):u("",!0),g.value!==void 0&&g.value!==null?(s(),n("div",Vy,[e("div",qy,[e("div",My,[l(a(Jn),{class:"w-4 h-4 text-muted-foreground"})]),e("div",Ly,[T[41]||(T[41]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Related Opportunities",-1)),e("div",Oy,m(g.value),1)])]),l(a(U),{onClick:T[9]||(T[9]=F=>f.value=!0),variant:"ghost",size:"sm",class:"text-xs shrink-0"},{default:k(()=>[...T[42]||(T[42]=[q(" View All ",-1)])]),_:1})])):u("",!0),y.value!==void 0&&y.value!==null?(s(),n("div",Ny,[e("div",Ey,[e("div",Py,[l(a(sn),{class:"w-4 h-4 text-muted-foreground"})]),e("div",Ry,[T[43]||(T[43]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Related Vehicles",-1)),e("div",Fy,m(y.value),1)])]),l(a(U),{onClick:T[10]||(T[10]=F=>c.value=!0),variant:"ghost",size:"sm",class:"text-xs shrink-0"},{default:k(()=>[...T[44]||(T[44]=[q(" View All ",-1)])]),_:1})])):u("",!0)])])):u("",!0),t.accountData.description||t.accountData.notes?(s(),n("div",Uy,[T[47]||(T[47]=e("h4",{class:"text-xs font-semibold text-muted-foreground uppercase tracking-wide"},"Additional Info",-1)),e("div",By,[e("div",_y,[l(a(Ue),{class:"w-4 h-4 text-muted-foreground"})]),e("div",zy,[T[46]||(T[46]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Description",-1)),e("div",Wy,m(t.accountData.description||t.accountData.notes),1)])])])):u("",!0),t.accountTags&&t.accountTags.length>0?(s(),n("div",Hy,[T[48]||(T[48]=e("h4",{class:"text-xs font-semibold text-muted-foreground uppercase tracking-wide"},"Tags",-1)),e("div",Yy,[(s(!0),n(G,null,Z(t.accountTags,F=>(s(),P(a(ce),{key:F,variant:"outline",class:"text-xs"},{default:k(()=>[q(m(F),1)]),_:2},1024))),128))])])):u("",!0),L.value?(s(),n("div",Gy,[T[53]||(T[53]=e("h4",{class:"text-xs font-semibold text-muted-foreground uppercase tracking-wide"},"Metadata",-1)),e("div",Ky,[t.accountExternalId?(s(),n("div",Qy,[e("div",Jy,[l(a(on),{class:"w-4 h-4 text-muted-foreground"})]),e("div",Zy,[T[49]||(T[49]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"External ID",-1)),e("div",Xy,m(t.accountExternalId),1)]),l(a(U),{onClick:T[11]||(T[11]=F=>de(t.accountExternalId,"External ID")),variant:"ghost",size:"icon",class:"opacity-0 group-hover:opacity-100 transition-opacity shrink-0",title:"Copy External ID"},{default:k(()=>[l(a(me),{class:"w-4 h-4"})]),_:1})])):u("",!0),V.value?(s(),n("div",eg,[e("div",tg,[l(a(Bt),{class:"w-4 h-4 text-muted-foreground"})]),e("div",sg,[T[50]||(T[50]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Created Date",-1)),e("div",ag,m($e(V.value)),1)])])):u("",!0),Y.value?(s(),n("div",ng,[e("div",lg,[l(a(Nt),{class:"w-4 h-4 text-muted-foreground"})]),e("div",og,[T[51]||(T[51]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Last Updated",-1)),e("div",ig,m($e(Y.value)),1)])])):u("",!0),ee.value?(s(),n("div",rg,[e("div",dg,[l(a(Qn),{class:"w-4 h-4 text-muted-foreground"})]),e("div",ug,[T[52]||(T[52]=e("div",{class:"text-xs text-muted-foreground mb-0.5"},"Last Activity",-1)),e("div",cg,m($e(ee.value)),1)])])):u("",!0),t.accountCustomFields&&Object.keys(t.accountCustomFields).length>0?(s(),n("div",mg,[(s(!0),n(G,null,Z(t.accountCustomFields,(F,O)=>(s(),n("div",{key:O,class:"flex items-center gap-3"},[e("div",fg,[l(a(Ue),{class:"w-4 h-4 text-muted-foreground"})]),e("div",vg,[e("div",pg,m(O),1),e("div",yg,m(F),1)])]))),128))])):u("",!0)])])):u("",!0),te.value?u("",!0):(s(),n("div",gg,[...T[54]||(T[54]=[e("p",{class:"text-xs"},"No account details available",-1)])]))])):u("",!0)]),_:1}),l(Ne,{show:C.value,title:"Edit Account",onClose:T[12]||(T[12]=F=>C.value=!1)},null,8,["show"]),l(Ne,{show:j.value,title:"View All Contacts",onClose:T[13]||(T[13]=F=>j.value=!1)},null,8,["show"]),l(Ne,{show:$.value,title:"View All Leads",onClose:T[14]||(T[14]=F=>$.value=!1)},null,8,["show"]),l(Ne,{show:f.value,title:"View All Opportunities",onClose:T[15]||(T[15]=F=>f.value=!1)},null,8,["show"]),l(Ne,{show:c.value,title:"View All Vehicles",onClose:T[16]||(T[16]=F=>c.value=!1)},null,8,["show"])]),_:1})):u("",!0)}},hg={class:"flex items-center gap-2"},bg={key:0,class:"space-y-3 animate-pulse"},kg={key:1,class:"space-y-2"},wg=["onClick"],$g={class:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center shrink-0"},Cg={class:"text-xs font-semibold text-primary"},Ag={class:"flex-1 min-w-0"},Sg={class:"flex items-center gap-2 mb-0.5"},Ig={class:"text-sm font-medium text-foreground truncate"},Tg={key:0,class:"text-xs text-muted-foreground truncate"},Dg={class:"flex items-center gap-3 mt-1"},jg={key:0,class:"flex items-center gap-1 text-xs text-muted-foreground"},Vg={class:"truncate max-w-32"},qg={key:1,class:"flex items-center gap-1 text-xs text-muted-foreground"},Mg={class:"truncate"},Lg={key:2,class:"text-center py-6 text-muted-foreground"},Og={__name:"RelatedContactsWidget",props:{relatedContacts:{type:Array,default:()=>[]},masterContactId:{type:[Number,String],default:null},currentContactId:{type:[Number,String],default:null},accountData:{type:Object,default:null},loading:{type:Boolean,default:!1}},setup(t){const o=t,v=je(),C=f=>o.masterContactId?String(f)===String(o.masterContactId):!1,j=f=>{if(!f)return"?";const c=f.trim().split(" ");return c.length>=2?(c[0][0]+c[c.length-1][0]).toUpperCase():f.substring(0,2).toUpperCase()},$=f=>{f&&String(f)!==String(o.currentContactId)&&v.push({path:`/customer/${f}`,query:{type:"contact"}})};return(f,c)=>t.accountData||t.loading?(s(),P(a(ze),{key:0,class:"h-full"},{default:k(()=>[l(a(Be),null,{default:k(()=>[e("div",hg,[l(a(Ot),{class:"w-4 h-4 text-foreground"}),l(a(ot),{class:"text-sm font-semibold leading-5"},{default:k(()=>[...c[0]||(c[0]=[q("Related Contacts",-1)])]),_:1})])]),_:1}),l(a(_e),null,{default:k(()=>[t.loading?(s(),n("div",bg,[(s(),n(G,null,Z(3,w=>e("div",{key:`skeleton-${w}`,class:"flex items-center gap-3 p-3"},[...c[1]||(c[1]=[e("div",{class:"w-10 h-10 bg-muted rounded-full"},null,-1),e("div",{class:"flex-1 space-y-2"},[e("div",{class:"h-4 bg-muted rounded w-3/4"}),e("div",{class:"h-3 bg-muted rounded w-1/2"})],-1)])])),64))])):t.relatedContacts&&t.relatedContacts.length>0?(s(),n("div",kg,[(s(!0),n(G,null,Z(t.relatedContacts,w=>(s(),n("div",{key:w.id,onClick:h=>$(w.id),class:"flex items-center gap-3 p-3 hover:bg-muted transition-colors rounded-md cursor-pointer group"},[e("div",$g,[e("span",Cg,m(w.initials||j(w.name)),1)]),e("div",Ag,[e("div",Sg,[e("span",Ig,m(w.name),1),C(w.id)?(s(),P(a(ce),{key:0,variant:"outline",class:"text-xs px-1.5 py-0"},{default:k(()=>[l(a(dn),{class:"w-3 h-3 mr-1"}),c[2]||(c[2]=q(" Master ",-1))]),_:1})):u("",!0)]),w.jobTitle||w.title?(s(),n("div",Tg,m(w.jobTitle||w.title),1)):u("",!0),e("div",Dg,[w.email?(s(),n("div",jg,[l(a(nt),{class:"w-3 h-3"}),e("span",Vg,m(w.email),1)])):u("",!0),w.phone?(s(),n("div",qg,[l(a(lt),{class:"w-3 h-3"}),e("span",Mg,m(w.phone),1)])):u("",!0)])]),l(a(yt),{class:"w-4 h-4 text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity shrink-0"})],8,wg))),128))])):t.loading?u("",!0):(s(),n("div",Lg,[l(a(Ot),{class:"w-8 h-8 mx-auto mb-2 opacity-30"}),c[3]||(c[3]=e("p",{class:"text-xs"},"No related contacts found",-1))]))]),_:1})]),_:1})):u("",!0)}},Ng={class:"h-full flex flex-col overflow-hidden bg-surface"},Eg={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 auto-rows-min"},Pg={class:"h-auto"},Rg={class:"h-auto"},Fg={key:0,class:"h-auto"},Ug={key:1,class:"h-auto"},Bg={class:"lg:col-span-2 h-auto"},_g={class:"lg:col-span-2 h-auto"},zg={key:2,class:"lg:col-span-2 h-auto"},Wg={class:"flex flex-col gap-6 mb-6"},t1={__name:"CustomerProfile",props:{customerId:{type:Number,required:!0},customerType:{type:String,default:"contact",validator:t=>["contact","account"].includes(t)},showCloseButton:{type:Boolean,default:!1},closeOnConvert:{type:Boolean,default:!1}},emits:["close"],setup(t,{emit:o}){const v=t,C=o,j=je();Qa(),Xa();const $=en(),f=E(!1),c=E(!1),w=E(!1),h=E(!1),d=E(!1),i=E(!1),x=E(!1),D=E(!1),I=E(null),p=E(null),r=E(null),g=E([]),y=E([]),V=E([]),Y=E([]),ee=E([]),se=E([]),X=E([]),ne=A(()=>"contact"),L=A(()=>p.value||$.currentCustomer),te=A(()=>{var B,ve,we;if(!r.value||!p.value)return((B=p.value)==null?void 0:B.isMasterContact)===!0;const R=r.value.masterContactId||((ve=r.value.masterContact)==null?void 0:ve.id),H=p.value.id||p.value.contactId;return R&&String(R)===String(H)||((we=p.value)==null?void 0:we.isMasterContact)===!0}),ge=A(()=>{const R=L.value;return R?{...R,id:R.id,type:"contact",customer:{id:R.id,name:R.name,email:R.email,phone:R.phone,address:R.address||"",initials:R.initials},source:R.source||"Direct",tags:R.tags||[],stage:"Contact",assignee:null,assigneeId:null}:{id:null,type:"contact",summary:null,preferences:[],customer:{id:null,name:"",email:"",phone:"",address:"",initials:"?"},source:"Direct",tags:[],stage:"Contact",assignee:null,assigneeId:null}}),$e=A(()=>{const R=new Date,H=(X.value||[]).filter(B=>(B==null?void 0:B.start)&&new Date(B.start)>=R);return H.sort((B,ve)=>new Date(B.start)-new Date(ve.start)),H.length>0?H[0]:null}),de=A(()=>null),W=A(()=>({currentActivities:A(()=>se.value),addActivity:async()=>{},updateActivity:async()=>{},deleteActivity:async()=>{}})),T=A(()=>({overviewActions:[],tabActions:["note","email","sms","whatsapp","attachment"]})),F=async()=>{var R,H,B,ve;if(v.customerId)try{f.value=!0,h.value=!0,d.value=!0,i.value=!0,x.value=!0,D.value=!0;const[we,Ce]=await Promise.all([$.fetchCustomerById(v.customerId,v.customerType).finally(()=>{f.value=!1}),Wn(v.customerId)]);p.value=we||$.currentCustomer,Y.value=Ce.data||[];const pe=((R=p.value)==null?void 0:R.accountId)||((H=p.value)==null?void 0:H.account_id);if(pe)try{if(c.value=!0,r.value=await kn(pe),((B=r.value)==null?void 0:B.type)==="Company"||((ve=r.value)==null?void 0:ve.accountType)==="Company")try{w.value=!0;const oe=await Hn(pe);g.value=(oe.data||[]).filter(ye=>ye.id!==v.customerId)}catch(oe){console.error("Failed to load related contacts:",oe),g.value=[]}finally{w.value=!1}else g.value=[]}catch(oe){console.error("Failed to load account data:",oe),r.value=null,g.value=[]}finally{c.value=!1}else r.value=null,g.value=[];const[Ge,Ae,Le]=await Promise.all([Yn(v.customerId,pe||null).finally(()=>{h.value=!1}),Gn(v.customerId,pe||null).finally(()=>{d.value=!1}),Kn(pe||v.customerId).finally(()=>{i.value=!1})]);y.value=Ge.data||[],V.value=Ae.data||[],ee.value=Le.data||[];const Ve=[];for(const oe of y.value)try{const ye=await xn(oe.id);Ve.push(...ye)}catch(ye){console.error(`Failed to load activities for lead ${oe.id}:`,ye)}for(const oe of V.value)try{const ye=await hn(oe.id);Ve.push(...ye)}catch(ye){console.error(`Failed to load activities for opportunity ${oe.id}:`,ye)}se.value=Ve,x.value=!1;try{X.value=await zn(v.customerId)}catch(oe){console.error("Failed to load appointments:",oe),X.value=[]}finally{D.value=!1}}catch(we){console.error("Error loading customer data:",we),I.value=we.message||"Failed to load customer",f.value=!1,c.value=!1,w.value=!1,h.value=!1,d.value=!1,i.value=!1,x.value=!1,D.value=!1}},O=async R=>{try{await $.addRequestedCar(v.customerId,R),await F()}catch(H){console.error("Error adding car to customer:",H),I.value=H.message||"Failed to add car"}},N=async()=>{try{h.value=!0;const R=await $.convertToLead(v.customerId);v.closeOnConvert&&C("close"),j.push({path:`/tasks/${R.id}`,query:{type:"lead"}})}catch(R){console.error("Error converting to lead:",R),I.value=R.message||"Failed to convert to lead",h.value=!1}},xe=async()=>{try{d.value=!0;const R=await $.convertToOpportunity(v.customerId);v.closeOnConvert&&C("close"),j.push({path:`/tasks/${R.id}`,query:{type:"opportunity"}})}catch(R){console.error("Error converting to opportunity:",R),I.value=R.message||"Failed to convert to opportunity",d.value=!1}},be=E(!1),ke=E("lead"),We=A(()=>{if(!L.value)return{id:null,name:"Unknown",email:"",phone:"",initials:"?"};const R=L.value;return{id:R.id,name:R.name||"Unknown",email:R.email||"",phone:R.phone||"",initials:R.initials||"?"}}),Pe=R=>{ke.value=R,be.value=!0},He=async R=>{try{if(ke.value==="lead"?h.value=!0:d.value=!0,be.value=!1,!v.customerId)throw new Error("Customer ID not found");ke.value==="lead"?await $.convertToLead(v.customerId):await $.convertToOpportunity(v.customerId),await F()}catch(H){console.error(`Error adding ${ke.value}:`,H),I.value=H.message||`Failed to add ${ke.value}`,ke.value==="lead"?h.value=!1:d.value=!1}},Ye=async()=>{await F()},it=async()=>{await F()};return ht(async()=>{await F()}),De(()=>v.customerId,R=>{R&&F()}),(R,H)=>(s(),n("div",Ng,[l(nc,{task:ge.value,type:ne.value,"management-widget":de.value,"store-adapter":W.value,"add-new-config":T.value,"show-close-button":t.showCloseButton,onClose:H[2]||(H[2]=B=>R.$emit("close")),onCarAdded:O,onConvertToLead:N,onConvertToOpportunity:xe,onTagUpdated:Ye,onAppointmentCreated:it},{"pinned-extra":k(({task:B})=>{var ve,we,Ce,pe,Ge,Ae,Le,Ve,oe,ye,rt,Ke,dt,qe,bt,ut,kt,wt,$t,Ct,At,St,It,Tt,Dt,Me,ct,mt,jt,Vt,qt,Mt,b,S,_,K,ie,ue,he,M,Q,Re,Fe,ft,Qe,Je,Lt,vt,pt,Se,Ie,Zt,Xt,es,ts,ss,as,ns,ls,os,is,rs,ds,us,cs,ms,fs,vs,ps,ys,gs,xs,hs,bs,ks,ws,$s,Cs,As,Ss,Is,Ts,Ds,js,Vs,qs,Ms,Ls,Os,Ns,Es,Ps,Rs,Fs,Us,Bs,_s,zs,Ws,Hs,Ys,Gs,Ks,Qs,Js,Zs,Xs,ea,ta,sa,aa,na,la,oa,ia,ra,da,ua,ca,ma,fa,va,pa,ya,ga,xa,ha,ba,ka,wa,$a,Ca,Aa,Sa,Ia,Ta,Da,ja,Va,qa,Ma,La,Oa;return[e("div",Eg,[e("div",Pg,[l(Yv,{name:((ve=p.value)==null?void 0:ve.name)||((we=B==null?void 0:B.customer)==null?void 0:we.name)||"","first-name":((Ce=p.value)==null?void 0:Ce.firstName)||"","last-name":((pe=p.value)==null?void 0:pe.lastName)||"",initials:((Ge=p.value)==null?void 0:Ge.initials)||((Ae=B==null?void 0:B.customer)==null?void 0:Ae.initials)||"",title:((Le=p.value)==null?void 0:Le.title)||((Ve=p.value)==null?void 0:Ve.salutation)||"",salutation:((oe=p.value)==null?void 0:oe.salutation)||((ye=p.value)==null?void 0:ye.title)||"","job-title":((rt=p.value)==null?void 0:rt.jobTitle)||"","birth-date":((Ke=p.value)==null?void 0:Ke.birthDate)||"",gender:((dt=p.value)==null?void 0:dt.gender)||"","place-of-birth":((qe=p.value)==null?void 0:qe.placeOfBirth)||"",email:((bt=p.value)==null?void 0:bt.email)||((ut=B==null?void 0:B.customer)==null?void 0:ut.email)||"","secondary-email":((kt=p.value)==null?void 0:kt.secondaryEmail)||"",phone:((wt=p.value)==null?void 0:wt.phone)||(($t=B==null?void 0:B.customer)==null?void 0:$t.phone)||"","secondary-phone":((Ct=p.value)==null?void 0:Ct.secondaryPhone)||"","mobile-phone":((At=p.value)==null?void 0:At.mobilePhone)||"","preferred-contact-method":((St=p.value)==null?void 0:St.preferredContactMethod)||((It=p.value)==null?void 0:It.preferredChannel)||"","preferred-channel":((Tt=p.value)==null?void 0:Tt.preferredChannel)||"",address:((Dt=p.value)==null?void 0:Dt.address)||((Me=B==null?void 0:B.customer)==null?void 0:Me.address)||"","street-address1":((ct=p.value)==null?void 0:ct.streetAddress1)||((mt=p.value)==null?void 0:mt.streetAddress)||((Vt=(jt=p.value)==null?void 0:jt.address)==null?void 0:Vt.streetLine1)||"","street-address2":((qt=p.value)==null?void 0:qt.streetAddress2)||((b=(Mt=p.value)==null?void 0:Mt.address)==null?void 0:b.streetLine2)||"",city:((S=p.value)==null?void 0:S.city)||((K=(_=p.value)==null?void 0:_.address)==null?void 0:K.city)||"","postal-code":((ie=p.value)==null?void 0:ie.postalCode)||((ue=p.value)==null?void 0:ue.zipCode)||((M=(he=p.value)==null?void 0:he.address)==null?void 0:M.postalCode)||"",region:((Q=p.value)==null?void 0:Q.region)||((Re=p.value)==null?void 0:Re.state)||((Fe=p.value)==null?void 0:Fe.county)||((Qe=(ft=p.value)==null?void 0:ft.address)==null?void 0:Qe.region)||"",country:((Je=p.value)==null?void 0:Je.country)||((vt=(Lt=p.value)==null?void 0:Lt.address)==null?void 0:vt.country)||"","contact-custom-fields":((pt=p.value)==null?void 0:pt.customFields)||((Se=p.value)==null?void 0:Se.contactCustomFields)||{},"external-id":((Ie=p.value)==null?void 0:Ie.externalId)||((Zt=p.value)==null?void 0:Zt.contactExternalId)||"","created-at":((Xt=p.value)==null?void 0:Xt.createdAt)||((es=p.value)==null?void 0:es.createdDate)||"","created-date":((ts=p.value)==null?void 0:ts.createdDate)||((ss=p.value)==null?void 0:ss.createdAt)||"","updated-at":((as=p.value)==null?void 0:as.updatedAt)||((ns=p.value)==null?void 0:ns.lastUpdatedDate)||((ls=p.value)==null?void 0:ls.lastContact)||"","last-updated-date":((os=p.value)==null?void 0:os.lastUpdatedDate)||((is=p.value)==null?void 0:is.updatedAt)||"","last-activity-date":((rs=p.value)==null?void 0:rs.lastActivityDate)||"","is-master-contact":te.value,"account-name":((ds=r.value)==null?void 0:ds.name)||((us=r.value)==null?void 0:us.companyName)||"",loading:f.value},null,8,["name","first-name","last-name","initials","title","salutation","job-title","birth-date","gender","place-of-birth","email","secondary-email","phone","secondary-phone","mobile-phone","preferred-contact-method","preferred-channel","address","street-address1","street-address2","city","postal-code","region","country","contact-custom-fields","external-id","created-at","created-date","updated-at","last-updated-date","last-activity-date","is-master-contact","account-name","loading"])]),e("div",Rg,[l(Tm,{summary:(B==null?void 0:B.summary)||((cs=p.value)==null?void 0:cs.summary),preferences:(B==null?void 0:B.preferences)||((ms=p.value)==null?void 0:ms.preferences),"customer-data":p.value,loading:f.value},null,8,["summary","preferences","customer-data","loading"])]),r.value&&r.value.type==="Company"?(s(),n("div",Fg,[l(xg,{"account-data":r.value,"current-contact-id":t.customerId,"account-status":((fs=r.value)==null?void 0:fs.status)||((vs=r.value)==null?void 0:vs.accountStatus)||"Active","company-website":((ps=r.value)==null?void 0:ps.website)||((ys=r.value)==null?void 0:ys.companyWebsite)||"","company-phone":((gs=r.value)==null?void 0:gs.companyPhone)||((xs=r.value)==null?void 0:xs.phone)||"","company-email":((hs=r.value)==null?void 0:hs.companyEmail)||((bs=r.value)==null?void 0:bs.email)||"","company-address":((ks=r.value)==null?void 0:ks.companyAddress)||((ws=r.value)==null?void 0:ws.address)||"","company-street-address1":((Cs=($s=r.value)==null?void 0:$s.companyAddress)==null?void 0:Cs.streetLine1)||((As=r.value)==null?void 0:As.streetAddress1)||((Ss=r.value)==null?void 0:Ss.companyStreetAddress)||((Ts=(Is=r.value)==null?void 0:Is.address)==null?void 0:Ts.streetLine1)||(typeof((Ds=r.value)==null?void 0:Ds.address)=="string"?(Vs=(js=r.value)==null?void 0:js.address)==null?void 0:Vs.split(",")[0]:"")||"","company-street-address2":((Ms=(qs=r.value)==null?void 0:qs.companyAddress)==null?void 0:Ms.streetLine2)||((Ls=r.value)==null?void 0:Ls.streetAddress2)||((Ns=(Os=r.value)==null?void 0:Os.address)==null?void 0:Ns.streetLine2)||"","company-city":((Ps=(Es=r.value)==null?void 0:Es.companyAddress)==null?void 0:Ps.city)||((Rs=r.value)==null?void 0:Rs.city)||((Fs=r.value)==null?void 0:Fs.companyCity)||((Bs=(Us=r.value)==null?void 0:Us.address)==null?void 0:Bs.city)||"","company-postal-code":((zs=(_s=r.value)==null?void 0:_s.companyAddress)==null?void 0:zs.postalCode)||((Ws=r.value)==null?void 0:Ws.postalCode)||((Hs=r.value)==null?void 0:Hs.zipCode)||((Ys=r.value)==null?void 0:Ys.companyPostalCode)||((Ks=(Gs=r.value)==null?void 0:Gs.address)==null?void 0:Ks.postalCode)||"","company-region":((Js=(Qs=r.value)==null?void 0:Qs.companyAddress)==null?void 0:Js.region)||((Zs=r.value)==null?void 0:Zs.region)||((Xs=r.value)==null?void 0:Xs.state)||((ea=r.value)==null?void 0:ea.county)||((ta=r.value)==null?void 0:ta.companyRegion)||((aa=(sa=r.value)==null?void 0:sa.address)==null?void 0:aa.region)||"","company-country":((la=(na=r.value)==null?void 0:na.companyAddress)==null?void 0:la.country)||((oa=r.value)==null?void 0:oa.country)||((ia=r.value)==null?void 0:ia.companyCountry)||((da=(ra=r.value)==null?void 0:ra.address)==null?void 0:da.country)||"","fiscal-entity":((ua=r.value)==null?void 0:ua.fiscalEntity)||((ca=r.value)==null?void 0:ca.fiscalEntityName)||"","account-external-id":((ma=r.value)==null?void 0:ma.externalId)||((fa=r.value)==null?void 0:fa.accountExternalId)||"","account-custom-fields":((va=r.value)==null?void 0:va.customFields)||((pa=r.value)==null?void 0:pa.accountCustomFields)||{},"account-created-at":((ya=r.value)==null?void 0:ya.createdAt)||((ga=r.value)==null?void 0:ga.createdDate)||"","created-date":((xa=r.value)==null?void 0:xa.createdDate)||((ha=r.value)==null?void 0:ha.createdAt)||"","account-updated-at":((ba=r.value)==null?void 0:ba.updatedAt)||((ka=r.value)==null?void 0:ka.lastUpdatedDate)||((wa=r.value)==null?void 0:wa.lastContact)||"","last-updated-date":(($a=r.value)==null?void 0:$a.lastUpdatedDate)||((Ca=r.value)==null?void 0:Ca.updatedAt)||"","last-activity":((Aa=r.value)==null?void 0:Aa.lastActivity)||((Sa=r.value)==null?void 0:Sa.lastActivityDate)||((Ia=r.value)==null?void 0:Ia.lastContact)||"","last-activity-date":((Ta=r.value)==null?void 0:Ta.lastActivityDate)||((Da=r.value)==null?void 0:Da.lastActivity)||"","related-contacts-count":g.value.length,"related-leads-count":y.value.length,"related-opportunities-count":V.value.length,"related-vehicles-count":ee.value.length,"account-tags":((ja=r.value)==null?void 0:ja.tags)||[],"payment-terms":((Va=r.value)==null?void 0:Va.paymentTerms)||"","credit-limit":((qa=r.value)==null?void 0:qa.creditLimit)||"",loading:c.value},null,8,["account-data","current-contact-id","account-status","company-website","company-phone","company-email","company-address","company-street-address1","company-street-address2","company-city","company-postal-code","company-region","company-country","fiscal-entity","account-external-id","account-custom-fields","account-created-at","created-date","account-updated-at","last-updated-date","last-activity","last-activity-date","related-contacts-count","related-leads-count","related-opportunities-count","related-vehicles-count","account-tags","payment-terms","credit-limit","loading"])])):u("",!0),r.value&&r.value.type==="Company"?(s(),n("div",Ug,[l(Og,{"related-contacts":g.value,"master-contact-id":((Ma=r.value)==null?void 0:Ma.masterContactId)||((Oa=(La=r.value)==null?void 0:La.masterContact)==null?void 0:Oa.id),"current-contact-id":t.customerId,"account-data":r.value,loading:w.value},null,8,["related-contacts","master-contact-id","current-contact-id","account-data","loading"])])):u("",!0),e("div",Bg,[l(Rm,{leads:y.value,opportunities:V.value,activities:se.value,loading:h.value||d.value||x.value},null,8,["leads","opportunities","activities","loading"])]),e("div",_g,[l(pf,{"next-appointment":$e.value,activities:se.value,leads:y.value,opportunities:V.value,"customer-id":t.customerId,loading:x.value||D.value||h.value||d.value},null,8,["next-appointment","activities","leads","opportunities","customer-id","loading"])]),ee.value.length>0||i.value?(s(),n("div",zg,[l(gm,{cars:ee.value},null,8,["cars"])])):u("",!0)])]}),"tab-negotiations":k(()=>[e("div",Wg,[l(wc,{leads:y.value,"all-tasks":Y.value,loading:h.value,onAddLead:H[0]||(H[0]=B=>Pe("lead"))},null,8,["leads","all-tasks","loading"]),l(Uc,{opportunities:V.value,"all-tasks":Y.value,activities:se.value,loading:d.value,onAddOpportunity:H[1]||(H[1]=B=>Pe("opportunity"))},null,8,["opportunities","all-tasks","activities","loading"])])]),"tab-appointments":k(()=>[l(nm,{appointments:X.value,loading:D.value},null,8,["appointments","loading"])]),_:1},8,["task","type","management-widget","store-adapter","add-new-config","show-close-button"]),L.value?(s(),P(hm,{key:0,show:be.value,type:ke.value,contact:We.value,onClose:H[3]||(H[3]=B=>be.value=!1),onSave:He},null,8,["show","type","contact"])):u("",!0)]))}};export{t1 as _};
