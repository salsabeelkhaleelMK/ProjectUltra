import{O as y,$ as q,r as v,c as f,l as E,G as i,d as F,m as h,e as l,F as H,i as R,z as N,q as V,h as z,o as M,n as L,t as G,g as W,w as j,A as p,C as m,H as $}from"./index-Baowk8yV.js";import{_ as Q}from"./PageHeader-K4h7Nky0.js";import{_ as J}from"./ModalShell-DcQqocRS.js";import{y as X}from"./components-j1JUk8PC.js";import{i as P,Q as B}from"./index-C1tcDFBl.js";import"./toggle-group-item.vue_vue_type_script_setup_true_lang-Csij51_o-N-LQGDgb.js";import"./index-Ct-3v9pQ-DjTMGHGd.js";const T=(o=300)=>new Promise(r=>setTimeout(r,o)),Z=async(o={})=>{await T();let r=[...y];if(o.status&&(r=r.filter(n=>n.status===o.status)),o.brand&&(r=r.filter(n=>n.brand===o.brand)),o.search){const n=o.search.toLowerCase();r=r.filter(c=>c.brand.toLowerCase().includes(n)||c.model.toLowerCase().includes(n)||c.vin.toLowerCase().includes(n))}return{data:r,total:r.length}},_=async o=>{await T();const r=y.find(n=>n.id===parseInt(o));if(!r)throw new Error("Vehicle not found");return r},ee=async o=>{await T();const r={id:y.length+1,...o,stockDays:0};return y.push(r),r},le=async(o,r)=>{await T();const n=y.findIndex(c=>c.id===parseInt(o));if(n===-1)throw new Error("Vehicle not found");return y[n]={...y[n],...r},y[n]},te=async o=>{await T();const r=y.findIndex(n=>n.id===parseInt(o));if(r===-1)throw new Error("Vehicle not found");return y.splice(r,1),{success:!0}},ae=q("vehicles",()=>{const o=v([]),r=v(null),n=v(!1),c=v(null),b=v({status:null,brand:null,search:""}),D=f(()=>o.value.length),C=f(()=>o.value.filter(u=>u.status==="Available")),w=f(()=>o.value.reduce((u,d)=>u+d.price,0));async function I(){n.value=!0,c.value=null;try{const u=await Z(b.value);o.value=u.data}catch(u){c.value=u.message}finally{n.value=!1}}async function K(u){n.value=!0,c.value=null;try{r.value=await _(u)}catch(d){c.value=d.message}finally{n.value=!1}}async function k(u){n.value=!0,c.value=null;try{const d=await ee(u);return o.value.unshift(d),d}catch(d){throw c.value=d.message,d}finally{n.value=!1}}async function s(u,d){n.value=!0,c.value=null;try{const g=await le(u,d),S=o.value.findIndex(U=>U.id===u);return S!==-1&&(o.value[S]=g),g}catch(g){throw c.value=g.message,g}finally{n.value=!1}}async function x(u){n.value=!0,c.value=null;try{await te(u),o.value=o.value.filter(d=>d.id!==u)}catch(d){throw c.value=d.message,d}finally{n.value=!1}}function A(u){b.value={...b.value,...u},I()}return{vehicles:o,currentVehicle:r,loading:n,error:c,filters:b,totalVehicles:D,availableVehicles:C,totalInventoryValue:w,loadVehicles:I,loadVehicleById:K,addVehicle:k,modifyVehicle:s,removeVehicle:x,setFilters:A}}),se={class:"page-container"},ne={class:"p-4 md:p-8"},re={class:"flex items-center gap-3 mb-4 overflow-x-auto pb-2 scrollbar-hide"},oe=["onClick"],ie={class:"text-sm font-medium text-foreground whitespace-nowrap"},ue={class:"table-wrapper w-full"},ce={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},de=["max"],pe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ve={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},me={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ye={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Te={__name:"Vehicles",setup(o){z();const r=ae(),n=v("in-stock"),c=v({pageIndex:0,pageSize:10}),b=v(""),D=v([]),C=v([]),w=f(()=>n.value==="in-stock"?r.vehicles.filter(t=>t.stockDays!==null&&t.stockDays!==void 0):r.vehicles.filter(t=>t.stockDays===null||t.stockDays===void 0)),I=f(()=>[{key:"in-stock",label:"In stock",count:r.vehicles.filter(t=>t.stockDays!==null&&t.stockDays!==void 0).length,borderColor:"border-t-blue-600"},{key:"customer-vehicles",label:"Customers' vehicles",count:r.vehicles.filter(t=>t.stockDays===null||t.stockDays===void 0).length,borderColor:"border-t-purple-600"}]),K=t=>{n.value=t},k=v(!1),s=v({brand:"",model:"",year:"",vin:"",plates:"",fuelType:"",gearType:"",kilometers:"",registration:"",owner:"",ownershipType:"",ownedSince:"",warrantyInfo:"",stockDays:null}),x=()=>{k.value=!1,s.value={brand:"",model:"",year:"",vin:"",plates:"",fuelType:"",gearType:"",kilometers:"",registration:"",owner:"",ownershipType:"",ownedSince:"",warrantyInfo:"",stockDays:null}},A=async()=>{try{const t={brand:s.value.brand,model:s.value.model,year:parseInt(s.value.year)||null,vin:s.value.vin||null,plates:s.value.plates||null,fuelType:s.value.fuelType||null,gearType:s.value.gearType||null,kilometers:parseInt(s.value.kilometers)||0,registration:s.value.registration||null,owner:s.value.owner||null,ownershipType:s.value.ownershipType||null,ownedSince:s.value.ownedSince||null,warrantyInfo:s.value.warrantyInfo||null,stockDays:null,status:"Available"};await r.addVehicle(t),x()}catch(t){console.error("Error adding vehicle:",t)}},u=[{key:"status",label:"Status",type:"select",operators:[{value:"eq",label:"is"},{value:"ne",label:"is not"}],options:[{value:"Available",label:"Available"},{value:"In Stock",label:"In Stock"},{value:"Sold",label:"Sold"}],aiHint:"Vehicle availability status"},{key:"brand",label:"Brand",type:"multiselect",operators:[{value:"in",label:"is any of"},{value:"notIn",label:"is none of"}],options:[{value:"Volkswagen",label:"Volkswagen"},{value:"Mercedes-Benz",label:"Mercedes-Benz"},{value:"Audi",label:"Audi"},{value:"Porsche",label:"Porsche"}],aiHint:"Car manufacturer brand"},{key:"price",label:"Price",type:"inputrange",inputType:"number",operators:[{value:"between",label:"is between"},{value:"gte",label:"is at least"},{value:"lte",label:"is at most"}],prefix:"â‚¬",aiHint:"Vehicle price in euros"},{key:"stockDays",label:"Stock Days",type:"inputrange",inputType:"number",operators:[{value:"between",label:"is between"},{value:"gte",label:"is at least"},{value:"lte",label:"is at most"}],aiHint:"Number of days in stock"}];E(()=>{r.loadVehicles()});const d=t=>{const e=t.original||t;console.log("Vehicle clicked:",e)},g=t=>new Intl.NumberFormat("en-US").format(t),S=f(()=>({class:{tr:()=>"cursor-pointer hover:bg-gray-50 transition-colors"}})),U=t=>t.kilometers===0?t.year===new Date().getFullYear()?"New":"New 0km":"Used",O=t=>t?(typeof t=="string"&&t.includes("/"),t):"N/A",Y=f(()=>n.value==="in-stock"?[{accessorKey:"image",header:"Photo",meta:{title:"Photo"},cell:({row:t})=>{const e=t.original;return e.image?i("img",{src:e.image,alt:`${e.brand} ${e.model}`,class:"w-16 h-16 object-cover rounded-md"}):i("div",{class:"w-16 h-16 bg-gradient-to-br from-gray-100 to-gray-200 rounded-md flex items-center justify-center shrink-0"},[i("i",{class:"fa-solid fa-car text-2xl text-gray-400"})])}},{accessorKey:"brand",header:"Vehicle",meta:{title:"Vehicle"},cell:({row:t})=>{const e=t.original;return i("div",[i("div",{class:"text-content-bold"},`${e.brand} ${e.model}`),i("div",{class:"text-meta"},e.year)])}},{accessorKey:"type",header:"Type",meta:{title:"Type"},cell:({row:t})=>{const e=t.original,a=U(e);return i("span",{class:"text-sm text-gray-600"},a)}},{accessorKey:"engine",header:"Engine",meta:{title:"Engine"},cell:({row:t})=>i("span",{class:"text-sm text-gray-600"},"N/A")},{accessorKey:"fuelType",header:"Fuel type",meta:{title:"Fuel type"},cell:({row:t})=>i("span",{class:"text-sm text-gray-600"},t.original.fuelType||"N/A")},{accessorKey:"gearType",header:"Gear type",meta:{title:"Gear type"},cell:({row:t})=>i("span",{class:"text-sm text-gray-600"},t.original.gearType||"N/A")},{accessorKey:"registration",header:"Registered at",meta:{title:"Registered at"},cell:({row:t})=>{const e=t.original;return i("span",{class:"text-sm text-gray-600"},O(e.registration)||"N/A")}},{accessorKey:"kilometers",header:"Mileage",meta:{title:"Mileage"},cell:({row:t})=>i("span",{class:"text-sm text-gray-600"},`${g(t.original.kilometers)} km`)},{accessorKey:"stockDays",header:"Days in stock",meta:{title:"Days in stock"},cell:({row:t})=>{const e=t.original.stockDays,a=e>300?"text-red-600":"text-gray-600";return i("span",{class:`text-sm font-medium ${a}`},`${e} days`)}},{accessorKey:"dealership",header:"Dealership",meta:{title:"Dealership"},cell:({row:t})=>i("span",{class:"text-sm text-gray-600"},t.original.dealership||"N/A")},{accessorKey:"status",header:"Availability",meta:{title:"Availability"},cell:({row:t})=>{const e=t.original.status;return i(P,{text:e,size:"small",theme:e==="Available"?"green":e==="In Stock"?"blue":"gray"})}}]:[{accessorKey:"brand",header:"Vehicle",meta:{title:"Vehicle"},cell:({row:t})=>{const e=t.original;return i("div",[i("div",{class:"text-content-bold"},`${e.brand} ${e.model}`),i("div",{class:"text-meta"},e.year)])}},{accessorKey:"plates",header:"Plates",meta:{title:"Plates"},cell:({row:t})=>{const e=t.original,a=e.plates||(e.vin?e.vin.slice(-6):null)||"N/A";return i("span",{class:"text-sm text-gray-600"},a)}},{accessorKey:"kilometers",header:"Mileage",meta:{title:"Mileage"},cell:({row:t})=>i("span",{class:"text-sm text-gray-600"},`${g(t.original.kilometers)} km`)},{accessorKey:"registration",header:"Registered at",meta:{title:"Registered at"},cell:({row:t})=>{const e=t.original;return i("span",{class:"text-sm text-gray-600"},O(e.registration)||"N/A")}},{accessorKey:"owner",header:"Owner",meta:{title:"Owner"},cell:({row:t})=>{const e=t.original,a=e.owner||(e.requestedBy&&e.requestedBy.length>0?e.requestedBy[0]:null)||"N/A";return i("span",{class:"text-sm text-gray-600"},a)}},{accessorKey:"ownershipType",header:"Ownership type",meta:{title:"Ownership type"},cell:({row:t})=>i("span",{class:"text-sm text-gray-600"},"N/A")},{accessorKey:"ownedSince",header:"Owned since",meta:{title:"Owned since"},cell:({row:t})=>{const e=t.original;return i("span",{class:"text-sm text-gray-600"},O(e.registration)||"N/A")}},{accessorKey:"warrantyInfo",header:"Warranty info",meta:{title:"Warranty info"},cell:({row:t})=>i("span",{class:"text-sm text-gray-600"},"N/A")}]);return(t,e)=>(M(),F("div",se,[h(Q,{title:"Vehicles Inventory",subtitle:`${w.value.length} vehicles`},null,8,["subtitle"]),l("div",ne,[l("div",re,[(M(!0),F(H,null,R(I.value,a=>(M(),F("button",{key:a.key,onClick:ge=>K(a.key),class:L(["flex items-center justify-between gap-3 px-4 py-3 bg-white border border-border rounded-lg cursor-pointer hover:shadow-sm transition-all shrink-0 min-w-[160px] border-t-4",n.value===a.key?a.borderColor:"border-t-border"])},[l("span",ie,G(a.label),1),h(V(P),{text:String(a.count),size:"small",theme:n.value===a.key?"blue":"gray"},null,8,["text","theme"])],10,oe))),128))]),l("div",ue,[h(V(X),{data:w.value,columns:Y.value,loading:V(r).loading,meta:S.value,onRowClick:d,columnFiltersOptions:{filterDefs:u},pagination:c.value,"onUpdate:pagination":e[1]||(e[1]=a=>c.value=a),globalFilter:b.value,"onUpdate:globalFilter":e[2]||(e[2]=a=>b.value=a),sorting:D.value,"onUpdate:sorting":e[3]||(e[3]=a=>D.value=a),columnFilters:C.value,"onUpdate:columnFilters":e[4]||(e[4]=a=>C.value=a),paginationOptions:{rowCount:w.value.length},globalFilterOptions:{debounce:300,placeholder:"Q Search or ask a question"}},{toolbar:N(()=>[n.value==="customer-vehicles"?(M(),F("button",{key:0,onClick:e[0]||(e[0]=a=>k.value=!0),class:"flex items-center gap-2 px-4 py-2 rounded-lg border border-gray-300 bg-white text-gray-700 font-medium hover:bg-gray-50 transition-colors"},[...e[18]||(e[18]=[l("i",{class:"fa-solid fa-plus"},null,-1),l("span",null,"Add new",-1)])])):W("",!0)]),"empty-state":N(()=>[...e[19]||(e[19]=[l("div",{class:"empty-state"},[l("i",{class:"fa-solid fa-car empty-state-icon"}),l("p",{class:"empty-state-text"},"No vehicles found")],-1)])]),_:1},8,["data","columns","loading","meta","columnFiltersOptions","pagination","globalFilter","sorting","columnFilters","paginationOptions"])])]),h(J,{show:k.value,title:"Add Customer Vehicle",subtitle:"Fill in the details for the new customer vehicle.",onClose:x,size:"lg"},{actions:N(()=>[h(V(B),{label:"Cancel",variant:"outline",onClick:x}),h(V(B),{label:"Add Vehicle",variant:"primary",onClick:A})]),default:N(()=>[l("form",{onSubmit:j(A,["prevent"]),class:"space-y-4"},[l("div",ce,[l("div",null,[e[20]||(e[20]=l("label",{class:"block label-upper mb-2"},"Brand",-1)),p(l("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>s.value.brand=a),type:"text",placeholder:"e.g., Volkswagen",class:"input",required:""},null,512),[[m,s.value.brand]])]),l("div",null,[e[21]||(e[21]=l("label",{class:"block label-upper mb-2"},"Model",-1)),p(l("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>s.value.model=a),type:"text",placeholder:"e.g., ID.4",class:"input",required:""},null,512),[[m,s.value.model]])]),l("div",null,[e[22]||(e[22]=l("label",{class:"block label-upper mb-2"},"Year",-1)),p(l("input",{"onUpdate:modelValue":e[7]||(e[7]=a=>s.value.year=a),type:"number",placeholder:"e.g., 2024",class:"input",min:"1900",max:new Date().getFullYear()+1,required:""},null,8,de),[[m,s.value.year]])])]),l("div",pe,[l("div",null,[e[23]||(e[23]=l("label",{class:"block label-upper mb-2"},"VIN",-1)),p(l("input",{"onUpdate:modelValue":e[8]||(e[8]=a=>s.value.vin=a),type:"text",placeholder:"Vehicle Identification Number",class:"input"},null,512),[[m,s.value.vin]])]),l("div",null,[e[24]||(e[24]=l("label",{class:"block label-upper mb-2"},"Plates",-1)),p(l("input",{"onUpdate:modelValue":e[9]||(e[9]=a=>s.value.plates=a),type:"text",placeholder:"License plate number",class:"input"},null,512),[[m,s.value.plates]])])]),l("div",ve,[l("div",null,[e[26]||(e[26]=l("label",{class:"block label-upper mb-2"},"Fuel Type",-1)),p(l("select",{"onUpdate:modelValue":e[10]||(e[10]=a=>s.value.fuelType=a),class:"input"},[...e[25]||(e[25]=[l("option",{value:""},"Select fuel type...",-1),l("option",{value:"Petrol"},"Petrol",-1),l("option",{value:"Diesel"},"Diesel",-1),l("option",{value:"Electric"},"Electric",-1),l("option",{value:"Hybrid"},"Hybrid",-1),l("option",{value:"Plug-in Hybrid"},"Plug-in Hybrid",-1)])],512),[[$,s.value.fuelType]])]),l("div",null,[e[28]||(e[28]=l("label",{class:"block label-upper mb-2"},"Gear Type",-1)),p(l("select",{"onUpdate:modelValue":e[11]||(e[11]=a=>s.value.gearType=a),class:"input"},[...e[27]||(e[27]=[l("option",{value:""},"Select gear type...",-1),l("option",{value:"Manual"},"Manual",-1),l("option",{value:"Automatic"},"Automatic",-1),l("option",{value:"CVT"},"CVT",-1)])],512),[[$,s.value.gearType]])]),l("div",null,[e[29]||(e[29]=l("label",{class:"block label-upper mb-2"},"Mileage (km)",-1)),p(l("input",{"onUpdate:modelValue":e[12]||(e[12]=a=>s.value.kilometers=a),type:"number",placeholder:"0",class:"input",min:"0"},null,512),[[m,s.value.kilometers,void 0,{number:!0}]])])]),l("div",me,[l("div",null,[e[30]||(e[30]=l("label",{class:"block label-upper mb-2"},"Registered At",-1)),p(l("input",{"onUpdate:modelValue":e[13]||(e[13]=a=>s.value.registration=a),type:"text",placeholder:"MM/YYYY (e.g., 01/2024)",class:"input"},null,512),[[m,s.value.registration]])]),l("div",null,[e[31]||(e[31]=l("label",{class:"block label-upper mb-2"},"Owned Since",-1)),p(l("input",{"onUpdate:modelValue":e[14]||(e[14]=a=>s.value.ownedSince=a),type:"text",placeholder:"MM/YYYY (e.g., 01/2024)",class:"input"},null,512),[[m,s.value.ownedSince]])])]),l("div",ye,[l("div",null,[e[32]||(e[32]=l("label",{class:"block label-upper mb-2"},"Owner",-1)),p(l("input",{"onUpdate:modelValue":e[15]||(e[15]=a=>s.value.owner=a),type:"text",placeholder:"Owner name",class:"input"},null,512),[[m,s.value.owner]])]),l("div",null,[e[34]||(e[34]=l("label",{class:"block label-upper mb-2"},"Ownership Type",-1)),p(l("select",{"onUpdate:modelValue":e[16]||(e[16]=a=>s.value.ownershipType=a),class:"input"},[...e[33]||(e[33]=[l("option",{value:""},"Select ownership type...",-1),l("option",{value:"Private"},"Private",-1),l("option",{value:"Company"},"Company",-1),l("option",{value:"Lease"},"Lease",-1),l("option",{value:"Fleet"},"Fleet",-1)])],512),[[$,s.value.ownershipType]])])]),l("div",null,[e[35]||(e[35]=l("label",{class:"block label-upper mb-2"},"Warranty Info",-1)),p(l("textarea",{"onUpdate:modelValue":e[17]||(e[17]=a=>s.value.warrantyInfo=a),rows:"3",placeholder:"Warranty information...",class:"input"},null,512),[[m,s.value.warrantyInfo]])])],32)]),_:1},8,["show"])]))}};export{Te as default};
