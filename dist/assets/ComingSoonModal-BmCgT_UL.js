import{r as S,d as r,o as n,e as t,g as c,n as D,t as y,D as ne,A as C,w as H,k as O,F as M,i as P,c as T,Y as he,p as F,q as $,m as V,H as le,C as q,l as Y,z as B,B as Z,U as ke,h as we,Z as $e,S as Ce,I as L}from"./index-Baowk8yV.js";import{i as Se,Q as ie}from"./index-C1tcDFBl.js";import{_ as Ae}from"./ReassignUserModal-BR__nY6Q.js";import{_ as De}from"./CreateEventModal-ClRjWvQH.js";import{_ as X}from"./ModalShell-DcQqocRS.js";import"./toggle-group-item.vue_vue_type_script_setup_true_lang-Csij51_o-N-LQGDgb.js";const Te={class:"w-full"},Oe={class:"flex items-center justify-between gap-3 md:gap-4"},qe={class:"flex items-center gap-3 md:gap-4 flex-1"},Ne={class:"min-w-0 flex-1"},Ie={class:"flex items-center gap-2"},Ve={class:"heading-main truncate"},Ee={class:"flex flex-wrap items-center gap-2 mt-1"},Fe={class:"flex items-center gap-1 ml-2"},Me={class:"relative"},Ue={key:0,class:"absolute top-full right-0 mt-2 w-48 bg-white border border-gray-200 rounded-xl shadow-lg shadow-gray-100/50 z-50 overflow-hidden flex flex-col p-1"},je={key:0,class:"border-t border-gray-100 my-1"},Be={key:0,class:"mt-4 pt-4 border-t-2 border-dashed border-gray-300 animate-fade-in relative"},We={class:"flex items-center gap-4"},Le={class:"flex flex-wrap items-center gap-x-6 gap-y-2"},Re={class:"flex items-center gap-2"},Pe={class:"text-xs text-gray-900 font-medium"},ze={class:"flex items-center gap-2"},He={class:"text-xs text-gray-900 font-medium"},Ye={class:"flex items-center gap-2"},Ke={class:"w-6 h-6 rounded bg-gray-100 flex items-center justify-center shrink-0"},Qe={key:0,class:"fa-solid fa-map-marker-alt text-gray-500 text-[10px]"},Ge={key:1,class:"fa-regular fa-calendar text-gray-500 text-[10px]"},Je={class:"text-xs text-gray-900 font-medium"},Ze={key:0,class:"absolute -bottom-6 left-0 px-2 py-1 bg-gray-900 text-white text-[10px] rounded shadow-lg whitespace-nowrap"},Xe={__name:"ContactInfo",props:{initials:{type:String,required:!0},name:{type:String,required:!0},avatarColorClass:{type:String,default:"bg-orange-100 text-orange-600"},email:{type:String,required:!0},phone:{type:String,required:!0},thirdFieldValue:{type:String,required:!0},emailLabel:{type:String,default:"Email"},phoneLabel:{type:String,default:"Phone"},thirdFieldLabel:{type:String,default:"Expected Close"},taskType:{type:String,default:"lead"}},emits:["action"],setup(e,{emit:g}){const d={mounted(o,l){o.clickOutsideEvent=b=>{o===b.target||o.contains(b.target)||l.value()},document.addEventListener("click",o.clickOutsideEvent)},unmounted(o){document.removeEventListener("click",o.clickOutsideEvent)}},i=g,f=S(!1),a=S(!1),p=S(null),m=o=>{a.value=!1,i("action",o)},s=async(o,l)=>{try{await navigator.clipboard.writeText(o),p.value=l,setTimeout(()=>{p.value=null},1500)}catch(b){console.error("Failed to copy:",b)}};return(o,l)=>(n(),r("div",Te,[t("div",Oe,[t("div",qe,[t("div",{class:D(["w-12 h-12 rounded-full flex items-center justify-center text-lg font-bold border-2 border-white shadow-sm shrink-0",e.avatarColorClass])},y(e.initials),3),t("div",Ne,[t("div",Ie,[t("h1",Ve,y(e.name),1),ne(o.$slots,"name-action")]),t("div",Ee,[ne(o.$slots,"tags")])])]),t("div",Fe,[t("div",Me,[t("button",{onClick:l[0]||(l[0]=H(b=>a.value=!a.value,["stop"])),class:"w-9 h-9 flex items-center justify-center bg-blue-600 hover:bg-blue-700 text-white rounded-lg shrink-0 transition-colors"},[...l[14]||(l[14]=[t("i",{class:"fa-solid fa-plus text-sm"},null,-1)])]),a.value?C((n(),r("div",Ue,[t("button",{onClick:l[1]||(l[1]=b=>m("note")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Note "),t("button",{onClick:l[2]||(l[2]=b=>m("financing")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Financing "),t("button",{onClick:l[3]||(l[3]=b=>m("tradein")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Trade-in "),t("button",{onClick:l[4]||(l[4]=b=>m("purchase")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Purchase "),t("button",{onClick:l[5]||(l[5]=b=>m("attachment")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Attachment "),l[19]||(l[19]=t("div",{class:"border-t border-gray-100 my-1"},null,-1)),t("button",{onClick:l[6]||(l[6]=b=>m("whatsapp")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...l[15]||(l[15]=[t("i",{class:"fa-brands fa-whatsapp text-xs text-gray-400"},null,-1),O(" WhatsApp msg ",-1)])]),t("button",{onClick:l[7]||(l[7]=b=>m("email")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...l[16]||(l[16]=[t("i",{class:"fa-regular fa-envelope text-xs text-gray-400"},null,-1),O(" Email ",-1)])]),t("button",{onClick:l[8]||(l[8]=b=>m("sms")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...l[17]||(l[17]=[t("i",{class:"fa-solid fa-comment-dots text-xs text-gray-400"},null,-1),O(" SMS ",-1)])]),t("button",{onClick:l[9]||(l[9]=b=>m("call")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...l[18]||(l[18]=[t("i",{class:"fa-solid fa-phone text-xs text-gray-400"},null,-1),O(" Call ",-1)])]),e.taskType==="opportunity"?(n(),r("div",je)):c("",!0),e.taskType==="opportunity"?(n(),r("button",{key:1,onClick:l[10]||(l[10]=b=>m("appointment")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Appointment ")):c("",!0)])),[[d,()=>a.value=!1]]):c("",!0)]),t("button",{onClick:l[11]||(l[11]=b=>f.value=!f.value),class:"w-9 h-9 flex items-center justify-center bg-white border border-gray-200 rounded-lg hover:bg-gray-50 shrink-0"},[t("i",{class:D(["fa-solid fa-chevron-up text-sm transition-transform duration-200",{"rotate-180":f.value}])},null,2)])])]),f.value?(n(),r("div",Be,[t("div",We,[t("div",Le,[t("div",Re,[l[21]||(l[21]=t("div",{class:"w-6 h-6 rounded bg-gray-100 flex items-center justify-center shrink-0"},[t("i",{class:"fa-regular fa-envelope text-gray-500 text-[10px]"})],-1)),t("span",Pe,y(e.email),1),t("button",{onClick:l[12]||(l[12]=H(b=>s(e.email,"email"),["stop"])),class:"w-5 h-5 flex items-center justify-center rounded hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors shrink-0",title:"Copy email"},[...l[20]||(l[20]=[t("i",{class:"fa-regular fa-copy text-[10px]"},null,-1)])])]),t("div",ze,[l[23]||(l[23]=t("div",{class:"w-6 h-6 rounded bg-gray-100 flex items-center justify-center shrink-0"},[t("i",{class:"fa-solid fa-phone text-gray-500 text-[10px]"})],-1)),t("span",He,y(e.phone),1),t("button",{onClick:l[13]||(l[13]=H(b=>s(e.phone,"phone"),["stop"])),class:"w-5 h-5 flex items-center justify-center rounded hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors shrink-0",title:"Copy phone"},[...l[22]||(l[22]=[t("i",{class:"fa-regular fa-copy text-[10px]"},null,-1)])])]),t("div",Ye,[t("div",Ke,[e.thirdFieldLabel.toLowerCase().includes("address")?(n(),r("i",Qe)):(n(),r("i",Ge))]),t("span",Je,y(e.thirdFieldValue),1)])])]),p.value?(n(),r("div",Ze,y(p.value==="email"?"Email":"Phone")+" copied! ",1)):c("",!0)])):c("",!0)]))}},_e={class:"flex gap-0 md:gap-8 text-base font-medium text-slate-500 py-1"},et=["onClick"],tt={class:"hidden md:inline whitespace-nowrap"},at={__name:"Tabs",props:{modelValue:{type:String,required:!0},tabs:{type:Array,required:!0}},emits:["update:modelValue"],setup(e){const g={overview:"fa-solid fa-house",note:"fa-solid fa-note-sticky",communication:"fa-solid fa-comments",attachment:"fa-solid fa-paperclip"},d=i=>g[i]||"fa-solid fa-circle";return(i,f)=>(n(),r("div",_e,[(n(!0),r(M,null,P(e.tabs,a=>(n(),r("div",{key:a.key,onClick:p=>i.$emit("update:modelValue",a.key),class:D(["flex-1 md:flex-none pb-2 border-b-2 cursor-pointer transition-colors flex items-center justify-center gap-1.5",e.modelValue===a.key?"border-slate-900 text-slate-900":"border-transparent hover:text-slate-700 hover:border-slate-200"])},[t("i",{class:D([d(a.key),"text-base md:text-base"])},null,2),t("span",tt,y(a.label),1),a.count!==void 0?(n(),r("span",{key:0,class:D(["inline-flex items-center justify-center px-1.5 md:px-2 py-0.5 rounded-full text-xs font-semibold",e.modelValue===a.key?"bg-gray-200 text-gray-700":"bg-gray-100 text-gray-500"])},y(a.count),3)):c("",!0)],10,et))),128))]))}},st={class:"metadata-bar w-full"},nt={class:"flex items-center gap-1.5 md:gap-2 px-2 md:px-3 py-1.5"},lt={class:"flex items-center gap-1.5"},it={class:"text-[10px] md:text-xs font-bold text-gray-800"},ot={class:"flex items-center gap-1.5 md:gap-2 px-2 md:px-3 py-1.5"},rt={class:"flex items-center gap-1.5 md:gap-2 px-2 md:px-3 py-1.5"},dt={class:"text-[10px] md:text-xs font-bold text-gray-800"},ut={__name:"StageOwnerBar",props:{stage:{type:String,required:!0},owner:{type:String,required:!0},source:{type:String,default:""},deliverySubstatus:{type:String,default:null}},emits:["reassign"],setup(e){const g=e;T(()=>g.deliverySubstatus?he(g.deliverySubstatus):"");const d=T(()=>g.deliverySubstatus?g.deliverySubstatus==="Delivered"?"green":g.deliverySubstatus==="Awaiting Delivery"?"blue":"gray":"gray");return(i,f)=>(n(),r("div",st,[t("div",nt,[f[1]||(f[1]=t("span",{class:"label-upper text-[9px] md:text-xs"},"Stage",-1)),t("div",lt,[t("span",it,y(e.stage),1),e.deliverySubstatus?(n(),F($(Se),{key:0,text:e.deliverySubstatus,size:"small",theme:d.value},null,8,["text","theme"])):c("",!0)])]),f[5]||(f[5]=t("div",{class:"metadata-divider"},null,-1)),t("div",ot,[f[2]||(f[2]=t("span",{class:"label-upper text-[9px] md:text-xs"},"Owner",-1)),t("button",{onClick:f[0]||(f[0]=a=>i.$emit("reassign")),class:"text-[10px] md:text-xs font-bold text-blue-600 hover:text-blue-700 hover:underline transition-colors cursor-pointer"},y(e.owner),1)]),e.source?(n(),r(M,{key:0},[f[4]||(f[4]=t("div",{class:"metadata-divider"},null,-1)),t("div",rt,[f[3]||(f[3]=t("span",{class:"label-upper text-[9px] md:text-xs"},"Source",-1)),t("span",dt,y(e.source),1)])],64)):c("",!0)]))}},ct={key:0,class:"flex-grow border-t border-gray-200"},mt={key:0,class:"absolute top-full right-0 md:left-1/2 md:-translate-x-1/2 mt-2 w-48 bg-white border border-gray-200 rounded-xl shadow-lg shadow-gray-100/50 z-10 overflow-hidden flex flex-col p-1"},ft={key:0,class:"border-t border-gray-100 my-1"},yt={key:1,class:"flex-grow border-t border-gray-200"},gt={__name:"AddNewButton",props:{show:{type:Boolean,default:!0},actions:{type:Array,default:()=>["note","financing","tradein","attachment","email","whatsapp","sms"]},activeTab:{type:String,default:"overview"},inline:{type:Boolean,default:!1}},emits:["action"],setup(e,{emit:g}){const d={mounted(x,u){x.clickOutsideEvent=v=>{x===v.target||x.contains(v.target)||u.value()},document.addEventListener("click",x.clickOutsideEvent)},unmounted(x){document.removeEventListener("click",x.clickOutsideEvent)}},i=e,f=g,a=S(!1),p=T(()=>i.inline?"bg-blue-600 hover:bg-blue-700 text-white font-medium w-9 h-9 rounded-lg shadow-sm transition-all flex items-center justify-center z-20 relative":"bg-gray-50 hover:bg-white border border-gray-200 text-slate-700 font-medium w-9 h-9 rounded-full text-sm shadow-sm transition-all flex items-center justify-center z-20 relative"),m={note:"note",attachment:"attachment",email:"communication",whatsapp:"communication",sms:"communication"},s=T(()=>{if(!i.activeTab||i.activeTab==="overview")return i.actions.filter(u=>!m[u]);const x=Object.entries(m).filter(([,u])=>u===i.activeTab).map(([u])=>u);return i.actions.filter(u=>x.includes(u))}),o=T(()=>s.value.some(x=>["email","whatsapp","sms"].includes(x))),l=T(()=>s.value.some(x=>["addVehicle","configureVehicle"].includes(x))),b=T(()=>s.value.some(x=>["note","financing","tradein","attachment","requestedCar","purchase"].includes(x))),I=x=>{a.value=!1,f("action",x)};return(x,u)=>e.show?(n(),r("div",{key:0,class:D(["relative flex items-center",e.inline?"justify-end mb-0 py-0":"py-1 mb-4"])},[e.inline?c("",!0):(n(),r("div",ct)),t("div",{class:D(["relative",e.inline?"mx-0":"mx-4"])},[t("button",{onClick:u[0]||(u[0]=H(v=>a.value=!a.value,["stop"])),class:D(p.value)},[...u[12]||(u[12]=[t("i",{class:"fa-solid fa-plus text-xs"},null,-1)])],2),a.value?C((n(),r("div",mt,[l.value?(n(),r(M,{key:0},[s.value.includes("addVehicle")?(n(),r("button",{key:0,onClick:u[1]||(u[1]=v=>I("addVehicle")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Add Vehicle ")):c("",!0),s.value.includes("configureVehicle")?(n(),r("button",{key:1,onClick:u[2]||(u[2]=v=>I("configureVehicle")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Configure Vehicle ")):c("",!0)],64)):c("",!0),b.value?(n(),r(M,{key:1},[l.value?(n(),r("div",ft)):c("",!0),s.value.includes("note")?(n(),r("button",{key:1,onClick:u[3]||(u[3]=v=>I("note")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Note ")):c("",!0),s.value.includes("financing")?(n(),r("button",{key:2,onClick:u[4]||(u[4]=v=>I("financing")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Financing ")):c("",!0),s.value.includes("tradein")?(n(),r("button",{key:3,onClick:u[5]||(u[5]=v=>I("tradein")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Trade-in ")):c("",!0),s.value.includes("requestedCar")?(n(),r("button",{key:4,onClick:u[6]||(u[6]=v=>I("requestedCar")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Requested car ")):c("",!0),s.value.includes("purchase")?(n(),r("button",{key:5,onClick:u[7]||(u[7]=v=>I("purchase")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Purchase ")):c("",!0),s.value.includes("attachment")?(n(),r("button",{key:6,onClick:u[8]||(u[8]=v=>I("attachment")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Attachment ")):c("",!0)],64)):c("",!0),o.value?(n(),r(M,{key:2},[u[16]||(u[16]=t("div",{class:"border-t border-gray-100 my-1"},null,-1)),s.value.includes("email")?(n(),r("button",{key:0,onClick:u[9]||(u[9]=v=>I("email")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...u[13]||(u[13]=[t("i",{class:"fa-regular fa-envelope text-xs text-gray-400"},null,-1),O(" Send Email ",-1)])])):c("",!0),s.value.includes("whatsapp")?(n(),r("button",{key:1,onClick:u[10]||(u[10]=v=>I("whatsapp")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...u[14]||(u[14]=[t("i",{class:"fa-brands fa-whatsapp text-xs text-gray-400"},null,-1),O(" Send WhatsApp ",-1)])])):c("",!0),s.value.includes("sms")?(n(),r("button",{key:2,onClick:u[11]||(u[11]=v=>I("sms")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...u[15]||(u[15]=[t("i",{class:"fa-solid fa-comment-dots text-xs text-gray-400"},null,-1),O(" Send SMS ",-1)])])):c("",!0)],64)):c("",!0)])),[[d,()=>a.value=!1]]):c("",!0)],2),e.inline?c("",!0):(n(),r("div",yt))],2)):c("",!0)}},pt={class:"bg-purple-50/50 border border-purple-100 rounded-lg p-4"},vt={class:"flex items-start gap-3"},bt={class:"flex-1 min-w-0"},xt={class:"font-bold text-sm text-slate-800 mb-2"},ht={class:"space-y-1.5 text-xs text-gray-600"},kt={class:"flex items-center gap-2"},wt={class:"flex items-center gap-2"},$t={class:"flex items-center gap-2"},Ct={key:0,class:"mt-2"},St={__name:"AppointmentWidget",props:{appointmentData:{type:Object,required:!0}},setup(e){const g=e,d=T(()=>g.appointmentData.date?new Date(g.appointmentData.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""),i=T(()=>g.appointmentData.time?g.appointmentData.time:""),f=a=>({scheduled:"bg-blue-100 text-blue-700 border border-blue-200",confirmed:"bg-green-100 text-green-700 border border-green-200",pending:"bg-yellow-100 text-yellow-700 border border-yellow-200",cancelled:"bg-red-100 text-red-700 border border-red-200"})[a==null?void 0:a.toLowerCase()]||"bg-gray-100 text-gray-700 border border-gray-200";return(a,p)=>(n(),r("div",pt,[t("div",vt,[p[3]||(p[3]=t("div",{class:"w-10 h-10 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center shrink-0"},[t("i",{class:"fa-solid fa-calendar text-sm"})],-1)),t("div",bt,[t("h4",xt,y(e.appointmentData.type),1),t("div",ht,[t("div",kt,[p[0]||(p[0]=t("i",{class:"fa-regular fa-calendar text-gray-400"},null,-1)),t("span",null,y(d.value),1)]),t("div",wt,[p[1]||(p[1]=t("i",{class:"fa-regular fa-clock text-gray-400"},null,-1)),t("span",null,y(i.value),1)]),t("div",$t,[p[2]||(p[2]=t("i",{class:"fa-solid fa-user text-gray-400"},null,-1)),t("span",null,y(e.appointmentData.assignee),1)])]),e.appointmentData.status?(n(),r("div",Ct,[t("span",{class:D(["inline-flex px-2 py-0.5 rounded text-[10px] font-semibold",f(e.appointmentData.status)])},y(e.appointmentData.status),3)])):c("",!0)])])]))}},At={class:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm flex gap-4 animate-fade-in mb-4 feed-item"},Dt={class:"flex-1"},Tt={class:"flex items-center gap-2 mb-1"},Ot={class:"text-xs font-bold text-slate-800"},qt={class:"text-[10px] text-gray-400"},Nt={class:"text-[10px] text-gray-400"},It={key:0,class:"bg-blue-50 text-blue-600 text-[10px] px-1 py-0.5 rounded border border-blue-100"},Vt={class:"ml-auto relative"},Et={key:0,class:"absolute right-0 top-full mt-1 w-32 bg-white border border-gray-200 rounded-lg shadow-lg z-10 overflow-hidden"},Ft={key:0,class:"text-sm text-slate-700"},Mt={key:1,class:"text-sm text-slate-700 flex items-center gap-2"},Ut={key:2,class:"mt-2"},jt={key:0},Bt={key:1,class:"bg-gray-50 border border-gray-200 rounded-lg p-3"},Wt={key:0},Lt={class:"text-sm font-bold text-slate-800"},Rt={key:0,class:"text-xs text-gray-600 mt-0.5"},Pt={class:"grid grid-cols-2 gap-x-4 gap-y-1 text-xs text-gray-500 mt-2"},zt={key:0},Ht={key:1},Yt={key:2},Kt={key:3},Qt={key:4},Gt={key:1},Jt={class:"text-sm font-bold text-slate-800 mb-2"},Zt={class:"grid grid-cols-2 gap-x-4 gap-y-2 text-xs"},Xt={key:0},_t={class:"text-slate-700 font-medium ml-1"},ea={key:1},ta={class:"text-slate-700 font-medium ml-1"},aa={key:2},sa={class:"text-slate-700 font-medium ml-1"},na={key:3},la={class:"text-slate-700 font-medium ml-1"},ia={key:4},oa={class:"text-slate-700 font-medium ml-1"},ra={key:5},da={class:"text-slate-700 font-medium ml-1"},ua={key:2,class:"flex items-center gap-3"},ca={key:0,class:"w-16 h-16 bg-gray-200 rounded overflow-hidden flex-shrink-0"},ma=["src"],fa={class:"flex-1"},ya={class:"text-sm font-bold text-slate-800"},ga={class:"text-xs text-gray-500"},pa={key:1,class:"bg-purple-600 text-white text-[10px] font-bold px-1 py-0.5 rounded"},va={key:3,class:"flex items-center gap-3"},ba={class:"flex-1"},xa={class:"text-sm font-bold text-slate-800"},ha={class:"text-xs text-gray-500"},ka={key:0,class:"text-xs text-gray-400 mt-1"},wa={key:1,class:"text-xs text-gray-600 mt-1"},me={__name:"FeedItemCard",props:{item:{type:Object,required:!0},taskType:{type:String,default:"lead"},customerInitials:{type:String,required:!0}},emits:["edit","delete"],setup(e,{emit:g}){const d=e,i=g,f=S(!1),a={mounted(x,u){x.clickOutsideEvent=v=>{x===v.target||x.contains(v.target)||u.value()},setTimeout(()=>{document.addEventListener("click",x.clickOutsideEvent)},0)},unmounted(x){document.removeEventListener("click",x.clickOutsideEvent)}},p=x=>({note:"fa-regular fa-note-sticky",communication:"fa-solid fa-comment-dots",email:"fa-regular fa-envelope",whatsapp:"fa-brands fa-whatsapp",sms:"fa-solid fa-comment-dots",attachment:"fa-solid fa-paperclip",tradein:"fa-solid fa-car-side",financing:"fa-solid fa-file-invoice-dollar",offer:"fa-solid fa-handshake",purchase:"fa-solid fa-shopping-cart",appointment:"fa-solid fa-calendar"})[x]||"fa-solid fa-circle",m=x=>({note:"bg-orange-100 text-orange-600 border-orange-200",communication:"bg-gray-100 text-gray-600 border-gray-200",email:"bg-blue-100 text-blue-600 border-blue-200",whatsapp:"bg-green-100 text-green-600 border-green-200",sms:"bg-gray-100 text-gray-600 border-gray-200",attachment:"bg-blue-50 text-blue-600 border-blue-100",tradein:"bg-green-50 text-green-600 border-green-100",financing:"bg-purple-50 text-purple-600 border-purple-100",offer:"bg-indigo-50 text-indigo-600 border-indigo-100",purchase:"bg-teal-50 text-teal-600 border-teal-100",appointment:"bg-purple-100 text-purple-600 border-purple-200"})[x]||"bg-gray-100 text-gray-600 border-gray-200",s=x=>{if(!x)return"Just now";const u=new Date(x),N=new Date-u,w=Math.floor(N/6e4),E=Math.floor(w/60),W=Math.floor(E/24);return w<1?"Just now":w<60?`${w} minutes ago`:E<24?`${E} hours ago`:W===1?"Yesterday":W<7?`${W} days ago`:u.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},o=x=>x?new Intl.NumberFormat("en-US").format(x):"0",l=x=>x?new Date(x).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",b=()=>{f.value=!1,i("edit",d.item)},I=()=>{f.value=!1,confirm("Are you sure you want to delete this item?")&&i("delete",d.item)};return(x,u)=>(n(),r("div",At,[t("div",{class:D(["w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold shrink-0 border",m(e.item.type)])},[t("i",{class:D([p(e.item.type),"text-sm"])},null,2)],2),t("div",Dt,[t("div",Tt,[t("span",Ot,y(e.customerInitials),1),t("span",qt,y(e.item.action||"added"),1),t("span",Nt,"• "+y(s(e.item.timestamp)),1),e.item.autoDetected?(n(),r("span",It,"Auto-detected")):c("",!0),t("div",Vt,[t("button",{onClick:u[0]||(u[0]=H(v=>f.value=!f.value,["stop"])),class:"text-gray-400 hover:text-gray-600 transition-colors p-1",title:"More actions"},[...u[1]||(u[1]=[t("i",{class:"fa-solid fa-ellipsis-vertical text-sm"},null,-1)])]),f.value?C((n(),r("div",Et,[t("button",{onClick:b,class:"w-full text-left px-3 py-2 text-xs text-slate-700 hover:bg-gray-50 flex items-center gap-2"},[...u[2]||(u[2]=[t("i",{class:"fa-solid fa-pencil text-gray-400"},null,-1),O(" Edit ",-1)])]),t("button",{onClick:I,class:"w-full text-left px-3 py-2 text-xs text-red-600 hover:bg-red-50 flex items-center gap-2"},[...u[3]||(u[3]=[t("i",{class:"fa-solid fa-trash text-red-400"},null,-1),O(" Delete ",-1)])])])),[[a,()=>f.value=!1]]):c("",!0)])]),e.item.content?(n(),r("div",Ft,y(e.item.content),1)):c("",!0),e.item.fileName?(n(),r("div",Mt,[u[4]||(u[4]=t("i",{class:"fa-solid fa-paperclip text-gray-400"},null,-1)),t("span",null,y(e.item.fileName),1)])):c("",!0),e.item.data?(n(),r("div",Ut,[e.item.type==="appointment"?(n(),r("div",jt,[V(St,{"appointment-data":e.item.data},null,8,["appointment-data"])])):(n(),r("div",Bt,[e.item.type==="tradein"?(n(),r("div",Wt,[t("h4",Lt,y(e.item.data.brand)+" "+y(e.item.data.model),1),e.item.data.version?(n(),r("p",Rt,y(e.item.data.version),1)):c("",!0),t("div",Pt,[e.item.data.year?(n(),r("div",zt,[u[5]||(u[5]=t("i",{class:"fa-regular fa-calendar mr-1"},null,-1)),O(y(e.item.data.year),1)])):c("",!0),e.item.data.km?(n(),r("div",Ht,[u[6]||(u[6]=t("i",{class:"fa-solid fa-road mr-1"},null,-1)),O(y(e.item.data.km)+" km ",1)])):c("",!0),e.item.data.plate?(n(),r("div",Yt,[u[7]||(u[7]=t("i",{class:"fa-solid fa-id-card mr-1"},null,-1)),O(y(e.item.data.plate),1)])):c("",!0),e.item.data.date?(n(),r("div",Kt,[u[8]||(u[8]=t("i",{class:"fa-regular fa-calendar-check mr-1"},null,-1)),O(y(l(e.item.data.date)),1)])):c("",!0),e.item.data.class?(n(),r("div",Qt,[u[9]||(u[9]=t("i",{class:"fa-solid fa-car mr-1"},null,-1)),O(y(e.item.data.class),1)])):c("",!0)])])):e.item.type==="financing"?(n(),r("div",Gt,[t("h4",Jt,y(e.item.data.product),1),t("div",Zt,[e.item.data.provider?(n(),r("div",Xt,[u[10]||(u[10]=t("span",{class:"text-gray-500"},"Provider:",-1)),t("span",_t,y(e.item.data.provider),1)])):c("",!0),e.item.data.total?(n(),r("div",ea,[u[11]||(u[11]=t("span",{class:"text-gray-500"},"Total:",-1)),t("span",ta,"€"+y(o(e.item.data.total)),1)])):c("",!0),e.item.data.monthly?(n(),r("div",aa,[u[12]||(u[12]=t("span",{class:"text-gray-500"},"Monthly:",-1)),t("span",sa,"€"+y(o(e.item.data.monthly)),1)])):c("",!0),e.item.data.deposit?(n(),r("div",na,[u[13]||(u[13]=t("span",{class:"text-gray-500"},"Deposit:",-1)),t("span",la,"€"+y(o(e.item.data.deposit)),1)])):c("",!0),e.item.data.startDate?(n(),r("div",ia,[u[14]||(u[14]=t("span",{class:"text-gray-500"},"Start:",-1)),t("span",oa,y(l(e.item.data.startDate)),1)])):c("",!0),e.item.data.expDate?(n(),r("div",ra,[u[15]||(u[15]=t("span",{class:"text-gray-500"},"Expires:",-1)),t("span",da,y(l(e.item.data.expDate)),1)])):c("",!0)])])):e.item.type==="offer"?(n(),r("div",ua,[e.item.data.image?(n(),r("div",ca,[t("img",{src:e.item.data.image,alt:"Car",class:"w-full h-full object-cover"},null,8,ma)])):c("",!0),t("div",fa,[t("h4",ya,y(e.item.data.brand)+" "+y(e.item.data.model)+" ("+y(e.item.data.year)+")",1),t("p",ga,"€ "+y(o(e.item.data.price)),1)]),e.item.data.isMainOffer?(n(),r("span",pa,"Main Offer")):c("",!0)])):e.item.type==="purchase"?(n(),r("div",va,[t("div",ba,[t("h4",xa,y(e.item.data.brand)+" "+y(e.item.data.model)+" ("+y(e.item.data.year)+")",1),t("p",ha,"€ "+y(o(e.item.data.price)),1),e.item.data.purchaseDate?(n(),r("p",ka,"Purchased: "+y(l(e.item.data.purchaseDate)),1)):c("",!0),e.item.data.notes?(n(),r("p",wa,y(e.item.data.notes),1)):c("",!0)])])):c("",!0)]))])):c("",!0)])]))}},$a={class:"h-16 px-5 border-b border-gray-100 bg-gray-50/50 flex items-center justify-between gap-3"},Ca={class:"flex items-center gap-3"},Sa=["title"],Aa={key:0,class:"fa-solid fa-arrow-left text-sm"},Da={key:1,class:"fa-solid fa-arrow-right text-sm"},Ta={key:2,class:"font-bold text-lg text-gray-800"},Oa={key:0,class:"flex-1 overflow-y-auto px-5 py-6 scrollbar-hide relative"},qa={key:0,class:"absolute left-[39px] top-0 bottom-0 w-0.5 bg-gray-200 z-0"},Na={key:1,class:"text-center py-8 text-gray-400 relative z-10"},Ia={class:"text-sm"},Va={key:2,class:"space-y-6 relative z-10"},Ea={key:0,class:"mb-4 pl-12"},Fa={class:"text-sm font-semibold text-gray-800"},Ma={class:"flex gap-4 relative mb-6"},Ua={class:"flex-1 min-w-0"},ja={class:"text-sm text-slate-700 leading-snug"},Ba={class:"font-bold"},Wa={key:0,class:"mt-2 bg-orange-50/50 border border-orange-100 p-3 rounded-lg text-sm text-gray-700"},La={class:"text-xs text-gray-400 mt-1"},Ra={key:1,class:"flex-1 overflow-y-auto py-6 scrollbar-hide relative flex flex-col items-center"},Pa={key:0,class:"absolute left-1/2 top-0 bottom-0 w-0.5 bg-gray-200 -translate-x-1/2 z-0"},za={key:1,class:"space-y-4 relative z-10"},Ha=["title"],Ya={key:2,class:"text-center py-8 text-gray-400 relative z-10"},Ka={__name:"ActivitySummarySidebar",props:{title:{type:String,default:"Activity summary"},activities:{type:Array,default:()=>[]},emptyMessage:{type:String,default:"No activities yet"},collapsed:{type:Boolean,default:!0},showCollapse:{type:Boolean,default:!0},show:{type:Boolean,default:!0},mobileFullscreen:{type:Boolean,default:!1}},emits:["toggle-collapse","close"],setup(e,{emit:g}){const d=e,i=s=>{const o={call:"fa-solid fa-phone text-blue-600",email:"fa-solid fa-envelope text-green-600",note:"fa-solid fa-sticky-note text-yellow-600",meeting:"fa-solid fa-calendar text-purple-600",task:"fa-solid fa-check-circle text-indigo-600",attachment:"fa-solid fa-paperclip text-gray-600",status:"fa-solid fa-tag text-orange-600",default:"fa-solid fa-circle text-gray-400"};return o[s]||o.default},f=s=>{const o={call:"bg-blue-100 text-blue-600",email:"bg-green-100 text-green-600",note:"bg-yellow-100 text-yellow-600",meeting:"bg-purple-100 text-purple-600",task:"bg-indigo-100 text-indigo-600",attachment:"bg-gray-100 text-gray-600",status:"bg-orange-100 text-orange-600",default:"bg-gray-100 text-gray-400"};return o[s]||o.default},a=s=>{if(!s)return"";const o=new Date(s),l=new Date,b=new Date(l);return b.setDate(b.getDate()-1),o.toDateString()===l.toDateString()?"Today":o.toDateString()===b.toDateString()?"Yesterday":o.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},p=s=>s?new Date(s).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",m=(s,o)=>{if(s===0)return!0;const l=d.activities[s-1];if(!l)return!0;const b=new Date(o.timestamp).toDateString(),I=new Date(l.timestamp).toDateString();return b!==I};return(s,o)=>e.show?(n(),r("div",{key:0,class:D(["bg-white border-l border-gray-200 shrink-0 flex flex-col transition-all duration-300",[e.collapsed?"w-16":"w-80",e.mobileFullscreen?"xl:relative xl:border-l":""]])},[t("div",$a,[t("div",Ca,[e.mobileFullscreen?(n(),r("button",{key:0,onClick:o[0]||(o[0]=l=>s.$emit("close")),class:"xl:hidden w-8 h-8 flex items-center justify-center text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"},[...o[2]||(o[2]=[t("i",{class:"fa-solid fa-xmark text-lg"},null,-1)])])):e.showCollapse?(n(),r("button",{key:1,onClick:o[1]||(o[1]=l=>s.$emit("toggle-collapse")),class:"w-8 h-8 flex items-center justify-center rounded-md text-gray-400 hover:text-gray-900 hover:bg-gray-100 transition-colors shrink-0",title:e.collapsed?"Expand sidebar":"Collapse sidebar"},[e.collapsed?(n(),r("i",Aa)):(n(),r("i",Da))],8,Sa)):c("",!0),e.collapsed?c("",!0):(n(),r("h2",Ta,y(e.title),1))])]),e.collapsed?(n(),r("div",Ra,[e.activities.length>0?(n(),r("div",Pa)):c("",!0),e.activities.length>0?(n(),r("div",za,[(n(!0),r(M,null,P(e.activities,l=>(n(),r("div",{key:l.id,class:"relative"},[t("div",{class:D(["w-8 h-8 rounded-full flex items-center justify-center shrink-0 z-10 relative bg-white border-2 border-gray-200",f(l.type)]),title:`${l.user} ${l.action}`},[t("i",{class:D([i(l.type),"text-xs"])},null,2)],10,Ha)]))),128))])):(n(),r("div",Ya,[...o[4]||(o[4]=[t("i",{class:"fa-solid fa-clock text-2xl mb-2"},null,-1)])]))])):(n(),r("div",Oa,[e.activities.length>0?(n(),r("div",qa)):c("",!0),e.activities.length===0?(n(),r("div",Na,[o[3]||(o[3]=t("i",{class:"fa-solid fa-clock text-4xl mb-2"},null,-1)),t("p",Ia,y(e.emptyMessage),1)])):(n(),r("div",Va,[(n(!0),r(M,null,P(e.activities,(l,b)=>(n(),r(M,{key:l.id},[m(b,l)?(n(),r("div",Ea,[t("h3",Fa,y(a(l.timestamp)),1)])):c("",!0),t("div",Ma,[t("div",{class:D(["w-10 h-10 rounded-full flex items-center justify-center shrink-0 z-10 relative bg-white",f(l.type)])},[t("i",{class:D([i(l.type),"text-sm"])},null,2)],2),t("div",Ua,[t("div",ja,[t("span",Ba,y(l.user),1),O(" "+y(l.action),1)]),l.content?(n(),r("div",Wa,y(l.content),1)):c("",!0),t("div",La,y(p(l.timestamp)),1)])])],64))),128))]))]))],2)):c("",!0)}},Qa={class:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm mb-6 animate-fade-in relative"},Ga={class:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3"},Ja={class:"mb-3"},Za={class:"flex justify-end gap-2"},Xa={__name:"CommunicationWidget",props:{type:{type:String,required:!0},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(e,{emit:g}){const d=e,i=g,f=S(""),a=S(""),p=()=>{!f.value.trim()&&!a.value||i("save",{type:"communication",action:`sent via ${d.type}`,content:f.value||`Sent template: ${a.value}`,communicationType:d.type})};return(m,s)=>(n(),r("div",Qa,[s[5]||(s[5]=t("div",{class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-t border-l border-gray-200 rotate-45"},null,-1)),t("h5",Ga,y(e.type==="email"?"Send Email":e.type==="whatsapp"?"Send WhatsApp":e.type==="sms"?"Send SMS":"Send Message"),1),t("div",Ja,[s[4]||(s[4]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Template",-1)),C(t("select",{"onUpdate:modelValue":s[0]||(s[0]=o=>a.value=o),class:"input"},[...s[3]||(s[3]=[t("option",{value:""},"Select a template...",-1),t("option",null,"Follow-up",-1),t("option",null,"Meeting Confirmation",-1),t("option",null,"Quote Proposal",-1),t("option",null,"Unable to Reach",-1)])],512),[[le,a.value]])]),C(t("textarea",{"onUpdate:modelValue":s[1]||(s[1]=o=>f.value=o),class:"input mb-3",rows:"4",placeholder:"Type your message here..."},null,512),[[q,f.value]]),t("div",Za,[t("button",{onClick:s[2]||(s[2]=o=>m.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),t("button",{onClick:p,class:"bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Send")])]))}},_a={key:0,class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-t border-l border-gray-200 rotate-45"},es={key:1,class:"flex justify-between items-center mb-4"},ts={class:"text-sm font-bold text-slate-800"},as={key:2,class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},ss={__name:"NoteWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0},hideActions:{type:Boolean,default:!1},hideHeader:{type:Boolean,default:!1}},emits:["save","cancel"],setup(e,{expose:g,emit:d}){const i=e,f=d,a=S("");Y(()=>{i.item&&(a.value=i.item.content||"")});const p=()=>{var m,s;a.value.trim()&&f("save",{id:((m=i.item)==null?void 0:m.id)||Date.now(),type:"note",action:i.item?"updated a note":"added a note",content:a.value,timestamp:((s=i.item)==null?void 0:s.timestamp)||new Date().toISOString(),isEdit:!!i.item})};return g({submit:p,canSubmit:()=>!!a.value.trim()}),(m,s)=>(n(),r("div",{class:D(["animate-fade-in relative",{"bg-white border border-gray-200 rounded-xl p-5 shadow-sm mb-6":!e.hideHeader}])},[e.hideHeader?c("",!0):(n(),r("div",_a)),e.hideHeader?c("",!0):(n(),r("div",es,[t("h5",ts,y(e.item?"Edit Note":"Add Note"),1),t("button",{onClick:s[0]||(s[0]=o=>m.$emit("cancel")),class:"text-gray-400 hover:text-gray-600"},[...s[3]||(s[3]=[t("i",{class:"fa-solid fa-xmark"},null,-1)])])])),t("div",null,[s[4]||(s[4]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Note",-1)),C(t("textarea",{"onUpdate:modelValue":s[1]||(s[1]=o=>a.value=o),rows:"4",class:"input",placeholder:"Enter your note..."},null,512),[[q,a.value]])]),e.hideActions?c("",!0):(n(),r("div",as,[t("button",{onClick:s[2]||(s[2]=o=>m.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),t("button",{onClick:p,class:"bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save")]))],2))}},ns={class:"bg-white border border-gray-200 rounded-xl p-5 shadow-sm mb-6 animate-fade-in relative"},ls={class:"flex justify-between items-center mb-4"},is={class:"text-sm font-bold text-slate-800"},os={class:"flex items-center gap-3"},rs={key:0,class:"text-sm text-slate-600"},ds={key:1,class:"text-sm text-gray-400"},us={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},cs=["disabled"],ms={__name:"AttachmentWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(e,{emit:g}){const d=e,i=g,f=S(null),a=S("");Y(()=>{d.item&&(a.value=d.item.fileName||"")});const p=s=>{const o=s.target.files[0];o&&(f.value=o,a.value=o.name)},m=()=>{var s,o;!f.value&&!d.item||i("save",{id:((s=d.item)==null?void 0:s.id)||Date.now(),type:"attachment",action:d.item?"updated an attachment":"added an attachment",fileName:a.value,timestamp:((o=d.item)==null?void 0:o.timestamp)||new Date().toISOString(),isEdit:!!d.item})};return(s,o)=>(n(),r("div",ns,[o[6]||(o[6]=t("div",{class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-t border-l border-gray-200 rotate-45"},null,-1)),t("div",ls,[t("h5",is,y(e.item?"Edit Attachment":"Add Attachment"),1),t("button",{onClick:o[0]||(o[0]=l=>s.$emit("cancel")),class:"text-gray-400 hover:text-gray-600"},[...o[3]||(o[3]=[t("i",{class:"fa-solid fa-xmark"},null,-1)])])]),t("div",null,[o[5]||(o[5]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"File",-1)),t("div",os,[t("input",{type:"file",onChange:p,ref:"fileInput",class:"hidden"},null,544),t("button",{onClick:o[1]||(o[1]=l=>s.$refs.fileInput.click()),class:"bg-gray-50 hover:bg-gray-100 border border-gray-300 rounded-md px-4 py-2 text-sm text-slate-700 transition-colors"},[...o[4]||(o[4]=[t("i",{class:"fa-solid fa-paperclip mr-2"},null,-1),O("Choose File ",-1)])]),a.value?(n(),r("span",rs,y(a.value),1)):(n(),r("span",ds,"No file selected"))])]),t("div",us,[t("button",{onClick:o[2]||(o[2]=l=>s.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),t("button",{onClick:m,disabled:!f.value,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save",8,cs)])]))}},fs={key:0,class:"mb-8"},ys={class:"flex items-center gap-2 mb-4"},gs={class:"font-bold text-gray-800 text-sm"},ps={class:"bg-white border border-gray-200 rounded-xl shadow-sm mb-6 overflow-hidden"},vs={class:"p-4"},bs={class:"flex items-center justify-between"},xs={class:"flex items-center gap-4"},hs={class:"w-16 h-12 bg-gray-200 rounded-md overflow-hidden shrink-0 border border-gray-100"},ks=["src"],ws={key:1,class:"fa-solid fa-car text-3xl text-gray-400 w-full h-full flex items-center justify-center"},$s={class:"flex items-center gap-2"},Cs={class:"font-bold text-slate-800 text-sm md:text-base"},Ss={class:"mt-1.5 flex items-center gap-2"},As={key:0,class:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-green-50 border border-green-100 text-green-700 text-[10px] font-semibold rounded-md"},Ds={key:1,class:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-orange-50 border border-orange-100 text-orange-700 text-[10px] font-semibold rounded-md"},Ts={key:2,class:"hidden sm:flex items-center gap-1.5 bg-gray-100 hover:bg-gray-200 border border-gray-200 text-slate-700 text-xs font-semibold px-3 py-1.5 rounded-full transition-colors group/btn"},Os={class:"flex items-center gap-4"},qs={key:0,class:"text-right"},Ns={class:"font-bold text-slate-800"},Is={class:"border-t border-gray-200"},Vs={class:"font-medium"},Es={key:0,class:"border-t border-gray-100 p-6 bg-gray-50/30 text-sm animate-fade-in"},Fs={class:"mb-6"},Ms={class:"grid grid-cols-2 md:grid-cols-4 gap-y-4 gap-x-6"},Us={key:0},js={class:"font-medium text-slate-700"},Bs={key:1},Ws={class:"font-medium text-slate-700"},Ls={key:2},Rs={class:"font-medium text-slate-700"},Ps={class:"font-medium text-slate-700"},zs={class:"grid grid-cols-2 md:grid-cols-4 gap-y-4 gap-x-6"},Hs={key:0},Ys={class:"font-medium text-slate-700"},Ks={key:1},Qs={class:"font-medium text-slate-700"},Gs={key:2},Js={class:"font-medium text-slate-700"},Zs={key:3},Xs={class:"font-medium text-slate-700"},_s={key:4},en={class:"font-mono text-xs bg-white border border-gray-200 px-2 py-1 rounded inline-block text-gray-600"},tn={key:5},an={class:"font-medium text-slate-700"},sn={key:0,class:"mt-6 flex justify-end"},nn={key:0,class:"border-t border-gray-200 my-6"},ln={key:1,class:"mb-6 px-6"},on={class:"bg-white border border-gray-200 rounded-lg p-4"},rn={class:"text-sm text-slate-700 leading-relaxed"},dn={__name:"VehicleWidget",props:{show:{type:Boolean,default:!0},label:{type:String,default:"Requested Car"},brand:{type:String,required:!0},model:{type:String,required:!0},year:{type:[Number,String],required:!0},image:{type:String,default:""},price:{type:Number,default:null},requestMessage:{type:String,default:""},requestType:{type:String,default:""},source:{type:String,default:""},dealership:{type:String,default:""},registration:{type:String,default:""},kilometers:{type:Number,default:null},fuelType:{type:String,default:""},gearType:{type:String,default:""},vin:{type:String,default:""},stockDays:{type:Number,default:null},showOpenAd:{type:Boolean,default:!0},showTechnicalSpecs:{type:Boolean,default:!0},channel:{type:String,default:"Email"},adCampaign:{type:String,default:""},expectedPurchaseDate:{type:String,default:""},fiscalEntity:{type:String,default:""},sourceDetails:{type:String,default:""},adMedium:{type:String,default:""},adSource:{type:String,default:""}},setup(e){const g=S(!1),d=f=>new Intl.NumberFormat("en-US").format(f),i=f=>new Intl.NumberFormat("en-US").format(f);return(f,a)=>e.show?(n(),r("div",fs,[t("div",ys,[a[1]||(a[1]=t("i",{class:"fa-solid fa-thumbtack text-gray-400 text-xs"},null,-1)),t("h3",gs,y(e.label),1)]),t("div",ps,[t("div",vs,[t("div",bs,[t("div",xs,[t("div",hs,[e.image?(n(),r("img",{key:0,src:e.image,alt:"Car",class:"w-full h-full object-cover"},null,8,ks)):(n(),r("i",ws))]),t("div",null,[t("div",$s,[t("div",Cs,y(e.brand)+" "+y(e.model)+" ("+y(e.year)+")",1)]),t("div",Ss,[e.stockDays!==void 0&&e.stockDays!==null?(n(),r("div",As,[a[2]||(a[2]=t("div",{class:"w-1 h-1 bg-green-500 rounded-full"},null,-1)),O(" In stock ("+y(e.stockDays)+" days) ",1)])):(n(),r("div",Ds,[...a[3]||(a[3]=[t("div",{class:"w-1 h-1 bg-orange-500 rounded-full"},null,-1),O(" Out of stock ",-1)])])),e.showOpenAd&&e.price?(n(),r("button",Ts,[...a[4]||(a[4]=[O(" Open Ad ",-1),t("i",{class:"fa-solid fa-arrow-up-right-from-square text-[10px] text-gray-400 group-hover/btn:text-gray-800"},null,-1)])])):c("",!0)])])]),t("div",Os,[e.price?(n(),r("div",qs,[a[5]||(a[5]=t("div",{class:"text-xs text-gray-500 font-medium mb-0.5"},"Price",-1)),t("div",Ns,"€ "+y(d(e.price)),1)])):c("",!0)])])]),t("div",Is,[t("button",{onClick:a[0]||(a[0]=p=>g.value=!g.value),class:"w-full p-3 flex items-center justify-center gap-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-50 transition-colors"},[t("span",Vs,y(g.value?"Hide":"View")+" Details",1),t("i",{class:D(["fa-solid fa-chevron-down text-xs transition-transform duration-200",{"rotate-180":g.value}])},null,2)])]),g.value?(n(),r("div",Es,[t("div",Fs,[a[16]||(a[16]=t("h4",{class:"text-xs font-bold uppercase text-gray-500 tracking-wider mb-4"},"REQUEST DETAILS",-1)),t("div",Ms,[e.requestType?(n(),r("div",Us,[a[6]||(a[6]=t("div",{class:"text-xs text-gray-500 mb-1"},"Request type",-1)),t("div",js,y(e.requestType),1)])):c("",!0),e.source?(n(),r("div",Bs,[a[7]||(a[7]=t("div",{class:"text-xs text-gray-500 mb-1"},"Source",-1)),t("div",Ws,y(e.source),1)])):c("",!0),t("div",null,[a[8]||(a[8]=t("div",{class:"text-xs text-gray-500 mb-1"},"Source details",-1)),t("div",{class:D(["font-medium",e.sourceDetails?"text-slate-700":"text-gray-400"])},y(e.sourceDetails||"--"),3)]),e.dealership?(n(),r("div",Ls,[a[9]||(a[9]=t("div",{class:"text-xs text-gray-500 mb-1"},"Dealership",-1)),t("div",Rs,y(e.dealership),1)])):c("",!0),t("div",null,[a[10]||(a[10]=t("div",{class:"text-xs text-gray-500 mb-1"},"Channel",-1)),t("div",Ps,y(e.channel||"Email"),1)]),t("div",null,[a[11]||(a[11]=t("div",{class:"text-xs text-gray-500 mb-1"},"AdCampaign",-1)),t("div",{class:D(["font-medium",e.adCampaign?"text-slate-700":"text-gray-400"])},y(e.adCampaign||"--"),3)]),t("div",null,[a[12]||(a[12]=t("div",{class:"text-xs text-gray-500 mb-1"},"AdMedium",-1)),t("div",{class:D(["font-medium",e.adMedium?"text-slate-700":"text-gray-400"])},y(e.adMedium||"--"),3)]),t("div",null,[a[13]||(a[13]=t("div",{class:"text-xs text-gray-500 mb-1"},"AdSource",-1)),t("div",{class:D(["font-medium",e.adSource?"text-slate-700":"text-gray-400"])},y(e.adSource||"--"),3)]),t("div",null,[a[14]||(a[14]=t("div",{class:"text-xs text-gray-500 mb-1"},"Expected purchase date",-1)),t("div",{class:D(["font-medium",e.expectedPurchaseDate?"text-slate-700":"text-gray-400"])},y(e.expectedPurchaseDate||"--"),3)]),t("div",null,[a[15]||(a[15]=t("div",{class:"text-xs text-gray-500 mb-1"},"Fiscal entity",-1)),t("div",{class:D(["font-medium",e.fiscalEntity?"text-slate-700":"text-gray-400"])},y(e.fiscalEntity||"--"),3)])])]),a[26]||(a[26]=t("div",{class:"border-t border-gray-200 my-4"},null,-1)),t("div",null,[a[24]||(a[24]=t("div",{class:"flex justify-between items-center mb-4"},[t("h4",{class:"text-xs font-bold uppercase text-gray-500 tracking-wider"},"VEHICLE DETAILS")],-1)),t("div",zs,[e.registration?(n(),r("div",Hs,[a[17]||(a[17]=t("div",{class:"text-xs text-gray-500 mb-1"},"Registration",-1)),t("div",Ys,y(e.registration),1)])):c("",!0),e.kilometers!==void 0&&e.kilometers!==null?(n(),r("div",Ks,[a[18]||(a[18]=t("div",{class:"text-xs text-gray-500 mb-1"},"Kilometers",-1)),t("div",Qs,y(i(e.kilometers))+" Km",1)])):c("",!0),e.fuelType?(n(),r("div",Gs,[a[19]||(a[19]=t("div",{class:"text-xs text-gray-500 mb-1"},"Fuel type",-1)),t("div",Js,y(e.fuelType),1)])):c("",!0),e.gearType?(n(),r("div",Zs,[a[20]||(a[20]=t("div",{class:"text-xs text-gray-500 mb-1"},"Gear type",-1)),t("div",Xs,y(e.gearType),1)])):c("",!0),e.vin?(n(),r("div",_s,[a[21]||(a[21]=t("div",{class:"text-xs text-gray-500 mb-1"},"VIN Number",-1)),t("div",en,y(e.vin),1)])):c("",!0),e.dealership?(n(),r("div",tn,[a[22]||(a[22]=t("div",{class:"text-xs text-gray-500 mb-1"},"Dealership",-1)),t("div",an,y(e.dealership),1)])):c("",!0)]),e.showTechnicalSpecs?(n(),r("div",sn,[...a[23]||(a[23]=[t("button",{class:"bg-white border border-gray-200 text-slate-700 hover:text-blue-600 hover:border-blue-200 font-medium px-4 py-2 rounded-lg text-xs transition-colors flex items-center gap-2 group"},[t("i",{class:"fa-solid fa-list-check text-gray-400 group-hover:text-blue-500"}),O(" View technical specs ")],-1)])])):c("",!0)]),e.requestMessage?(n(),r("div",nn)):c("",!0),e.requestMessage?(n(),r("div",ln,[a[25]||(a[25]=t("h4",{class:"text-xs font-bold uppercase text-gray-500 tracking-wider mb-4"},"REQUEST MESSAGE",-1)),t("div",on,[t("p",rn,y(e.requestMessage),1)])])):c("",!0)])):c("",!0)])])):c("",!0)}},un={class:"animate-fade-in"},cn={class:"space-y-4"},mn={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},fn={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},yn={key:0,class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},gn=["disabled"],pn={__name:"FinancingWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:[String,Number],required:!0},hideActions:{type:Boolean,default:!1}},emits:["save","cancel"],setup(e,{expose:g,emit:d}){const i=e,f=d,a=S({startDate:"",expDate:"",productName:"",deposit:"",loanAmount:""});Y(()=>{i.item&&i.item.data&&(a.value={startDate:i.item.data.startDate||"",expDate:i.item.data.expDate||"",productName:i.item.data.product||i.item.data.productName||"",deposit:i.item.data.deposit||"",loanAmount:i.item.data.total||i.item.data.loanAmount||""})});const p=()=>{var m,s;a.value.productName&&f("save",{id:((m=i.item)==null?void 0:m.id)||Date.now(),type:"financing",action:i.item?"updated a financing proposal":"added a financing proposal",data:{product:a.value.productName,provider:"Audi Financial",total:a.value.loanAmount||"0",monthly:Math.round(parseFloat(a.value.loanAmount||0)/36).toString(),startDate:a.value.startDate,expDate:a.value.expDate,deposit:a.value.deposit},timestamp:((s=i.item)==null?void 0:s.timestamp)||new Date().toISOString(),isEdit:!!i.item})};return g({submit:p,isValid:T(()=>!!a.value.productName)}),(m,s)=>(n(),r("div",un,[t("div",cn,[t("div",mn,[t("div",null,[s[6]||(s[6]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Start date",-1)),C(t("input",{type:"date","onUpdate:modelValue":s[0]||(s[0]=o=>a.value.startDate=o),class:"input"},null,512),[[q,a.value.startDate]])]),t("div",null,[s[7]||(s[7]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Expiration date",-1)),C(t("input",{type:"date","onUpdate:modelValue":s[1]||(s[1]=o=>a.value.expDate=o),class:"input"},null,512),[[q,a.value.expDate]])])]),t("div",null,[s[8]||(s[8]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Financial product name",-1)),C(t("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=o=>a.value.productName=o),class:"input"},null,512),[[q,a.value.productName]])]),t("div",fn,[t("div",null,[s[9]||(s[9]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Deposit",-1)),C(t("input",{type:"number","onUpdate:modelValue":s[3]||(s[3]=o=>a.value.deposit=o),class:"input"},null,512),[[q,a.value.deposit]])]),t("div",null,[s[10]||(s[10]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Total loan amount",-1)),C(t("input",{type:"number","onUpdate:modelValue":s[4]||(s[4]=o=>a.value.loanAmount=o),class:"input"},null,512),[[q,a.value.loanAmount]])])])]),e.hideActions?c("",!0):(n(),r("div",yn,[t("button",{onClick:s[5]||(s[5]=o=>m.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),t("button",{onClick:p,disabled:!a.value.productName,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save",8,gn)]))]))}},vn={__name:"FinancingModal",props:{show:{type:Boolean,required:!0},item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:[String,Number],required:!0}},emits:["close","save"],setup(e,{emit:g}){const d=g,i=S(null),f=T(()=>{var m;return((m=i.value)==null?void 0:m.isValid)||!1}),a=()=>{var m;(m=i.value)==null||m.submit()},p=m=>{d("save",m),d("close")};return(m,s)=>(n(),F(X,{show:e.show,title:"Add Financing",subtitle:"Record financing details for this customer",size:"lg",onClose:s[1]||(s[1]=o=>m.$emit("close")),onCancel:s[2]||(s[2]=o=>m.$emit("close"))},{actions:B(()=>[V($(ie),{label:"Save Financing",variant:"primary",size:"small",class:"rounded-sm",disabled:!f.value,onClick:a},null,8,["disabled"])]),default:B(()=>[V(pn,{item:e.item,"task-type":e.taskType,"task-id":e.taskId,"hide-actions":!0,ref_key:"widgetRef",ref:i,onSave:p,onCancel:s[0]||(s[0]=o=>m.$emit("close"))},null,8,["item","task-type","task-id"])]),_:1},8,["show"]))}},bn={class:"animate-fade-in"},xn={class:"space-y-4"},hn={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},kn={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},wn={key:0,class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},$n=["disabled"],Cn={__name:"TradeInWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:[String,Number],required:!0},hideActions:{type:Boolean,default:!1}},emits:["save","cancel"],setup(e,{expose:g,emit:d}){const i=e,f=d,a=S({class:"Car",brand:"",model:"",version:"",km:"",plate:"",date:""});Y(()=>{i.item&&i.item.data&&(a.value={class:i.item.data.class||"Car",brand:i.item.data.brand||"",model:i.item.data.model||"",version:i.item.data.version||"",km:i.item.data.km||"",plate:i.item.data.plate||"",date:i.item.data.date||""})});const p=()=>{var m,s;a.value.brand&&f("save",{id:((m=i.item)==null?void 0:m.id)||Date.now(),type:"tradein",action:i.item?"updated a trade-in":"added a trade-in",data:{class:a.value.class,brand:a.value.brand,model:a.value.model||"Unknown Model",year:a.value.date?new Date(a.value.date).getFullYear():"Unknown Year",km:a.value.km||"0",plate:a.value.plate||"",date:a.value.date||""},timestamp:((s=i.item)==null?void 0:s.timestamp)||new Date().toISOString(),isEdit:!!i.item})};return g({submit:p,isValid:T(()=>!!a.value.brand)}),(m,s)=>(n(),r("div",bn,[t("div",xn,[t("div",null,[s[9]||(s[9]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Class",-1)),C(t("select",{"onUpdate:modelValue":s[0]||(s[0]=o=>a.value.class=o),class:"input"},[...s[8]||(s[8]=[t("option",{value:"Car"},"Car",-1),t("option",{value:"Motorcycle"},"Motorcycle",-1),t("option",{value:"Truck"},"Truck",-1)])],512),[[le,a.value.class]])]),t("div",hn,[t("div",null,[s[10]||(s[10]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Brand",-1)),C(t("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=o=>a.value.brand=o),class:"input"},null,512),[[q,a.value.brand]])]),t("div",null,[s[11]||(s[11]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Model",-1)),C(t("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=o=>a.value.model=o),class:"input"},null,512),[[q,a.value.model]])])]),t("div",null,[s[12]||(s[12]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Version",-1)),C(t("input",{type:"text","onUpdate:modelValue":s[3]||(s[3]=o=>a.value.version=o),class:"input"},null,512),[[q,a.value.version]])]),t("div",kn,[t("div",null,[s[13]||(s[13]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Km",-1)),C(t("input",{type:"number","onUpdate:modelValue":s[4]||(s[4]=o=>a.value.km=o),class:"input"},null,512),[[q,a.value.km]])]),t("div",null,[s[14]||(s[14]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Plate",-1)),C(t("input",{type:"text","onUpdate:modelValue":s[5]||(s[5]=o=>a.value.plate=o),class:"input"},null,512),[[q,a.value.plate]])])]),t("div",null,[s[15]||(s[15]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Registration date",-1)),C(t("input",{type:"date","onUpdate:modelValue":s[6]||(s[6]=o=>a.value.date=o),class:"input"},null,512),[[q,a.value.date]])])]),e.hideActions?c("",!0):(n(),r("div",wn,[t("button",{onClick:s[7]||(s[7]=o=>m.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),t("button",{onClick:p,disabled:!a.value.brand,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save",8,$n)]))]))}},Sn={__name:"TradeInModal",props:{show:{type:Boolean,required:!0},item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:[String,Number],required:!0}},emits:["close","save"],setup(e,{emit:g}){const d=g,i=S(null),f=T(()=>{var m;return((m=i.value)==null?void 0:m.isValid)||!1}),a=()=>{var m;(m=i.value)==null||m.submit()},p=m=>{d("save",m),d("close")};return(m,s)=>(n(),F(X,{show:e.show,title:"Add Trade-In Vehicle",subtitle:"Record details of the customer's trade-in vehicle",size:"lg",onClose:s[1]||(s[1]=o=>m.$emit("close")),onCancel:s[2]||(s[2]=o=>m.$emit("close"))},{actions:B(()=>[V($(ie),{label:"Save Trade-In",variant:"primary",size:"small",class:"rounded-sm",disabled:!f.value,onClick:a},null,8,["disabled"])]),default:B(()=>[V(Cn,{item:e.item,"task-type":e.taskType,"task-id":e.taskId,"hide-actions":!0,ref_key:"widgetRef",ref:i,onSave:p,onCancel:s[0]||(s[0]=o=>m.$emit("close"))},null,8,["item","task-type","task-id"])]),_:1},8,["show"]))}},An={class:"bg-white rounded-xl p-5 mb-6 animate-fade-in relative"},Dn={key:0,class:"flex justify-between items-center mb-4"},Tn={class:"text-sm font-bold text-slate-800"},On={key:1,class:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200"},qn={class:"flex items-center gap-3"},Nn={class:"w-16 h-16 bg-gray-200 rounded overflow-hidden flex-shrink-0"},In=["src"],Vn={key:1,class:"fa-solid fa-car text-gray-400 w-full h-full flex items-center justify-center"},En={class:"font-bold text-sm text-gray-800"},Fn={class:"text-xs text-gray-500"},Mn={class:"space-y-4"},Un={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},jn={key:2,class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},Bn=["disabled"],Wn={__name:"OfferWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"opportunity"},taskId:{type:Number,required:!0},selectedVehicle:{type:Object,default:null},hideHeader:{type:Boolean,default:!1},hideActions:{type:Boolean,default:!1}},emits:["save","cancel"],setup(e,{expose:g,emit:d}){const i=e,f=d,a=S({price:0,financingType:"",downPayment:0,monthlyPayment:0,term:36,interestRate:3.5,deliveryDate:"",validUntil:"",notes:"",brand:"",model:"",year:"",image:""});Y(()=>{if(i.selectedVehicle){a.value.price=i.selectedVehicle.price||0,a.value.brand=i.selectedVehicle.brand||"",a.value.model=i.selectedVehicle.model||"",a.value.year=i.selectedVehicle.year||"",a.value.image=i.selectedVehicle.image||"";const o=new Date;o.setDate(o.getDate()+30),a.value.validUntil=o.toISOString().split("T")[0]}i.item&&i.item.data&&(a.value={...a.value,...i.item.data,price:i.item.data.price||i.item.data.total||0,financingType:i.item.data.financingType||i.item.data.paymentMethod||"",notes:i.item.data.notes||i.item.data.description||""})}),Z(()=>i.selectedVehicle,o=>{o&&!i.item&&(a.value.price=o.price||0,a.value.brand=o.brand||"",a.value.model=o.model||"",a.value.year=o.year||"",a.value.image=o.image||"")});const p=T(()=>a.value.price>0&&a.value.financingType!==""),m=o=>o?o.toLocaleString("en-US"):"0",s=()=>{var l,b;if(!p.value)return;const o={id:((l=i.item)==null?void 0:l.id)||Date.now(),type:"offer",action:i.item?"updated an offer":"created an offer",data:{brand:a.value.brand,model:a.value.model,year:a.value.year,price:a.value.price,total:a.value.price,paymentMethod:a.value.financingType,financingType:a.value.financingType,downPayment:a.value.downPayment,monthlyPayment:a.value.monthlyPayment,term:a.value.term,interestRate:a.value.interestRate,deliveryDate:a.value.deliveryDate,validUntil:a.value.validUntil,notes:a.value.notes,description:a.value.notes,image:a.value.image},timestamp:((b=i.item)==null?void 0:b.timestamp)||new Date().toISOString(),isEdit:!!i.item};f("save",o)};return g({submit:s,isValid:p,offerData:a}),(o,l)=>(n(),r("div",An,[e.hideHeader?c("",!0):(n(),r("div",Dn,[t("h5",Tn,y(e.item?"Edit Offer":"Create Offer"),1),t("button",{onClick:l[0]||(l[0]=b=>o.$emit("cancel")),class:"text-gray-400 hover:text-gray-600"},[...l[11]||(l[11]=[t("i",{class:"fa-solid fa-xmark"},null,-1)])])])),e.selectedVehicle?(n(),r("div",On,[l[12]||(l[12]=t("p",{class:"text-xs text-gray-500 mb-2"},"Creating offer for:",-1)),t("div",qn,[t("div",Nn,[e.selectedVehicle.image?(n(),r("img",{key:0,src:e.selectedVehicle.image,alt:"Vehicle",class:"w-full h-full object-cover"},null,8,In)):(n(),r("i",Vn))]),t("div",null,[t("h4",En,y(e.selectedVehicle.brand)+" "+y(e.selectedVehicle.model)+" ("+y(e.selectedVehicle.year)+") ",1),t("p",Fn,"Base Price: € "+y(m(e.selectedVehicle.price)),1)])])])):c("",!0),t("div",Mn,[t("div",null,[l[13]||(l[13]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},[O(" Offer Price (€) "),t("span",{class:"text-red-500"},"*")],-1)),C(t("input",{type:"number","onUpdate:modelValue":l[1]||(l[1]=b=>a.value.price=b),class:"input",placeholder:"Enter offer price"},null,512),[[q,a.value.price]])]),t("div",null,[l[15]||(l[15]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},[O(" Payment Method "),t("span",{class:"text-red-500"},"*")],-1)),C(t("select",{"onUpdate:modelValue":l[2]||(l[2]=b=>a.value.financingType=b),class:"input"},[...l[14]||(l[14]=[t("option",{value:""},"Select payment method",-1),t("option",{value:"cash"},"Cash",-1),t("option",{value:"finance"},"Finance",-1),t("option",{value:"lease"},"Lease",-1)])],512),[[le,a.value.financingType]])]),a.value.financingType==="finance"||a.value.financingType==="lease"?(n(),r("div",Un,[t("div",null,[l[16]||(l[16]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Down Payment (€)",-1)),C(t("input",{type:"number","onUpdate:modelValue":l[3]||(l[3]=b=>a.value.downPayment=b),class:"input",placeholder:"0"},null,512),[[q,a.value.downPayment]])]),t("div",null,[l[17]||(l[17]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Monthly Payment (€)",-1)),C(t("input",{type:"number","onUpdate:modelValue":l[4]||(l[4]=b=>a.value.monthlyPayment=b),class:"input",placeholder:"Calculated automatically"},null,512),[[q,a.value.monthlyPayment]])]),t("div",null,[l[18]||(l[18]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Term (months)",-1)),C(t("input",{type:"number","onUpdate:modelValue":l[5]||(l[5]=b=>a.value.term=b),class:"input",placeholder:"36"},null,512),[[q,a.value.term]])]),t("div",null,[l[19]||(l[19]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Interest Rate (%)",-1)),C(t("input",{type:"number",step:"0.1","onUpdate:modelValue":l[6]||(l[6]=b=>a.value.interestRate=b),class:"input",placeholder:"3.5"},null,512),[[q,a.value.interestRate]])])])):c("",!0),t("div",null,[l[20]||(l[20]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Expected Delivery Date",-1)),C(t("input",{type:"date","onUpdate:modelValue":l[7]||(l[7]=b=>a.value.deliveryDate=b),class:"input"},null,512),[[q,a.value.deliveryDate]])]),t("div",null,[l[21]||(l[21]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Offer Valid Until",-1)),C(t("input",{type:"date","onUpdate:modelValue":l[8]||(l[8]=b=>a.value.validUntil=b),class:"input"},null,512),[[q,a.value.validUntil]])]),t("div",null,[l[22]||(l[22]=t("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Notes / Special Terms",-1)),C(t("textarea",{"onUpdate:modelValue":l[9]||(l[9]=b=>a.value.notes=b),rows:"3",class:"input",placeholder:"Any special terms, conditions, or notes about this offer..."},null,512),[[q,a.value.notes]])])]),e.hideActions?c("",!0):(n(),r("div",jn,[t("button",{onClick:l[10]||(l[10]=b=>o.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"}," Cancel "),t("button",{onClick:s,disabled:!p.value,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},y(e.item?"Update Offer":"Create Offer"),9,Bn)]))]))}},Ln={__name:"OfferModal",props:{show:{type:Boolean,required:!0},item:{type:Object,default:null},taskType:{type:String,default:"opportunity"},taskId:{type:[String,Number],required:!0},requestedCar:{type:Object,default:null},recommendedCars:{type:Array,default:()=>[]}},emits:["close","save"],setup(e,{emit:g}){const d=g,i=S(null),f=T(()=>{var m;return((m=i.value)==null?void 0:m.isValid)||!1}),a=()=>{var m;(m=i.value)==null||m.submit()},p=m=>{d("save",m),d("close")};return(m,s)=>(n(),F(X,{show:e.show,title:"Create Offer",subtitle:"Create a purchase offer for the customer",size:"2xl",onClose:s[1]||(s[1]=o=>m.$emit("close")),onCancel:s[2]||(s[2]=o=>m.$emit("close"))},{actions:B(()=>[V($(ie),{label:e.item?"Update Offer":"Create Offer",variant:"primary",size:"small",class:"rounded-sm",disabled:!f.value,onClick:a},null,8,["label","disabled"])]),default:B(()=>[V(Wn,{item:e.item,"task-type":e.taskType,"task-id":e.taskId,"requested-car":e.requestedCar,"recommended-cars":e.recommendedCars,"hide-header":!0,"hide-actions":!0,ref_key:"widgetRef",ref:i,onSave:p,onCancel:s[0]||(s[0]=o=>m.$emit("close"))},null,8,["item","task-type","task-id","requested-car","recommended-cars"])]),_:1},8,["show"]))}},ae={note:"note",communication:"communication",email:"communication",call:"communication",sms:"communication",whatsapp:"communication",attachment:"attachment",document:"attachment",file:"attachment",tradein:"tradein","trade-in":"tradein",financing:"financing",offer:"offers",purchase:"offers",appointment:"appointments",survey:"surveys",default:"overview"};function fe(e){if(!e)return ae.default;const g=e.toLowerCase().trim();return ae[g]||ae.default}function Rn({store:e,taskId:g,getTabForItemType:d,isOverviewModalAction:i}){const f=S(null),a=S(null),p=S("overview"),m=S("email"),s=S([]);Z(p,()=>{f.value=null,a.value=null});const o=T(()=>[...e.currentActivities.value,...s.value.filter(N=>!N.activityId)].filter(N=>{const w=d(N.type);return p.value==="overview"?w==="overview":w===p.value}).sort((N,w)=>{const E=new Date(N.timestamp||0);return new Date(w.timestamp||0)-E})),l=v=>(a.value=null,p.value==="overview"&&i&&i(v)?{type:"overview-modal",action:v}:(["email","sms","whatsapp","call"].includes(v)?(m.value=v,f.value="communication"):f.value=v,null)),b=async v=>{var N;if(v.isEdit){const w=s.value.findIndex(E=>E.id===v.id);w>-1&&(s.value[w]={...s.value[w],...v}),(N=a.value)!=null&&N.activityId&&await e.updateActivity(g.value,a.value.activityId,{type:v.communicationType||v.type,user:"You",action:v.action,content:v.content,fileName:v.fileName,data:v.data})}else{const w=v.communicationType||v.type,E=await e.addActivity(g.value,{type:w,user:"You",action:v.action,content:v.content,fileName:v.fileName,data:v.data});s.value.push({id:E.id,type:w==="email"||w==="whatsapp"||w==="sms"?"communication":w,action:v.action,content:v.content,fileName:v.fileName,data:v.data,timestamp:E.timestamp,activityId:E.id})}f.value=null,a.value=null},I=()=>{f.value=null,a.value=null},x=v=>{d(v.type)&&(f.value=v.type==="email"||v.type==="whatsapp"||v.type==="sms"||v.type==="communication"?"communication":v.type,a.value=v)},u=async v=>{try{await e.deleteActivity(g.value,v)}catch(N){throw console.error("Error deleting item:",N),N}};return{activeTab:p,showInlineWidget:f,inlineWidgetType:T(()=>f.value),editingItem:a,isEditing:T(()=>a.value!==null),communicationType:m,inlineContent:s,filteredInlineContent:o,handleAddNewAction:l,handleWidgetSave:b,handleWidgetCancel:I,handleEditItem:x,handleDeleteItem:u}}const Pn={class:"flex-1 flex flex-col overflow-hidden h-full"},zn={class:"bg-white border-b border-gray-200 shrink-0 shadow-sm"},Hn={class:"px-4 md:px-8 py-4 md:py-6"},Yn={class:"flex-1 flex flex-row overflow-hidden"},Kn={class:"flex-1 flex flex-col overflow-hidden min-w-0"},Qn={class:"flex-1 overflow-y-auto p-4 md:p-8 scrollbar-hide"},Gn={class:"mb-4"},Jn={key:0},Zn={key:0,class:"mb-6"},Xn={key:2,class:"mb-6"},_n={class:"space-y-6 mb-6"},el={key:3,class:"space-y-4 mb-6 px-1"},tl={key:1},al={key:0,class:"space-y-4 mb-6 px-1"},ul={__name:"CustomerShell",props:{task:{type:Object,required:!0},type:{type:String,required:!0},managementWidget:{type:Object,required:!0},storeAdapter:{type:Object,required:!0},addNewConfig:{type:Object,required:!0}},emits:["car-added","convert-to-lead","convert-to-opportunity"],setup(e,{emit:g}){const d=e,i=ke(),f=we(),a=T(()=>d.task.id),p=T(()=>d.type==="contact"?"bg-blue-100 text-blue-600":d.type==="lead"?"bg-orange-100 text-orange-600":"bg-purple-100 text-purple-600"),m=T(()=>i.path.startsWith("/tasks")&&!i.path.startsWith("/customer")),s=S(i.path.startsWith("/tasks")&&!i.path.startsWith("/customer"));Z(()=>i.path,h=>{s.value=h.startsWith("/tasks")&&!h.startsWith("/customer")});const o=()=>{f.push({path:`/customer/${d.task.id}`,query:{type:d.type}})};function l(h){v.value=!1}const b=()=>{N.value=!0},I=async h=>{var A,U,J,j;const k=h.name;d.type==="lead"?await((U=(A=d.storeAdapter).updateLead)==null?void 0:U.call(A,d.task.id,{assignee:k,assigneeType:h.type,teamId:h.type==="team"?h.id:null})):d.type==="opportunity"&&await((j=(J=d.storeAdapter).updateOpportunity)==null?void 0:j.call(J,d.task.id,{assignee:k,assigneeType:h.type,teamId:h.type==="team"?h.id:null})),N.value=!1},x=S(!1),u=S(null),v=S(!1),N=S(!1),{activeTab:w,showInlineWidget:E,editingItem:W,communicationType:ye,inlineContent:re,filteredInlineContent:K,handleAddNewAction:ge,handleWidgetSave:Q,handleWidgetCancel:_,handleEditItem:de,handleDeleteItem:ue}=Rn({store:d.storeAdapter,taskId:a,getTabForItemType:fe,isOverviewModalAction:h=>w.value==="overview"&&d.addNewConfig.overviewActions.includes(h)});Z(()=>d.task.id,()=>{w.value="overview"});const ee=h=>{const k=ge(h);k&&k.modalAction&&(u.value=k.modalAction,x.value=!0)},pe=h=>{if(h==="appointment"){v.value=!0;return}const k={note:"note",attachment:"attachment",email:"communication",whatsapp:"communication",sms:"communication",call:"communication",appointment:"overview"};if(["financing","tradein","purchase"].includes(h))u.value=h,x.value=!0;else{const A=k[h];A?(w.value=A,setTimeout(()=>{ee(h),setTimeout(()=>{try{const U=document.querySelector(".animate-fade-in");U&&U.parentNode&&U.scrollIntoView({behavior:"smooth",block:"start"})}catch(U){console.debug("Could not scroll to inline widget:",U)}},100)},50)):ee(h)}},G=()=>{x.value=!1,u.value=null},te=async h=>{await Q(h),G()},ve=T(()=>{const h=[...d.storeAdapter.currentActivities.value,...re.value],k=h.filter(j=>fe(j.type)==="overview").length,A=h.filter(j=>["call","email","sms","whatsapp","communication"].includes(j.type)).length,U=h.filter(j=>j.type==="note").length,J=h.filter(j=>j.type==="attachment").length;return[{key:"overview",label:"Overview",count:k},{key:"note",label:"Notes",count:U},{key:"communication",label:"Communication",count:A},{key:"attachment",label:"Attachments",count:J}]}),ce=T(()=>[...d.storeAdapter.currentActivities.value,...re.value]);T(()=>u.value==="financing"?"Add Financing":u.value==="tradein"?"Add Trade-in":u.value==="purchase"?"Create Purchase Offer":"");const be=async h=>{if(d.type==="opportunity")try{await d.storeAdapter.addVehicle(d.task.id,h.vehicleData),d.storeAdapter.loadOpportunityById&&await d.storeAdapter.loadOpportunityById(d.task.id)}catch(k){console.error("Error selecting vehicle:",k)}},xe=async h=>{if(d.type==="opportunity")try{await d.storeAdapter.createOffer(d.task.id,h.offerData),d.storeAdapter.loadOpportunityById&&await d.storeAdapter.loadOpportunityById(d.task.id)}catch(k){console.error("Error creating offer:",k)}};return(h,k)=>(n(),r("div",Pn,[t("header",zn,[t("div",Hn,[V(Xe,{initials:e.task.customer.initials,name:e.task.customer.name,email:e.task.customer.email,phone:e.task.customer.phone,"third-field-value":e.task.customer.address,"avatar-color-class":p.value,"task-type":e.type,"email-label":"Email","phone-label":"Phone","third-field-label":"Address",onAction:pe},{tags:B(()=>[(n(!0),r(M,null,P(e.task.tags,A=>(n(),r("span",{key:A,class:"badge-ui bg-blue-50 border-blue-100 text-blue-700 font-semibold"},y(A),1))),128))]),"name-action":B(()=>[m.value?(n(),r("button",{key:0,onClick:o,class:"w-7 h-7 flex items-center justify-center bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-lg text-blue-600 hover:text-blue-700 transition-colors shrink-0",title:"Open in new page"},[...k[7]||(k[7]=[t("i",{class:"fa-solid fa-external-link text-xs"},null,-1)])])):c("",!0)]),_:1},8,["initials","name","email","phone","third-field-value","avatar-color-class","task-type"])])]),t("div",Yn,[t("div",Kn,[t("main",Qn,[t("div",Gn,[V(at,{modelValue:$(w),"onUpdate:modelValue":k[0]||(k[0]=A=>$e(w)?w.value=A:null),tabs:ve.value,class:"mb-0"},null,8,["modelValue","tabs"])]),$(w)==="overview"?(n(),r("div",Jn,[e.type!=="contact"?(n(),r("div",Zn,[V(ut,{stage:e.task.displayStage||e.task.stage,owner:e.task.assignee,source:e.task.source||"","delivery-substatus":e.task.deliverySubstatus,onReassign:b},null,8,["stage","owner","source","delivery-substatus"])])):c("",!0),e.task.requestedCar?(n(),F(dn,{key:1,brand:e.task.requestedCar.brand,model:e.task.requestedCar.model,year:e.task.requestedCar.year,image:e.task.requestedCar.image||"",price:e.task.requestedCar.price||null,"request-message":e.task.requestedCar.requestMessage||"","request-type":e.task.requestedCar.requestType||"",source:e.task.source||"",dealership:e.task.requestedCar.dealership||"",registration:e.task.requestedCar.registration||"",kilometers:e.task.requestedCar.kilometers||null,"fuel-type":e.task.requestedCar.fuelType||"","gear-type":e.task.requestedCar.gearType||"",vin:e.task.requestedCar.vin||"","stock-days":e.task.requestedCar.stockDays!==void 0?e.task.requestedCar.stockDays:null,channel:e.task.requestedCar.channel||"Email","ad-campaign":e.task.requestedCar.adCampaign||"","expected-purchase-date":e.task.requestedCar.expectedPurchaseDate||"","fiscal-entity":e.task.requestedCar.fiscalEntity||"","source-details":e.task.requestedCar.sourceDetails||"","ad-medium":e.task.requestedCar.adMedium||"","ad-source":e.task.requestedCar.adSource||"",label:"Requested Car",class:"mb-6"},null,8,["brand","model","year","image","price","request-message","request-type","source","dealership","registration","kilometers","fuel-type","gear-type","vin","stock-days","channel","ad-campaign","expected-purchase-date","fiscal-entity","source-details","ad-medium","ad-source"])):c("",!0),e.managementWidget?(n(),r("div",Xn,[(n(),F(Ce(e.managementWidget),{lead:e.type==="lead"?e.task:void 0,opportunity:e.type==="opportunity"?e.task:void 0,contact:e.type==="contact"?e.task:void 0,activities:ce.value,onCarAdded:k[1]||(k[1]=A=>h.$emit("car-added",A)),onConvertToLead:k[2]||(k[2]=A=>h.$emit("convert-to-lead")),onConvertToOpportunity:k[3]||(k[3]=A=>h.$emit("convert-to-opportunity")),onVehicleSelected:be,onCreateOffer:xe},null,40,["lead","opportunity","contact","activities"]))])):c("",!0),t("div",_n,[ne(h.$slots,"pinned-extra",{task:e.task})]),$(K).length>0?(n(),r("div",el,[(n(!0),r(M,null,P($(K),A=>(n(),F(me,{key:A.id,item:A,"task-type":e.type,"customer-initials":"SK",onEdit:$(de),onDelete:$(ue)},null,8,["item","task-type","onEdit","onDelete"]))),128))])):c("",!0)])):(n(),r("div",tl,[V(gt,{actions:e.addNewConfig.tabActions,"active-tab":$(w),onAction:ee},null,8,["actions","active-tab"]),t("div",null,[$(E)==="communication"?(n(),F(Xa,{key:0,type:$(ye),"task-type":e.type,"task-id":e.task.id,item:$(W),onSave:$(Q),onCancel:$(_)},null,8,["type","task-type","task-id","item","onSave","onCancel"])):c("",!0),$(E)==="note"?(n(),F(ss,{key:1,item:$(W),"task-type":e.type,"task-id":e.task.id,onSave:$(Q),onCancel:$(_)},null,8,["item","task-type","task-id","onSave","onCancel"])):c("",!0),$(E)==="attachment"?(n(),F(ms,{key:2,item:$(W),"task-type":e.type,"task-id":e.task.id,onSave:$(Q),onCancel:$(_)},null,8,["item","task-type","task-id","onSave","onCancel"])):c("",!0)]),$(K).length>0?(n(),r("div",al,[(n(!0),r(M,null,P($(K),A=>(n(),F(me,{key:A.id,item:A,"task-type":e.type,"customer-initials":"SK",onEdit:$(de),onDelete:$(ue)},null,8,["item","task-type","onEdit","onDelete"]))),128))])):c("",!0)]))])]),V(Ka,{title:"Activity summary",activities:ce.value,collapsed:s.value,"show-collapse":!0,show:!0,class:"hidden lg:flex",onToggleCollapse:k[4]||(k[4]=A=>s.value=!s.value)},null,8,["activities","collapsed"])]),V(vn,{show:u.value==="financing"&&x.value,item:null,"task-type":e.type,"task-id":e.task.id,onSave:te,onClose:G},null,8,["show","task-type","task-id"]),V(Sn,{show:u.value==="tradein"&&x.value,item:null,"task-type":e.type,"task-id":e.task.id,onSave:te,onClose:G},null,8,["show","task-type","task-id"]),V(Ln,{show:u.value==="purchase"&&x.value,item:null,"task-type":e.type,"task-id":e.task.id,"requested-car":e.type==="lead"?e.task.requestedCar:null,"recommended-cars":[],onSave:te,onClose:G},null,8,["show","task-type","task-id","requested-car"]),V(Ae,{show:N.value,onClose:k[5]||(k[5]=A=>N.value=!1),onConfirm:I},null,8,["show"]),v.value?(n(),F(De,{key:0,show:v.value,customer:e.task.customer,assignee:e.task.assignee,"disabled-fields":["customer"],onCreate:l,onCancel:k[6]||(k[6]=A=>v.value=!1)},null,8,["show","customer","assignee"])):c("",!0)]))}},oe={Qualified:{primaryAction:{key:"schedule-appointment",title:"Schedule First Appointment",description:"Begin the sales process by scheduling an appointment with the customer",label:"Schedule Appointment",icon:"fa-solid fa-calendar-plus",buttonClass:"bg-blue-600 hover:bg-blue-700 text-white",colorScheme:{background:"bg-blue-50/50",border:"border-blue-100"}},secondaryActions:[{key:"select-vehicle",label:"Select Vehicle",icon:"fa-solid fa-car",description:"Choose a vehicle for this opportunity"},{key:"schedule-appointment",label:"Schedule Appointment",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"OOFB",condition:"qualified-no-offers-7-13-days"},{type:"UFB",condition:"qualified-no-offers-14-plus-days"}]},"Awaiting Appointment":{primaryAction:{key:"view-or-schedule-appointment",title:e=>e.scheduledAppointment?"Next Appointment":"Schedule Appointment",description:e=>e.scheduledAppointment?`Scheduled for ${e.formatDateTime(e.scheduledAppointment.start)}`:"Schedule an appointment to move forward",label:e=>e.scheduledAppointment?"View Appointment":"Schedule Appointment",icon:"fa-solid fa-calendar-check",buttonClass:"bg-purple-600 hover:bg-purple-700 text-white",colorScheme:{background:"bg-purple-50/50",border:"border-purple-100"}},secondaryActions:[{key:"reschedule",label:"Reschedule",icon:"fa-solid fa-calendar-days",description:"Change appointment date/time"},{key:"cancel-appointment",label:"Cancel Appointment",icon:"fa-solid fa-calendar-xmark"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"NS",condition:"appointment-past-not-completed"}]},"To be Called Back":{primaryAction:{key:"call-prospect",title:"Call Prospect",description:"Customer requested a callback. Follow up to maintain engagement",label:"Initiate Call",icon:"fa-solid fa-phone",buttonClass:"bg-indigo-600 hover:bg-indigo-700 text-white",colorScheme:{background:"bg-indigo-50/50",border:"border-indigo-100"}},secondaryActions:[{key:"schedule-appointment",label:"Schedule Appointment",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[]},"In Negotiation":{primaryAction:{key:"create-offer",title:"Create Offer",description:e=>e.hasOffers?"Add another offer or refine existing proposal":"Create initial offer to move forward with negotiation",label:e=>e.hasOffers?"Add Another Offer":"Create Offer",icon:"fa-solid fa-file-invoice-dollar",buttonClass:"bg-yellow-600 hover:bg-yellow-700 text-white",colorScheme:{background:"bg-yellow-50/50",border:"border-yellow-100"}},secondaryActions:[{key:"schedule-appointment",label:"Schedule Appointment",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"OFB",condition:"negotiation-5-plus-days-no-contract-has-offers"},{type:"NFU",condition:"negotiation-5-plus-days-no-contract-no-future-appointment-has-offers"}]},"Offer Sent":{primaryAction:{key:"follow-up-offer",title:"Follow Up on Offer",description:"Offer recently sent. Follow up to gauge customer interest",label:"Log Follow-up",icon:"fa-solid fa-phone-volume",buttonClass:"bg-orange-600 hover:bg-orange-700 text-white",colorScheme:{background:"bg-orange-50/50",border:"border-orange-100"}},secondaryActions:[{key:"add-offer",label:"Add Another Offer",icon:"fa-solid fa-file-invoice-dollar"},{key:"schedule-appointment",label:"Schedule Follow-up",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"OFB",condition:"negotiation-5-plus-days-no-contract-has-offers"},{type:"NFU",condition:"negotiation-5-plus-days-no-contract-no-future-appointment-has-offers"}]},"Awaiting Response":{primaryAction:{key:"request-decision",title:"Request Customer Decision",description:"Offer has been pending. Time to request a decision from the prospect",label:"Request Decision",icon:"fa-solid fa-circle-question",buttonClass:"bg-pink-600 hover:bg-pink-700 text-white",colorScheme:{background:"bg-pink-50/50",border:"border-pink-100"}},secondaryActions:[{key:"add-contract",label:"Add Contract",icon:"fa-solid fa-file-contract",description:"Customer accepted - add contract to proceed"},{key:"add-offer",label:"Send New Offer",icon:"fa-solid fa-file-invoice-dollar"},{key:"schedule-appointment",label:"Schedule Meeting",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"OFB",condition:"negotiation-5-plus-days-no-contract-has-offers"},{type:"NFU",condition:"negotiation-5-plus-days-no-contract-no-future-appointment-has-offers"}]},"Contract Pending":{primaryAction:{key:"finalize-contract",title:"Finalize Contract",description:"Collect e-signatures and finalize contract documentation",label:"Collect Signatures",icon:"fa-solid fa-file-signature",buttonClass:"bg-emerald-600 hover:bg-emerald-700 text-white",colorScheme:{background:"bg-emerald-50/50",border:"border-emerald-100"}},secondaryActions:[{key:"close-won",label:"Close as Won",icon:"fa-solid fa-check-circle",description:"Mark deal as won and finalize"},{key:"extend-deadline",label:"Extend Deadline",icon:"fa-solid fa-clock"},{key:"add-offer",label:"Revise Offer",icon:"fa-solid fa-file-invoice-dollar"},{key:"schedule-appointment",label:"Schedule Appointment",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[]},"Closed Won":{primaryAction:e=>{const g=e.deliverySubstatus;return g==="Delivered"?{key:"collect-feedback",title:"Post-Delivery Follow-up",description:"Vehicle delivered. Collect customer feedback",label:"Collect Feedback",icon:"fa-solid fa-comment",buttonClass:"bg-green-600 hover:bg-green-700 text-white",colorScheme:{background:"bg-green-50/50",border:"border-green-100"}}:g==="Awaiting Delivery"?{key:"confirm-delivery",title:"Confirm Delivery Details",description:"Delivery scheduled. Confirm date/time with customer",label:"Confirm Delivery",icon:"fa-solid fa-calendar-check",buttonClass:"bg-teal-600 hover:bg-teal-700 text-white",colorScheme:{background:"bg-teal-50/50",border:"border-teal-100"}}:{key:"schedule-delivery",title:"Set Delivery Date",description:"Contract signed! Schedule vehicle delivery with the customer",label:"Schedule Delivery",icon:"fa-solid fa-truck",buttonClass:"bg-green-600 hover:bg-green-700 text-white",colorScheme:{background:"bg-green-50/50",border:"border-green-100"}}},secondaryActions:[{key:"collect-feedback",label:"Collect Feedback",icon:"fa-solid fa-comment",conditional:"is-delivered"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"CFB",condition:"contract-7-plus-days-no-delivery"},{type:"DFB",condition:"delivery-date-set"},{type:"DFB",condition:"delivery-3-plus-days"}]},Abandoned:{primaryAction:{key:"reopen",title:"Opportunity Abandoned",description:"This opportunity has been inactive for an extended period. Reopen it to continue the sales process.",label:"Reopen Opportunity",icon:"fa-solid fa-rotate-left",buttonClass:"bg-gray-600 hover:bg-gray-700 text-white",colorScheme:{background:"bg-gray-50/50",border:"border-gray-100"}},secondaryActions:[{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark",description:"Mark this opportunity as lost"},{key:"requalify",label:"Requalify as Lead",icon:"fa-solid fa-arrow-left",description:"Convert back to a lead"}],taskWidgets:[{type:"ABANDONED",condition:"opportunity-abandoned"}]}},se={reopen:{key:"reopen",label:"Reopen Opportunity",icon:"fa-solid fa-rotate-left",description:"Restart the management process"},requalify:{key:"requalify",label:"Requalify as Lead",icon:"fa-solid fa-arrow-left",description:"Convert back to a lead"},closeLost:{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}};function R(e){if(!e)return 0;const g=new Date(e),i=Math.abs(new Date-g);return Math.ceil(i/(1e3*60*60*24))}const z={"no-appointment":e=>!e.scheduledAppointment,"has-appointment":e=>!!e.scheduledAppointment,"appointment-past-not-completed":e=>e.scheduledAppointment?new Date(e.scheduledAppointment.start)<new Date&&e.scheduledAppointment.status!=="completed":!1,"has-future-appointment":e=>e.scheduledAppointment?new Date(e.scheduledAppointment.start)>new Date:!1,"no-offers":e=>!e.hasOffers,"has-offers":e=>e.hasOffers,"qualified-no-offers-7-13-days":e=>{const g=L(),d=g.getSetting("oofbMinDays"),i=g.getSetting("oofbMaxDays"),f=R(e.opportunity.createdAt);return f>=d&&f<i+1&&!e.hasOffers},"qualified-no-offers-14-plus-days":e=>{const d=L().getSetting("ufbDays");return R(e.opportunity.createdAt)>=d&&!e.hasOffers},"negotiation-5-plus-days-no-contract-has-offers":e=>{if(e.stage==="In Negotiation"&&!e.hasOffers)return!1;const d=L().getSetting("ofbDays");return R(e.opportunity.lastActivity||e.opportunity.createdAt)>=d&&!e.opportunity.contractDate&&e.hasOffers},"negotiation-5-plus-days-no-contract-no-future-appointment-has-offers":e=>{if(e.stage==="In Negotiation"&&!e.hasOffers)return!1;const d=L().getSetting("nfuDays"),i=R(e.opportunity.lastActivity||e.opportunity.createdAt),f=e.scheduledAppointment&&new Date(e.scheduledAppointment.start)>new Date;return i>=d&&!e.opportunity.contractDate&&!f&&e.hasOffers},"contract-7-plus-days-no-delivery":e=>{var a;if(!e.opportunity.contractDate)return!1;const d=L().getSetting("cfbDays"),i=R(e.opportunity.contractDate),f=(a=e.activities)==null?void 0:a.some(p=>{var m;return p.type==="delivery"||((m=p.action)==null?void 0:m.toLowerCase().includes("delivered"))});return i>=d&&!f},"delivery-date-set":e=>!!e.opportunity.deliveryDate,"delivery-3-plus-days":e=>{var a;const g=(a=e.activities)==null?void 0:a.find(p=>{var m;return p.type==="delivery"||((m=p.action)==null?void 0:m.toLowerCase().includes("delivered"))});if(!g)return!1;const i=L().getSetting("dfbDays");return R(g.timestamp)>=i},"is-awaiting-delivery":e=>e.deliverySubstatus==="Awaiting Delivery","is-delivered":e=>e.deliverySubstatus==="Delivered","has-no-delivery":e=>!e.deliverySubstatus||e.deliverySubstatus===null,"is-closed":e=>{const g=e.stage;return g==="Closed Won"||g==="Closed Lost"},"is-closed-with-task-widget":e=>z["is-closed"](e)&&e.hasActiveTaskWidget,"opportunity-abandoned":e=>{if(z["is-closed"](e))return!1;const g=L(),d=g.getSetting("abandonedOpportunityDays");if(!g.getSetting("abandonedEligibleStages").includes(e.stage))return!1;const f=e.opportunity.lastActivity||e.opportunity.createdAt;return R(f)>=d}};function cl(e,g){if(z["is-closed-with-task-widget"](g))return[se.reopen,se.requalify,se.closeLost];const d=oe[e];return!d||!d.secondaryActions?[]:d.secondaryActions.filter(i=>{if(!i.conditional)return!0;const f=z[i.conditional];return f?f(g):!0})}function ml(e,g){const d=oe[e];if(!d||!d.taskWidgets)return null;const f=L().getSetting("autoCloseWidgetsOnClose"),a=z["is-closed"]({stage:e});for(const p of d.taskWidgets){if(f&&a&&(p.type==="NFU"||p.type==="OFB"))continue;const m=z[p.condition];if(m&&m(g))return p.type}return null}function fl(e,g){const d=oe[e];if(!d||!d.primaryAction)return null;const i=d.primaryAction;return{...i,title:typeof i.title=="function"?i.title(g):i.title,description:typeof i.description=="function"?i.description(g):i.description,label:typeof i.label=="function"?i.label(g):i.label}}function yl(e){return{OOFB:"Overdue Offer Follow-up Task",UFB:"Urgent Follow-up Task",NFU:"No Future Updates Task",OFB:"Offer Follow-up Task",CFB:"Contract Follow-up Task",DFB:"Delivery Follow-up Task",NS:"No-Show Follow-up Task",ABANDONED:"Abandoned Opportunity Task"}[e]||"Task"}function gl(e){return e==="Closed Won"||e==="Closed Lost"||e==="Delivered"}const pl={__name:"ComingSoonModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Coming Soon"}},emits:["close"],setup(e,{emit:g}){const d=g,i=()=>{d("close")};return(f,a)=>(n(),F(X,{show:e.show,title:e.title,onCancel:i},{default:B(()=>[...a[0]||(a[0]=[t("div",{class:"py-8 flex items-center justify-center"},[t("p",{class:"text-gray-600 text-lg font-medium"},"Coming soon")],-1)])]),_:1},8,["show","title"]))}};export{ss as _,fl as a,cl as b,yl as c,Wn as d,pl as e,ul as f,ml as g,dn as h,gl as i};
