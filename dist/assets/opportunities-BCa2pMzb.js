import{$ as A,r as v,c as d,V as x,a7 as $,a8 as I,a9 as B,aa as V,ab as S,ac as b,ad as k,ae as C,af as F,ag as H}from"./index-DouNJQER.js";const G=A("opportunities",()=>{const s=v([]),n=v(null),r=v(!1),u=v(null),O=d(()=>n.value?x.filter(e=>e.opportunityId===n.value.id):[]),h=d(()=>s.value.filter(e=>e.priority==="Hot"&&e.stage!=="Closed Lost")),w=async(e={})=>await p(e),p=async(e={})=>{r.value=!0,u.value=null;try{const t=await $(e);return s.value=t.data||t,t}catch(t){throw u.value=t.message,t}finally{r.value=!1}},o=async e=>await y(e),y=async e=>{r.value=!0,u.value=null;try{return n.value=await I(e),n.value}catch(t){throw u.value=t.message,t}finally{r.value=!1}},m=async e=>{r.value=!0,u.value=null;try{const t=await B(e);return s.value.push(t),t}catch(t){throw u.value=t.message,t}finally{r.value=!1}},g=async(e,t)=>await f(e,t),f=async(e,t)=>{var l;r.value=!0,u.value=null;try{const a=await V(e,t),i=s.value.findIndex(c=>c.id===e);return i!==-1&&(s.value[i]=a),((l=n.value)==null?void 0:l.id)===e&&(n.value=a),a}catch(a){throw u.value=a.message,a}finally{r.value=!1}};return{opportunities:s,currentOpportunity:n,loading:r,error:u,currentOpportunityActivities:O,hotOpportunities:h,loadOpportunities:w,fetchOpportunities:p,loadOpportunityById:o,fetchOpportunityById:y,createOpportunity:m,modifyOpportunity:g,updateOpportunity:f,deleteOpportunity:async e=>{r.value=!0,u.value=null;try{await S(e),s.value=s.value.filter(t=>t.id!==e)}catch(t){throw u.value=t.message,t}finally{r.value=!1}},addActivity:async(e,t)=>{var l;r.value=!0,u.value=null;try{const a=await b(e,t);return((l=n.value)==null?void 0:l.id)===parseInt(e)&&await o(e),a}catch(a){throw u.value=a.message,a}finally{r.value=!1}},updateActivity:async(e,t,l)=>{var a;r.value=!0,u.value=null;try{const i=await k(e,t,l);return((a=n.value)==null?void 0:a.id)===parseInt(e)&&await o(e),i}catch(i){throw u.value=i.message,i}finally{r.value=!1}},deleteActivity:async(e,t)=>{var l;r.value=!0,u.value=null;try{return await H(e,t),((l=n.value)==null?void 0:l.id)===parseInt(e)&&await o(e),{success:!0}}catch(a){throw u.value=a.message,a}finally{r.value=!1}},addVehicle:async(e,t)=>{var l;r.value=!0,u.value=null;try{const a=await C(e,t),i=s.value.findIndex(c=>c.id===parseInt(e));return i!==-1&&(s.value[i]=a),((l=n.value)==null?void 0:l.id)===parseInt(e)&&(n.value=a),a}catch(a){throw u.value=a.message,a}finally{r.value=!1}},createOffer:async(e,t)=>{var l;r.value=!0,u.value=null;try{const a=await F(e,t),i=s.value.findIndex(c=>c.id===parseInt(e));return i!==-1&&(s.value[i]=a.opportunity),((l=n.value)==null?void 0:l.id)===parseInt(e)&&(n.value=a.opportunity),a}catch(a){throw u.value=a.message,a}finally{r.value=!1}}}});export{G as u};
