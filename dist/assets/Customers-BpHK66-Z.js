import{r as x,l as de,c as f,x as pe,o as h,D as j,e as o,d as N,p as g,G as y,s as M,y as E,u as me,C as ge,E as ye,m as xe,K as s,F as ve,i as be,h as fe,X as he,g as Ce,n as Ae,t as ke}from"./index-4t0q-YoU.js";import{_ as Ne}from"./PageHeader-27gL1xgJ.js";import{Q as we,i as Se}from"./index-B_XAiWWB.js";import{_ as De}from"./ModalShell-CCJo1Yaq.js";import{y as Oe}from"./components-DlDjID9_.js";import{u as $e}from"./opportunities-DBOjrln3.js";import{u as Ke}from"./customers-DNroEOnp.js";import{g as Z,c as _,f as ee}from"./formatters-C-gGI16G.js";import"./index-Ct-3v9pQ-BMtYOyzV.js";import"./toggle-group-item.vue_vue_type_script_setup_true_lang-Csij51_o-Dd2SCa0l.js";import"./settings-Buo-UMP2.js";const Te={class:"space-y-4"},qe={key:0},Le={key:1},Ue={key:2},Ie={key:3},Ve=["placeholder"],Fe={__name:"AddCustomerModal",props:{show:{type:Boolean,default:!1},activeTab:{type:String,required:!0},initialData:{type:Object,default:()=>({})}},emits:["close","save"],setup(C,{emit:w}){const d=C,S=w,n=x({customerName:"",email:"",phone:"",company:"",vehicle:"",value:"",reason:""});de(()=>d.show,c=>{c&&(n.value={customerName:d.initialData.customerName||"",email:d.initialData.email||"",phone:d.initialData.phone||"",company:d.initialData.company||"",vehicle:d.initialData.vehicle||"",value:d.initialData.value||"",reason:d.initialData.reason||""})});const D=f(()=>({contacts:"Add New Contact","open-leads":"Add New Lead","open-opportunities":"Add New Opportunity","in-negotiation":"Add Opportunity in Negotiation",won:"Add Won Opportunity",lost:"Add Lost Opportunity"})[d.activeTab]||"Add New Item"),A=f(()=>({contacts:"Contact","open-leads":"Lead","open-opportunities":"Opportunity","in-negotiation":"Opportunity",won:"Won Opportunity",lost:"Lost Opportunity"})[d.activeTab]||"Item"),B=()=>{S("save",{...n.value}),n.value={customerName:"",email:"",phone:"",company:"",vehicle:"",value:"",reason:""}};return(c,l)=>(h(),pe(De,{show:C.show,title:D.value,subtitle:"Fill in the details below",size:"md",onClose:l[13]||(l[13]=r=>c.$emit("close")),onCancel:l[14]||(l[14]=r=>c.$emit("close"))},{actions:j(()=>[M(E(we),{label:`Create ${A.value}`,variant:"primary",size:"small",class:"rounded-sm",onClick:B},null,8,["label"])]),default:j(()=>[o("div",Te,[C.activeTab==="contacts"?(h(),N("div",qe,[l[15]||(l[15]=o("label",{class:"block label-upper mb-2"},"Contact Name",-1)),g(o("input",{"onUpdate:modelValue":l[0]||(l[0]=r=>n.value.customerName=r),type:"text",placeholder:"Enter contact name...",class:"input"},null,512),[[y,n.value.customerName]]),l[16]||(l[16]=o("label",{class:"block label-upper mb-2 mt-4"},"Email",-1)),g(o("input",{"onUpdate:modelValue":l[1]||(l[1]=r=>n.value.email=r),type:"email",placeholder:"contact@example.com",class:"input"},null,512),[[y,n.value.email]]),l[17]||(l[17]=o("label",{class:"block label-upper mb-2 mt-4"},"Phone",-1)),g(o("input",{"onUpdate:modelValue":l[2]||(l[2]=r=>n.value.phone=r),type:"tel",placeholder:"+49...",class:"input"},null,512),[[y,n.value.phone]]),l[18]||(l[18]=o("label",{class:"block label-upper mb-2 mt-4"},"Company (optional)",-1)),g(o("input",{"onUpdate:modelValue":l[3]||(l[3]=r=>n.value.company=r),type:"text",placeholder:"Company name...",class:"input"},null,512),[[y,n.value.company]])])):C.activeTab==="open-leads"?(h(),N("div",Le,[l[19]||(l[19]=o("label",{class:"block label-upper mb-2"},"Customer Name",-1)),g(o("input",{"onUpdate:modelValue":l[4]||(l[4]=r=>n.value.customerName=r),type:"text",placeholder:"Enter customer name...",class:"input"},null,512),[[y,n.value.customerName]]),l[20]||(l[20]=o("label",{class:"block label-upper mb-2 mt-4"},"Email",-1)),g(o("input",{"onUpdate:modelValue":l[5]||(l[5]=r=>n.value.email=r),type:"email",placeholder:"customer@example.com",class:"input"},null,512),[[y,n.value.email]]),l[21]||(l[21]=o("label",{class:"block label-upper mb-2 mt-4"},"Requested Vehicle",-1)),g(o("input",{"onUpdate:modelValue":l[6]||(l[6]=r=>n.value.vehicle=r),type:"text",placeholder:"e.g., Volkswagen ID.4",class:"input"},null,512),[[y,n.value.vehicle]])])):C.activeTab==="open-opportunities"||C.activeTab==="in-negotiation"?(h(),N("div",Ue,[l[22]||(l[22]=o("label",{class:"block label-upper mb-2"},"Customer Name",-1)),g(o("input",{"onUpdate:modelValue":l[7]||(l[7]=r=>n.value.customerName=r),type:"text",placeholder:"Enter customer name...",class:"input"},null,512),[[y,n.value.customerName]]),l[23]||(l[23]=o("label",{class:"block label-upper mb-2 mt-4"},"Vehicle",-1)),g(o("input",{"onUpdate:modelValue":l[8]||(l[8]=r=>n.value.vehicle=r),type:"text",placeholder:"e.g., Porsche Taycan",class:"input"},null,512),[[y,n.value.vehicle]]),l[24]||(l[24]=o("label",{class:"block label-upper mb-2 mt-4"},"Opportunity Value",-1)),g(o("input",{"onUpdate:modelValue":l[9]||(l[9]=r=>n.value.value=r),type:"number",placeholder:"0",class:"input"},null,512),[[y,n.value.value]])])):(h(),N("div",Ie,[l[25]||(l[25]=o("label",{class:"block label-upper mb-2"},"Customer Name",-1)),g(o("input",{"onUpdate:modelValue":l[10]||(l[10]=r=>n.value.customerName=r),type:"text",placeholder:"Enter customer name...",class:"input"},null,512),[[y,n.value.customerName]]),l[26]||(l[26]=o("label",{class:"block label-upper mb-2 mt-4"},"Vehicle",-1)),g(o("input",{"onUpdate:modelValue":l[11]||(l[11]=r=>n.value.vehicle=r),type:"text",placeholder:"Vehicle model",class:"input"},null,512),[[y,n.value.vehicle]]),l[27]||(l[27]=o("label",{class:"block label-upper mb-2 mt-4"},"Reason",-1)),g(o("textarea",{"onUpdate:modelValue":l[12]||(l[12]=r=>n.value.reason=r),rows:"3",placeholder:`Reason for ${C.activeTab==="won"?"win":"loss"}...`,class:"input resize-none"},null,8,Ve),[[y,n.value.reason]])]))])]),_:1},8,["show","title"]))}},Re={class:"page-container"},Me={class:"p-4 md:p-8"},We={class:"flex items-center gap-3 mb-6 overflow-x-auto pb-2 scrollbar-hide"},Ee=["onClick"],je={class:"text-sm font-medium text-foreground whitespace-nowrap"},Be={class:"table-wrapper w-full"},tt={__name:"Customers",setup(C){const w=fe();he();const d=me(),S=ge(),n=$e(),D=Ke(),A=f(()=>{const e=S.leads.filter(m=>!m.isDisqualified),a=n.opportunities.filter(m=>m.stage!=="Closed Won"&&m.stage!=="Closed Lost"),i=n.opportunities.filter(m=>m.stage==="In Negotiation"||m.stage==="In negotiation"),p=n.opportunities.filter(m=>m.stage==="Closed Won"),b=n.opportunities.filter(m=>m.stage==="Closed Lost");return{contacts:D.totalCustomers,openLeads:e.length,openOpportunities:a.length-i.length,inNegotiation:i.length,won:p.length,lost:b.length}}),c=x(d.isOperator()?"open-leads":d.isManager()||d.isSalesman()?"in-negotiation":"contacts");x("");const l=x(!1),r=x(!1),z=x("all"),$=x({status:"",priority:"",source:""}),Q=x({pageIndex:0,pageSize:10}),P=x(""),H=x([]),G=x([]);x({});const te=f(()=>c.value==="contacts"?[{key:"source",label:"Source",type:"select",operators:[{value:"eq",label:"is"},{value:"ne",label:"is not"}],options:[{value:"Marketing",label:"Marketing"},{value:"Referral",label:"Referral"},{value:"Direct",label:"Direct"}]},{key:"company",label:"Has Company",type:"boolean",operators:[{value:"exists",label:"exists"},{value:"notExists",label:"does not exist"}]}]:[{key:"status",label:"Status",type:"multiselect",operators:[{value:"in",label:"is any of"},{value:"notIn",label:"is none of"}],options:[{value:"Valid",label:"Valid"},{value:"Not valid",label:"Not valid"},{value:"Qualified",label:"Qualified"},{value:"Not interested",label:"Not interested"}]},{key:"priority",label:"Priority",type:"select",operators:[{value:"eq",label:"is"},{value:"ne",label:"is not"}],options:[{value:"Hot",label:"Hot"},{value:"Normal",label:"Normal"}]},{key:"source",label:"Source",type:"select",operators:[{value:"eq",label:"is"},{value:"ne",label:"is not"}],options:[{value:"Marketing",label:"Marketing"},{value:"Referral",label:"Referral"},{value:"Direct",label:"Direct"}]}]),X=x({customerName:"",email:"",phone:"",company:"",vehicle:"",value:"",reason:""}),ae=f(()=>{const e=[{key:"contacts",label:"Customers",count:A.value.contacts,borderColor:"border-t-purple-600",badgeColor:"bg-purple-600 text-white"},{key:"open-leads",label:"Open Leads",count:A.value.openLeads,borderColor:"border-t-blue-600",badgeColor:"bg-blue-600 text-white"},{key:"open-opportunities",label:"Open opportunities",count:A.value.openOpportunities,borderColor:"border-t-orange-500",badgeColor:"bg-orange-500 text-white"},{key:"in-negotiation",label:"In negotiation",count:A.value.inNegotiation,borderColor:"border-t-blue-500",badgeColor:"bg-blue-500 text-white"},{key:"won",label:"Won",count:A.value.won,borderColor:"border-t-green-500",badgeColor:"bg-green-500 text-white"},{key:"lost",label:"Lost",count:A.value.lost,borderColor:"border-t-red-500",badgeColor:"bg-red-500 text-white"}];return d.isOperator()?e.filter(a=>a.key==="contacts"||a.key==="open-leads"):d.isSalesman()?e.filter(a=>a.key!=="open-leads"):e}),se=()=>{X.value={customerName:"",email:"",phone:"",company:"",vehicle:"",value:"",reason:""},l.value=!1},le=f(()=>{let e=D.customers;z.value==="contacts"?e=D.contacts:z.value==="accounts"&&(e=D.accounts);const a=t=>{if(!t)return"N/A";const u=t.split(",");return u.length>1&&u[u.length-1].trim().replace(/^\d+\s*/,"").trim()||t},i=e.map(t=>({id:`customer-${t.id}`,stageKey:"contacts",customer:t.name,accountType:t.company&&t.company!==""?"Account":"Contact",telephone:t.phone,location:a(t.address),createdAt:O(t.createdAt),name:t.name,accountOwner:t.source||"N/A",updatedAt:O(t.lastContact||t.createdAt),lastActivity:O(t.lastContact),openOpportunities:n.opportunities.filter(u=>u.customerId===t.id&&u.stage!=="Closed Won"&&u.stage!=="Closed Lost").length,wonOpportunities:n.opportunities.filter(u=>u.customerId===t.id&&u.stage==="Closed Won").length,initials:t.initials||t.name.slice(0,2).toUpperCase(),type:t.company&&t.company!==""?"account":"contact",customerId:t.id}));let p=S.leads;r.value?p=S.leads.filter(t=>t.isDisqualified===!0):p=S.leads.filter(t=>!t.isDisqualified);const b=p.map(t=>{var u,v,k,K,T,q,L,U,I,V,F,R;return{id:`lead-${t.id}`,stageKey:"open-leads",customer:((u=t.customer)==null?void 0:u.name)||"Unknown",email:((v=t.customer)==null?void 0:v.email)||"",initials:((k=t.customer)==null?void 0:k.initials)||((T=(K=t.customer)==null?void 0:K.name)==null?void 0:T.slice(0,2).toUpperCase())||"?",nextAction:ee(t.nextActionDue)||"No due date",nextActionFull:_(t.nextActionDue),deadlineStatus:Z(t.nextActionDue),car:`${((q=t.requestedCar)==null?void 0:q.brand)||""} ${((L=t.requestedCar)==null?void 0:L.model)||""}`.trim()||"N/A",carStatus:((U=t.requestedCar)==null?void 0:U.stockDays)!==void 0&&((I=t.requestedCar)==null?void 0:I.stockDays)!==null?"In Stock":"Out of Stock",carStatusClass:((V=t.requestedCar)==null?void 0:V.stockDays)!==void 0&&((F=t.requestedCar)==null?void 0:F.stockDays)!==null?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700",requestType:((R=t.requestedCar)==null?void 0:R.requestType)||"Quotation",source:t.source||"Marketing",assignee:t.assignee,assigneeInitials:t.assignee?t.assignee.slice(0,2).toUpperCase():"NA",createdAt:O(t.createdAt),lastActivity:O(t.lastActivity),status:t.status,statusClass:ie(t.status),priority:t.priority||"Normal"}}),m=t=>{const u=ye.filter(v=>v.opportunityId===t&&v.type==="appointment").sort((v,k)=>new Date(k.timestamp)-new Date(v.timestamp));return u.length>0?u[0].timestamp:null},ce=n.opportunities.map(t=>{var k,K,T,q,L,U,I,V,F,R,Y;let u="open-opportunities";t.stage==="In Negotiation"||t.stage==="In negotiation"?u="in-negotiation":t.stage==="Closed Won"?u="won":t.stage==="Closed Lost"&&(u="lost");const v=m(t.id);return{id:`opp-${t.id}`,stageKey:u,customer:((k=t.customer)==null?void 0:k.name)||"Unknown",email:((K=t.customer)==null?void 0:K.email)||"",initials:((T=t.customer)==null?void 0:T.initials)||((L=(q=t.customer)==null?void 0:q.name)==null?void 0:L.slice(0,2).toUpperCase())||"?",nextAction:ee(t.expectedCloseDate)||"No due date",nextActionFull:_(t.expectedCloseDate),deadlineStatus:Z(t.expectedCloseDate),car:`${((U=t.vehicle)==null?void 0:U.brand)||""} ${((I=t.vehicle)==null?void 0:I.model)||""}`.trim()||"N/A",carStatus:((V=t.vehicle)==null?void 0:V.stockDays)!==void 0&&((F=t.vehicle)==null?void 0:F.stockDays)!==null?"In Stock":"Out of Stock",carStatusClass:((R=t.vehicle)==null?void 0:R.stockDays)!==void 0&&((Y=t.vehicle)==null?void 0:Y.stockDays)!==null?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700",requestType:t.requestType||"Opportunity",source:t.source||"Marketing",assignee:t.assignee,assigneeInitials:t.assignee?t.assignee.slice(0,2).toUpperCase():"NA",createdAt:O(t.createdAt),lastAppointment:v?O(v):"N/A",status:t.stage,statusClass:u==="in-negotiation"?"bg-orange-100 text-orange-700":u==="won"?"bg-green-100 text-green-700":u==="lost"?"bg-red-100 text-red-700":"bg-purple-100 text-purple-700",priority:t.priority||"Normal"}});return[...i,...b,...ce]}),J=f(()=>{let e=le.value.filter(a=>a.stageKey===c.value);return $.value.status&&(e=e.filter(a=>a.status===$.value.status)),$.value.priority&&(e=e.filter(a=>a.priority===$.value.priority)),$.value.source&&(e=e.filter(a=>a.source===$.value.source)),e}),ne=e=>{c.value=e},ie=e=>({Valid:"bg-green-100 text-green-700","Not valid":"bg-red-100 text-red-700",Qualified:"bg-gray-100 text-gray-700","Not interested":"bg-red-100 text-red-700",Open:"bg-blue-100 text-blue-700"})[e]||"bg-gray-100 text-gray-700",O=e=>e?new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}):"-",oe=(e,a)=>{if(!a||!e)return"gray";const p={contacts:"gray","open-leads":"blue","open-opportunities":"blue","in-negotiation":"blue",won:"green",lost:"red"}[e]||"gray";return["blue","green","red","gray"].includes(p)?p:"gray"};xe(async()=>{await D.loadCustomers(),await S.loadLeads(),await n.loadOpportunities()});const W=e=>{if(e.stageKey==="contacts"){const i=e.customerId||e.id.split("-")[1];w.push({path:`/customer/${i}`});return}const a=e.id.match(/-(\d+)$/);if(c.value==="open-leads"&&e.id.startsWith("lead-")){const i=a?a[1]:e.id.replace("lead-","");w.push({path:`/tasks/${i}`,query:{type:"lead"}})}else if(e.id.startsWith("opp-")){const i=a?a[1]:e.id.replace("opp-","");w.push({path:`/tasks/${i}`,query:{type:"opportunity"}})}else if(e.stageKey==="won"||e.stageKey==="lost"){const i=a?a[1]:e.id.replace("opp-","");w.push({path:`/tasks/${i}`,query:{type:"opportunity"}})}},re=f(()=>({class:{tr:"cursor-pointer hover:bg-gray-50 transition-colors"}})),ue=f(()=>c.value==="contacts"?[{accessorKey:"customer",header:"Customer",meta:{title:"Customer",onOpen:e=>W(e.original)},cell:({row:e})=>{const a=e.original;return s("div",{class:"flex items-center gap-2 md:gap-3"},[s("div",{class:"w-9 h-9 rounded-full flex items-center justify-center text-xs font-bold shrink-0 bg-blue-100 text-blue-600"},a.initials),s("div",{class:"min-w-0"},[s("div",{class:"text-sm font-semibold text-gray-900 truncate max-w-[120px] md:max-w-none"},a.customer)])])}},{accessorKey:"accountType",header:"Account type",meta:{title:"Account type"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.accountType||"N/A")},{accessorKey:"telephone",header:"Telephone",meta:{title:"Telephone"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.telephone||"N/A")},{accessorKey:"location",header:"Location",meta:{title:"Location"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600 truncate max-w-[150px]"},e.original.location||"N/A")},{accessorKey:"createdAt",header:"Created at",meta:{title:"Created at"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.createdAt||"N/A")},{accessorKey:"accountOwner",header:"Account owner",meta:{title:"Account owner"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.type==="account"&&e.original.accountOwner||"N/A")},{accessorKey:"updatedAt",header:"Updated at",meta:{title:"Updated at"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.type==="account"&&e.original.updatedAt||"N/A")},{accessorKey:"lastActivity",header:"Last activity",meta:{title:"Last activity"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.type==="account"&&e.original.lastActivity||"N/A")},{accessorKey:"openOpportunities",header:"Open opportunities",meta:{title:"Open opportunities"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.type==="account"?String(e.original.openOpportunities||0):"N/A")},{accessorKey:"wonOpportunities",header:"Won opportunities",meta:{title:"Won opportunities"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.type==="account"?String(e.original.wonOpportunities||0):"N/A")},{id:"actions",header:"",meta:{title:"Actions"},cell:()=>s("button",{class:"text-gray-400 hover:text-gray-600"},[s("i",{class:"fa-solid fa-ellipsis-vertical"})])}]:c.value==="open-leads"?[{accessorKey:"customer",header:"Customer",meta:{title:"Customer",onOpen:e=>W(e.original)},cell:({row:e})=>{const a=e.original;return s("div",{class:"flex items-center gap-2 md:gap-3"},[s("div",{class:"w-9 h-9 rounded-full flex items-center justify-center text-xs font-bold shrink-0 bg-orange-100 text-orange-600"},a.initials),s("div",{class:"min-w-0"},[s("div",{class:"text-sm font-semibold text-gray-900 truncate"},a.customer),s("div",{class:"text-xs text-gray-500 truncate hidden sm:block"},a.email)])])}},{accessorKey:"nextAction",header:"Next action due",meta:{title:"Next action due"},cell:({row:e})=>{var i,p,b;const a=e.original;return a.nextActionFull?s("div",{class:"text-sm"},[s("div",{class:`font-medium mb-0.5 ${((i=a.deadlineStatus)==null?void 0:i.textClass)||"text-gray-600"}`},a.nextActionFull),s("div",{class:`text-xs flex items-center gap-1 ${((p=a.deadlineStatus)==null?void 0:p.textClass)||"text-gray-500"}`},[(b=a.deadlineStatus)!=null&&b.icon?s("i",{class:`fa-solid ${a.deadlineStatus.icon} text-[10px]`}):null,s("span",a.nextAction)])]):"-"}},{accessorKey:"car",header:"Requested car",meta:{title:"Requested car"},cell:({row:e})=>s("div",{class:"flex items-center gap-2"},[s("i",{class:"fa-brands fa-volkswagen text-gray-400 text-sm"}),s("span",{class:"text-sm font-medium text-gray-900 truncate max-w-[120px]"},e.original.car||"N/A")])},{accessorKey:"carStatus",header:"Car status",meta:{title:"Car status"},cell:({row:e})=>s("span",{class:`inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold ${e.original.carStatusClass}`},e.original.carStatus)},{accessorKey:"requestType",header:"Request type",meta:{title:"Request type"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.requestType||"N/A")},{accessorKey:"source",header:"Source",meta:{title:"Source"},cell:({row:e})=>s("span",{class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-gray-100 text-gray-700"},e.original.source||"N/A")},{accessorKey:"assignee",header:"Assignee",meta:{title:"Assignee"},cell:({row:e})=>s("div",{class:"flex items-center gap-2"},[s("div",{class:"w-6 h-6 rounded-full bg-gray-100 flex items-center justify-center text-[10px] font-bold text-gray-600 shrink-0"},e.original.assigneeInitials),s("span",{class:"text-sm text-gray-600 truncate max-w-[80px] hidden md:inline"},e.original.assignee||"N/A")])},{accessorKey:"createdAt",header:"Created at",meta:{title:"Created at"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.createdAt||"N/A")},{accessorKey:"lastActivity",header:"Last activity",meta:{title:"Last activity"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.lastActivity||"N/A")},{accessorKey:"status",header:"Status",meta:{title:"Status"},cell:({row:e})=>s("span",{class:`inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold ${e.original.statusClass}`},e.original.status)},{id:"actions",header:"",meta:{title:"Actions"},cell:()=>s("button",{class:"text-gray-400 hover:text-gray-600"},[s("i",{class:"fa-solid fa-ellipsis-vertical"})])}]:[{accessorKey:"customer",header:"Customer",meta:{title:"Customer",onOpen:e=>W(e.original)},cell:({row:e})=>{const a=e.original;return s("div",{class:"flex items-center gap-2 md:gap-3"},[s("div",{class:"w-9 h-9 rounded-full flex items-center justify-center text-xs font-bold shrink-0 bg-purple-100 text-purple-600"},a.initials),s("div",{class:"min-w-0"},[s("div",{class:"text-sm font-semibold text-gray-900 truncate"},a.customer),s("div",{class:"text-xs text-gray-500 truncate hidden sm:block"},a.email)])])}},{accessorKey:"nextAction",header:"Next action due",meta:{title:"Next action due"},cell:({row:e})=>{var i,p,b;const a=e.original;return a.nextActionFull?s("div",{class:"text-sm"},[s("div",{class:`font-medium mb-0.5 ${((i=a.deadlineStatus)==null?void 0:i.textClass)||"text-gray-600"}`},a.nextActionFull),s("div",{class:`text-xs flex items-center gap-1 ${((p=a.deadlineStatus)==null?void 0:p.textClass)||"text-gray-500"}`},[(b=a.deadlineStatus)!=null&&b.icon?s("i",{class:`fa-solid ${a.deadlineStatus.icon} text-[10px]`}):null,s("span",a.nextAction)])]):"-"}},{accessorKey:"car",header:"Offered car",meta:{title:"Offered car"},cell:({row:e})=>s("div",{class:"flex items-center gap-2"},[s("i",{class:"fa-brands fa-volkswagen text-gray-400 text-sm"}),s("span",{class:"text-sm font-medium text-gray-900 truncate max-w-[120px]"},e.original.car||"N/A")])},{accessorKey:"carStatus",header:"Car status",meta:{title:"Car status"},cell:({row:e})=>s("span",{class:`inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold ${e.original.carStatusClass}`},e.original.carStatus)},{accessorKey:"requestType",header:"Request type",meta:{title:"Request type"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.requestType||"N/A")},{accessorKey:"source",header:"Source",meta:{title:"Source"},cell:({row:e})=>s("span",{class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-gray-100 text-gray-700"},e.original.source||"N/A")},{accessorKey:"assignee",header:"Assignee",meta:{title:"Assignee"},cell:({row:e})=>s("div",{class:"flex items-center gap-2"},[s("div",{class:"w-6 h-6 rounded-full bg-gray-100 flex items-center justify-center text-[10px] font-bold text-gray-600 shrink-0"},e.original.assigneeInitials),s("span",{class:"text-sm text-gray-600 truncate max-w-[80px] hidden md:inline"},e.original.assignee||"N/A")])},{accessorKey:"createdAt",header:"Created at",meta:{title:"Created at"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.createdAt||"N/A")},{accessorKey:"lastAppointment",header:"Last appointment",meta:{title:"Last appointment"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.lastAppointment||"N/A")},{accessorKey:"status",header:"Status",meta:{title:"Status"},cell:({row:e})=>s("span",{class:`inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold ${e.original.statusClass}`},e.original.status)},{id:"actions",header:"",meta:{title:"Actions"},cell:()=>s("button",{class:"text-gray-400 hover:text-gray-600"},[s("i",{class:"fa-solid fa-ellipsis-vertical"})])}]);return(e,a)=>(h(),N("div",Re,[M(Ne,{title:"Customers"},{actions:j(()=>[c.value==="contacts"||c.value==="open-leads"||c.value==="open-opportunities"?(h(),N("button",{key:0,onClick:a[0]||(a[0]=i=>E(w).push("/add-new")),class:"flex items-center gap-2 px-4 py-2 rounded-lg border border-gray-300 bg-white text-gray-700 font-medium hover:bg-gray-50 transition-colors"},[...a[6]||(a[6]=[o("i",{class:"fa-solid fa-plus"},null,-1),o("span",{class:"hidden sm:inline"},"Add new",-1)])])):Ce("",!0)]),_:1}),o("div",Me,[o("div",We,[(h(!0),N(ve,null,be(ae.value,i=>(h(),N("button",{key:i.key,onClick:p=>ne(i.key),class:Ae(["flex items-center justify-between gap-3 px-4 py-3 bg-white border border-border rounded-lg cursor-pointer hover:shadow-sm transition-all shrink-0 min-w-[160px] border-t-4",c.value===i.key?i.borderColor:"border-t-border"])},[o("span",je,ke(i.label),1),M(E(Se),{text:String(i.count),size:"small",theme:oe(i.key,c.value===i.key)},null,8,["text","theme"])],10,Ee))),128))]),o("div",Be,[M(E(Oe),{data:J.value,columns:ue.value,meta:re.value,onRowClick:W,columnFiltersOptions:{filterDefs:te.value},pagination:Q.value,"onUpdate:pagination":a[1]||(a[1]=i=>Q.value=i),globalFilter:P.value,"onUpdate:globalFilter":a[2]||(a[2]=i=>P.value=i),sorting:H.value,"onUpdate:sorting":a[3]||(a[3]=i=>H.value=i),columnFilters:G.value,"onUpdate:columnFilters":a[4]||(a[4]=i=>G.value=i),paginationOptions:{rowCount:J.value.length},globalFilterOptions:{debounce:300}},{"empty-state":j(()=>[...a[7]||(a[7]=[o("div",{class:"empty-state"},[o("i",{class:"fa-solid fa-inbox empty-state-icon"}),o("p",{class:"empty-state-text"},"No records found")],-1)])]),_:1},8,["data","columns","meta","columnFiltersOptions","pagination","globalFilter","sorting","columnFilters","paginationOptions"])])]),M(Fe,{show:l.value,"active-tab":c.value,"initial-data":X.value,onClose:a[5]||(a[5]=i=>l.value=!1),onSave:se},null,8,["show","active-tab","initial-data"])]))}};export{tt as default};
