import{a2 as Y,r as h,c as k,d as D,o as C,F as R,i as z,n as j,e as l,s as g,t as E,y as s,D as V,G as L,m as W,J as u,h as G,k as K,w as Q,p as b,H as x,v as N}from"./index-CadXi4tZ.js";import{f as J,a as X,c as Z,u as _,d as ee}from"./vehicles-axOG3UAX.js";import{_ as le}from"./PageHeader-MC8aPyLd.js";import{i as O,Q as q}from"./index-Dm9i4Ymj.js";import{W as te,z as ae,F as se,L as ne,H as re,j as ie,K as oe,C as ue}from"./toggle-group-item.vue_vue_type_script_setup_true_lang-Csij51_o-DsnSKQBg.js";import{y as de}from"./components-CmzOo1UI.js";import"./index-Ct-3v9pQ-BaCU_Qk3.js";const B=Y("vehicles",()=>{const o=h([]),p=h(null),n=h(!1),r=h(null),f=h({status:null,brand:null,search:""}),w=k(()=>o.value.length),F=k(()=>o.value.filter(d=>d.status==="Available")),A=k(()=>o.value.reduce((d,c)=>d+c.price,0)),y=async()=>{n.value=!0,r.value=null;try{const d=await J(f.value);o.value=d.data}catch(d){r.value=d.message}finally{n.value=!1}},m=async d=>{n.value=!0,r.value=null;try{p.value=await X(d)}catch(c){r.value=c.message}finally{n.value=!1}},v=async d=>{n.value=!0,r.value=null;try{const c=await Z(d);return o.value.unshift(c),c}catch(c){throw r.value=c.message,c}finally{n.value=!1}},M=async(d,c)=>{n.value=!0,r.value=null;try{const T=await _(d,c),S=o.value.findIndex(U=>U.id===d);return S!==-1&&(o.value[S]=T),T}catch(T){throw r.value=T.message,T}finally{n.value=!1}},i=async d=>{n.value=!0,r.value=null;try{await ee(d),o.value=o.value.filter(c=>c.id!==d)}catch(c){throw r.value=c.message,c}finally{n.value=!1}};function I(d){f.value={...f.value,...d},y()}return{vehicles:o,currentVehicle:p,loading:n,error:r,filters:f,totalVehicles:w,availableVehicles:F,totalInventoryValue:A,fetchVehicles:y,fetchVehicleById:m,addVehicle:v,modifyVehicle:M,removeVehicle:i,setFilters:I}}),ce={class:"flex items-center gap-3 mb-4 overflow-x-auto pb-2 scrollbar-hide"},pe=["onClick"],me={class:"text-sm font-medium text-foreground whitespace-nowrap"},ye={__name:"VehicleFilters",props:{vehicleTabs:{type:Array,required:!0},vehicleFilter:{type:String,required:!0}},emits:["filter-change"],setup(o){return(p,n)=>(C(),D("div",ce,[(C(!0),D(R,null,z(o.vehicleTabs,r=>(C(),D("button",{key:r.key,onClick:f=>p.$emit("filter-change",r.key),class:j(["flex items-center justify-between gap-3 px-4 py-3 bg-white border border-border rounded-lg cursor-pointer hover:shadow-sm transition-all shrink-0 min-w-[160px] border-t-4",o.vehicleFilter===r.key?r.borderColor:"border-t-border"])},[l("span",me,E(r.label),1),g(s(O),{text:String(r.count),size:"small",theme:o.vehicleFilter===r.key?"blue":"gray"},null,8,["text","theme"])],10,pe))),128))]))}},ge={class:"table-wrapper w-full"},ve={__name:"VehicleGrid",props:{filteredVehicles:{type:Array,required:!0},columns:{type:Array,required:!0},loading:{type:Boolean,default:!1},tableMeta:{type:Object,required:!0},filterDefinitions:{type:Array,required:!0},pagination:{type:Object,required:!0},globalFilter:{type:String,required:!0},sorting:{type:Array,required:!0},columnFilters:{type:Array,required:!0}},emits:["row-click","update:pagination","update:globalFilter","update:sorting","update:columnFilters"],setup(o,{emit:p}){const n=o,r=p,f=k({get:()=>n.pagination,set:y=>r("update:pagination",y)}),w=k({get:()=>n.globalFilter,set:y=>r("update:globalFilter",y)}),F=k({get:()=>n.sorting,set:y=>r("update:sorting",y)}),A=k({get:()=>n.columnFilters,set:y=>r("update:columnFilters",y)});return(y,m)=>(C(),D("div",ge,[g(s(de),{data:o.filteredVehicles,columns:o.columns,loading:o.loading,meta:o.tableMeta,onRowClick:m[0]||(m[0]=v=>y.$emit("row-click",v)),columnFiltersOptions:{filterDefs:o.filterDefinitions},pagination:f.value,"onUpdate:pagination":m[1]||(m[1]=v=>f.value=v),globalFilter:w.value,"onUpdate:globalFilter":m[2]||(m[2]=v=>w.value=v),sorting:F.value,"onUpdate:sorting":m[3]||(m[3]=v=>F.value=v),columnFilters:A.value,"onUpdate:columnFilters":m[4]||(m[4]=v=>A.value=v),paginationOptions:{rowCount:o.filteredVehicles.length},globalFilterOptions:{debounce:300,placeholder:"Q Search or ask a question"}},{toolbar:V(()=>[L(y.$slots,"toolbar")]),"empty-state":V(()=>[...m[5]||(m[5]=[l("div",{class:"empty-state"},[l("i",{class:"fa-solid fa-car empty-state-icon"}),l("p",{class:"empty-state-text"},"No vehicles found")],-1)])]),_:3},8,["data","columns","loading","meta","columnFiltersOptions","pagination","globalFilter","sorting","columnFilters","paginationOptions"])]))}};function be(){const o=B(),p=h(!1),n=h({brand:"",model:"",year:"",vin:"",plates:"",fuelType:"",gearType:"",kilometers:"",registration:"",owner:"",ownershipType:"",ownedSince:"",warrantyInfo:"",stockDays:null}),r=()=>{p.value=!1,n.value={brand:"",model:"",year:"",vin:"",plates:"",fuelType:"",gearType:"",kilometers:"",registration:"",owner:"",ownershipType:"",ownedSince:"",warrantyInfo:"",stockDays:null}};return{showAddModal:p,newVehicle:n,handleCloseModal:r,handleSubmit:async()=>{try{const w={brand:n.value.brand,model:n.value.model,year:parseInt(n.value.year)||null,vin:n.value.vin||null,plates:n.value.plates||null,fuelType:n.value.fuelType||null,gearType:n.value.gearType||null,kilometers:parseInt(n.value.kilometers)||0,registration:n.value.registration||null,owner:n.value.owner||null,ownershipType:n.value.ownershipType||null,ownedSince:n.value.ownedSince||null,warrantyInfo:n.value.warrantyInfo||null,stockDays:null,status:"Available"};await o.addVehicle(w),r()}catch(w){console.error("Error adding vehicle:",w)}}}}const fe={class:"page-container"},he={class:"p-4 md:p-8"},we={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ke=["max"],xe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ve={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Fe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Te={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},$e={__name:"Vehicles",setup(o){G();const p=B(),n=h("in-stock"),r=h({pageIndex:0,pageSize:10}),f=h(""),w=h([]),F=h([]),A=t=>{t||I()},y=k(()=>n.value==="in-stock"?p.vehicles.filter(t=>t.stockDays!==null&&t.stockDays!==void 0):p.vehicles.filter(t=>t.stockDays===null||t.stockDays===void 0)),m=k(()=>[{key:"in-stock",label:"In stock",count:p.vehicles.filter(t=>t.stockDays!==null&&t.stockDays!==void 0).length,borderColor:"border-t-blue-600"},{key:"customer-vehicles",label:"Customers' vehicles",count:p.vehicles.filter(t=>t.stockDays===null||t.stockDays===void 0).length,borderColor:"border-t-purple-600"}]),v=t=>{n.value=t},{showAddModal:M,newVehicle:i,handleCloseModal:I,handleSubmit:d}=be(),c=[{key:"status",label:"Status",type:"select",operators:[{value:"eq",label:"is"},{value:"ne",label:"is not"}],options:[{value:"Available",label:"Available"},{value:"In Stock",label:"In Stock"},{value:"Sold",label:"Sold"}],aiHint:"Vehicle availability status"},{key:"brand",label:"Brand",type:"multiselect",operators:[{value:"in",label:"is any of"},{value:"notIn",label:"is none of"}],options:[{value:"Volkswagen",label:"Volkswagen"},{value:"Mercedes-Benz",label:"Mercedes-Benz"},{value:"Audi",label:"Audi"},{value:"Porsche",label:"Porsche"}],aiHint:"Car manufacturer brand"},{key:"price",label:"Price",type:"inputrange",inputType:"number",operators:[{value:"between",label:"is between"},{value:"gte",label:"is at least"},{value:"lte",label:"is at most"}],prefix:"â‚¬",aiHint:"Vehicle price in euros"},{key:"stockDays",label:"Stock Days",type:"inputrange",inputType:"number",operators:[{value:"between",label:"is between"},{value:"gte",label:"is at least"},{value:"lte",label:"is at most"}],aiHint:"Number of days in stock"}];W(()=>{p.fetchVehicles()});const T=t=>{t.original},S=t=>new Intl.NumberFormat("en-US").format(t),U=k(()=>({class:{tr:()=>"cursor-pointer hover:bg-gray-50 transition-colors"}})),P=t=>t.kilometers===0?t.year===new Date().getFullYear()?"New":"New 0km":"Used",$=t=>t?(typeof t=="string"&&t.includes("/"),t):"N/A",H=k(()=>n.value==="in-stock"?[{accessorKey:"image",header:"Photo",meta:{title:"Photo"},cell:({row:t})=>{const e=t.original;return e.image?u("img",{src:e.image,alt:`${e.brand} ${e.model}`,class:"w-16 h-16 object-cover rounded-md"}):u("div",{class:"w-16 h-16 bg-gradient-to-br from-gray-100 to-gray-200 rounded-md flex items-center justify-center shrink-0"},[u("i",{class:"fa-solid fa-car text-2xl text-gray-400"})])}},{accessorKey:"brand",header:"Vehicle",meta:{title:"Vehicle"},cell:({row:t})=>{const e=t.original;return u("div",[u("div",{class:"text-content-bold"},`${e.brand} ${e.model}`),u("div",{class:"text-meta"},e.year)])}},{accessorKey:"type",header:"Type",meta:{title:"Type"},cell:({row:t})=>{const e=t.original,a=P(e);return u("span",{class:"text-sm text-gray-600"},a)}},{accessorKey:"engine",header:"Engine",meta:{title:"Engine"},cell:({row:t})=>u("span",{class:"text-sm text-gray-600"},"N/A")},{accessorKey:"fuelType",header:"Fuel type",meta:{title:"Fuel type"},cell:({row:t})=>u("span",{class:"text-sm text-gray-600"},t.original.fuelType||"N/A")},{accessorKey:"gearType",header:"Gear type",meta:{title:"Gear type"},cell:({row:t})=>u("span",{class:"text-sm text-gray-600"},t.original.gearType||"N/A")},{accessorKey:"registration",header:"Registered at",meta:{title:"Registered at"},cell:({row:t})=>{const e=t.original;return u("span",{class:"text-sm text-gray-600"},$(e.registration)||"N/A")}},{accessorKey:"kilometers",header:"Mileage",meta:{title:"Mileage"},cell:({row:t})=>u("span",{class:"text-sm text-gray-600"},`${S(t.original.kilometers)} km`)},{accessorKey:"stockDays",header:"Days in stock",meta:{title:"Days in stock"},cell:({row:t})=>{const e=t.original.stockDays,a=e>300?"text-red-600":"text-gray-600";return u("span",{class:`text-sm font-medium ${a}`},`${e} days`)}},{accessorKey:"dealership",header:"Dealership",meta:{title:"Dealership"},cell:({row:t})=>u("span",{class:"text-sm text-gray-600"},t.original.dealership||"N/A")},{accessorKey:"status",header:"Availability",meta:{title:"Availability"},cell:({row:t})=>{const e=t.original.status;return u(O,{text:e,size:"small",theme:e==="Available"?"green":e==="In Stock"?"blue":"gray"})}}]:[{accessorKey:"brand",header:"Vehicle",meta:{title:"Vehicle"},cell:({row:t})=>{const e=t.original;return u("div",[u("div",{class:"text-content-bold"},`${e.brand} ${e.model}`),u("div",{class:"text-meta"},e.year)])}},{accessorKey:"plates",header:"Plates",meta:{title:"Plates"},cell:({row:t})=>{const e=t.original,a=e.plates||(e.vin?e.vin.slice(-6):null)||"N/A";return u("span",{class:"text-sm text-gray-600"},a)}},{accessorKey:"kilometers",header:"Mileage",meta:{title:"Mileage"},cell:({row:t})=>u("span",{class:"text-sm text-gray-600"},`${S(t.original.kilometers)} km`)},{accessorKey:"registration",header:"Registered at",meta:{title:"Registered at"},cell:({row:t})=>{const e=t.original;return u("span",{class:"text-sm text-gray-600"},$(e.registration)||"N/A")}},{accessorKey:"owner",header:"Owner",meta:{title:"Owner"},cell:({row:t})=>{const e=t.original,a=e.owner||(e.requestedBy&&e.requestedBy.length>0?e.requestedBy[0]:null)||"N/A";return u("span",{class:"text-sm text-gray-600"},a)}},{accessorKey:"ownershipType",header:"Ownership type",meta:{title:"Ownership type"},cell:({row:t})=>u("span",{class:"text-sm text-gray-600"},"N/A")},{accessorKey:"ownedSince",header:"Owned since",meta:{title:"Owned since"},cell:({row:t})=>{const e=t.original;return u("span",{class:"text-sm text-gray-600"},$(e.registration)||"N/A")}},{accessorKey:"warrantyInfo",header:"Warranty info",meta:{title:"Warranty info"},cell:({row:t})=>u("span",{class:"text-sm text-gray-600"},"N/A")}]);return(t,e)=>(C(),D("div",fe,[g(le,{title:"Vehicles Inventory"},{actions:V(()=>[l("button",{onClick:e[0]||(e[0]=a=>M.value=!0),class:"group flex items-center gap-2 rounded-2xl border border-gray-200 px-4 py-2 text-sm font-medium text-gray-600 hover:border-indigo-100 hover:bg-indigo-50 hover:text-indigo-600 transition-all"},[...e[19]||(e[19]=[l("i",{class:"fa-solid fa-plus text-gray-400 group-hover:text-indigo-500"},null,-1),l("span",{class:"hidden sm:inline"},"Add new",-1)])])]),_:1}),l("div",he,[g(ye,{"vehicle-tabs":m.value,"vehicle-filter":n.value,onFilterChange:v},null,8,["vehicle-tabs","vehicle-filter"]),g(ve,{"filtered-vehicles":y.value,columns:H.value,loading:s(p).loading,"table-meta":U.value,"filter-definitions":c,pagination:r.value,"onUpdate:pagination":e[1]||(e[1]=a=>r.value=a),"global-filter":f.value,"onUpdate:globalFilter":e[2]||(e[2]=a=>f.value=a),sorting:w.value,"onUpdate:sorting":e[3]||(e[3]=a=>w.value=a),"column-filters":F.value,"onUpdate:columnFilters":e[4]||(e[4]=a=>F.value=a),onRowClick:T},null,8,["filtered-vehicles","columns","loading","table-meta","pagination","global-filter","sorting","column-filters"])]),g(s(te),{open:s(M),"onUpdate:open":A},{default:V(()=>[g(s(ae),null,{default:V(()=>[g(s(se),{class:"fixed inset-0 z-50 bg-black/50"}),g(s(ne),{class:"w-full sm:max-w-lg"},{default:V(()=>[g(s(re),null,{default:V(()=>[g(s(ie),null,{default:V(()=>[...e[20]||(e[20]=[K("Add Customer Vehicle",-1)])]),_:1}),g(s(oe),null,{default:V(()=>[...e[21]||(e[21]=[K("Fill in the details for the new customer vehicle.",-1)])]),_:1})]),_:1}),l("form",{onSubmit:e[18]||(e[18]=Q((...a)=>s(d)&&s(d)(...a),["prevent"])),class:"space-y-4"},[l("div",we,[l("div",null,[e[22]||(e[22]=l("label",{class:"block label-upper mb-2"},"Brand",-1)),b(l("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>s(i).brand=a),type:"text",placeholder:"e.g., Volkswagen",class:"input",required:""},null,512),[[x,s(i).brand]])]),l("div",null,[e[23]||(e[23]=l("label",{class:"block label-upper mb-2"},"Model",-1)),b(l("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>s(i).model=a),type:"text",placeholder:"e.g., ID.4",class:"input",required:""},null,512),[[x,s(i).model]])]),l("div",null,[e[24]||(e[24]=l("label",{class:"block label-upper mb-2"},"Year",-1)),b(l("input",{"onUpdate:modelValue":e[7]||(e[7]=a=>s(i).year=a),type:"number",placeholder:"e.g., 2024",class:"input",min:"1900",max:new Date().getFullYear()+1,required:""},null,8,ke),[[x,s(i).year]])])]),l("div",xe,[l("div",null,[e[25]||(e[25]=l("label",{class:"block label-upper mb-2"},"VIN",-1)),b(l("input",{"onUpdate:modelValue":e[8]||(e[8]=a=>s(i).vin=a),type:"text",placeholder:"Vehicle Identification Number",class:"input"},null,512),[[x,s(i).vin]])]),l("div",null,[e[26]||(e[26]=l("label",{class:"block label-upper mb-2"},"Plates",-1)),b(l("input",{"onUpdate:modelValue":e[9]||(e[9]=a=>s(i).plates=a),type:"text",placeholder:"License plate number",class:"input"},null,512),[[x,s(i).plates]])])]),l("div",Ve,[l("div",null,[e[28]||(e[28]=l("label",{class:"block label-upper mb-2"},"Fuel Type",-1)),b(l("select",{"onUpdate:modelValue":e[10]||(e[10]=a=>s(i).fuelType=a),class:"input"},[...e[27]||(e[27]=[l("option",{value:""},"Select fuel type...",-1),l("option",{value:"Petrol"},"Petrol",-1),l("option",{value:"Diesel"},"Diesel",-1),l("option",{value:"Electric"},"Electric",-1),l("option",{value:"Hybrid"},"Hybrid",-1),l("option",{value:"Plug-in Hybrid"},"Plug-in Hybrid",-1)])],512),[[N,s(i).fuelType]])]),l("div",null,[e[30]||(e[30]=l("label",{class:"block label-upper mb-2"},"Gear Type",-1)),b(l("select",{"onUpdate:modelValue":e[11]||(e[11]=a=>s(i).gearType=a),class:"input"},[...e[29]||(e[29]=[l("option",{value:""},"Select gear type...",-1),l("option",{value:"Manual"},"Manual",-1),l("option",{value:"Automatic"},"Automatic",-1),l("option",{value:"CVT"},"CVT",-1)])],512),[[N,s(i).gearType]])]),l("div",null,[e[31]||(e[31]=l("label",{class:"block label-upper mb-2"},"Mileage (km)",-1)),b(l("input",{"onUpdate:modelValue":e[12]||(e[12]=a=>s(i).kilometers=a),type:"number",placeholder:"0",class:"input",min:"0"},null,512),[[x,s(i).kilometers,void 0,{number:!0}]])])]),l("div",Fe,[l("div",null,[e[32]||(e[32]=l("label",{class:"block label-upper mb-2"},"Registered At",-1)),b(l("input",{"onUpdate:modelValue":e[13]||(e[13]=a=>s(i).registration=a),type:"text",placeholder:"MM/YYYY (e.g., 01/2024)",class:"input"},null,512),[[x,s(i).registration]])]),l("div",null,[e[33]||(e[33]=l("label",{class:"block label-upper mb-2"},"Owned Since",-1)),b(l("input",{"onUpdate:modelValue":e[14]||(e[14]=a=>s(i).ownedSince=a),type:"text",placeholder:"MM/YYYY (e.g., 01/2024)",class:"input"},null,512),[[x,s(i).ownedSince]])])]),l("div",Te,[l("div",null,[e[34]||(e[34]=l("label",{class:"block label-upper mb-2"},"Owner",-1)),b(l("input",{"onUpdate:modelValue":e[15]||(e[15]=a=>s(i).owner=a),type:"text",placeholder:"Owner name",class:"input"},null,512),[[x,s(i).owner]])]),l("div",null,[e[36]||(e[36]=l("label",{class:"block label-upper mb-2"},"Ownership Type",-1)),b(l("select",{"onUpdate:modelValue":e[16]||(e[16]=a=>s(i).ownershipType=a),class:"input"},[...e[35]||(e[35]=[l("option",{value:""},"Select ownership type...",-1),l("option",{value:"Private"},"Private",-1),l("option",{value:"Company"},"Company",-1),l("option",{value:"Lease"},"Lease",-1),l("option",{value:"Fleet"},"Fleet",-1)])],512),[[N,s(i).ownershipType]])])]),l("div",null,[e[37]||(e[37]=l("label",{class:"block label-upper mb-2"},"Warranty Info",-1)),b(l("textarea",{"onUpdate:modelValue":e[17]||(e[17]=a=>s(i).warrantyInfo=a),rows:"3",placeholder:"Warranty information...",class:"input"},null,512),[[x,s(i).warrantyInfo]])])],32),g(s(ue),{class:"flex flex-col sm:flex-row justify-end items-stretch sm:items-center gap-3"},{default:V(()=>[g(s(q),{label:"Cancel",variant:"outline",class:"w-full sm:w-auto",onClick:s(I)},null,8,["onClick"]),g(s(q),{label:"Add Vehicle",variant:"primary",class:"w-full sm:w-auto",onClick:s(d)},null,8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]))}};export{$e as default};
