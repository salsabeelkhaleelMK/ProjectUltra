import{E as dt,c as S,G as ut,r as A,H as _e,d as b,o as p,g as T,p as Z,e,w as et,x as H,y as n,P as tt,n as K,t as O,I as ue,k as W,F as pe,_ as st,s as C,D,T as ct,l as ye,J as ce,i as fe,K as Se,L as oe,j as Qe,M as He,N as pt,h as nt,C as je,u as Ae,O as Be,v as we,Q as X,R as Ut,S as Ft,U as Me,V as Ve,W as Xe,z as Pe,m as lt,X as Vt,Y as Rt,Z as jt}from"./index-Bh03WcOC.js";import{u as Ye}from"./opportunities-BTZM9yyg.js";import{u as We}from"./users-C5eDhXwU.js";import{y as Wt}from"./components-Bqk3nxzX.js";import{_ as zt,i as Ht,g as Pt,a as Qt,s as Yt,b as Kt,c as Gt,d as Jt,e as Ze,f as Xt,h as Zt,j as _t,k as es,l as ts,m as ss,n as ns,o as ls,p as os,q as as,r as is}from"./ComingSoonModal-RE8dbRfU.js";import{f as Ue,a as Re,g as mt,b as ft,c as yt,d as vt}from"./formatters-DjeI4Z8-.js";import{z as De,F as Te,L as Ie,H as Oe,j as qe,K as ze,C as Ne,W as Le}from"./toggle-group-item.vue_vue_type_script_setup_true_lang-Csij51_o-DA4kdAII.js";import{_ as gt}from"./ReassignUserModal-Ccn5hxL3.js";import{f as bt}from"./vehicles-u7UgHrW7.js";import{_ as rs}from"./CreateEventModal-CDTj2y2Y.js";import{_ as ds,a as us}from"./EditEventModal-DsBMdzyo.js";/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=dt("LayoutGridIcon",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=dt("TableIcon",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]),cs={key:1,class:"absolute right-3 top-8 z-50"},ps={class:"flex gap-2 mb-0.5"},ms={key:1,class:"px-2 py-0.5 rounded text-fluid-xs font-medium bg-red-50 text-red-700 border border-red-200"},fs={class:"font-bold text-gray-900 text-fluid-sm line-clamp-2 pt-0.5"},ys={class:"flex gap-3 text-fluid-xs mt-0.5 mb-1"},vs={class:"flex items-center gap-1.5"},gs={class:"flex items-center gap-1.5"},bs={key:0,class:"text-fluid-xs text-gray-600 pb-3"},hs={key:2,class:"flex items-center justify-between pt-1 border-t border-black/5"},xs={class:"text-fluid-xs flex items-center gap-2"},ws={class:"rounded-full bg-black text-white font-medium flex items-center justify-center text-fluid-xs shrink-0 w-3 h-3"},ks={class:"text-gray-600 font-medium"},Cs={key:1},$s={class:"text-fluid-xs font-medium"},Ss={__name:"TaskCard",props:{item:{type:Object,required:!0},selected:{type:Boolean,default:!1},selectedClass:{type:[String,Function],default:"bg-white border-2 border-blue-500 shadow-md"},unselectedClass:{type:[String,Function],default:"bg-white border border-black/5 hover:border-blue-300"},showMenu:{type:Boolean,default:!0},openMenuId:{type:[Number,String],default:null},getName:{type:Function,required:!0},getVehicleInfo:{type:Function,default:null},menuItems:{type:Array,default:null}},emits:["select","menu-click","menu-close"],setup(t,{emit:y}){const s=t,d=S(()=>s.item.compositeId||`${s.item.type||"task"}-${s.item.id}`||s.item.id),l=S(()=>s.selected),o=S(()=>l.value?typeof s.selectedClass=="function"?s.selectedClass(s.item):s.selectedClass:typeof s.unselectedClass=="function"?s.unselectedClass(s.item):s.unselectedClass),c=S(()=>{const i=s.item.displayStage||s.item.stage;return i?ut(i,s.item.type||"opportunity"):"bg-gray-100 text-gray-700"}),r=i=>{if(!i)return"?";const a=i.split(" ");return a.length>=2?(a[0][0]+a[a.length-1][0]).toUpperCase():i.substring(0,2).toUpperCase()},m=A(null);return(i,a)=>{const u=_e("click-outside");return p(),b("div",{ref_key:"cardRef",ref:m,onClick:a[1]||(a[1]=f=>i.$emit("select",d.value)),class:K(["bg-white rounded-xl p-2.5 min-h-32 flex flex-col justify-between hover:shadow-mk-dashboard-card cursor-pointer relative transition-shadow",o.value])},[t.showMenu?(p(),b("button",{key:0,onClick:a[0]||(a[0]=et(f=>i.$emit("menu-click",t.item.id),["stop"])),class:"absolute top-3 right-3 text-gray-300 hover:text-gray-600"},[...a[2]||(a[2]=[e("i",{class:"fa-solid fa-ellipsis-vertical"},null,-1)])])):T("",!0),t.openMenuId===t.item.id&&t.showMenu?Z((p(),b("div",cs,[t.menuItems&&t.menuItems.length>0?(p(),H(n(tt),{key:0,items:t.menuItems,className:"w-40"},null,8,["items"])):T("",!0)])),[[u,()=>i.$emit("menu-close")]]):T("",!0),e("div",null,[e("div",ps,[e("span",{class:K(["px-2 py-0.5 rounded text-fluid-xs font-medium border",t.item.type==="lead"?"bg-blue-50 text-blue-700 border-blue-200":"bg-purple-50 text-purple-700 border-purple-200"])},O(t.item.type==="lead"?"Lead":"Opportunity"),3),t.item.displayStage||t.item.stage?(p(),b("span",{key:0,class:K(["px-2 py-0.5 rounded text-fluid-xs font-medium border",c.value])},O(t.item.displayStage||t.item.stage),3)):T("",!0),t.item.priority==="Hot"?(p(),b("span",ms," Hot ")):T("",!0)]),e("h3",fs,O(t.getName(t.item)),1),e("div",ys,[e("span",vs,[a[3]||(a[3]=e("i",{class:"fa-solid fa-location-dot text-fluid-xs"},null,-1)),ue(i.$slots,"location",{item:t.item})]),e("span",gs,[a[4]||(a[4]=e("i",{class:"fa-solid fa-globe text-fluid-xs"},null,-1)),ue(i.$slots,"source",{item:t.item},()=>{var f;return[W(O(t.item.source||((f=t.item.customer)==null?void 0:f.source)||"Unknown"),1)]})])]),t.getVehicleInfo?(p(),b("p",bs,O(t.getVehicleInfo(t.item)),1)):T("",!0)]),i.$slots.owner||i.$slots.dates?(p(),b("div",hs,[e("div",xs,[ue(i.$slots,"owner",{item:t.item},()=>[t.item.assignee?(p(),b(pe,{key:0},[e("div",ws,O(r(t.item.assignee)),1),e("span",ks,O(t.item.assignee),1)],64)):(p(),b("span",Cs,"Unassigned"))])]),e("div",$s,[ue(i.$slots,"dates",{item:t.item})])])):T("",!0)],2)}}},As={class:"flex items-center gap-2"},Ds={key:0,class:"flex gap-2"},Ts={class:"relative ml-auto",ref:"sortContainer"},Is={key:0,class:"absolute -top-0.5 -right-0.5 w-2.5 h-2.5 rounded-full border-2 border-white",style:{"background-color":"var(--brand-red)"}},Os={key:0,class:"absolute right-0 mt-2 z-50 sort-dropdown-wrapper"},qs={__name:"TaskFilters",props:{typeFilter:{type:String,default:"all"},sortOption:{type:String,default:"recent-first"},showTypeFilter:{type:Boolean,default:!0},showClosed:{type:Boolean,default:!1}},emits:["filter-change","sort-change","toggle-closed"],setup(t,{emit:y}){const s=t,d=y,l=A(!1),o=()=>{l.value=!l.value},c=m=>{l.value=!1,d("sort-change",m)},r=S(()=>[{key:"recent-first",label:"Most Recent First",onClick:()=>c("recent-first")},...s.typeFilter==="lead"?[{key:"urgent-first",label:"Urgent first",onClick:()=>c("urgent-first")}]:[],{key:"assigned-to-me",label:"Assigned to me",onClick:()=>c("assigned-to-me")},{key:"assigned-to-my-team",label:"Assigned to my team",onClick:()=>c("assigned-to-my-team")}].map(i=>({...i,className:i.key===s.sortOption?"sort-item-selected":""})));return(m,i)=>{const a=_e("click-outside");return p(),b("div",As,[t.showTypeFilter?(p(),b("div",Ds,[e("button",{onClick:i[0]||(i[0]=u=>m.$emit("filter-change","all")),class:K(["text-xs font-medium px-3 py-1.5 rounded-md border transition-colors",t.typeFilter==="all"?"bg-brand-dark text-white border-brand-dark":"bg-white hover:bg-gray-50 border-gray-200 text-gray-700"])}," All ",2),e("button",{onClick:i[1]||(i[1]=u=>m.$emit("filter-change","lead")),class:K(["text-xs font-medium px-3 py-1.5 rounded-md border transition-colors",t.typeFilter==="lead"?"bg-brand-dark text-white border-brand-dark":"bg-white hover:bg-gray-50 border-gray-200 text-gray-700"])}," Leads ",2),e("button",{onClick:i[2]||(i[2]=u=>m.$emit("filter-change","opportunity")),class:K(["text-xs font-medium px-3 py-1.5 rounded-md border transition-colors",t.typeFilter==="opportunity"?"bg-brand-dark text-white border-brand-dark":"bg-white hover:bg-gray-50 border-gray-200 text-gray-700"])}," Opportunities ",2)])):T("",!0),e("div",Ts,[e("button",{onClick:et(o,["stop"]),class:"relative w-8 h-8 flex items-center justify-center rounded-md border border-gray-200 hover:bg-gray-50 transition-colors text-gray-600 hover:text-gray-900"},[i[3]||(i[3]=e("i",{class:"fa-solid fa-arrow-down-wide-short text-sm"},null,-1)),t.sortOption&&t.sortOption!=="recent-first"?(p(),b("span",Is)):T("",!0)]),C(ct,{name:"dropdown"},{default:D(()=>[l.value?Z((p(),b("div",Os,[C(n(tt),{items:r.value,className:"w-56"},null,8,["items"])])),[[a,()=>l.value=!1]]):T("",!0)]),_:1})],512)])}}},Ns=st(qs,[["__scopeId","data-v-b1a2e14c"]]),Ls={class:"tasks-list-container border-r border-black/5 flex flex-col shrink-0 w-full lg:w-80 h-full"},Es={class:"page-header shrink-0"},Bs={class:"page-header-main"},Ms={class:"page-header-content"},Us={class:"page-header-title-container"},Fs={class:"page-header-title"},Vs={class:"page-header-actions"},Rs={class:"bg-white border border-black/5 p-0.5 rounded-lg inline-flex gap-0.5"},js={class:"px-5 py-3"},Ws={class:"relative"},zs=["placeholder"],Hs={key:0,class:"px-5 pb-3"},Ps={__name:"TasksList",props:{title:{type:String,default:"Tasks"},items:{type:Array,default:()=>[]},selectedId:{type:[String,Number],default:null},typeFilter:{type:String,default:"all"},initialSearchQuery:{type:String,default:""},selectedClass:{type:[String,Function],default:""},unselectedClass:{type:[String,Function],default:""},openMenuId:{type:[String,Number],default:null},getName:{type:Function,default:t=>t.name||"Unknown"},getVehicleInfo:{type:Function,default:()=>"No vehicle specified"},getMenuItems:{type:Function,default:null},showMenu:{type:Boolean,default:!0},showTypeFilter:{type:Boolean,default:!0},searchPlaceholder:{type:String,default:"Search tasks..."},viewMode:{type:String,default:"card"}},emits:["select","menu-click","menu-close","filter-change","sort-change","close","view-change"],setup(t,{emit:y}){const s=t,d=y,l=A(s.initialSearchQuery),o=A(null),c=A("recent-first");ye(()=>s.initialSearchQuery,a=>{l.value=a});const r=S(()=>{if(!l.value.trim())return s.items;const a=l.value.toLowerCase().trim();return s.items.filter(u=>{const f=s.getName(u).toLowerCase(),g=s.getVehicleInfo(u).toLowerCase();return f.includes(a)||g.includes(a)})}),m=a=>s.selectedId?(a.compositeId||`${a.type||"task"}-${a.id}`)===s.selectedId:!1,i=a=>{c.value=a,d("sort-change",a)};return(a,u)=>(p(),b("div",Ls,[e("header",Es,[e("div",Bs,[e("div",Ms,[e("div",Us,[e("h1",Fs,O(t.title),1)]),e("div",Vs,[e("div",Rs,[e("button",{onClick:u[0]||(u[0]=f=>a.$emit("view-change","table")),class:K(["h-7 px-2.5 rounded-md transition-all flex items-center justify-center",t.viewMode==="table"?"bg-brand-gray text-heading shadow-sm":"text-sub hover:text-heading"]),title:"Table View"},[C(n(xt),{size:14})],2),e("button",{onClick:u[1]||(u[1]=f=>a.$emit("view-change","card")),class:K(["h-7 px-2.5 rounded-md transition-all flex items-center justify-center",t.viewMode==="card"?"bg-brand-gray text-heading shadow-sm":"text-sub hover:text-heading"]),title:"Card View"},[C(n(ht),{size:14})],2)])])])])]),e("div",js,[e("div",Ws,[u[7]||(u[7]=e("i",{class:"fa-solid fa-magnifying-glass absolute left-3 top-2.5 text-sub text-fluid-sm"},null,-1)),Z(e("input",{"onUpdate:modelValue":u[2]||(u[2]=f=>l.value=f),type:"text",placeholder:t.searchPlaceholder,class:"w-full bg-white border border-black/5 rounded-lg pl-9 pr-3 py-2 text-fluid-sm"},null,8,zs),[[ce,l.value]])])]),t.showTypeFilter?(p(),b("div",Hs,[C(Ns,{"type-filter":t.typeFilter,"sort-option":c.value,"show-type-filter":!0,onFilterChange:u[3]||(u[3]=f=>a.$emit("filter-change",f)),onSortChange:i},null,8,["type-filter","sort-option"])])):T("",!0),e("div",{ref_key:"scrollContainer",ref:o,class:"flex-1 overflow-y-auto px-5 space-y-3 pt-4 pb-6 scrollbar-hide"},[(p(!0),b(pe,null,fe(r.value,f=>(p(),H(Ss,{key:f.compositeId||`${f.type||"task"}-${f.id}`,item:f,selected:m(f),"selected-class":t.selectedClass,"unselected-class":t.unselectedClass,"show-menu":t.showMenu,"open-menu-id":t.openMenuId,getName:t.getName,getVehicleInfo:t.getVehicleInfo,"menu-items":t.getMenuItems?t.getMenuItems(f):null,onSelect:u[4]||(u[4]=g=>a.$emit("select",g)),onMenuClick:u[5]||(u[5]=g=>a.$emit("menu-click",g)),onMenuClose:u[6]||(u[6]=g=>a.$emit("menu-close"))},{location:D(({item:g})=>[ue(a.$slots,"location",{item:g},void 0,!0)]),source:D(({item:g})=>[ue(a.$slots,"source",{item:g},void 0,!0)]),owner:D(({item:g})=>[ue(a.$slots,"owner",{item:g},void 0,!0)]),dates:D(({item:g})=>[ue(a.$slots,"dates",{item:g},void 0,!0)]),_:2},1032,["item","selected","selected-class","unselected-class","show-menu","open-menu-id","getName","getVehicleInfo","menu-items"]))),128))],512)]))}},Qs=st(Ps,[["__scopeId","data-v-f606b725"]]);function wt(t,y=[],s,d){const l=Se(),o=l.getSetting("urgencyWeights")||{intent:40,behavioral:35,temporal:25},c=l.getSetting("urgencyThresholds")||{hot:80,warm:50,standard:20},r=Ys(t,y),m=Ks(t,y),i=Gs(t),a=Js(t),u=o.intent+o.behavioral+o.temporal,f={intent:o.intent/u*100,behavioral:o.behavioral/u*100,temporal:o.temporal/u*100},g=r/40*f.intent,$=m/35*f.behavioral,I=i/25*f.temporal,N=Math.min(100,Math.max(0,g+$+I+a));let w="COLD";return N>=c.hot?w="HOT":N>=c.warm?w="WARM":N>=c.standard&&(w="STANDARD"),{score:Math.round(N*10)/10,level:w,breakdown:{intent:Math.round(r*10)/10,behavioral:Math.round(m*10)/10,temporal:Math.round(i*10)/10,quality:Math.round(a*10)/10,total:Math.round(N*10)/10}}}function Ys(t,y){var d;let s=0;return(t.requestType==="Test Drive"||((d=t.scheduledAppointment)==null?void 0:d.type)==="test-drive"||y.some(l=>l.type==="test-drive"||l.type==="appointment"))&&(s=Math.max(s,40)),y.some(l=>l.type==="financing")&&(s=Math.max(s,35)),y.some(l=>l.type==="tradein")&&(s=Math.max(s,30)),(t.source==="Walk-in"||y.some(l=>{var o,c,r;return((o=l.content)==null?void 0:o.toLowerCase().includes("location"))||((c=l.content)==null?void 0:c.toLowerCase().includes("dealership"))||((r=l.content)==null?void 0:r.toLowerCase().includes("visit"))}))&&(s=Math.max(s,25)),t.requestedCar&&(t.requestedCar.requestMessage||y.some(l=>{var o,c;return((o=l.content)==null?void 0:o.toLowerCase().includes("configur"))||l.type==="attachment"&&((c=l.fileName)==null?void 0:c.toLowerCase().includes("config"))}))&&(s=Math.max(s,20)),y.some(l=>{var c;const o=((c=l.content)==null?void 0:c.toLowerCase())||"";return o.includes("compare")||o.includes("versus")||o.includes("vs")||o.includes("alternative")})&&(s=Math.max(s,15)),Math.min(s,40)}function Ks(t,y){let s=0;const d=new Set(y.map(r=>{if(!r.timestamp)return null;const m=new Date(r.timestamp);return`${m.getFullYear()}-${m.getMonth()}-${m.getDate()}`}).filter(Boolean)),l=Math.min(d.size*10,35);s+=l,t.contactAttempts&&t.contactAttempts.length>1&&(s+=20);const o=y.reduce((r,m)=>{var i;return r+(((i=m.content)==null?void 0:i.length)||0)},0),c=Math.min(Math.floor(o/50),25);return s+=c,y.some(r=>{var m,i,a;return r.type==="attachment"&&(((m=r.fileName)==null?void 0:m.toLowerCase().includes("brochure"))||((i=r.fileName)==null?void 0:i.toLowerCase().includes("spec"))||((a=r.fileName)==null?void 0:a.toLowerCase().includes("pdf")))})&&(s+=15),Math.min(s,35)}function Gs(t){let y=0;if(!t.createdAt)return 0;const s=new Date,d=new Date(t.createdAt),l=(s.getTime()-d.getTime())/(1e3*60*60);l<2?y+=25:l<24?y+=15:l<48?y+=5:y-=10;const o=d.getDay(),c=d.getHours();if((o===0||o===6||c<9||c>17)&&(y+=10),t.contactAttempts&&t.contactAttempts.length===3&&(y+=50),t.lastActivity){const r=new Date(t.lastActivity);(s.getTime()-r.getTime())/(1e3*60*60*24)>3&&(y+=20)}return Math.min(Math.max(y,0),25)}function Js(t){var s,d,l,o,c,r,m;let y=0;return(s=t.customer)!=null&&s.email&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.customer.email)&&(y+=10),(d=t.customer)!=null&&d.phone&&/^\+?[\d\s\-()]+$/.test(t.customer.phone)&&t.customer.phone.length>=10&&(y+=10),(l=t.customer)!=null&&l.name&&((o=t.customer)!=null&&o.email)&&((c=t.customer)!=null&&c.phone)&&((r=t.customer)!=null&&r.address)&&(y+=5),(t.isDuplicate||t.isDisqualified||!((m=t.customer)!=null&&m.name))&&(y-=20),y}function kt(t){switch(t){case"HOT":return"ðŸ”¥";case"WARM":return"ðŸŸ¡";case"STANDARD":return"ðŸŸ¢";case"COLD":return"âšª";default:return"âšª"}}function Ct(t){switch(t){case"HOT":return"bg-red-50 text-red-700 border-red-200";case"WARM":return"bg-orange-50 text-orange-700 border-orange-200";case"STANDARD":return"bg-green-50 text-green-700 border-green-200";case"COLD":return"bg-gray-50 text-gray-700 border-gray-200";default:return"bg-gray-50 text-gray-700 border-gray-200"}}function Xs({typeFilter:t,showTypeFilter:y,tasks:s}){return{filterDefinitions:S(()=>{const l=[];y.value&&l.push({key:"type",label:"Type",type:"select",operators:[{value:"eq",label:"is"}],options:[{value:"lead",label:"Lead"},{value:"opportunity",label:"Opportunity"}],aiHint:"Lead or Opportunity type",pinned:!0}),l.push({key:"status",label:"Status",type:"multiselect",operators:[{value:"in",label:"is any of"},{value:"notIn",label:"is none of"}],options:[{value:"Valid",label:"Valid"},{value:"Not valid",label:"Not valid"},{value:"Qualified",label:"Qualified"},{value:"In Negotiation",label:"In Negotiation"},{value:"Won",label:"Won"},{value:"Lost",label:"Lost"},{value:"Not interested",label:"Not interested"},{value:"Open",label:"Open"},{value:"Open Lead",label:"Open Lead"}],aiHint:"Lead status or opportunity stage",pinned:!0}),l.push({key:"priority",label:"Priority",type:"select",operators:[{value:"eq",label:"is"}],options:[{value:"Hot",label:"High"},{value:"Normal",label:"Normal"}],aiHint:"Task priority level"}),t.value==="lead"&&l.push({key:"urgencyLevel",label:"Urgency",type:"select",operators:[{value:"eq",label:"is"}],options:[{value:"HOT",label:"ðŸ”¥ Hot"},{value:"WARM",label:"ðŸŸ¡ Warm"},{value:"STANDARD",label:"ðŸŸ¢ Standard"},{value:"COLD",label:"âšª Cold"}],aiHint:"Lead urgency level based on scoring",pinned:!0}),l.push({key:"source",label:"Source",type:"multiselect",operators:[{value:"in",label:"is any of"},{value:"notIn",label:"is none of"}],options:[{value:"Marketing",label:"Marketing"},{value:"Website",label:"Website"},{value:"Referral",label:"Referral"},{value:"Walk-in",label:"Walk-in"}],aiHint:"Lead or opportunity source",pinned:!0});const o=[...new Set(s.value.map(r=>r.assignee).filter(Boolean))];o.length>0&&l.push({key:"assignee",label:"Assignee",type:"select",operators:[{value:"eq",label:"is"}],options:o.map(r=>({value:r,label:r})),aiHint:"Person assigned to the task",pinned:!0});const c=[...new Set(s.value.map(r=>{const m=r.type==="lead"?r.requestedCar:r.vehicle;return m==null?void 0:m.brand}).filter(Boolean))];return c.length>0&&l.push({key:"requestedCarBrand",label:"Requested car",type:"multiselect",operators:[{value:"in",label:"is any of"},{value:"notIn",label:"is none of"}],options:c.map(r=>({value:r,label:r})),aiHint:"Car brand requested by customer"}),l.push({key:"createdAt",label:"Creation date",type:"daterange",operators:[{value:"between",label:"is between"},{value:"gte",label:"is after"},{value:"lte",label:"is before"}],aiHint:"Date when the task was created"}),l})}}const Zs={class:"page-container flex-1 flex flex-col overflow-hidden min-w-0"},_s={class:"page-header shrink-0"},en={class:"page-header-main"},tn={class:"page-header-content"},sn={class:"page-header-actions"},nn={class:"bg-white border border-black/5 p-0.5 rounded-lg inline-flex gap-0.5"},ln={class:"flex-1 overflow-y-auto p-4 md:p-8"},on={class:"table-wrapper w-full"},an={__name:"TasksTableView",props:{tasks:{type:Array,required:!0},currentTaskId:{type:String,default:null},highlightId:{type:String,default:null},typeFilter:{type:String,default:"all"},sortOption:{type:String,default:"recent-first"},showTypeFilter:{type:Boolean,default:!0},showClosed:{type:Boolean,default:!1},showMobileClose:{type:Boolean,default:!1},openMenuId:{type:[Number,String],default:null},searchPlaceholder:{type:String,default:"Search tasks..."},viewMode:{type:String,default:"table"},getVehicleType:{type:Function,required:!0},getVehicleTypeBadgeClass:{type:Function,required:!0},getOwnerInfo:{type:Function,required:!0},getStageBadgeClass:{type:Function,required:!0}},emits:["select","menu-click","menu-close","filter-change","sort-change","toggle-closed","reassign","close","view-change"],setup(t,{emit:y}){const s=t,d=y,l=Se();A("");const o=A({pageIndex:0,pageSize:10}),c=A(""),r=A([]),m=A([{id:"status",value:["Valid","Qualified","Open Lead"],operator:"in"},{id:"type",value:"lead",operator:"eq"},{id:"source",value:["Marketing","Website"],operator:"in"},{id:"assignee",value:void 0},{id:"urgencyLevel",value:void 0}]);A({});const{filterDefinitions:i}=Xs({typeFilter:S(()=>s.typeFilter),showTypeFilter:S(()=>s.showTypeFilter),tasks:S(()=>s.tasks)}),a=S(()=>s.tasks),u=h=>h.compositeId===s.currentTaskId||h.compositeId===s.highlightId,f=h=>{if(h.type==="lead")return h.requestedCar?`${h.requestedCar.brand} ${h.requestedCar.model}`:"No vehicle specified";const v=h.vehicle||h.requestedCar;return v?`${v.brand} ${v.model}`:"No vehicle specified"},g=h=>{const v=h.type==="lead"?h.requestedCar:h.vehicle;if(!v)return{status:"N/A",class:"bg-surfaceSecondary text-body"};const x=v.stockDays!==void 0&&v.stockDays!==null;return{status:x?"In Stock":"Out of Stock",class:x?"bg-green-100 text-green-700":"bg-surfaceSecondary text-body"}},$=h=>{var v;return h.type==="lead"?((v=h.requestedCar)==null?void 0:v.requestType)||h.requestType||"N/A":h.requestType||"Opportunity"},I=S(()=>[{accessorKey:"type",header:"Task type",meta:{title:"Task type",onOpen:h=>N(h.original)},cell:({row:h})=>{const v=h.original,x=v.type==="lead"?"bg-blue-50 text-blue-700":"bg-purple-50 text-purple-700";return oe("span",{class:`inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold ${x}`},v.type==="lead"?"Lead":"Opportunity")}},{accessorKey:"customer",header:"Customer",meta:{title:"Customer"},cell:({row:h})=>{const v=h.original;return oe("div",{class:"flex items-center gap-2 md:gap-3"},[oe("div",{class:`w-9 h-9 rounded-full flex items-center justify-center text-xs font-bold shrink-0 ${v.type==="lead"?"bg-orange-100 text-orange-600":"bg-purple-100 text-purple-600"}`},v.customer.initials),oe("div",{class:"min-w-0"},[oe("div",{class:"text-content font-semibold text-heading truncate max-w-[7.5rem] md:max-w-none"},v.customer.name),oe("div",{class:"text-meta truncate hidden sm:block"},v.customer.email)])])}},{accessorKey:"car",header:"Car",meta:{title:"Car"},cell:({row:h})=>{const v=h.original,x=f(v);return x==="No vehicle specified"?oe("span",{class:"text-meta"},"N/A"):oe("div",{class:"flex items-center gap-2"},[oe("i",{class:"fa-brands fa-volkswagen text-sub text-sm"}),oe("span",{class:"text-content font-medium text-heading truncate max-w-[7.5rem]"},x)])}},{accessorKey:"carStatus",header:"Car status",meta:{title:"Car status"},cell:({row:h})=>{const v=h.original,x=g(v);return oe("span",{class:`inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold ${x.class}`},x.status)}},{accessorKey:"requestType",header:"Request type",meta:{title:"Request type"},cell:({row:h})=>{const v=h.original,x=$(v);return oe("span",{class:"text-meta"},x)}},{accessorKey:"source",header:"Source",meta:{title:"Source"},cell:({row:h})=>{const v=h.original;return oe("span",{class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-surfaceSecondary text-body"},v.source||"N/A")}},{accessorKey:"assignee",header:"Assignee",meta:{title:"Assignee"},cell:({row:h})=>{const v=h.original,x=s.getOwnerInfo(v);return oe("div",{class:"flex items-center gap-2"},[oe("div",{class:"w-6 h-6 rounded-full bg-surfaceSecondary flex items-center justify-center text-xs font-bold text-body shrink-0"},x.initials),oe("span",{class:"text-meta truncate max-w-20"},x.name)])}},{accessorKey:"status",header:"Status",meta:{title:"Status"},cell:({row:h})=>{const v=h.original,x=v.type==="lead"?v.status:v.displayStage||v.stage,L=s.getStageBadgeClass(x);return oe("span",{class:`inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold ${L}`},x)}},...s.typeFilter==="lead"&&l.getSetting("urgencyEnabled")!==!1?[{id:"urgencyLevel",accessorKey:"urgencyLevel",header:"Urgency",meta:{title:"Urgency"},cell:({row:h})=>{const v=h.original;if(v.type!=="lead")return oe("span",{class:"text-meta"},"â€”");let x=v.urgencyLevel;x||(x=wt(v).level);const L=Ct(x),z=kt(x);return oe("span",{class:`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-semibold border ${L}`},[oe("span",{},z),oe("span",{},x)])}}]:[],{id:"actions",header:"",meta:{title:"Actions"},cell:({row:h})=>{const v=h.original;return oe("button",{class:"text-sub hover:text-body",onClick:x=>{x.stopPropagation(),d("menu-click",v.id)}},[oe("i",{class:"fa-solid fa-ellipsis-vertical"})])}}]),N=h=>{c.value=String(h.id),d("select",h.compositeId)},w=S(()=>({class:{tr:h=>{const v="cursor-pointer hover:bg-surfaceSecondary transition-colors",x=h.original;return u(x)?`${v} bg-blue-50 border-l-4 border-l-blue-500`:v}}}));return(h,v)=>(p(),b("div",Zs,[e("header",_s,[e("div",en,[e("div",tn,[v[8]||(v[8]=e("div",{class:"page-header-title-container"},[e("h1",{class:"page-header-title"},"Tasks")],-1)),e("div",sn,[e("div",nn,[e("button",{onClick:v[0]||(v[0]=x=>h.$emit("view-change","table")),class:K(["h-7 px-2.5 rounded-md transition-all flex items-center justify-center",t.viewMode==="table"?"bg-brand-gray text-heading shadow-sm":"text-sub hover:text-heading"]),title:"Table View"},[C(n(xt),{size:14})],2),e("button",{onClick:v[1]||(v[1]=x=>h.$emit("view-change","card")),class:K(["h-7 px-2.5 rounded-md transition-all flex items-center justify-center",t.viewMode==="card"?"bg-brand-gray text-heading shadow-sm":"text-sub hover:text-heading"]),title:"Card View"},[C(n(ht),{size:14})],2)]),e("button",{onClick:v[2]||(v[2]=x=>h.$emit("toggle-closed",!t.showClosed)),class:"group flex items-center gap-2 rounded-2xl border border-E5E7EB px-3 py-1.5 bg-surface text-fluid-sm font-medium text-body hover:border-red-100 hover:bg-red-50 hover:text-brand-red transition-all"},[...v[7]||(v[7]=[e("i",{class:"fa-solid fa-eye-slash text-sub group-hover:text-brand-red"},null,-1),e("span",{class:"hidden sm:inline"},"Show Closed",-1)])])])])])]),e("div",ln,[e("div",on,[C(n(Wt),{data:a.value,columns:I.value,meta:w.value,onRowClick:N,columnFiltersOptions:{filterDefs:n(i)},pagination:o.value,"onUpdate:pagination":v[3]||(v[3]=x=>o.value=x),globalFilter:c.value,"onUpdate:globalFilter":v[4]||(v[4]=x=>c.value=x),sorting:r.value,"onUpdate:sorting":v[5]||(v[5]=x=>r.value=x),columnFilters:m.value,"onUpdate:columnFilters":v[6]||(v[6]=x=>m.value=x),paginationOptions:{rowCount:a.value.length},globalFilterOptions:{debounce:300,placeholder:"Q Search or ask a question"}},{toolbar:D(()=>[...v[9]||(v[9]=[e("div",{class:"flex justify-end"},[e("button",{class:"group flex items-center gap-2 rounded-2xl border border-E5E7EB px-4 py-2 text-sm font-medium text-body hover:border-purple-100 hover:bg-purple-50 hover:text-purple-600 transition-all"},[e("i",{class:"fa-solid fa-arrow-left text-sub group-hover:text-purple-500"}),e("span",{class:"hidden sm:inline"},"Switch back to old design")])],-1)])]),"empty-state":D(()=>[...v[10]||(v[10]=[e("div",{class:"empty-state"},[e("i",{class:"fa-solid fa-tasks empty-state-icon"}),e("p",{class:"empty-state-text"},"No tasks found")],-1)])]),_:1},8,["data","columns","meta","columnFiltersOptions","pagination","globalFilter","sorting","columnFilters","paginationOptions"])])])]))}},rn={key:0,class:"flex-1 flex flex-col overflow-hidden lg:border-l border bg-surface"},dn={key:1,class:"hidden lg:flex flex-1 flex-col overflow-hidden lg:border-l border-black/5 bg-surface"},it={__name:"TaskDetailView",props:{task:{type:Object,default:null},managementWidget:{type:Object,required:!0},storeAdapter:{type:Object,required:!0},addNewConfig:{type:Object,required:!0}},setup(t){return(y,s)=>t.task?(p(),b("div",rn,[C(zt,{task:t.task,type:t.task.type,"management-widget":t.managementWidget,"store-adapter":t.storeAdapter,"add-new-config":t.addNewConfig},null,8,["task","type","management-widget","store-adapter","add-new-config"])])):(p(),b("div",dn,[...s[0]||(s[0]=[Qe('<div class="flex-1 flex items-center justify-center p-8"><div class="text-center max-w-sm"><div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-surfaceSecondary flex items-center justify-center"><i class="fa-solid fa-tasks text-2xl text-sub"></i></div><h3 class="text-fluid-lg font-semibold text-heading mb-2">No task selected</h3><p class="text-fluid-sm text-sub">Select a task from the list to view its details and manage activities</p></div></div>',1)])]))}},un={key:0,class:"lg:hidden border-b border shrink-0 bg-brand-gray"},cn={class:"px-4 py-3 flex items-center justify-between gap-3"},pn=["aria-label"],mn={key:0,class:"flex-1 flex items-center justify-center"},fn={key:1,class:"flex items-center gap-2"},yn={__name:"MobileDetailHeader",props:{show:{type:Boolean,required:!0},backLabel:{type:String,default:"Back"}},emits:["back"],setup(t,{emit:y}){const s=y,d=()=>{s("back")};return(l,o)=>t.show?(p(),b("div",un,[e("div",cn,[e("button",{onClick:d,class:"w-11 h-11 flex items-center justify-center text-body hover:text-heading hover:bg-surfaceSecondary rounded-lg transition-colors shrink-0","aria-label":t.backLabel},[...o[0]||(o[0]=[e("i",{class:"fa-solid fa-arrow-left text-lg"},null,-1)])],8,pn),l.$slots.title?(p(),b("div",mn,[ue(l.$slots,"title")])):T("",!0),l.$slots.actions?(p(),b("div",fn,[ue(l.$slots,"actions")])):T("",!0)])])):T("",!0)}};function $t(t,y={}){const s=Se(),d=S(()=>{const N=typeof t=="function"?t():He(t);return{lead:N,displayStage:N?pt(N,"lead"):null}}),l=S(()=>d.value.displayStage||"New"),o=S(()=>{const N=d.value;return Ht(N)}),c=S(()=>{const N=d.value,w=Pt(N);if(!w)return null;const h=y[w.key];return{...w,handler:h||(()=>console.warn(`No handler for action: ${w.key}`))}}),r=S(()=>{const N=d.value;return Qt(N).map(h=>{const v=y[h.key];return{...h,handler:v||(()=>console.warn(`No handler for action: ${h.key}`))}})}),m=S(()=>{const N=d.value;return Yt(N)}),i=S(()=>{const N=d.value;return Kt(N)}),a=S(()=>{const N=d.value;return Gt(N)}),u=S(()=>{const N=d.value;return Jt(N)}),f=S(()=>{const w=d.value.lead;return((w==null?void 0:w.contactAttempts)||[]).length||0}),g=S(()=>s.getSetting("maxContactAttempts")),$=S(()=>f.value+1>=g.value),I=S(()=>!0);return{displayStage:l,isClosed:o,primaryAction:c,secondaryActions:r,showLQWidget:m,showDeadlineBanner:i,canPostpone:a,canReassign:I,lqWidgetMode:u,contactAttempts:f,maxContactAttempts:g,shouldShowAutoDisqualifyWarning:$}}function vn({getLead:t,leadState:y,emit:s}){const d=nt(),l=je(),o=Ae();async function c(w){var v;const h=t();if(h){if(!y.canPostpone.value){console.warn("Cannot postpone in current state");return}try{const x=new Date(`${w.date}T${w.time}:00`),L=x.toISOString(),z={nextActionDue:L};if((w.assigneeId||w.teamId)&&(z.assignee=w.assignee||null,z.assigneeId=w.assigneeId||null,z.assigneeType=w.assigneeType||"user",z.teamId=w.teamId||null,z.team=w.team||null),await l.updateLead(h.id,z),w.createAppointment){const P=new Date(x);P.setHours(P.getHours()+1),await l.updateLead(h.id,{scheduledAppointment:{id:Date.now(),title:`Follow-up Call - ${h.customer.name}`,start:L,end:P.toISOString(),type:"Call",assignee:w.assignee||h.assignee,assigneeId:w.assigneeId||h.assigneeId,assigneeType:w.assigneeType||h.assigneeType||"user",teamId:w.teamId||h.teamId,team:w.team||h.team,status:"scheduled"}}),await l.addActivity(h.id,{type:"appointment",user:((v=o.currentUser)==null?void 0:v.name)||"You",action:"scheduled follow-up call",content:`Follow-up call scheduled for ${Ue(x)} at ${Re(x)}`,data:{type:"Call",date:w.date,time:w.time,assignee:w.assignee||h.assignee}})}await l.addActivity(h.id,{type:"note",user:"You",action:"postponed lead qualification task",content:`Task postponed to ${Ue(x)} at ${Re(x)}${w.assignee?` and reassigned to ${w.assignee}`:""}`}),await l.fetchLeadById(h.id)}catch(x){console.error("Failed to postpone lead task:",x)}}}async function r(w){const h=t();if(h)try{if(await l.updateLead(h.id,{stage:"Validated"}),await l.addActivity(h.id,{type:"note",user:"You",action:"validated lead",content:"Lead has been validated and is ready for follow-up"}),w.scheduleFollowUp&&w.appointmentData){const v=new Date(`${w.appointmentData.date}T${w.appointmentData.time}:00`);await l.scheduleFollowUp(h.id,{dateTime:v.toISOString(),assignee:w.appointmentData.assignee||h.assignee,assigneeId:w.appointmentData.assigneeId||null,assigneeType:w.appointmentData.assigneeType||"user",teamId:w.appointmentData.teamId||null,team:w.appointmentData.team||null}),await l.addActivity(h.id,{type:"appointment",user:"You",action:"scheduled follow-up call",content:`Follow-up call scheduled for ${Ue(v)} at ${Re(v)}`})}await l.fetchLeadById(h.id)}catch(v){console.error("Failed to validate lead:",v)}}async function m(){const w=t();if(w)try{const h=await l.convertLeadToOpportunity(w.id);o.canAccessOpportunities()?d.push({path:`/tasks/${h}`,query:{type:"opportunity"}}):d.push("/tasks")}catch(h){console.error("Failed to qualify lead:",h)}}async function i(w){const h=t();if(h)try{const v=h.contactAttempts||[];await l.updateLead(h.id,{contactAttempts:[...v,w],lastContactAttempt:w.timestamp,totalContactAttempts:v.length+1}),await l.addActivity(h.id,{type:"call",user:"You",action:`logged call attempt - ${w.outcome}`,content:w.notes||`Call attempt via ${w.channel}`,data:{outcome:w.outcome,channel:w.channel,duration:w.duration}}),await l.fetchLeadById(h.id)}catch(v){console.error("Failed to log call attempt:",v)}}async function a(w){const h=t();if(h)try{await l.addActivity(h.id,{type:"note",user:"You",action:"added a note",content:w.content||w.text||"",data:w}),await l.fetchLeadById(h.id)}catch(v){console.error("Failed to save note:",v)}}function u(){s("open-purchase-method")}function f(){s("open-trade-in")}async function g(w){var v;const h=t();if(h)try{const x=`${w.date}T${w.time}:00`,L=new Date(x);L.setHours(L.getHours()+1),await l.updateLead(h.id,{scheduledAppointment:{id:Date.now(),title:`${w.type} - ${h.customer.name}`,start:x,end:L.toISOString(),type:w.type,assignee:w.assignee,assigneeId:w.assigneeId,status:"scheduled",location:w.location||"",notes:w.notes||""}}),await l.addActivity(h.id,{type:"appointment",user:((v=o.currentUser)==null?void 0:v.name)||"You",action:"scheduled an appointment",content:`${w.type} scheduled for ${w.date} at ${w.time}`,data:{type:w.type,date:w.date,time:w.time,assignee:w.assignee}}),await l.fetchLeadById(h.id)}catch(x){console.error("Failed to schedule appointment:",x)}}async function $(w){const h=t();if(h){if(y.isClosed.value&&!w.force){console.warn("Lead already closed");return}try{const v=y.displayStage.value,x=w.reason==="Duplicate"?Be.CLOSED_DUPLICATE:w.category==="Not Interested"?Be.CLOSED_NOT_INTERESTED:Be.CLOSED_INVALID,L=Ze(v,x);if(L){const{updates:z,activities:P}=L(h,x,w);await l.updateLead(h.id,z);for(const ee of P)await l.addActivity(h.id,ee)}else{const z=w.reason==="Duplicate";await l.updateLead(h.id,{isDisqualified:!0,disqualifyReason:w.reason,isDuplicate:z,stage:z?"Closed Failed":"Not Valid",status:"Disqualified",scheduledAppointment:null,nextActionDue:null}),await l.addActivity(h.id,{type:"note",user:"You",action:"disqualified lead",content:`Lead disqualified - Category: ${w.category}, Reason: ${w.reason}`})}d.push("/tasks")}catch(v){console.error("Failed to disqualify lead:",v)}}}async function I(){const w=t();if(w)try{const h=y.displayStage.value,v=Be.NEW,x=Ze(h,v);if(x){const{updates:L,activities:z}=x(w);await l.updateLead(w.id,L);for(const P of z)await l.addActivity(w.id,P)}else await l.updateLead(w.id,{isDisqualified:!1,disqualifyReason:null,disqualifyCategory:null,isDuplicate:!1,stage:"Open Lead",status:"Open",nextActionDue:null,scheduledAppointment:null}),await l.addActivity(w.id,{type:"note",user:"You",action:"reopened lead",content:"Lead has been reopened for qualification"});await l.fetchLeadById(w.id)}catch(h){console.error("Failed to reopen lead:",h)}}function N(){const w=t();w&&w.opportunityId&&d.push({path:`/tasks/${w.opportunityId}`,query:{type:"opportunity"}})}return{handlePostponed:c,handleValidated:r,handleQualified:m,handleCallAttemptLogged:i,handleNoteSaved:a,handleOpenPurchaseMethod:u,handleOpenTradeIn:f,handleAppointmentScheduled:g,handleDisqualified:$,handleReopen:I,viewOpportunity:N}}const gn={class:"bg-white rounded-lg p-4 shadow-sm flex flex-col",style:{"box-shadow":"var(--nsc-card-shadow)"}},bn={class:"space-y-6"},St={__name:"TaskManagementWidget",props:{task:{type:Object,required:!0},containerClass:{type:String,default:""}},setup(t){return(y,s)=>t.task?(p(),b("div",{key:0,class:K(["rounded-[12px] flex flex-col",t.containerClass]),style:{"background-color":"var(--base-muted, #f5f5f5)"}},[s[0]||(s[0]=e("div",{class:"px-4 py-4 flex items-center justify-between shrink-0"},[e("div",{class:"flex items-center gap-2"},[e("i",{class:"fa-solid fa-clipboard-check text-heading"}),e("h2",{class:"text-fluid-sm font-medium text-heading leading-5"},"Manage next steps")])],-1)),e("div",gn,[ue(y.$slots,"deadline-banner"),e("div",bn,[ue(y.$slots,"primary-action"),ue(y.$slots,"task-widgets"),ue(y.$slots,"closed-state"),ue(y.$slots,"secondary-actions")])])],2)):T("",!0)}},hn={class:"flex justify-between items-start mb-3"},xn={class:"font-bold text-gray-900 text-fluid-sm"},wn={class:"text-fluid-xs text-gray-500 mt-0.5"},kn={class:"flex gap-3 flex-wrap"},At={__name:"PrimaryActionWidget",props:{action:{type:Object,required:!0},colorScheme:{type:Object,required:!0}},emits:["action-clicked"],setup(t){return(y,s)=>(p(),b("div",{class:K(["rounded-lg p-4 relative transition-all duration-300 border",[t.colorScheme.background,t.colorScheme.border]])},[e("div",hn,[e("div",null,[e("h4",xn,O(t.action.title),1),e("p",wn,O(t.action.description),1)])]),e("div",kn,[e("button",{onClick:s[0]||(s[0]=d=>y.$emit("action-clicked")),class:K([t.action.buttonClass,"font-medium px-4 py-2 rounded-lg text-fluid-xs flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"])},[e("i",{class:K(t.action.icon)},null,2),W(" "+O(t.action.label),1)],2)])],2))}},Cn={class:"flex items-center gap-3"},$n={class:"flex-1"},Sn={key:0,class:"text-fluid-xs font-normal opacity-75"},An={__name:"DeadlineBanner",props:{nextActionDue:{type:String,default:null},isClosed:{type:Boolean,default:!1},showDeadlineBanner:{type:Boolean,default:!0},taskId:{type:[String,Number],required:!0}},emits:["dismissed"],setup(t,{emit:y}){const s=t,d=y,l=A(!1),o=S(()=>mt(s.nextActionDue)),c=S(()=>s.isClosed||!s.showDeadlineBanner||l.value?!1:o.value.type==="overdue"||o.value.type==="urgent"),r=()=>{l.value=!0,d("dismissed")};return(m,i)=>c.value?(p(),b("div",{key:0,class:K(["mx-4 mt-4 px-4 py-3 rounded-lg border flex items-center justify-between",[o.value.bgClass,o.value.borderClass]])},[e("div",Cn,[e("div",{class:K(["w-9 h-9 rounded-lg flex items-center justify-center",[o.value.bgClass,o.value.borderClass,"border"]])},[e("i",{class:K(["text-sm",[`fa-solid ${o.value.icon}`,o.value.textClass]])},null,2)],2),e("div",$n,[i[0]||(i[0]=e("div",{class:"text-fluid-xs font-medium text-gray-600 mb-0.5"},"Next Action Due",-1)),e("div",{class:K(["text-fluid-sm font-bold",o.value.textClass])},[W(O(n(ft)(t.nextActionDue))+" ",1),o.value.type!=="overdue"?(p(),b("span",Sn," ("+O(n(yt)(t.nextActionDue))+") ",1)):T("",!0)],2)]),o.value.type==="overdue"?(p(),b("div",{key:0,class:K(["text-fluid-xs font-bold uppercase px-2.5 py-1 rounded-md",[o.value.bgClass,o.value.textClass,o.value.borderClass,"border"]])},[...i[1]||(i[1]=[e("i",{class:"fa-solid fa-exclamation-circle mr-1"},null,-1),W(" Overdue ",-1)])],2)):o.value.type==="urgent"?(p(),b("div",{key:1,class:K(["text-fluid-xs font-bold uppercase px-2.5 py-1 rounded-md",[o.value.bgClass,o.value.textClass,o.value.borderClass,"border"]])},[...i[2]||(i[2]=[e("i",{class:"fa-solid fa-bolt mr-1"},null,-1),W(" Urgent ",-1)])],2)):T("",!0)]),e("button",{onClick:r,class:"w-6 h-6 flex items-center justify-center text-gray-500 hover:text-gray-700 hover:bg-gray-200 rounded transition-colors ml-2 shrink-0",title:"Dismiss"},[...i[3]||(i[3]=[e("i",{class:"fa-solid fa-xmark text-xs"},null,-1)])])],2)):T("",!0)}},Ke=(t,y)=>{if(!t||!y)return[];const s=new Date(y).getDay();if(s===0||s===6)return[];const[l,o]=t.split("-"),c=parseInt(o);return l==="team"?Tn(c,y):l==="user"?Dn(c,y,s):[]},Dn=(t,y,s)=>{const d={1:{1:["09:00","09:30","10:00","10:30","11:00"],2:["09:00","10:00","11:00","14:00","15:00"],3:["09:00","09:30","10:30","11:00"],4:["09:00","10:00","11:00","14:00","16:00"],5:["09:00","10:00","11:00"]},2:{1:["14:00","14:30","15:00","15:30","16:00"],2:["13:00","14:00","15:00","16:00","17:00"],3:["14:00","15:00","16:00","17:00"],4:["13:00","14:30","15:00","16:00"],5:["14:00","15:00","16:00"]},3:{1:["09:00","10:30","14:00","15:30"],2:["09:30","11:00","14:00","16:00"],3:["10:00","11:30","14:30","16:00"],4:["09:00","11:00","14:00","15:00"],5:["10:00","11:00","14:00","15:00"]},4:{1:["09:00","10:00","11:00","13:00","14:00","15:00","16:00"],2:["09:00","10:30","11:30","14:00","15:00","16:30"],3:["09:30","10:00","11:00","14:00","15:30","16:00"],4:["09:00","10:00","11:30","13:30","15:00","16:00"],5:["09:00","10:00","11:00","14:00","15:00"]}};return(d[t]||d[1])[s]||[]},Tn=(t,y)=>{const s=new Date(y).getDay(),d=["09:00","09:30","10:00","10:30","11:00","11:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00"];return t===1?s===1||s===4?["09:00","11:00","14:00","16:00"]:["10:00","14:00","15:00"]:t===2?d.filter((l,o)=>o%2===0):d},Dt=(t,y)=>{const s=Ke(t,y);return s.length===0?"none":s.length<=3?"limited":"good"},Tt=(t,y,s)=>{const d=[];return s.forEach(l=>{const o=`${l.type}-${l.id}`;if(o===t)return;const c=Ke(o,y);c.length>0&&d.push({...l,assigneeId:o,availableSlots:c,slotCount:c.length})}),d.sort((l,o)=>o.slotCount-l.slotCount)},In={class:"space-y-4"},On=["min"],qn={key:0,class:"bg-surfaceSecondary border border-E5E7EB rounded-lg p-3"},Nn={class:"flex items-center justify-between mb-2"},Ln={key:0,class:"flex items-center gap-3"},En={key:0,class:"fa-solid fa-users text-fluid-sm"},Bn={key:1},Mn={class:"flex-1"},Un={class:"font-medium text-fluid-sm text-heading"},Fn={class:"text-fluid-xs text-sub capitalize"},Vn={key:1,class:"animate-fade-in"},Rn={label:"Teams"},jn=["value"],Wn={label:"Users"},zn=["value"],Hn={key:1},Pn={key:0,class:"bg-amber-50 border border-amber-200 rounded-lg p-3 animate-fade-in"},Qn={class:"flex items-start gap-2"},Yn={class:"flex-1"},Kn={class:"text-fluid-xs text-amber-700 mt-1"},Gn={key:0,class:"mt-3 pt-3 border-t border-amber-200"},Jn={class:"space-y-1"},Xn=["onClick"],Zn={class:"text-fluid-sm font-medium text-heading"},_n={class:"text-fluid-xs text-sub"},el={key:1,class:"bg-blue-50 border border-blue-200 rounded-lg p-3 animate-fade-in"},tl={key:2,class:"bg-green-50 border border-green-200 rounded-lg p-3 animate-fade-in"},sl={key:2,class:"animate-fade-in"},nl={class:"grid grid-cols-4 gap-2"},ll=["onClick"],ol={__name:"ScheduleAppointmentModal",props:{show:{type:Boolean,required:!0},preselectedAssignee:{type:Object,default:null}},emits:["close","confirm"],setup(t,{emit:y}){const s=t,d=y,l=Ae(),o=We(),c=A(""),r=A(null),m=A(""),i=A(""),a=A(!1),u=A(!1),f=S(()=>o.assignableUsers),g=S(()=>o.assignableTeams),$=S(()=>new Date().toISOString().split("T")[0]),I=S(()=>r.value&&r.value.startsWith("team-")),N=S(()=>{if(!r.value)return{};const[M,E]=r.value.split("-"),V=parseInt(E);if(M==="team"){const j=o.getTeamById(V);return{name:(j==null?void 0:j.name)||"Unknown Team",subtitle:"Team",avatarClass:"bg-green-100 text-green-700",initials:""}}else{const j=o.getUserById(V);return{name:(j==null?void 0:j.name)||"Unknown",subtitle:(j==null?void 0:j.role)||"User",avatarClass:z(j==null?void 0:j.role),initials:L(j==null?void 0:j.name)}}}),w=S(()=>!m.value||!r.value?[]:Ke(r.value,m.value)),h=S(()=>!m.value||!r.value?null:Dt(r.value,m.value)),v=S(()=>{if(!m.value||!r.value)return[];if(h.value!=="none")return[];const M=[...g.value.map(E=>({...E,type:"team"})),...f.value.map(E=>({...E,type:"user"}))];return Tt(r.value,m.value,M)}),x=S(()=>!!(c.value&&m.value&&i.value&&r.value)),L=M=>M?M.split(" ").map(E=>E[0]).join("").toUpperCase().substring(0,2):"?",z=M=>({manager:"bg-blue-100 text-blue-700",salesman:"bg-purple-100 text-purple-700",operator:"bg-orange-100 text-orange-700"})[M]||"bg-surfaceSecondary text-body",P=M=>{r.value=M.assigneeId,u.value=!1,a.value=!1};ye(()=>s.show,M=>{M?ee():ne()}),ye(m,()=>{i.value="",u.value=!1}),ye(r,()=>{i.value="",u.value=!1});const ee=()=>{var M;if(s.preselectedAssignee){const{type:E,id:V}=s.preselectedAssignee;r.value=`${E}-${V}`}else r.value=`user-${((M=l.currentUser)==null?void 0:M.id)||1}`},ne=()=>{var M;c.value="",r.value=`user-${((M=l.currentUser)==null?void 0:M.id)||1}`,m.value="",showTimeslots.value=!1,i.value=""},J=M=>{M||d("close")},F=()=>{if(!x.value)return;const M=r.value.startsWith("team-"),E=parseInt(r.value.split("-")[1]);let V={};if(M){const j=o.getTeamById(E);V={assigneeType:"team",teamId:E,team:(j==null?void 0:j.name)||"Unknown Team",assignee:null,assigneeId:null}}else{const j=o.getUserById(E);V={assigneeType:"user",assigneeId:E,assignee:(j==null?void 0:j.name)||"Unknown",teamId:null,team:null}}d("confirm",{type:c.value,date:m.value,time:i.value,...V}),d("close")},U=()=>{d("close")};return(M,E)=>(p(),H(n(Le),{open:t.show,"onUpdate:open":J},{default:D(()=>[C(n(De),null,{default:D(()=>[C(n(Te),{class:"fixed inset-0 z-50 bg-black/50"}),C(n(Ie),{class:"w-full sm:max-w-lg"},{default:D(()=>[C(n(Oe),null,{default:D(()=>[C(n(qe),{class:"text-fluid-lg"},{default:D(()=>[...E[5]||(E[5]=[W("Schedule Appointment",-1)])]),_:1}),C(n(ze),{class:"text-fluid-xs"},{default:D(()=>[...E[6]||(E[6]=[W("Book an appointment with the customer",-1)])]),_:1})]),_:1}),e("div",In,[e("div",null,[E[8]||(E[8]=e("label",{class:"block text-fluid-xs font-medium text-sub mb-1.5"},"Appointment Type",-1)),Z(e("select",{"onUpdate:modelValue":E[0]||(E[0]=V=>c.value=V),class:"input text-fluid-sm"},[...E[7]||(E[7]=[e("option",{value:"",disabled:""},"Select type...",-1),e("option",null,"Showroom Visit",-1),e("option",null,"Test Drive",-1),e("option",null,"Video Call",-1),e("option",null,"Home Visit",-1),e("option",null,"Closing Meeting",-1)])],512),[[we,c.value]])]),e("div",null,[E[9]||(E[9]=e("label",{class:"block text-fluid-xs font-medium text-sub mb-1.5"},"Select Date",-1)),Z(e("input",{type:"date","onUpdate:modelValue":E[1]||(E[1]=V=>m.value=V),min:$.value,class:"input text-fluid-sm"},null,8,On),[[ce,m.value]])]),r.value?(p(),b("div",qn,[e("div",Nn,[E[10]||(E[10]=e("label",{class:"text-fluid-xs font-medium text-sub"},"Assigned to",-1)),e("button",{onClick:E[2]||(E[2]=V=>a.value=!a.value),class:"text-fluid-xs text-brand-red hover:underline font-medium"},O(a.value?"Cancel":"Change"),1)]),a.value?(p(),b("div",Vn,[Z(e("select",{"onUpdate:modelValue":E[3]||(E[3]=V=>r.value=V),class:"input text-fluid-sm"},[e("optgroup",Rn,[(p(!0),b(pe,null,fe(g.value,V=>(p(),b("option",{key:`team-${V.id}`,value:`team-${V.id}`},O(V.name)+" Team ",9,jn))),128))]),e("optgroup",Wn,[(p(!0),b(pe,null,fe(f.value,V=>{var j;return p(),b("option",{key:`user-${V.id}`,value:`user-${V.id}`},O(V.name)+O(V.id===((j=n(l).currentUser)==null?void 0:j.id)?" (Me)":""),9,zn)}),128))])],512),[[we,r.value]])])):(p(),b("div",Ln,[e("div",{class:K(["w-9 h-9 rounded-full flex items-center justify-center font-semibold text-fluid-sm",N.value.avatarClass])},[I.value?(p(),b("i",En)):(p(),b("span",Bn,O(N.value.initials),1))],2),e("div",Mn,[e("p",Un,O(N.value.name),1),e("p",Fn,O(N.value.subtitle),1)])]))])):T("",!0),m.value&&r.value?(p(),b("div",Hn,[h.value==="none"?(p(),b("div",Pn,[e("div",Qn,[E[13]||(E[13]=e("i",{class:"fa-solid fa-calendar-xmark text-amber-600 mt-0.5"},null,-1)),e("div",Yn,[E[12]||(E[12]=e("p",{class:"text-fluid-sm font-medium text-amber-900"},"No availability on this date",-1)),e("p",Kn,[E[11]||(E[11]=W(" Try selecting a different date or ",-1)),e("button",{onClick:E[4]||(E[4]=V=>u.value=!u.value),class:"underline font-medium"}," view other "+O(I.value?"teams":"salespeople"),1)])])]),u.value&&v.value.length>0?(p(),b("div",Gn,[E[14]||(E[14]=e("p",{class:"text-fluid-xs font-medium text-amber-900 mb-2"},"Available alternatives:",-1)),e("div",Jn,[(p(!0),b(pe,null,fe(v.value.slice(0,3),V=>(p(),b("button",{key:V.assigneeId,onClick:j=>P(V),class:"w-full text-left p-2 rounded bg-white hover:bg-amber-50 border border-amber-200 transition-colors"},[e("p",Zn,O(V.name),1),e("p",_n,O(V.slotCount)+" slots available",1)],8,Xn))),128))])])):T("",!0)])):h.value==="limited"?(p(),b("div",el,[...E[15]||(E[15]=[e("div",{class:"flex items-center gap-2"},[e("i",{class:"fa-solid fa-clock text-blue-600"}),e("p",{class:"text-fluid-sm text-blue-700"},[e("span",{class:"font-medium"},"Limited availability"),W(" - Book soon! ")])],-1)])])):h.value==="good"?(p(),b("div",tl,[...E[16]||(E[16]=[e("div",{class:"flex items-center gap-2"},[e("i",{class:"fa-solid fa-check-circle text-green-600"}),e("p",{class:"text-fluid-sm text-green-700"},[e("span",{class:"font-medium"},"Good availability"),W(" on this date ")])],-1)])])):T("",!0)])):T("",!0),w.value.length>0?(p(),b("div",sl,[E[17]||(E[17]=e("label",{class:"block text-fluid-xs font-medium text-sub mb-2"},"Available Time Slots",-1)),e("div",nl,[(p(!0),b(pe,null,fe(w.value,V=>(p(),b("button",{key:V,onClick:j=>i.value=V,class:K(["py-2 border rounded-lg text-fluid-xs font-medium transition-all",i.value===V?"border-brand-red bg-red-50 text-brand-red":"border-E5E7EB text-body hover:border-brand-red hover:bg-red-50/50"])},O(V),11,ll))),128))])])):T("",!0)]),C(n(Ne),{class:"flex flex-col sm:flex-row justify-end items-stretch sm:items-center gap-3"},{default:D(()=>[C(n(X),{label:"Cancel",variant:"outline",size:"small",class:"rounded-sm w-full sm:w-auto text-fluid-sm",onClick:U}),C(n(X),{label:"Confirm Appointment",variant:"primary",size:"small",class:"rounded-sm w-full sm:w-auto text-fluid-sm !bg-brand-black !hover:bg-brand-darkDarker !text-white !border-brand-black",disabled:!x.value,onClick:F},null,8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]))}},al={class:"bg-surface border border-E5E7EB rounded-lg p-6 space-y-4"},il={class:"flex items-center justify-between mb-2"},rl={class:"space-y-4"},dl=["min"],ul={key:0,class:"bg-surfaceSecondary border border-E5E7EB rounded-lg p-3"},cl={class:"flex items-center justify-between mb-2"},pl={key:0,class:"flex items-center gap-3"},ml={key:0,class:"fa-solid fa-users text-fluid-sm"},fl={key:1},yl={class:"flex-1"},vl={class:"font-medium text-fluid-sm text-heading"},gl={class:"text-fluid-xs text-sub capitalize"},bl={key:1,class:"animate-fade-in"},hl={label:"Teams"},xl=["value"],wl={label:"Users"},kl=["value"],Cl={key:1},$l={key:0,class:"bg-amber-50 border border-amber-200 rounded-lg p-3 animate-fade-in"},Sl={class:"flex items-start gap-2"},Al={class:"flex-1"},Dl={class:"text-fluid-xs text-amber-700 mt-1"},Tl={key:0,class:"mt-3 pt-3 border-t border-amber-200"},Il={class:"space-y-1"},Ol=["onClick"],ql={class:"text-fluid-sm font-medium text-heading"},Nl={class:"text-fluid-xs text-sub"},Ll={key:1,class:"bg-blue-50 border border-blue-200 rounded-lg p-3 animate-fade-in"},El={key:2,class:"bg-green-50 border border-green-200 rounded-lg p-3 animate-fade-in"},Bl={key:2,class:"animate-fade-in"},Ml={class:"grid grid-cols-4 gap-2"},Ul=["onClick"],Fl={class:"flex justify-end gap-2 pt-3 border-t border-E5E7EB"},Vl={__name:"ScheduleAppointmentInline",props:{preselectedAssignee:{type:Object,default:null},canCancel:{type:Boolean,default:!1}},emits:["confirm","cancel"],setup(t,{emit:y}){const s=t,d=y,l=Ae(),o=We(),c=A(""),r=A(null),m=A(""),i=A(""),a=A(!1),u=A(!1),f=S(()=>o.assignableUsers),g=S(()=>o.assignableTeams),$=S(()=>new Date().toISOString().split("T")[0]),I=S(()=>r.value||(s.preselectedAssignee?`${s.preselectedAssignee.type}-${s.preselectedAssignee.id}`:null)),N=S(()=>{if(!I.value)return{};const[J,F]=I.value.split("-"),U=parseInt(F);if(J==="team"){const M=o.getTeamById(U);return{name:(M==null?void 0:M.name)||"Unknown Team",subtitle:"Team",avatarClass:"bg-green-100 text-green-700",initials:"",isTeam:!0}}else{const M=o.getUserById(U);return{name:(M==null?void 0:M.name)||"Unknown",subtitle:(M==null?void 0:M.role)||"User",avatarClass:z(M==null?void 0:M.role),initials:L(M==null?void 0:M.name),isTeam:!1}}}),w=S(()=>!m.value||!I.value?[]:Ke(I.value,m.value)),h=S(()=>!m.value||!I.value?null:Dt(I.value,m.value)),v=S(()=>{if(!m.value||!I.value)return[];if(h.value!=="none")return[];const J=[...g.value.map(F=>({...F,type:"team"})),...f.value.map(F=>({...F,type:"user"}))];return Tt(I.value,m.value,J)}),x=S(()=>!!(c.value&&m.value&&i.value&&I.value)),L=J=>J?J.split(" ").map(F=>F[0]).join("").toUpperCase().substring(0,2):"?",z=J=>({manager:"bg-blue-100 text-blue-700",salesman:"bg-purple-100 text-purple-700",operator:"bg-orange-100 text-orange-700"})[J]||"bg-surfaceSecondary text-body",P=J=>{r.value=J.assigneeId,u.value=!1,a.value=!1};ye(m,()=>{i.value="",u.value=!1}),ye(()=>I.value,()=>{i.value="",u.value=!1}),ye(()=>s.preselectedAssignee,J=>{J&&!r.value&&(r.value=`${J.type}-${J.id}`)},{immediate:!0});const ee=()=>{if(!x.value)return;const[J,F]=I.value.split("-"),U=parseInt(F),M=J==="team";let E={};if(M){const V=o.getTeamById(U);E={assigneeType:"team",teamId:U,team:(V==null?void 0:V.name)||"Unknown Team",assignee:null,assigneeId:null}}else{const V=o.getUserById(U);E={assigneeType:"user",assigneeId:U,assignee:(V==null?void 0:V.name)||"Unknown",teamId:null,team:null}}d("confirm",{type:c.value,date:m.value,time:i.value,...E}),c.value="",m.value="",i.value="",a.value=!1,u.value=!1},ne=()=>{d("cancel")};return(J,F)=>(p(),b("div",al,[e("div",il,[F[6]||(F[6]=e("h5",{class:"font-semibold text-heading text-fluid-sm"},"Schedule Appointment",-1)),t.canCancel?(p(),b("button",{key:0,onClick:ne,class:"text-fluid-xs text-sub hover:text-body transition-colors"},[...F[5]||(F[5]=[e("i",{class:"fa-solid fa-times"},null,-1)])])):T("",!0)]),e("div",rl,[e("div",null,[F[8]||(F[8]=e("label",{class:"block text-fluid-xs font-medium text-sub mb-1.5"},"Appointment Type",-1)),Z(e("select",{"onUpdate:modelValue":F[0]||(F[0]=U=>c.value=U),class:"input text-fluid-sm"},[...F[7]||(F[7]=[e("option",{value:"",disabled:""},"Select type...",-1),e("option",null,"Showroom Visit",-1),e("option",null,"Test Drive",-1),e("option",null,"Video Call",-1),e("option",null,"Home Visit",-1),e("option",null,"Closing Meeting",-1)])],512),[[we,c.value]])]),e("div",null,[F[9]||(F[9]=e("label",{class:"block text-fluid-xs font-medium text-sub mb-1.5"},"Select Date",-1)),Z(e("input",{type:"date","onUpdate:modelValue":F[1]||(F[1]=U=>m.value=U),min:$.value,class:"input text-fluid-sm"},null,8,dl),[[ce,m.value]])]),I.value?(p(),b("div",ul,[e("div",cl,[F[10]||(F[10]=e("label",{class:"text-fluid-xs font-medium text-sub"},"Assigned to",-1)),e("button",{onClick:F[2]||(F[2]=U=>a.value=!a.value),class:"text-fluid-xs text-brand-red hover:underline font-medium"},O(a.value?"Cancel":"Change"),1)]),a.value?(p(),b("div",bl,[Z(e("select",{"onUpdate:modelValue":F[3]||(F[3]=U=>r.value=U),class:"input text-fluid-sm"},[e("optgroup",hl,[(p(!0),b(pe,null,fe(g.value,U=>(p(),b("option",{key:`team-${U.id}`,value:`team-${U.id}`},O(U.name)+" Team ",9,xl))),128))]),e("optgroup",wl,[(p(!0),b(pe,null,fe(f.value,U=>{var M;return p(),b("option",{key:`user-${U.id}`,value:`user-${U.id}`},O(U.name)+O(U.id===((M=n(l).currentUser)==null?void 0:M.id)?" (Me)":""),9,kl)}),128))])],512),[[we,r.value]])])):(p(),b("div",pl,[e("div",{class:K(["w-9 h-9 rounded-full flex items-center justify-center font-semibold text-fluid-sm",N.value.avatarClass])},[N.value.isTeam?(p(),b("i",ml)):(p(),b("span",fl,O(N.value.initials),1))],2),e("div",yl,[e("p",vl,O(N.value.name),1),e("p",gl,O(N.value.subtitle),1)])]))])):T("",!0),m.value&&r.value?(p(),b("div",Cl,[h.value==="none"?(p(),b("div",$l,[e("div",Sl,[F[13]||(F[13]=e("i",{class:"fa-solid fa-calendar-xmark text-amber-600 mt-0.5"},null,-1)),e("div",Al,[F[12]||(F[12]=e("p",{class:"text-fluid-sm font-medium text-amber-900"},"No availability on this date",-1)),e("p",Dl,[F[11]||(F[11]=W(" Try selecting a different date or ",-1)),e("button",{onClick:F[4]||(F[4]=U=>u.value=!u.value),class:"underline font-medium"}," view other "+O(N.value.isTeam?"teams":"salespeople"),1)])])]),u.value&&v.value.length>0?(p(),b("div",Tl,[F[14]||(F[14]=e("p",{class:"text-fluid-xs font-medium text-amber-900 mb-2"},"Available alternatives:",-1)),e("div",Il,[(p(!0),b(pe,null,fe(v.value.slice(0,3),U=>(p(),b("button",{key:U.assigneeId,onClick:M=>P(U),class:"w-full text-left p-2 rounded bg-white hover:bg-amber-50 border border-amber-200 transition-colors"},[e("p",ql,O(U.name),1),e("p",Nl,O(U.slotCount)+" slots available",1)],8,Ol))),128))])])):T("",!0)])):h.value==="limited"?(p(),b("div",Ll,[...F[15]||(F[15]=[e("div",{class:"flex items-center gap-2"},[e("i",{class:"fa-solid fa-clock text-blue-600"}),e("p",{class:"text-fluid-sm text-blue-700"},[e("span",{class:"font-medium"},"Limited availability"),W(" - Book soon! ")])],-1)])])):h.value==="good"?(p(),b("div",El,[...F[16]||(F[16]=[e("div",{class:"flex items-center gap-2"},[e("i",{class:"fa-solid fa-check-circle text-green-600"}),e("p",{class:"text-fluid-sm text-green-700"},[e("span",{class:"font-medium"},"Good availability"),W(" on this date ")])],-1)])])):T("",!0)])):T("",!0),w.value.length>0?(p(),b("div",Bl,[F[17]||(F[17]=e("label",{class:"block text-fluid-xs font-medium text-sub mb-2"},"Available Time Slots",-1)),e("div",Ml,[(p(!0),b(pe,null,fe(w.value,U=>(p(),b("button",{key:U,onClick:M=>i.value=U,class:K(["py-2 border rounded-lg text-fluid-xs font-medium transition-all",i.value===U?"border-brand-red bg-red-50 text-brand-red":"border-E5E7EB text-body hover:border-brand-red hover:bg-red-50/50"])},O(U),11,Ul))),128))])])):T("",!0),e("div",Fl,[t.canCancel?(p(),H(n(X),{key:0,label:"Cancel",variant:"outline",size:"small",class:"text-fluid-sm",onClick:ne})):T("",!0),C(n(X),{label:"Confirm Appointment",variant:"primary",size:"small",class:"text-fluid-sm !bg-brand-black !hover:bg-brand-darkDarker !text-white !border-brand-black",disabled:!x.value,onClick:ee},null,8,["disabled"])])])]))}},Rl={class:"space-y-3"},jl={class:"space-y-2"},Wl={key:0,class:"font-semibold text-heading text-fluid-sm mb-2"},zl={class:"grid grid-cols-4 gap-2"},Hl={key:0},Pl={__name:"CommunicationSelector",props:{title:{type:String,default:"Send follow-up message"},showEmail:{type:Boolean,default:!0},showSMS:{type:Boolean,default:!0},showWhatsApp:{type:Boolean,default:!0},showDontSend:{type:Boolean,default:!1},initialTemplate:{type:String,default:""},initialMessage:{type:String,default:""}},emits:["send","cancel","dont-send"],setup(t,{emit:y}){const s=y,d=A(null),l=S(()=>m=>`bg-surface border-2 rounded-lg h-10 flex items-center justify-center gap-2 text-fluid-xs font-medium transition-all ${d.value===m?"border-brand-red bg-red-50 text-brand-red":"border-E5E7EB text-body hover:border-red-300 hover:bg-red-50/50"}`),o=m=>{m==="dont-send"?s("dont-send"):d.value=m},c=m=>{s("send",m),d.value=null},r=()=>{d.value=null,s("cancel")};return(m,i)=>(p(),b("div",Rl,[e("div",jl,[t.title?(p(),b("h5",Wl,O(t.title),1)):T("",!0),e("div",zl,[t.showEmail?(p(),b("button",{key:0,onClick:i[0]||(i[0]=a=>o("email")),class:K(l.value("email"))},[...i[4]||(i[4]=[e("i",{class:"fa-solid fa-envelope text-xs"},null,-1),e("span",null,"Email",-1)])],2)):T("",!0),t.showSMS?(p(),b("button",{key:1,onClick:i[1]||(i[1]=a=>o("sms")),class:K(l.value("sms"))},[...i[5]||(i[5]=[e("i",{class:"fa-solid fa-message text-xs"},null,-1),e("span",null,"SMS",-1)])],2)):T("",!0),t.showWhatsApp?(p(),b("button",{key:2,onClick:i[2]||(i[2]=a=>o("whatsapp")),class:K(l.value("whatsapp"))},[...i[6]||(i[6]=[e("i",{class:"fa-brands fa-whatsapp text-xs"},null,-1),e("span",null,"WhatsApp",-1)])],2)):T("",!0),t.showDontSend?(p(),b("button",{key:3,onClick:i[3]||(i[3]=a=>o("dont-send")),class:K(l.value("dont-send"))},[...i[7]||(i[7]=[e("i",{class:"fa-solid fa-xmark text-xs"},null,-1),e("span",null,"Don't send",-1)])],2)):T("",!0)])]),d.value&&d.value!=="dont-send"?(p(),b("div",Hl,[d.value==="email"?(p(),H(Xt,{key:0,"initial-template":t.initialTemplate,"initial-message":t.initialMessage,onSend:c,onCancel:r},null,8,["initial-template","initial-message"])):d.value==="sms"?(p(),H(Zt,{key:1,"initial-template":t.initialTemplate,"initial-message":t.initialMessage,onSend:c,onCancel:r},null,8,["initial-template","initial-message"])):d.value==="whatsapp"?(p(),H(_t,{key:2,"initial-template":t.initialTemplate,"initial-message":t.initialMessage,onSend:c,onCancel:r},null,8,["initial-template","initial-message"])):T("",!0)])):T("",!0)]))}};function Ql(){const t=Ut(),y=A(!1),s=A(!1),d=A(0),l=A(""),o=A(null),c=A({}),r=A(null),m={leadLines:["Yes, this is Josh Adams speaking.","Oh, hi Michael! Yes, I was waiting for your call.","That sounds great. I'm definitely interested in seeing it."],salesLines:["Hi Josh, Michael here regarding your Audi A6 inquiry.","Great. I see you're interested in the Allroad. Do you have a vehicle you'd like to trade in?"]},i=S(()=>{const I=Math.floor(d.value/60),N=d.value%60;return`${I.toString().padStart(2,"0")}:${N.toString().padStart(2,"0")}`}),a=()=>{y.value=!0,d.value=0,s.value=!1,l.value="",o.value=setInterval(()=>{d.value++,d.value>=20&&u()},1e3)},u=()=>{o.value&&(clearInterval(o.value),o.value=null),y.value=!1,s.value=!0,c.value={duration:d.value,notes:l.value,transcription:m,channel:"phone"}},f=async I=>{try{await navigator.clipboard.writeText(I),t.pushToast("success","Phone number copied to clipboard!")}catch{t.pushToast("error","Failed to copy phone number")}},g=I=>(r.value={tradeIn:m.leadLines.some(N=>N.toLowerCase().includes("trade")||N.toLowerCase().includes("exchange"))||!1,financing:m.leadLines.some(N=>N.toLowerCase().includes("financ")||N.toLowerCase().includes("payment")||N.toLowerCase().includes("loan"))||!1},r.value.tradeIn&&I&&(I.value.tradeIn=!0),r.value.financing&&I&&(I.value.financing=!0),r.value),$=()=>{y.value=!1,s.value=!1,d.value=0,l.value="",c.value={},o.value&&(clearInterval(o.value),o.value=null)};return Ft(()=>{o.value&&clearInterval(o.value)}),{isCallActive:y,callEnded:s,callDuration:d,callNotes:l,callData:c,extractedData:r,mockTranscription:m,formattedCallDuration:i,startCall:a,endCall:u,copyNumber:f,extractInformation:g,resetCall:$}}function Yl(t,y,s,d,l,o){var M,E,V;const c=A(!1),r=A(null),m=A(!1),i=A(null),a=A(!1),u=A(!1),f=[{value:"whatsapp",label:"WhatsApp"},{value:"sms",label:"SMS"},{value:"email",label:"Email"},{value:"dont-send",label:"Don't send"}],g=A("whatsapp"),$=A("followup-1"),I=A(null),N=A(""),w=A("09:00"),h=A("Not Interested"),v=A(""),x=A({dealership:((E=(M=t.value)==null?void 0:M.requestedCar)==null?void 0:E.dealership)||"Barcelona",team:"Audi Sales (New)",assigneeId:((V=o==null?void 0:o.value)==null?void 0:V.id)||null}),L=A({tradeIn:!1,financing:!1,contactAvailability:!1}),z=S(()=>{var be,me,ge,he,xe,Q,R;const j=((ge=(me=(be=t.value)==null?void 0:be.customer)==null?void 0:me.name)==null?void 0:ge.split(" ")[0])||"",de=((xe=(he=t.value)==null?void 0:he.requestedCar)==null?void 0:xe.brand)||"",ve=((R=(Q=t.value)==null?void 0:Q.requestedCar)==null?void 0:R.model)||"";return{"followup-1":`Hi ${j}! I tried calling you earlier but couldn't reach you. When would be a good time to discuss the ${de} ${ve}?`,"followup-2":`Hello ${j}, this is regarding your inquiry about the ${de} ${ve}. Please let me know when you're available for a call.`,custom:""}}),P=S(()=>$.value==="custom"?"Type your custom message...":z.value[$.value]||""),ee=S(()=>{var j;return!!((j=t.value)!=null&&j.scheduledAppointment)});return{showOutcomeSelection:c,selectedOutcome:r,appointmentScheduled:m,scheduledAppointmentData:i,showNoteModal:a,showScheduleAppointmentModal:u,followupChannels:f,followupChannel:g,selectedTemplate:$,rescheduleTime:I,customDate:N,customTime:w,disqualifyCategory:h,disqualifyReason:v,assignment:x,preferences:L,messageTemplates:z,messagePreview:P,hasExistingAppointment:ee,selectOutcome:j=>{r.value=j,j==="interested"&&(s!=null&&s.value)&&(L.value.tradeIn=s.value.tradeIn||!1,L.value.financing=s.value.financing||!1)},cancelOutcome:()=>{r.value=null,c.value=!1,m.value=!1,i.value=null},calculateNextCallDate:()=>{if(I.value==="tomorrow-9am"){const de=new Date;return de.setDate(de.getDate()+1),de.setHours(9,0,0,0),de.toISOString()}else if(I.value==="monday"){const de=new Date,ve=(8-de.getDay())%7||7;return de.setDate(de.getDate()+ve),de.setHours(9,0,0,0),de.toISOString()}else if(I.value==="custom"&&N.value&&w.value)return new Date(`${N.value}T${w.value}:00`).toISOString();const j=new Date;return j.setDate(j.getDate()+1),j.setHours(9,0,0,0),j.toISOString()},resetOutcomeState:()=>{r.value=null,c.value=!1,m.value=!1,i.value=null,g.value="whatsapp",$.value="followup-1",I.value=null,N.value="",w.value="09:00",h.value="Not Interested",v.value=""}}}function Kl(t,y,s,d,l,o){const{callData:c}=y,{showOutcomeSelection:r,selectedOutcome:m,appointmentScheduled:i,scheduledAppointmentData:a,assignment:u,preferences:f,cancelOutcome:g,calculateNextCallDate:$,showScheduleAppointmentModal:I}=s;return{logManualCall:()=>{c.value={channel:"external",notes:"",transcription:null},r.value=!0},handleScheduleAppointmentConfirm:async P=>{a.value=P,i.value=!0,I.value=!1,t("appointment-scheduled",P)},handleQualify:()=>{var ee,ne,J;const P={timestamp:new Date().toISOString(),outcome:"interested",channel:((ee=c.value)==null?void 0:ee.channel)||"phone",notes:((ne=c.value)==null?void 0:ne.notes)||"",transcription:((J=c.value)==null?void 0:J.transcription)||null};t("call-attempt-logged",P),t("validated",{scheduleFollowUp:!1}),t("qualified",{assignment:u.value,preferences:f.value,scheduleAppointment:i.value,appointmentData:a.value}),g()},handleDisqualifyFromInterested:()=>{var ee,ne,J;const P={timestamp:new Date().toISOString(),outcome:"interested",channel:((ee=c.value)==null?void 0:ee.channel)||"phone",notes:((ne=c.value)==null?void 0:ne.notes)||"",transcription:((J=c.value)==null?void 0:J.transcription)||null};t("call-attempt-logged",P),m.value="not-valid"},handleNoAnswerConfirm:async()=>{var F,U,M;const P={timestamp:new Date().toISOString(),outcome:"no-answer",channel:((F=c.value)==null?void 0:F.channel)||"phone",notes:((U=c.value)==null?void 0:U.notes)||"",transcription:((M=c.value)==null?void 0:M.transcription)||null};t("call-attempt-logged",P);const ee=$(),ne=ee.split("T")[0],J=new Date(ee).toTimeString().slice(0,5);t("postponed",{date:ne,time:J,createAppointment:!0}),(l==null?void 0:l.value)+1>=(o==null?void 0:o.value)&&t("disqualified",{category:"Not Interested",reason:"Unreachable"}),g()},handleNotValidConfirm:()=>{var ee,ne,J;const P={timestamp:new Date().toISOString(),outcome:"not-valid",channel:((ee=c.value)==null?void 0:ee.channel)||"phone",notes:((ne=c.value)==null?void 0:ne.notes)||"",transcription:((J=c.value)==null?void 0:J.transcription)||null};t("call-attempt-logged",P),t("disqualified",{category:s.disqualifyCategory.value,reason:s.disqualifyReason.value}),g()},handleNoteSave:P=>{s.showNoteModal.value=!1,t("note-saved",P)}}}const Gl={key:0,class:"flex gap-2 items-center mb-4"},Jl=["disabled"],Xl=["disabled"],Zl={key:1,class:"mb-4 space-y-4 border-t border pt-4"},_l={key:0,class:"bg-slate-900 text-white rounded-lg p-4"},eo={class:"flex items-center justify-between mb-4 pb-3 border-b border-slate-700"},to={class:"flex items-center gap-2 text-red-400"},so={class:"text-xs font-mono"},no={class:"space-y-3 text-sm font-mono"},lo={class:"ml-2"},oo={class:"ml-2"},ao={key:0},io={class:"ml-2"},ro={key:1},uo={class:"ml-2"},co={key:2},po={class:"ml-2"},mo={class:"mt-4 pt-4 border-t border-slate-700"},fo=["model-value"],yo={class:"mt-4 flex justify-end"},vo={key:1,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},go={class:"flex items-center justify-between"},bo={class:"flex gap-2"},ho={__name:"CallInterface",props:{isCallActive:{type:Boolean,required:!0},callEnded:{type:Boolean,required:!0},callDuration:{type:Number,required:!0},callNotes:{type:String,required:!0},formattedCallDuration:{type:String,required:!0},mockTranscription:{type:Object,required:!0},showOutcomeSelection:{type:Boolean,required:!0},contactAttempts:{type:Number,required:!0},maxContactAttempts:{type:Number,required:!0}},emits:["start-call","end-call","log-manual-call","extract-information","update:call-notes","copy-number"],setup(t){return(y,s)=>(p(),b("div",null,[!t.showOutcomeSelection&&!t.isCallActive&&!t.callEnded?(p(),b("div",Gl,[e("button",{disabled:t.isCallActive,onClick:s[0]||(s[0]=d=>y.$emit("start-call")),class:"bg-surface hover:bg-surfaceSecondary disabled:bg-surfaceSecondary disabled:cursor-not-allowed border border-E5E7EB text-body font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"},[s[6]||(s[6]=e("i",{class:"fa-solid fa-phone text-xs"},null,-1)),W(" "+O(t.contactAttempts>0?"Call Again":"Initiate Call"),1)],8,Jl),e("button",{disabled:t.isCallActive,onClick:s[1]||(s[1]=d=>y.$emit("log-manual-call")),class:"bg-surface hover:bg-surfaceSecondary disabled:bg-surfaceSecondary disabled:cursor-not-allowed border border-E5E7EB text-body font-medium px-4 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors"},[...s[7]||(s[7]=[e("i",{class:"fa-solid fa-clipboard-check text-xs"},null,-1),W(" Log Call Outcome ",-1)])],8,Xl)])):T("",!0),t.isCallActive||t.callEnded?(p(),b("div",Zl,[t.isCallActive?(p(),b("div",_l,[e("div",eo,[s[9]||(s[9]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fa-solid fa-waveform-lines text-blue-400 animate-pulse"}),e("span",{class:"text-xs font-bold uppercase tracking-wider"},"TRANSCRIBING")],-1)),e("div",to,[s[8]||(s[8]=e("span",{class:"w-2 h-2 bg-red-500 rounded-full animate-pulse"},null,-1)),e("span",so,"REC "+O(t.formattedCallDuration),1)])]),e("div",no,[e("div",null,[s[10]||(s[10]=e("span",{class:"text-blue-400 font-semibold"},"Lead:",-1)),e("span",lo,O(t.mockTranscription.leadLines[0]),1)]),e("div",null,[s[11]||(s[11]=e("span",{class:"text-green-400 font-semibold"},"Sales:",-1)),e("span",oo,O(t.mockTranscription.salesLines[0]),1)]),t.callDuration>=5?(p(),b("div",ao,[s[12]||(s[12]=e("span",{class:"text-blue-400 font-semibold"},"Lead:",-1)),e("span",io,O(t.mockTranscription.leadLines[1]),1)])):T("",!0),t.callDuration>=8?(p(),b("div",ro,[s[13]||(s[13]=e("span",{class:"text-green-400 font-semibold"},"Sales:",-1)),e("span",uo,O(t.mockTranscription.salesLines[1]),1)])):T("",!0),t.callDuration>=12?(p(),b("div",co,[s[14]||(s[14]=e("span",{class:"text-blue-400 font-semibold"},"Lead:",-1)),e("span",po,O(t.mockTranscription.leadLines[2]),1)])):T("",!0)]),e("div",mo,[e("textarea",{"model-value":t.callNotes,"onUpdate:modelValue":s[2]||(s[2]=d=>y.$emit("update:call-notes",d)),placeholder:"Add a quick note about this call...",class:"w-full p-3 bg-slate-800 border border-slate-700 rounded-lg text-white text-sm placeholder-gray-500 focus:outline-none focus:border-blue-500 resize-none",rows:"3"},null,8,fo)]),e("div",yo,[C(n(X),{label:"End Call",variant:"primary",size:"small",onClick:s[3]||(s[3]=d=>y.$emit("end-call")),class:"!bg-red-600 !hover:bg-red-700 !text-white !border-red-600"})])])):T("",!0),t.callEnded&&!t.isCallActive?(p(),b("div",vo,[e("div",go,[s[15]||(s[15]=e("div",null,[e("h4",{class:"font-bold text-heading mb-1 text-sm"},"Call Ended"),e("p",{class:"text-xs text-gray-600"},"Extract information from the transcription or log the outcome")],-1)),e("div",bo,[C(n(X),{label:"Extract information",variant:"primary",size:"small",onClick:s[4]||(s[4]=d=>y.$emit("extract-information")),class:"!bg-brand-red !hover:bg-brand-red-dark !text-white !border-brand-red"}),C(n(X),{label:"Log outcome",variant:"outline",size:"small",onClick:s[5]||(s[5]=d=>y.$emit("log-manual-call"))})])])])):T("",!0)])):T("",!0)]))}},xo={class:"bg-surfaceSecondary/50 border border-E5E7EB rounded-lg p-6 relative transition-all duration-300"},wo={class:"flex justify-between items-start mb-3"},ko={class:"font-bold text-heading text-fluid-sm"},Co={class:"text-fluid-xs mt-0.5"},$o={key:0,class:"mb-3 bg-blue-50 border border-blue-200 rounded-lg p-3"},So={class:"text-fluid-xs text-blue-700"},Ao={key:1,class:"mb-3 bg-surfaceSecondary border border-E5E7EB rounded-lg p-3"},Do={class:"flex items-center justify-between"},To={class:"flex items-center gap-2"},Io={class:"text-fluid-xs font-semibold text-heading"},Oo={key:0,class:"text-fluid-xs text-orange-600 font-medium flex items-center gap-1"},qo={class:"flex items-center gap-2 mb-3"},No={class:"text-fluid-sm text-body font-medium"},Lo={key:2,class:"mt-4 space-y-4 border-t border-E5E7EB pt-4"},Eo={class:"grid grid-cols-3 gap-2"},Bo={key:0,class:"space-y-4 bg-surface border border-E5E7EB rounded-lg p-6"},Mo={class:"grid grid-cols-3 gap-2"},Uo={key:0,class:"mt-3 grid grid-cols-2 gap-3"},Fo={class:"flex justify-end gap-2 pt-3 border-t border-E5E7EB"},Vo={key:1,class:"space-y-4 bg-surface border border-E5E7EB rounded-lg p-6"},Ro={class:"flex gap-4"},jo={class:"flex items-center gap-2 cursor-pointer"},Wo={class:"flex items-center gap-2 cursor-pointer"},zo={class:"flex justify-end gap-2 pt-3 border-t border-E5E7EB"},Ho={key:2,class:"space-y-4"},Po={class:"bg-surface border border-E5E7EB rounded-lg p-6"},Qo={class:"flex gap-2"},Yo={class:"bg-surface border border-E5E7EB rounded-lg p-6"},Ko={class:"flex items-center justify-between mb-4"},Go={key:0,class:"flex items-center gap-3 p-3 bg-surfaceSecondary rounded-lg border border-E5E7EB"},Jo={key:0,class:"fa-solid fa-users text-fluid-sm"},Xo={key:1},Zo={class:"flex-1"},_o={class:"font-medium text-fluid-sm text-heading"},ea={class:"text-fluid-xs text-sub capitalize"},ta={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-6"},sa={class:"grid grid-cols-2 gap-3 text-sm mb-3"},na={class:"ml-2 font-medium text-heading"},la={class:"ml-2 font-medium text-heading"},oa={class:"ml-2 font-medium text-heading capitalize"},aa={class:"ml-2 font-medium text-heading"},ia={key:1},ra={key:3,class:"bg-green-50 border border-green-200 rounded-lg p-6"},da={class:"flex items-start justify-between mb-3"},ua={class:"grid grid-cols-2 gap-3 text-fluid-sm"},ca={class:"ml-2 font-medium text-heading"},pa={class:"ml-2 font-medium text-heading"},ma={class:"ml-2 font-medium text-heading capitalize"},fa={class:"ml-2 font-medium text-heading"},ya={class:"flex justify-between items-center pt-3 border-t border-E5E7EB"},va={class:"flex gap-2"},ga={__name:"LQTask",props:{lead:{type:Object,required:!0},activities:{type:Array,default:()=>[]}},emits:["postponed","validated","qualified","disqualified","call-attempt-logged","note-saved","open-purchase-method","open-trade-in","appointment-scheduled"],setup(t,{emit:y}){const s=t,d=se=>{se||($e.value=!1)},l=y,o=We(),c=Ae();Se();const r=$t(()=>s.lead,{}),m=Ql(),{isCallActive:i,callEnded:a,callDuration:u,callNotes:f,callData:g,extractedData:$,mockTranscription:I,formattedCallDuration:N,startCall:w,endCall:h,copyNumber:v,extractInformation:x}=m,L=A(null),z=A(!1),P=A(!1);S(()=>o.assignableUsers);const ee=S(()=>c.currentUser),ne=se=>se?se.split(" ").map(k=>k[0]).join("").toUpperCase().substring(0,2):"?",J=se=>({manager:"bg-blue-100 text-blue-700",salesman:"bg-purple-100 text-purple-700",operator:"bg-orange-100 text-orange-700"})[se]||"bg-surfaceSecondary text-body",F=se=>{le.value.assignee=se,z.value=!1},U=()=>{w()},M=()=>{v(s.lead.customer.phone)},E=se=>{f.value=se},V=S(()=>{var se;return((se=r.primaryAction.value)==null?void 0:se.title)||"Call to Verify Contact Details"}),j=S(()=>{var se;return((se=r.primaryAction.value)==null?void 0:se.description)||"Begin lead qualification by verifying customer contact information."}),de=S(()=>s.lead.scheduledAppointment?new Date(s.lead.scheduledAppointment.start)<new Date:!1),ve=S(()=>!!s.lead.scheduledAppointment),be=S(()=>ve.value?{text:"Follow-up Scheduled",class:"bg-blue-100 text-blue-700"}:de.value?{text:"Overdue",class:"bg-red-100 text-red-700"}:{text:s.lead.nextActionDue?`Task Pending - Due ${yt(s.lead.nextActionDue)}`:"Task Pending",class:"bg-orange-100 text-orange-700"}),me=r.contactAttempts,ge=r.maxContactAttempts,he=Yl(Me(s,"lead"),g,$,me,ge,ee),{showOutcomeSelection:xe,selectedOutcome:Q,appointmentScheduled:R,scheduledAppointmentData:ae,showNoteModal:$e,showScheduleAppointmentModal:Fe,followupChannel:q,selectedTemplate:Y,rescheduleTime:te,customDate:ie,customTime:B,disqualifyCategory:G,disqualifyReason:re,assignment:le,hasExistingAppointment:Ee,selectOutcome:Ge,cancelOutcome:Je}=he;S(()=>s.activities.filter(se=>se.type==="note"));const It=Kl(l,m,he,Me(s,"lead"),me,ge),{logManualCall:Ot,handleScheduleAppointmentConfirm:ot,handleQualify:qt,handleDisqualifyFromInterested:Nt,handleNoAnswerConfirm:Lt,handleNotValidConfirm:Et,handleNoteSave:Bt}=It,Mt=se=>{console.log("Follow-up message sent:",se),q.value=se.type,Y.value=se.template||""};return(se,k)=>(p(),b("div",xo,[e("div",wo,[e("div",null,[e("h4",ko,O(V.value),1),e("p",Co,O(j.value),1)]),e("div",{class:K(["flex items-center gap-2 px-2 py-1 rounded text-xs font-semibold",be.value.class])},O(be.value.text),3)]),ve.value?(p(),b("div",$o,[k[26]||(k[26]=e("div",{class:"flex items-center gap-2 mb-1"},[e("i",{class:"fa-solid fa-phone text-blue-600 text-xs"}),e("span",{class:"text-fluid-xs font-semibold text-blue-900"},"Scheduled Follow-up Call")],-1)),e("p",So,O(n(Ue)(t.lead.scheduledAppointment.start))+" at "+O(n(Re)(t.lead.scheduledAppointment.start)),1)])):T("",!0),n(me)>0?(p(),b("div",Ao,[e("div",Do,[e("div",To,[k[27]||(k[27]=e("i",{class:"fa-solid fa-phone text-body text-xs"},null,-1)),k[28]||(k[28]=e("span",{class:"text-fluid-xs font-semibold text-body"},"Contact Attempts:",-1)),e("span",Io,O(n(me))+" / "+O(n(ge)),1)]),n(me)>=n(ge)-1?(p(),b("div",Oo,[...k[29]||(k[29]=[e("i",{class:"fa-solid fa-exclamation-triangle"},null,-1),W(" One more attempt before auto-disqualification ",-1)])])):T("",!0)])])):T("",!0),e("div",qo,[e("span",No,O(t.lead.customer.phone),1),e("button",{onClick:M,class:"flex items-center justify-center rounded hover:bg-surfaceSecondary text-sub hover:text-body transition-colors w-[21.6px] h-[21.6px]",title:"Copy phone number"},[...k[30]||(k[30]=[e("i",{class:"fa-regular fa-copy text-xs"},null,-1)])])]),C(ho,{"is-call-active":n(i),"call-ended":n(a),"call-duration":n(u),"call-notes":n(f),"formatted-call-duration":n(N),"mock-transcription":n(I),"show-outcome-selection":n(xe),"contact-attempts":n(me),"max-contact-attempts":n(ge),onStartCall:U,onEndCall:n(h),onLogManualCall:n(Ot),onExtractInformation:n(x),"onUpdate:callNotes":E,onCopyNumber:M},null,8,["is-call-active","call-ended","call-duration","call-notes","formatted-call-duration","mock-transcription","show-outcome-selection","contact-attempts","max-contact-attempts","onEndCall","onLogManualCall","onExtractInformation"]),n(xe)?(p(),b("div",Lo,[e("div",null,[k[34]||(k[34]=e("h4",{class:"font-semibold text-heading mb-2 text-fluid-sm"},"What's the outcome?",-1)),e("div",Eo,[e("button",{onClick:k[0]||(k[0]=_=>n(Ge)("no-answer")),class:K(["bg-surface border-2 rounded-lg py-3 px-4 flex flex-col items-center justify-center gap-1.5 text-fluid-xs font-medium text-body transition-all",n(Q)==="no-answer"?"border-brand-red bg-red-50 text-brand-red":"border-E5E7EB hover:border-red-300 hover:bg-red-50/50"])},[...k[31]||(k[31]=[e("i",{class:"fa-solid fa-phone-slash text-sm"},null,-1),e("span",null,"No answer",-1)])],2),e("button",{onClick:k[1]||(k[1]=_=>n(Ge)("not-valid")),class:K(["bg-surface border-2 rounded-lg py-3 px-4 flex flex-col items-center justify-center gap-1.5 text-fluid-xs font-medium text-body transition-all",n(Q)==="not-valid"?"border-brand-red bg-red-50 text-brand-red":"border-E5E7EB hover:border-red-300 hover:bg-red-50/50"])},[...k[32]||(k[32]=[e("i",{class:"fa-solid fa-ban text-sm"},null,-1),e("span",null,"Not valid",-1)])],2),e("button",{onClick:k[2]||(k[2]=_=>n(Ge)("interested")),class:K(["bg-surface border-2 rounded-lg py-3 px-4 flex flex-col items-center justify-center gap-1.5 text-fluid-xs font-medium text-body transition-all",n(Q)==="interested"?"border-brand-red bg-red-50 text-brand-red":"border-E5E7EB hover:border-red-300 hover:bg-red-50/50"])},[...k[33]||(k[33]=[e("i",{class:"fa-solid fa-check-circle text-sm"},null,-1),e("span",null,"Interested",-1)])],2)])]),n(Q)==="no-answer"?(p(),b("div",Bo,[C(Pl,{title:"Send follow-up message","show-email":!0,"show-sms":!0,"show-whatsapp":!0,"show-dont-send":!0,onSend:Mt,onDontSend:k[3]||(k[3]=()=>{n(q).value="dont-send"}),onCancel:k[4]||(k[4]=()=>{n(Q).value=null})}),e("div",null,[k[37]||(k[37]=e("h5",{class:"font-semibold text-heading text-fluid-sm mb-2"},"Next call attempt",-1)),e("div",Mo,[e("button",{onClick:k[5]||(k[5]=_=>te.value="tomorrow-9am"),class:K(["bg-surface border-2 rounded-lg px-4 py-2 text-fluid-xs font-medium text-body transition-all",n(te)==="tomorrow-9am"?"border-primary-700 bg-primary-50 text-primary-700":"border-E5E7EB hover:border-primary-300 hover:bg-primary-50/50"])}," Tomorrow 9:00 AM ",2),e("button",{onClick:k[6]||(k[6]=_=>te.value="monday"),class:K(["bg-surface border-2 rounded-lg px-4 py-2 text-fluid-xs font-medium text-body transition-all",n(te)==="monday"?"border-primary-700 bg-primary-50 text-primary-700":"border-E5E7EB hover:border-primary-300 hover:bg-primary-50/50"])}," Monday ",2),e("button",{onClick:k[7]||(k[7]=_=>te.value="custom"),class:K(["bg-surface border-2 rounded-lg px-4 py-2 text-fluid-xs font-medium text-body transition-all",n(te)==="custom"?"border-primary-700 bg-primary-50 text-primary-700":"border-E5E7EB hover:border-primary-300 hover:bg-primary-50/50"])}," Select time ",2)]),n(te)==="custom"?(p(),b("div",Uo,[e("div",null,[k[35]||(k[35]=e("label",{class:"block text-fluid-xs font-semibold mb-1.5"},"Date",-1)),Z(e("input",{type:"date","onUpdate:modelValue":k[8]||(k[8]=_=>Ve(ie)?ie.value=_:null),class:"input"},null,512),[[ce,n(ie)]])]),e("div",null,[k[36]||(k[36]=e("label",{class:"block text-fluid-xs font-medium text-body mb-1.5"},"Time",-1)),Z(e("input",{type:"time","onUpdate:modelValue":k[9]||(k[9]=_=>Ve(B)?B.value=_:null),class:"input"},null,512),[[ce,n(B)]])])])):T("",!0)]),e("div",Fo,[C(n(X),{label:"Cancel",variant:"outline",size:"small",onClick:n(Je)},null,8,["onClick"]),C(n(X),{label:"Send and reschedule",variant:"primary",size:"small",onClick:n(Lt),class:"!bg-brand-red !hover:bg-brand-red-dark !text-white !border-brand-red"},null,8,["onClick"])])])):T("",!0),n(Q)==="not-valid"?(p(),b("div",Vo,[e("div",null,[k[40]||(k[40]=e("label",{class:"block text-fluid-xs font-semibold mb-2"},"Category",-1)),e("div",Ro,[e("label",jo,[Z(e("input",{type:"radio","onUpdate:modelValue":k[10]||(k[10]=_=>Ve(G)?G.value=_:null),value:"Not Valid",class:"w-4 h-4 text-blue-600 focus:ring-blue-500 border-gray-300"},null,512),[[Xe,n(G)]]),k[38]||(k[38]=e("span",{class:"text-fluid-sm text-body"},"Not Valid",-1))]),e("label",Wo,[Z(e("input",{type:"radio","onUpdate:modelValue":k[11]||(k[11]=_=>Ve(G)?G.value=_:null),value:"Not Interested",class:"w-4 h-4 text-blue-600 focus:ring-blue-500 border-gray-300"},null,512),[[Xe,n(G)]]),k[39]||(k[39]=e("span",{class:"text-fluid-sm text-body"},"Not Interested",-1))])])]),e("div",null,[k[42]||(k[42]=e("label",{class:"block text-fluid-xs font-medium text-body mb-2"},"Failure Reason",-1)),Z(e("select",{"onUpdate:modelValue":k[12]||(k[12]=_=>Ve(re)?re.value=_:null),class:"w-full bg-surface border-2 border-red-500 rounded-lg px-3 py-2 text-fluid-sm text-body focus:outline-none focus:border-red-600"},[...k[41]||(k[41]=[Qe('<option value="">Select a reason...</option><option value="Data cleanup">Data cleanup</option><option value="Unreachable">Unreachable</option><option value="Purchase postponed">Purchase postponed</option><option value="Vehicle sold">Vehicle sold</option><option value="Out of budget">Out of budget</option><option value="Financing rejected">Financing rejected</option><option value="Duplicate">Duplicate</option><option value="Bought elsewhere">Bought elsewhere</option>',9)])],512),[[we,n(re)]])]),e("div",zo,[C(n(X),{label:"Cancel",variant:"outline",size:"small",onClick:n(Je)},null,8,["onClick"]),C(n(X),{label:"Confirm Disqualification",variant:"primary",size:"small",disabled:!n(G)||!n(re),onClick:n(Et),class:"!bg-red-600 !hover:bg-red-700 !text-white !border-red-600"},null,8,["disabled","onClick"])])])):T("",!0),n(Q)==="interested"?(p(),b("div",Ho,[e("div",Po,[k[43]||(k[43]=e("h5",{class:"font-semibold text-heading text-fluid-sm mb-3"},"Customer preferences",-1)),e("div",Qo,[C(n(X),{label:"+ Add purchase method",variant:"primary",size:"small",onClick:k[13]||(k[13]=_=>l("open-purchase-method")),class:"!bg-brand-black !hover:bg-brand-darkDarker !text-white !border-brand-black"}),C(n(X),{label:"+ Add trade-in",variant:"primary",size:"small",onClick:k[14]||(k[14]=_=>l("open-trade-in")),class:"!bg-brand-black !hover:bg-brand-darkDarker !text-white !border-brand-black"}),C(n(X),{label:"+ Add note",variant:"primary",size:"small",onClick:k[15]||(k[15]=_=>$e.value=!0),class:"!bg-brand-black !hover:bg-brand-darkDarker !text-white !border-brand-black"})])]),e("div",Yo,[e("div",Ko,[k[44]||(k[44]=e("h5",{class:"font-semibold text-heading text-fluid-sm"},"Assign to salesman",-1)),C(n(X),{label:"Change",variant:"outline",size:"small",class:"text-fluid-xs",onClick:k[16]||(k[16]=_=>z.value=!0)})]),n(le).assignee?(p(),b("div",Go,[e("div",{class:K(["w-10 h-10 rounded-full flex items-center justify-center font-semibold text-fluid-sm",n(le).assignee.type==="team"?"bg-green-100 text-green-700":J(n(le).assignee.role)])},[n(le).assignee.type==="team"?(p(),b("i",Jo)):(p(),b("span",Xo,O(ne(n(le).assignee.name)),1))],2),e("div",Zo,[e("p",_o,O(n(le).assignee.name),1),e("p",ea,O(n(le).assignee.type==="team"?"Team":n(le).assignee.role),1)])])):(p(),b("button",{key:1,onClick:k[17]||(k[17]=_=>z.value=!0),class:"w-full p-4 border-2 border-dashed border-E5E7EB rounded-lg hover:border-brand-red hover:bg-red-50/50 transition-colors text-center"},[...k[45]||(k[45]=[e("i",{class:"fa-solid fa-user-plus text-2xl text-sub mb-2"},null,-1),e("p",{class:"text-fluid-sm font-medium text-body"},"Click to assign to salesman",-1)])]))]),n(Ee)&&!n(R)?(p(),b("div",ta,[k[50]||(k[50]=Qe('<div class="flex items-start justify-between mb-3"><div class="flex items-center gap-2"><i class="fa-solid fa-calendar-check text-blue-600"></i><h5 class="heading-sub">Existing Appointment</h5></div><span class="text-xs font-semibold text-blue-600 uppercase">Scheduled</span></div>',1)),e("div",sa,[e("div",null,[k[46]||(k[46]=e("span",{class:"text-body"},"Date:",-1)),e("span",na,O(n(Ue)(t.lead.scheduledAppointment.start)),1)]),e("div",null,[k[47]||(k[47]=e("span",{class:"text-body"},"Time:",-1)),e("span",la,O(n(Re)(t.lead.scheduledAppointment.start)),1)]),e("div",null,[k[48]||(k[48]=e("span",{class:"text-body"},"Type:",-1)),e("span",oa,O(t.lead.scheduledAppointment.type),1)]),e("div",null,[k[49]||(k[49]=e("span",{class:"text-body"},"Assigned to:",-1)),e("span",aa,O(t.lead.scheduledAppointment.assignee),1)])]),C(n(X),{label:"Reschedule Appointment",variant:"outline",size:"small",onClick:k[18]||(k[18]=_=>Fe.value=!0)})])):T("",!0),!n(Ee)&&!P.value&&!n(R)?(p(),b("div",ia,[e("button",{onClick:k[19]||(k[19]=_=>P.value=!0),class:"w-full p-4 border-2 border-dashed border-E5E7EB rounded-lg hover:border-blue-300 hover:bg-blue-50/50 transition-colors text-center"},[...k[51]||(k[51]=[e("i",{class:"fa-solid fa-calendar-plus text-2xl text-blue-600 mb-2"},null,-1),e("p",{class:"text-fluid-sm font-medium text-heading"},"Schedule Appointment",-1),e("p",{class:"text-fluid-xs text-sub mt-1"},"Book a meeting or test drive (optional)",-1)])])])):T("",!0),P.value&&!n(R)?(p(),H(Vl,{key:2,"preselected-assignee":n(le).assignee,"can-cancel":!0,onConfirm:n(ot),onCancel:k[20]||(k[20]=_=>P.value=!1)},null,8,["preselected-assignee","onConfirm"])):T("",!0),n(R)?(p(),b("div",ra,[e("div",da,[k[52]||(k[52]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fa-solid fa-calendar-check text-green-600"}),e("h5",{class:"font-semibold text-heading text-fluid-sm"},"Appointment Scheduled")],-1)),e("button",{onClick:k[21]||(k[21]=()=>{P.value=!0,R.value=!1}),class:"text-fluid-xs text-green-700 hover:underline font-medium"}," Reschedule ")]),e("div",ua,[e("div",null,[k[53]||(k[53]=e("span",{class:"text-body"},"Date:",-1)),e("span",ca,O(n(Ue)(n(ae).datetime)),1)]),e("div",null,[k[54]||(k[54]=e("span",{class:"text-body"},"Time:",-1)),e("span",pa,O(n(ae).time),1)]),e("div",null,[k[55]||(k[55]=e("span",{class:"text-body"},"Type:",-1)),e("span",ma,O(n(ae).type),1)]),e("div",null,[k[56]||(k[56]=e("span",{class:"text-body"},"Assigned to:",-1)),e("span",fa,O(n(ae).assignee),1)])])])):T("",!0),e("div",ya,[C(n(X),{label:"Cancel",variant:"outline",size:"small",onClick:n(Je)},null,8,["onClick"]),e("div",va,[C(n(X),{label:"Disqualify",variant:"outline",size:"small",onClick:n(Nt)},null,8,["onClick"]),C(n(X),{label:"Qualify",variant:"primary",size:"small",onClick:n(qt),class:"!bg-green-600 !hover:bg-green-700 !text-white !border-green-600"},null,8,["onClick"])])])])):T("",!0)])):T("",!0),C(n(Le),{open:n($e),"onUpdate:open":d},{default:D(()=>[C(n(De),null,{default:D(()=>[C(n(Te),{class:"fixed inset-0 z-50 bg-black/50"}),C(n(Ie),{class:"w-full sm:max-w-2xl"},{default:D(()=>[C(n(Oe),null,{default:D(()=>[C(n(qe),null,{default:D(()=>[...k[57]||(k[57]=[W("Add Note",-1)])]),_:1})]),_:1}),C(es,{ref_key:"noteWidgetRef",ref:L,item:null,"task-type":"lead","task-id":t.lead.id,borderless:!1,"hide-actions":!0,"hide-header":!0,onSave:n(Bt),onCancel:k[22]||(k[22]=_=>$e.value=!1)},null,8,["task-id","onSave"]),C(n(Ne),{class:"flex flex-col sm:flex-row justify-end items-stretch sm:items-center gap-3"},{default:D(()=>{var _,at;return[C(n(X),{variant:"outline",size:"small",class:"rounded-sm w-full sm:w-auto",onClick:k[23]||(k[23]=Xi=>$e.value=!1)},{default:D(()=>[...k[58]||(k[58]=[W(" Cancel ",-1)])]),_:1}),C(n(X),{variant:"primary",size:"small",class:"rounded-sm w-full sm:w-auto !bg-brand-red !hover:bg-brand-red-dark !text-white !border-brand-red",disabled:!((_=L.value)!=null&&_.canSubmit()),onClick:(at=L.value)==null?void 0:at.submit},{default:D(()=>[...k[59]||(k[59]=[W(" Save Note ",-1)])]),_:1},8,["disabled","onClick"])]}),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),C(ol,{show:n(Fe),"preselected-assignee":n(le).assignee,onConfirm:n(ot),onClose:k[24]||(k[24]=_=>Fe.value=!1)},null,8,["show","preselected-assignee","onConfirm"]),C(gt,{show:z.value,title:"Assign to salesman","confirm-label":"Assign",onConfirm:F,onClose:k[25]||(k[25]=_=>z.value=!1)},null,8,["show"])]))}},ba={key:0,class:"bg-gray-50/50 border border-gray-100 rounded-lg p-4"},ha={class:"flex justify-between items-start mb-3"},xa={class:"text-fluid-xs text-gray-500 mt-0.5"},wa={key:0},ka={__name:"LeadManagementWidget",props:{lead:{type:Object,required:!0}},emits:["open-purchase-method","open-trade-in"],setup(t,{emit:y}){const s=t,d=y,l=je(),o=()=>{var v;const h=l.currentLead;return h&&h.id===((v=s.lead)==null?void 0:v.id)?h:s.lead},c={"call-to-verify":()=>{},"call-prospect":()=>{},"complete-conversion":()=>{},reopen:()=>{}},r=$t(Me(s,"lead"),c),{handlePostponed:m,handleValidated:i,handleQualified:a,handleCallAttemptLogged:u,handleNoteSaved:f,handleOpenPurchaseMethod:g,handleOpenTradeIn:$,handleAppointmentScheduled:I,handleDisqualified:N,handleReopen:w}=vn({getLead:o,leadState:r,emit:d});return(h,v)=>(p(),H(St,{task:t.lead},{"deadline-banner":D(()=>[C(An,{"next-action-due":t.lead.nextActionDue,"is-closed":n(r).isClosed.value,"show-deadline-banner":n(r).showDeadlineBanner.value,"task-id":t.lead.id},null,8,["next-action-due","is-closed","show-deadline-banner","task-id"])]),"primary-action":D(()=>[!n(r).isClosed.value&&n(r).showLQWidget.value?(p(),H(ga,{key:t.lead.id,lead:t.lead,onPostponed:n(m),onValidated:n(i),onQualified:n(a),onDisqualified:n(N),onCallAttemptLogged:n(u),onNoteSaved:n(f),onOpenPurchaseMethod:n(g),onOpenTradeIn:n($),onAppointmentScheduled:n(I)},null,8,["lead","onPostponed","onValidated","onQualified","onDisqualified","onCallAttemptLogged","onNoteSaved","onOpenPurchaseMethod","onOpenTradeIn","onAppointmentScheduled"])):!n(r).isClosed.value&&n(r).primaryAction.value?(p(),H(At,{key:1,action:n(r).primaryAction.value,"color-scheme":n(r).primaryAction.value.colorScheme,onActionClicked:n(r).primaryAction.value.handler},null,8,["action","color-scheme","onActionClicked"])):T("",!0)]),"task-widgets":D(()=>[...v[0]||(v[0]=[])]),"closed-state":D(()=>[n(r).isClosed.value?(p(),b("div",ba,[e("div",ha,[e("div",null,[v[1]||(v[1]=e("h4",{class:"font-bold text-gray-900 text-fluid-sm"},"Lead Closed",-1)),e("p",xa,[W(" Status: "+O(n(r).displayStage.value)+" ",1),t.lead.disqualifyReason?(p(),b("span",wa," - "+O(t.lead.disqualifyReason),1)):T("",!0)])])]),C(n(X),{variant:"primary",size:"small",onClick:n(w),class:"flex items-center gap-2"},{default:D(()=>[...v[2]||(v[2]=[e("span",null,"Reopen Lead",-1),e("i",{class:"fa-solid fa-rotate-left"},null,-1)])]),_:1},8,["onClick"])])):T("",!0)]),_:1},8,["task"]))}},Ca={class:"flex justify-between items-start mb-3"},$a={class:"font-bold text-heading text-fluid-sm"},Sa={class:"text-fluid-xs text-sub mt-0.5"},Aa={class:"flex gap-3 flex-wrap"},ke={__name:"BaseTaskWidget",props:{title:{type:String,required:!0},description:{type:String,required:!0},colorScheme:{type:Object,required:!0,validator:t=>t.background&&t.border}},setup(t){return(y,s)=>(p(),b("div",{class:K(["rounded-lg p-4 relative transition-all duration-300 border",[t.colorScheme.background,t.colorScheme.border]])},[e("div",Ca,[e("div",null,[e("h4",$a,O(t.title),1),e("p",Sa,O(t.description),1)]),ue(y.$slots,"badge")]),e("div",Aa,[ue(y.$slots,"actions")]),ue(y.$slots,"survey"),ue(y.$slots,"content")],2))}},Da={class:"mt-1.5 border-t border pt-1.5"},Ta={key:1},Ia={class:"flex items-center justify-between mb-1.5"},Oa={class:"space-y-1.5"},qa={class:"block label-upper mb-1"},Na=["onUpdate:modelValue","placeholder"],La=["onUpdate:modelValue"],Ea=["value"],Ba={key:2,class:"space-y-0.5"},Ma=["onUpdate:modelValue","value"],Ce={__name:"SurveyWidget",props:{questions:{type:Array,required:!0}},emits:["survey-completed","survey-refused","not-responding"],setup(t,{emit:y}){const s=t,d=y,l=A(!1),o=A({});ye(()=>s.questions,a=>{const u={};a.forEach(f=>{u[f.key]=""}),o.value=u},{immediate:!0});const c=()=>{d("survey-completed",{...o.value}),i()},r=()=>{d("survey-refused"),i()},m=()=>{d("not-responding"),i()},i=()=>{l.value=!1;const a={};s.questions.forEach(u=>{a[u.key]=""}),o.value=a};return(a,u)=>(p(),b("div",Da,[l.value?(p(),b("div",Ta,[e("div",Ia,[u[4]||(u[4]=e("h5",{class:"text-xs font-semibold text-body"},"Survey / Feedback",-1)),e("button",{onClick:u[1]||(u[1]=f=>l.value=!1),class:"text-xs text-gray-400 hover:text-gray-600 font-medium py-0.5"},[...u[3]||(u[3]=[e("i",{class:"fa-solid fa-chevron-up text-xs"},null,-1)])])]),e("div",Oa,[(p(!0),b(pe,null,fe(t.questions,(f,g)=>(p(),b("div",{key:g,class:"bg-surfaceSecondary rounded-md p-1.5"},[e("label",qa,O(f.label),1),f.type==="text"?Z((p(),b("textarea",{key:0,"onUpdate:modelValue":$=>o.value[f.key]=$,placeholder:f.placeholder,rows:"2",class:"input resize-none text-xs py-1 px-2"},null,8,Na)),[[ce,o.value[f.key]]]):f.type==="select"?Z((p(),b("select",{key:1,"onUpdate:modelValue":$=>o.value[f.key]=$,class:"input text-xs py-1 px-2"},[u[5]||(u[5]=e("option",{value:""},"Select an option...",-1)),(p(!0),b(pe,null,fe(f.options,$=>(p(),b("option",{key:$,value:$},O($),9,Ea))),128))],8,La)),[[we,o.value[f.key]]]):f.type==="radio"?(p(),b("div",Ba,[(p(!0),b(pe,null,fe(f.options,$=>(p(),b("label",{key:$,class:"flex items-center text-xs"},[Z(e("input",{type:"radio","onUpdate:modelValue":I=>o.value[f.key]=I,value:$,class:"mr-1"},null,8,Ma),[[Xe,o.value[f.key]]]),W(" "+O($),1)]))),128))])):T("",!0)]))),128)),e("div",{class:"flex gap-1.5 flex-wrap pt-0.5"},[e("button",{onClick:c,class:"bg-green-600 hover:bg-green-700 text-white font-medium px-2.5 py-1 rounded-md text-xs transition-colors"}," Complete Survey "),e("button",{onClick:r,class:"bg-surface hover:bg-surfaceSecondary border border-E5E7EB text-body font-medium px-2.5 py-1 rounded-md text-xs transition-colors"}," Customer Refused "),e("button",{onClick:m,class:"bg-surface hover:bg-surfaceSecondary border border-E5E7EB text-body font-medium px-2.5 py-1 rounded-md text-xs transition-colors"}," Not Responding ")])])])):(p(),b("button",{key:0,onClick:u[0]||(u[0]=f=>l.value=!0),class:"w-full flex items-center justify-between text-xs text-sub hover:text-body py-0.5 transition-colors"},[...u[2]||(u[2]=[e("span",{class:"font-medium"},"Survey / Feedback",-1),e("i",{class:"fa-solid fa-chevron-down text-xs"},null,-1)])]))]))}},Ua={__name:"OOFBTask",props:{opportunity:{type:Object,required:!0}},emits:["create-offer","review","survey-completed","survey-refused","not-responding"],setup(t,{emit:y}){const s=t,d=y,l=[{key:"offerStatus",label:"Why hasn't an offer been created?",type:"select",options:["Still gathering information","Awaiting customer response","Vehicle unavailable","Pricing concerns","Other"]},{key:"customerInterest",label:"Is customer still interested?",type:"radio",options:["Yes","Maybe","No"]},{key:"notes",label:"Additional notes",type:"text",placeholder:"Any relevant feedback or next steps..."}],o=S(()=>{if(!s.opportunity.createdAt)return 0;const u=new Date(s.opportunity.createdAt),g=Math.abs(new Date-u);return Math.ceil(g/(1e3*60*60*24))}),c=()=>{d("create-offer",s.opportunity)},r=()=>{d("review",s.opportunity)},m=u=>{d("survey-completed",{opportunity:s.opportunity,responses:u})},i=()=>{d("survey-refused",{opportunity:s.opportunity})},a=()=>{d("not-responding",{opportunity:s.opportunity})};return(u,f)=>(p(),H(ke,{title:"Open Opportunity Feedback",description:`This opportunity has been open for ${o.value} days without any offer. Consider creating an offer to move forward.`,"color-scheme":{background:"bg-orange-50/50",border:"border-orange-100"}},{actions:D(()=>[e("button",{onClick:c,class:"bg-orange-600 hover:bg-orange-700 text-white font-medium px-4 py-2 rounded-lg text-fluid-xs flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Create Offer "),e("button",{onClick:r,class:"bg-surface hover:bg-surfaceSecondary border border-E5E7EB text-slate-700 font-medium px-4 py-2 rounded-lg text-fluid-xs flex items-center gap-2 transition-colors"}," Review Opportunity ")]),survey:D(()=>[C(Ce,{questions:l,onSurveyCompleted:m,onSurveyRefused:i,onNotResponding:a})]),_:1},8,["description"]))}},Fa={__name:"UFBTask",props:{opportunity:{type:Object,required:!0}},emits:["create-offer","survey-completed","survey-refused","not-responding"],setup(t,{emit:y}){const s=t,d=y,l=[{key:"lostInterest",label:"Has customer lost interest?",type:"radio",options:["Yes","Maybe","No","Unknown"]},{key:"blockers",label:"What are the blockers?",type:"select",options:["Pricing","Availability","Financing","No response","Changed mind","Found competitor","Other"]},{key:"notes",label:"Additional feedback",type:"text",placeholder:"Describe the situation and any relevant details..."}],o=S(()=>{if(!s.opportunity.createdAt)return 0;const a=new Date(s.opportunity.createdAt),f=Math.abs(new Date-a);return Math.ceil(f/(1e3*60*60*24))}),c=()=>{d("create-offer",s.opportunity)},r=a=>{d("survey-completed",{opportunity:s.opportunity,responses:a})},m=()=>{d("survey-refused",{opportunity:s.opportunity})},i=()=>{d("not-responding",{opportunity:s.opportunity})};return(a,u)=>(p(),H(ke,{title:"Unsold Feedback",description:`This opportunity has been open for ${o.value} days without any offer. This is a follow-up to ensure progress. Consider creating an offer or closing the opportunity.`,"color-scheme":{background:"bg-red-50/50",border:"border-red-100"}},{actions:D(()=>[e("button",{onClick:c,class:"bg-red-600 hover:bg-red-700 text-white font-medium px-4 py-2 rounded-lg text-fluid-xs flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Create Offer ")]),survey:D(()=>[C(Ce,{questions:l,onSurveyCompleted:r,onSurveyRefused:m,onNotResponding:i})]),_:1},8,["description"]))}},Va={__name:"NFUTask",props:{opportunity:{type:Object,required:!0}},emits:["schedule-closing","survey-completed","survey-refused","not-responding"],setup(t,{emit:y}){const s=t,d=y,l=[{key:"appointmentStatus",label:"Why no appointment scheduled?",type:"select",options:["Customer delaying","Awaiting vehicle availability","Logistics issues","Customer not responding","Other"]},{key:"customerStatus",label:"Customer status?",type:"radio",options:["Still interested","Considering","Lost interest","Unknown"]},{key:"notes",label:"Additional information",type:"text",placeholder:"Any relevant details about the follow-up..."}],o=()=>{d("schedule-closing",s.opportunity)},c=i=>{d("survey-completed",{opportunity:s.opportunity,responses:i})},r=()=>{d("survey-refused",{opportunity:s.opportunity})},m=()=>{d("not-responding",{opportunity:s.opportunity})};return(i,a)=>(p(),H(ke,{title:"Opportunity Follow-up",description:"No contract date exists. Push to close or schedule a closing meeting to finalize the deal.","color-scheme":{background:"bg-purple-50/50",border:"border-purple-100"}},{actions:D(()=>[e("button",{onClick:o,class:"bg-purple-600 hover:bg-purple-700 text-white font-medium px-4 py-2 rounded-lg text-fluid-xs flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Schedule Closing Meeting ")]),survey:D(()=>[C(Ce,{questions:l,onSurveyCompleted:c,onSurveyRefused:r,onNotResponding:m})]),_:1}))}},Ra={__name:"OFBTask",props:{opportunity:{type:Object,required:!0}},emits:["create-contract","survey-completed","survey-refused","not-responding"],setup(t,{emit:y}){const s=t,d=y,l=[{key:"customerFeedback",label:"Customer feedback on offer?",type:"select",options:["Positive","Neutral","Negative","No feedback yet"]},{key:"objections",label:"Any objections?",type:"text",placeholder:"Describe any concerns or objections raised by customer..."},{key:"nextSteps",label:"What are the next steps?",type:"select",options:["Waiting for customer decision","Revising offer","Scheduling closing meeting","Addressing objections","Other"]}],o=S(()=>{const a=s.opportunity.lastActivity||s.opportunity.createdAt;if(!a)return 0;const u=new Date(a),g=Math.abs(new Date-u);return Math.ceil(g/(1e3*60*60*24))}),c=()=>{d("create-contract",s.opportunity)},r=a=>{d("survey-completed",{opportunity:s.opportunity,responses:a})},m=()=>{d("survey-refused",{opportunity:s.opportunity})},i=()=>{d("not-responding",{opportunity:s.opportunity})};return(a,u)=>(p(),H(ke,{title:"Offer Feedback",description:`This opportunity has been in negotiation for ${o.value} days without a contract. Consider creating a contract to finalize the deal.`,"color-scheme":{background:"bg-blue-50/50",border:"border-blue-100"}},{actions:D(()=>[e("button",{onClick:c,class:"bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded-lg text-fluid-xs flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Create Contract ")]),survey:D(()=>[C(Ce,{questions:l,onSurveyCompleted:r,onSurveyRefused:m,onNotResponding:i})]),_:1},8,["description"]))}},ja={__name:"CFBTask",props:{opportunity:{type:Object,required:!0}},emits:["prepare-delivery","pre-delivery-checklist","survey-completed","survey-refused","not-responding"],setup(t,{emit:y}){const s=t,d=y,l=[{key:"deliveryTimeline",label:"Delivery timeline confirmation?",type:"select",options:["On schedule","Delayed","Ahead of schedule","To be determined"]},{key:"concerns",label:"Any concerns?",type:"text",placeholder:"Document any concerns or special requests from customer..."},{key:"readiness",label:"Vehicle readiness status?",type:"select",options:["Ready","In preparation","Waiting for parts","Other"]}],o=S(()=>{var $;if(!(($=s.opportunity)!=null&&$.contractDate))return 0;const u=new Date(s.opportunity.contractDate),g=Math.abs(new Date-u);return Math.ceil(g/(1e3*60*60*24))}),c=()=>{d("prepare-delivery",s.opportunity)},r=()=>{d("pre-delivery-checklist",s.opportunity)},m=u=>{d("survey-completed",{opportunity:s.opportunity,responses:u})},i=()=>{d("survey-refused",{opportunity:s.opportunity})},a=()=>{d("not-responding",{opportunity:s.opportunity})};return(u,f)=>(p(),H(ke,{title:"Contract Feedback",description:`Contract was signed ${o.value} days ago. Follow up on delivery status and collect customer feedback.`,"color-scheme":{background:"bg-green-50/50",border:"border-green-100"}},{actions:D(()=>[e("button",{onClick:c,class:"bg-green-600 hover:bg-green-700 text-white font-medium px-4 py-2 rounded-lg text-fluid-xs flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Prepare for Delivery "),e("button",{onClick:r,class:"bg-surface border border-D1D5DB text-brand-dark font-medium px-4 py-2 rounded-lg text-fluid-xs flex items-center gap-2 transition-colors hover:bg-surfaceSecondary"}," Pre-Delivery Checklist ")]),survey:D(()=>[C(Ce,{questions:l,onSurveyCompleted:m,onSurveyRefused:i,onNotResponding:a})]),_:1},8,["description"]))}},Wa={__name:"DFBTask",props:{opportunity:{type:Object,required:!0},activities:{type:Array,default:()=>[]}},emits:["delivery-feedback","survey-completed","survey-refused","not-responding"],setup(t,{emit:y}){const s=t,d=y,l=[{key:"satisfaction",label:"Satisfaction with vehicle?",type:"radio",options:["Very satisfied","Satisfied","Neutral","Dissatisfied","Very dissatisfied"]},{key:"deliveryExperience",label:"Delivery experience rating",type:"select",options:["Excellent","Good","Average","Poor","Very poor"]},{key:"issues",label:"Any issues or concerns?",type:"text",placeholder:"Document any issues or positive feedback from customer..."}],o=S(()=>{const a=s.activities.find($=>{var I;return $.type==="delivery"||((I=$.action)==null?void 0:I.toLowerCase().includes("delivered"))});if(!a||!a.timestamp)return 0;const u=new Date(a.timestamp),g=Math.abs(new Date-u);return Math.ceil(g/(1e3*60*60*24))}),c=()=>{d("delivery-feedback",s.opportunity)},r=a=>{d("survey-completed",{opportunity:s.opportunity,responses:a})},m=()=>{d("survey-refused",{opportunity:s.opportunity})},i=()=>{d("not-responding",{opportunity:s.opportunity})};return(a,u)=>(p(),H(ke,{title:"Delivery Feedback",description:`Vehicle was delivered ${o.value} days ago. Ask the customer if they're satisfied with the vehicle.`,"color-scheme":{background:"bg-teal-50/50",border:"border-teal-100"}},{actions:D(()=>[e("button",{onClick:c,class:"bg-teal-600 hover:bg-teal-700 text-white font-medium px-4 py-2 rounded-lg text-fluid-xs flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"}," Delivery Feedback ")]),survey:D(()=>[C(Ce,{questions:l,onSurveyCompleted:r,onSurveyRefused:m,onNotResponding:i})]),_:1},8,["description"]))}},za={__name:"NSTask",props:{opportunity:{type:Object,required:!0},scheduledAppointment:{type:Object,required:!0}},emits:["contact-customer","reschedule","survey-completed","survey-refused","not-responding","auto-close-lost","set-callback"],setup(t,{emit:y}){const s=t,d=y,l=S(()=>{var $;return(($=s.scheduledAppointment)==null?void 0:$.noShowCount)||0}),o=S(()=>{const $=l.value;return $===0?"No-Show Follow-up":$>=3?`No-Show #${$} - Final Warning`:`No-Show #${$} Follow-up`}),c=S(()=>{const $=l.value;return $>=3?"This is the third no-show. The opportunity will be automatically closed as lost if another appointment is not successfully completed.":$>=2?"This is the second no-show. Please make every effort to reach the customer and reschedule.":"Follow up with customer to understand the situation and book another appointment."}),r=[{key:"contactStatus",label:"Were you able to reach the customer?",type:"radio",options:["Yes","No","Left message"]},{key:"noShowReason",label:"Reason for no-show?",type:"select",options:["Emergency","Forgot","Changed mind","No response","Schedule conflict","Other"]},{key:"nextAction",label:"Next action?",type:"select",options:["Reschedule appointment","Customer will call back","Continue follow-up","Other"]},{key:"notes",label:"Additional notes",type:"text",placeholder:"Document the conversation and any relevant details..."}],m=S(()=>{var I;return(I=s.scheduledAppointment)!=null&&I.start?new Date(s.scheduledAppointment.start).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"unknown date"}),i=()=>{d("contact-customer",s.opportunity)},a=()=>{const $=l.value;if($>=3)d("auto-close-lost",{opportunity:s.opportunity,reason:`Automatically closed after ${$} no-shows`});else if($===1||$===2){const I=new Date;I.setDate(I.getDate()+2),d("set-callback",{opportunity:s.opportunity,callbackDate:I.toISOString()})}else d("reschedule",s.opportunity)},u=$=>{d("survey-completed",{opportunity:s.opportunity,responses:$})},f=()=>{d("survey-refused",{opportunity:s.opportunity})},g=()=>{d("not-responding",{opportunity:s.opportunity})};return($,I)=>(p(),H(ke,{title:o.value,description:`Appointment was scheduled for ${m.value} but customer did not show up. ${c.value}`,"color-scheme":{background:"bg-yellow-50/50",border:"border-yellow-100"}},{actions:D(()=>[e("button",{onClick:a,class:"bg-yellow-600 hover:bg-yellow-700 text-white font-medium px-4 py-2 rounded-lg text-fluid-xs flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"},[...I[0]||(I[0]=[e("i",{class:"fa-solid fa-calendar-plus"},null,-1),W(" Book Another Appointment ",-1)])]),e("button",{onClick:i,class:"bg-surface hover:bg-surfaceSecondary border border-E5E7EB text-slate-700 font-medium px-4 py-2 rounded-lg text-fluid-xs flex items-center gap-2 transition-colors"},[...I[1]||(I[1]=[e("i",{class:"fa-solid fa-phone"},null,-1),W(" Contact Customer ",-1)])])]),survey:D(()=>[C(Ce,{questions:r,onSurveyCompleted:u,onSurveyRefused:f,onNotResponding:g})]),_:1},8,["title","description"]))}},Ha={__name:"AbandonedTask",props:{opportunity:{type:Object,required:!0},activities:{type:Array,default:()=>[]}},emits:["reopen","close-lost","requalify","survey-completed","survey-refused","not-responding"],setup(t,{emit:y}){const s=t,d=y;Se();const l=[{key:"abandonmentReason",label:"Why was this opportunity abandoned?",type:"select",options:["No response from customer","Customer lost interest","Competitor won","Budget constraints","Timing issues","Other"]},{key:"customerStatus",label:"Customer status?",type:"radio",options:["Still interested","Lost interest","Bought elsewhere","Unknown"]},{key:"notes",label:"Additional notes",type:"text",placeholder:"Document any relevant information about why this opportunity was abandoned..."}],o=S(()=>{const f=s.opportunity.lastActivity||s.opportunity.createdAt;if(!f)return 0;const g=new Date(f),I=Math.abs(new Date-g);return Math.ceil(I/(1e3*60*60*24))}),c=()=>{d("reopen",s.opportunity)},r=()=>{d("close-lost",{opportunity:s.opportunity,reason:"Abandoned - no activity for extended period"})},m=()=>{d("requalify",s.opportunity)},i=f=>{d("survey-completed",{opportunity:s.opportunity,responses:f})},a=()=>{d("survey-refused",{opportunity:s.opportunity})},u=()=>{d("not-responding",{opportunity:s.opportunity})};return(f,g)=>(p(),H(ke,{title:"Opportunity Abandoned",description:`This opportunity has been inactive for ${o.value} days. Consider reopening it or closing as lost.`,"color-scheme":{background:"bg-surfaceSecondary/50",border:"border"}},{actions:D(()=>[e("button",{onClick:c,class:"bg-gray-600 hover:bg-gray-700 text-white font-medium px-4 py-2 rounded-lg text-fluid-xs flex items-center gap-2 transition-colors shadow-sm shadow-gray-200"},[...g[0]||(g[0]=[e("i",{class:"fa-solid fa-rotate-left"},null,-1),W(" Reopen Opportunity ",-1)])]),e("button",{onClick:r,class:"bg-surface hover:bg-surfaceSecondary border border-E5E7EB text-slate-700 font-medium px-4 py-2 rounded-lg text-fluid-xs flex items-center gap-2 transition-colors"},[...g[1]||(g[1]=[e("i",{class:"fa-solid fa-xmark"},null,-1),W(" Close as Lost ",-1)])]),e("button",{onClick:m,class:"bg-surface hover:bg-surfaceSecondary border border-E5E7EB text-slate-700 font-medium px-4 py-2 rounded-lg text-fluid-xs flex items-center gap-2 transition-colors"},[...g[2]||(g[2]=[e("i",{class:"fa-solid fa-arrow-left"},null,-1),W(" Requalify as Lead ",-1)])])]),survey:D(()=>[C(Ce,{questions:l,onSurveyCompleted:i,onSurveyRefused:a,onNotResponding:u})]),_:1},8,["description"]))}},Pa={OOFB:Ua,UFB:Fa,NFU:Va,OFB:Ra,CFB:ja,DFB:Wa,NS:za,ABANDONED:Ha};function Qa(t,y,s,d,l){const o=S(()=>{const f=He(t),g=He(y),$=He(s);return{opportunity:f,scheduledAppointment:g,activities:$,hasOffers:($==null?void 0:$.some(I=>I.type==="offer"))||!1,stage:f.displayStage||f.stage,deliverySubstatus:f.deliverySubstatus||null,formatDateTime:l,hasActiveTaskWidget:!1}}),c=S(()=>{const f=o.value,g=ts(f.stage,f);if(!g)return null;const $=Pa[g];return $?{type:g,component:$,props:{opportunity:f.opportunity,appointment:f.scheduledAppointment,activities:f.activities}}:(console.warn(`No component found for widget type: ${g}`),null)}),r=S(()=>({...o.value,hasActiveTaskWidget:!!c.value})),m=S(()=>{const f=r.value,g=ss(f.stage,f);if(!g)return null;const $=d[g.key];return{...g,handler:$||(()=>console.warn(`No handler for action: ${g.key}`))}}),i=S(()=>{const f=r.value;return ns(f.stage,f).map($=>{const I=d[$.key];return{...$,handler:I||(()=>console.warn(`No handler for action: ${$.key}`))}})}),a=S(()=>{const f=o.value;return ls(f.stage)}),u=S(()=>!c.value||!c.value.type?"":os(c.value.type));return{primaryAction:m,secondaryActions:i,activeTaskWidget:c,taskWidgetTitle:u,isClosed:a}}const Ya={class:"relative"},Ka=["disabled"],Ga={key:0,class:"absolute top-full right-0 mt-2 min-w-full z-[9999] dropdown-menu-small"},Ja={__name:"SecondaryActionsDropdown",props:{actions:{type:Array,default:()=>[]}},emits:["action-selected"],setup(t,{emit:y}){const s=t,d=y,l=A(!1),o=()=>{l.value=!l.value},c=()=>{l.value=!1},r=i=>{i.disabled||(c(),d("action-selected",i),i.handler&&typeof i.handler=="function"&&i.handler())},m=S(()=>(s.actions||[]).map(i=>({key:i.key,label:i.label,disabled:!!i.disabled,onClick:()=>r(i)})));return(i,a)=>{const u=_e("click-outside");return Z((p(),b("div",Ya,[e("button",{onClick:o,class:"w-auto bg-surface hover:bg-surfaceSecondary border border-E5E7EB text-body font-medium px-4 py-2 rounded-lg text-fluid-xs flex items-center justify-between gap-2 transition-colors whitespace-nowrap",disabled:!t.actions||t.actions.length===0},[a[0]||(a[0]=e("span",null,"More actions",-1)),e("i",{class:K(["fa-solid fa-chevron-down text-xs transition-transform duration-200 flex-shrink-0",{"rotate-180":l.value}])},null,2)],8,Ka),C(ct,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:D(()=>[l.value?(p(),b("div",Ga,[C(n(tt),{items:m.value,className:"min-w-full"},null,8,["items"])])):T("",!0)]),_:1})])),[[u,c]])}}},Xa={class:"w-full h-28 bg-surfaceSecondary rounded overflow-hidden mb-2"},Za=["src","alt"],_a={key:1,class:"w-full h-full flex items-center justify-center"},ei={class:"flex items-center justify-between mb-1.5"},ti={class:"text-sm font-bold text-heading"},si={class:"font-bold text-xs text-heading mb-0.5 line-clamp-1"},ni={class:"text-xs text-sub mb-1.5"},li={key:0,class:"text-xs text-green-600 font-medium mb-2"},oi={key:1,class:"text-xs text-orange-600 font-medium mb-2"},rt={__name:"VehicleCard",props:{vehicle:{type:Object,required:!0},badge:{type:String,required:!0},stockDays:{type:Number,default:null},selected:{type:Boolean,default:!1}},emits:["select"],setup(t){const y=t,s=S(()=>({Requested:"blue",Recommended:"gray","In Stock":"green",Custom:"yellow"})[y.badge]||"gray"),d=l=>l?l.toLocaleString("en-US"):"0";return(l,o)=>(p(),b("div",{onClick:o[1]||(o[1]=c=>l.$emit("select")),class:K(["border border-E5E7EB rounded-lg p-3 hover:border-blue-500 hover:shadow cursor-pointer transition-all bg-surface",{"border-blue-500 shadow":t.selected}])},[e("div",Xa,[t.vehicle.image?(p(),b("img",{key:0,src:t.vehicle.image,alt:`${t.vehicle.brand} ${t.vehicle.model}`,class:"w-full h-full object-cover"},null,8,Za)):(p(),b("div",_a,[...o[2]||(o[2]=[e("i",{class:"fa-solid fa-car text-sub opacity-50 text-2xl"},null,-1)])]))]),e("div",null,[e("div",ei,[C(n(Pe),{text:t.badge,size:"small",theme:s.value},null,8,["text","theme"]),e("span",ti,"â‚¬"+O(d(t.vehicle.price)),1)]),e("h4",si,O(t.vehicle.brand)+" "+O(t.vehicle.model),1),e("p",ni,O(t.vehicle.year),1),t.stockDays!==null&&t.stockDays!==void 0?(p(),b("div",li,[o[3]||(o[3]=e("i",{class:"fa-solid fa-check-circle mr-0.5"},null,-1)),W(" In stock ("+O(t.stockDays)+" days) ",1)])):(p(),b("div",oi,[...o[4]||(o[4]=[e("i",{class:"fa-solid fa-clock mr-0.5"},null,-1),W(" Out of stock ",-1)])])),e("button",{onClick:o[0]||(o[0]=et(c=>l.$emit("select"),["stop"])),class:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium px-3 py-1.5 rounded text-xs transition-colors"}," Select ")])],2))}},ai={class:"space-y-6"},ii={key:0},ri={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-3"},di={class:"mb-4"},ui={class:"relative"},ci={key:0,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-3"},pi={key:1,class:"text-center py-8 text-sub"},mi={class:"border border-E5E7EB rounded-lg p-4 bg-surfaceSecondary"},fi={key:0,class:"mt-4 space-y-3"},yi={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3"},vi={class:"flex justify-end"},gi=["disabled"],bi={__name:"VehicleSelectionModal",props:{show:{type:Boolean,required:!0},requestedVehicle:{type:Object,default:null},opportunityId:{type:Number,required:!0}},emits:["close","vehicle-selected"],setup(t,{emit:y}){const s=t,d=y,l=v=>{v||d("close")},o=A(""),c=A(!1),r=A(null),m=A(null),i=A(null),a=A([]),u=A({brand:"",model:"",year:new Date().getFullYear(),price:0,stockDays:null,image:""});lt(async()=>{try{const v=await bt({});a.value=v.data||[]}catch(v){console.error("Failed to load vehicles:",v),a.value=[]}});const f=S(()=>s.requestedVehicle&&s.requestedVehicle.stockDays!==null&&s.requestedVehicle.stockDays!==void 0),g=S(()=>{const v=[];if(s.requestedVehicle&&f.value&&v.push({...s.requestedVehicle,isRequested:!0}),a.value&&a.value.length>0){const x=a.value.filter(z=>s.requestedVehicle?z.brand!==s.requestedVehicle.brand||z.model!==s.requestedVehicle.model:!0),L=s.requestedVehicle&&f.value?3:4;v.push(...x.slice(0,L))}return v}),$=S(()=>{if(!a.value||a.value.length===0)return[];let v=[...a.value];if(o.value){const x=o.value.toLowerCase();v=v.filter(L=>L.brand.toLowerCase().includes(x)||L.model.toLowerCase().includes(x)||L.year.toString().includes(x))}return v}),I=S(()=>u.value.brand&&u.value.model&&u.value.year&&u.value.price>0),N=(v,x)=>{r.value=v,m.value=v.id||`custom-${Date.now()}`,i.value=x},w=()=>{if(!I.value)return;const v={...u.value,id:`custom-${Date.now()}`,isCustom:!0};N(v,"custom")},h=()=>{r.value&&(d("vehicle-selected",{vehicle:r.value,type:i.value}),d("close"),r.value=null,m.value=null,i.value=null,o.value="",c.value=!1,u.value={brand:"",model:"",year:new Date().getFullYear(),price:0,stockDays:null,image:""})};return(v,x)=>(p(),H(n(Le),{open:t.show,"onUpdate:open":l},{default:D(()=>[C(n(De),null,{default:D(()=>[C(n(Te),{class:"fixed inset-0 z-50 bg-black/50"}),C(n(Ie),{class:"w-full sm:max-w-6xl"},{default:D(()=>[C(n(Oe),null,{default:D(()=>[C(n(qe),null,{default:D(()=>[...x[7]||(x[7]=[W("Select Vehicle",-1)])]),_:1})]),_:1}),e("div",ai,[g.value.length?(p(),b("div",ii,[x[8]||(x[8]=e("h3",{class:"text-sm font-bold text-heading mb-3 flex items-center gap-2"},[e("i",{class:"fa-solid fa-sparkles text-purple-600"}),W(" Recommended Vehicles ")],-1)),e("div",ri,[(p(!0),b(pe,null,fe(g.value,L=>(p(),H(rt,{key:L.id,vehicle:L,badge:L.isRequested?"Requested":"Recommended","stock-days":L.stockDays,selected:m.value===L.id,onSelect:z=>N(L,L.isRequested?"requested":"recommended")},null,8,["vehicle","badge","stock-days","selected","onSelect"]))),128))])])):T("",!0),e("div",null,[x[11]||(x[11]=e("h3",{class:"text-sm font-bold text-heading mb-3 flex items-center gap-2"},[e("i",{class:"fa-solid fa-warehouse text-green-600"}),W(" Browse Stock ")],-1)),e("div",di,[e("div",ui,[x[9]||(x[9]=e("i",{class:"fa-solid fa-magnifying-glass absolute left-3 top-2.5 text-sub text-sm"},null,-1)),Z(e("input",{"onUpdate:modelValue":x[0]||(x[0]=L=>o.value=L),type:"text",placeholder:"Search by brand, model, year...",class:"w-full bg-surface border border-E5E7EB rounded-lg pl-10 pr-3 py-2 text-sm focus:outline-none focus:border-blue-500 transition-colors"},null,512),[[ce,o.value]])])]),$.value.length?(p(),b("div",ci,[(p(!0),b(pe,null,fe($.value,L=>(p(),H(rt,{key:L.id,vehicle:L,badge:"In Stock","stock-days":L.stockDays,selected:m.value===L.id,onSelect:z=>N(L,"stock")},null,8,["vehicle","stock-days","selected","onSelect"]))),128))])):(p(),b("div",pi,[...x[10]||(x[10]=[e("i",{class:"fa-solid fa-search text-4xl text-gray-300 mb-3"},null,-1),e("p",{class:"text-sm font-medium"},"No vehicles found matching your search",-1),e("p",{class:"text-xs mt-1 text-sub"},"Try different keywords or clear the search",-1)])]))]),e("div",null,[x[19]||(x[19]=e("h3",{class:"text-sm font-bold text-heading mb-3 flex items-center gap-2"},[e("i",{class:"fa-solid fa-wrench text-orange-600"}),W(" Configure Custom Vehicle ")],-1)),e("div",mi,[x[18]||(x[18]=e("p",{class:"text-xs text-body mb-3"}," Build a custom configuration with specific options and features ",-1)),e("button",{onClick:x[1]||(x[1]=L=>c.value=!c.value),class:"bg-orange-600 hover:bg-orange-700 text-white font-medium px-4 py-2 rounded-lg text-sm transition-colors"},[x[12]||(x[12]=e("i",{class:"fa-solid fa-cog mr-2"},null,-1)),W(" "+O(c.value?"Hide Configuration":"Build Custom Configuration"),1)]),c.value?(p(),b("div",fi,[e("div",yi,[e("div",null,[x[13]||(x[13]=e("label",{class:"block text-xs font-medium text-body mb-1"},"Brand",-1)),Z(e("input",{"onUpdate:modelValue":x[2]||(x[2]=L=>u.value.brand=L),type:"text",class:"input",placeholder:"e.g., Audi"},null,512),[[ce,u.value.brand]])]),e("div",null,[x[14]||(x[14]=e("label",{class:"block text-xs font-medium text-body mb-1"},"Model",-1)),Z(e("input",{"onUpdate:modelValue":x[3]||(x[3]=L=>u.value.model=L),type:"text",class:"input",placeholder:"e.g., e-tron GT"},null,512),[[ce,u.value.model]])]),e("div",null,[x[15]||(x[15]=e("label",{class:"block text-xs font-medium text-body mb-1"},"Year",-1)),Z(e("input",{"onUpdate:modelValue":x[4]||(x[4]=L=>u.value.year=L),type:"number",class:"input",placeholder:"2024"},null,512),[[ce,u.value.year]])]),e("div",null,[x[16]||(x[16]=e("label",{class:"block text-xs font-medium text-body mb-1"},"Price (â‚¬)",-1)),Z(e("input",{"onUpdate:modelValue":x[5]||(x[5]=L=>u.value.price=L),type:"number",class:"input",placeholder:"98000"},null,512),[[ce,u.value.price]])])]),e("div",vi,[e("button",{onClick:w,disabled:!I.value,class:"bg-orange-600 hover:bg-orange-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-medium px-4 py-2 rounded-lg text-sm transition-colors"},[...x[17]||(x[17]=[e("i",{class:"fa-solid fa-check mr-2"},null,-1),W(" Use Custom Configuration ",-1)])],8,gi)])])):T("",!0)])])]),C(n(Ne),{class:"flex flex-col sm:flex-row justify-end items-stretch sm:items-center gap-3"},{default:D(()=>[C(n(X),{label:"Cancel",variant:"outline",size:"small",class:"rounded-sm w-full sm:w-auto",onClick:x[6]||(x[6]=L=>v.$emit("close"))}),r.value?(p(),H(n(X),{key:0,label:"Confirm Selection",variant:"primary",size:"small",class:"rounded-sm w-full sm:w-auto !bg-brand-red !hover:bg-brand-red-dark !text-white !border-brand-red",onClick:h})):T("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]))}},hi={class:"space-y-4"},xi=["max"],wi={__name:"ContractDateModal",props:{show:{type:Boolean,required:!0}},emits:["confirm","cancel"],setup(t,{emit:y}){const s=t,d=y,l=A(""),o=A(""),c=A(""),r=S(()=>new Date().toISOString().split("T")[0]);ye(()=>s.show,u=>{if(u){const f=new Date;l.value=f.toISOString().split("T")[0],o.value=f.toTimeString().slice(0,5),c.value=""}});const m=()=>{if(!l.value)return;const u=o.value?`${l.value}T${o.value}:00`:`${l.value}T12:00:00`;d("confirm",{contractDate:u,notes:c.value})},i=()=>{d("cancel")},a=u=>{u||i()};return(u,f)=>(p(),H(n(Le),{open:t.show,"onUpdate:open":a},{default:D(()=>[C(n(De),null,{default:D(()=>[C(n(Te),{class:"fixed inset-0 z-50 bg-black/50"}),C(n(Ie),{class:"w-full sm:max-w-lg"},{default:D(()=>[C(n(Oe),null,{default:D(()=>[C(n(qe),null,{default:D(()=>[...f[3]||(f[3]=[W("Set Contract Signing Date",-1)])]),_:1}),C(n(ze),null,{default:D(()=>[...f[4]||(f[4]=[W("Record when the contract was signed to track delivery timeline",-1)])]),_:1})]),_:1}),e("div",hi,[e("div",null,[f[5]||(f[5]=e("label",{class:"block label-upper mb-2"},"Contract Date",-1)),Z(e("input",{type:"date","onUpdate:modelValue":f[0]||(f[0]=g=>l.value=g),max:r.value,class:"input"},null,8,xi),[[ce,l.value]])]),e("div",null,[f[6]||(f[6]=e("label",{class:"block label-upper mb-2"},"Time (Optional)",-1)),Z(e("input",{type:"time","onUpdate:modelValue":f[1]||(f[1]=g=>o.value=g),class:"input"},null,512),[[ce,o.value]])]),e("div",null,[f[7]||(f[7]=e("label",{class:"block label-upper mb-2"},"Notes (Optional)",-1)),Z(e("textarea",{"onUpdate:modelValue":f[2]||(f[2]=g=>c.value=g),rows:"3",placeholder:"Add any relevant notes about the contract signing...",class:"input resize-none"},null,512),[[ce,c.value]])])]),C(n(Ne),{class:"flex flex-col sm:flex-row justify-end items-stretch sm:items-center gap-3"},{default:D(()=>[C(n(X),{label:"Cancel",variant:"outline",size:"small",class:"rounded-sm w-full sm:w-auto",onClick:i}),C(n(X),{label:"Set Contract Date",variant:"primary",size:"small",class:"rounded-sm w-full sm:w-auto !bg-green-600 !hover:bg-green-700 !border-green-600",disabled:!l.value,onClick:m},null,8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]))}},ki={class:"space-y-4"},Ci=["max"],$i={__name:"DeliveryModal",props:{show:{type:Boolean,required:!0}},emits:["confirm","cancel"],setup(t,{emit:y}){const s=t,d=y,l=A(""),o=A(""),c=A(""),r=A(""),m=S(()=>new Date().toISOString().split("T")[0]);ye(()=>s.show,f=>{if(f){const g=new Date;l.value=g.toISOString().split("T")[0],o.value=g.toTimeString().slice(0,5),c.value="",r.value=""}});const i=()=>{if(!l.value||!c.value)return;const f=o.value?`${l.value}T${o.value}:00`:`${l.value}T12:00:00`;d("confirm",{deliveryDate:f,location:c.value,notes:r.value})},a=()=>{d("cancel")},u=f=>{f||a()};return(f,g)=>(p(),H(n(Le),{open:t.show,"onUpdate:open":u},{default:D(()=>[C(n(De),null,{default:D(()=>[C(n(Te),{class:"fixed inset-0 z-50 bg-black/50"}),C(n(Ie),{class:"w-full sm:max-w-lg"},{default:D(()=>[C(n(Oe),null,{default:D(()=>[C(n(qe),null,{default:D(()=>[...g[4]||(g[4]=[W("Mark as Delivered",-1)])]),_:1}),C(n(ze),null,{default:D(()=>[...g[5]||(g[5]=[W("Record the vehicle delivery date and details",-1)])]),_:1})]),_:1}),e("div",ki,[e("div",null,[g[6]||(g[6]=e("label",{class:"block label-upper mb-2"},"Delivery Date",-1)),Z(e("input",{type:"date","onUpdate:modelValue":g[0]||(g[0]=$=>l.value=$),max:m.value,class:"input"},null,8,Ci),[[ce,l.value]])]),e("div",null,[g[7]||(g[7]=e("label",{class:"block label-upper mb-2"},"Time (Optional)",-1)),Z(e("input",{type:"time","onUpdate:modelValue":g[1]||(g[1]=$=>o.value=$),class:"input"},null,512),[[ce,o.value]])]),e("div",null,[g[9]||(g[9]=e("label",{class:"block label-upper mb-2"},"Delivery Location",-1)),Z(e("select",{"onUpdate:modelValue":g[2]||(g[2]=$=>c.value=$),class:"input"},[...g[8]||(g[8]=[e("option",{value:""},"Select location...",-1),e("option",{value:"Dealership"},"At Dealership",-1),e("option",{value:"Customer Address"},"Customer Address",-1),e("option",{value:"Other"},"Other Location",-1)])],512),[[we,c.value]])]),e("div",null,[g[10]||(g[10]=e("label",{class:"block label-upper mb-2"},"Delivery Notes",-1)),Z(e("textarea",{"onUpdate:modelValue":g[3]||(g[3]=$=>r.value=$),rows:"3",placeholder:"Add any relevant delivery details, customer feedback, etc...",class:"input resize-none"},null,512),[[ce,r.value]])])]),C(n(Ne),{class:"flex flex-col sm:flex-row justify-end items-stretch sm:items-center gap-3"},{default:D(()=>[C(n(X),{label:"Cancel",variant:"outline",size:"small",class:"rounded-sm w-full sm:w-auto",onClick:a}),C(n(X),{label:"Mark as Delivered",variant:"primary",size:"small",class:"rounded-sm w-full sm:w-auto !bg-green-600 !hover:bg-green-700 !border-green-600",disabled:!l.value||!c.value,onClick:i},null,8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]))}},Si={class:"space-y-4"},Ai={__name:"CloseAsLostModal",props:{show:{type:Boolean,required:!0}},emits:["confirm","cancel"],setup(t,{emit:y}){const s=t,d=y,l=A(""),o=A("");ye(()=>s.show,i=>{i&&(l.value="",o.value="")});const c=()=>{l.value&&d("confirm",{reason:l.value,notes:o.value})},r=()=>{d("cancel")},m=i=>{i||r()};return(i,a)=>(p(),H(n(Le),{open:t.show,"onUpdate:open":m},{default:D(()=>[C(n(De),null,{default:D(()=>[C(n(Te),{class:"fixed inset-0 z-50 bg-black/50"}),C(n(Ie),{class:"w-full sm:max-w-lg"},{default:D(()=>[C(n(Oe),null,{default:D(()=>[C(n(qe),null,{default:D(()=>[...a[2]||(a[2]=[W("Close as Lost",-1)])]),_:1}),C(n(ze),null,{default:D(()=>[...a[3]||(a[3]=[W("Document why this opportunity didn't close",-1)])]),_:1})]),_:1}),e("div",Si,[e("div",null,[a[5]||(a[5]=e("label",{class:"block label-upper mb-2"},"Reason",-1)),Z(e("select",{"onUpdate:modelValue":a[0]||(a[0]=u=>l.value=u),class:"input"},[...a[4]||(a[4]=[e("option",{value:""},"Select a reason...",-1),e("option",{value:"Not interested"},"Not interested",-1),e("option",{value:"Budget constraints"},"Budget constraints",-1),e("option",{value:"Found better price"},"Found better price at competitor",-1),e("option",{value:"No response"},"Customer not responding",-1),e("option",{value:"Wrong timing"},"Timing not right",-1),e("option",{value:"Other"},"Other",-1)])],512),[[we,l.value]])]),e("div",null,[a[6]||(a[6]=e("label",{class:"block label-upper mb-2"},"Additional Notes",-1)),Z(e("textarea",{"onUpdate:modelValue":a[1]||(a[1]=u=>o.value=u),rows:"4",placeholder:"Add any relevant details about why this opportunity was lost...",class:"input resize-none"},null,512),[[ce,o.value]])])]),C(n(Ne),{class:"flex flex-col sm:flex-row justify-end items-stretch sm:items-center gap-3"},{default:D(()=>[C(n(X),{label:"Cancel",variant:"outline",size:"small",class:"rounded-sm w-full sm:w-auto",onClick:r}),C(n(X),{label:"Close as Lost",variant:"primary",size:"small",class:"rounded-sm w-full sm:w-auto !bg-red-600 !hover:bg-red-700 !border-red-600",disabled:!l.value,onClick:c},null,8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]))}},Di={__name:"RequalifyAsLeadModal",props:{show:{type:Boolean,required:!0}},emits:["confirm","cancel"],setup(t,{emit:y}){const s=y,d=l=>{l||s("cancel")};return(l,o)=>(p(),H(n(Le),{open:t.show,"onUpdate:open":d},{default:D(()=>[C(n(De),null,{default:D(()=>[C(n(Te),{class:"fixed inset-0 z-50 bg-black/50"}),C(n(Ie),{class:"w-full sm:max-w-lg"},{default:D(()=>[C(n(Oe),null,{default:D(()=>[C(n(qe),null,{default:D(()=>[...o[2]||(o[2]=[W("Requalify as Lead",-1)])]),_:1}),C(n(ze),null,{default:D(()=>[...o[3]||(o[3]=[W("This will convert the opportunity back to a lead. Some data will be lost.",-1)])]),_:1})]),_:1}),o[4]||(o[4]=e("div",{class:"space-y-6 max-h-[60vh] overflow-y-auto"},[e("div",{class:"flex items-start gap-4 mb-6"},[e("div",{class:"flex-shrink-0"},[e("div",{class:"w-12 h-12 rounded-sm bg-yellow-100 flex items-center justify-center border border-yellow-200"},[e("i",{class:"fa-solid fa-exclamation-triangle text-yellow-600 text-xl"})])]),e("div",{class:"flex-1"},[e("p",{class:"text-meta"}," Requalifying this opportunity will reset its stage and remove negotiation history. ")])]),e("div",null,[e("h4",{class:"text-sm font-bold text-red-700 mb-3 flex items-center gap-2"},[e("i",{class:"fa-solid fa-times-circle"}),W(" What will be lost ")]),e("ul",{class:"space-y-2 text-sm text-body"},[e("li",{class:"flex items-start gap-2"},[e("i",{class:"fa-solid fa-minus text-red-500 text-xs mt-1"}),e("span",null,"Opportunity stage and expected close date")]),e("li",{class:"flex items-start gap-2"},[e("i",{class:"fa-solid fa-minus text-red-500 text-xs mt-1"}),e("span",null,"Opportunity value and negotiation history")]),e("li",{class:"flex items-start gap-2"},[e("i",{class:"fa-solid fa-minus text-red-500 text-xs mt-1"}),e("span",null,"Stock or configured vehicles added to the opportunity")]),e("li",{class:"flex items-start gap-2"},[e("i",{class:"fa-solid fa-minus text-red-500 text-xs mt-1"}),e("span",null,"Offer history and negotiation data")])])]),e("div",null,[e("h4",{class:"text-sm font-bold text-green-700 mb-3 flex items-center gap-2"},[e("i",{class:"fa-solid fa-check-circle"}),W(" What will be kept ")]),e("ul",{class:"space-y-2 text-sm text-body"},[e("li",{class:"flex items-start gap-2"},[e("i",{class:"fa-solid fa-check text-green-500 text-xs mt-1"}),e("span",null,"Customer information and contact details")]),e("li",{class:"flex items-start gap-2"},[e("i",{class:"fa-solid fa-check text-green-500 text-xs mt-1"}),e("span",null,"Original requested car details")]),e("li",{class:"flex items-start gap-2"},[e("i",{class:"fa-solid fa-check text-green-500 text-xs mt-1"}),e("span",null,"All activities (notes, calls, emails, etc.)")])])]),e("div",{class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},[e("p",{class:"text-sm text-yellow-800"},[e("i",{class:"fa-solid fa-info-circle mr-2"}),W(" This action cannot be undone. The opportunity will be permanently removed and replaced with a new lead. ")])])],-1)),C(n(Ne),{class:"flex flex-col sm:flex-row justify-end items-stretch sm:items-center gap-3"},{default:D(()=>[C(n(X),{label:"Cancel",variant:"outline",size:"small",class:"rounded-sm w-full sm:w-auto",onClick:o[0]||(o[0]=c=>l.$emit("cancel"))}),C(n(X),{label:"Confirm Requalification",variant:"primary",size:"small",class:"rounded-sm w-full sm:w-auto !bg-yellow-600 !hover:bg-yellow-700 !border-yellow-600",onClick:o[1]||(o[1]=c=>l.$emit("confirm"))})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]))}},Ti={key:0,class:"bg-green-50/50 border border-green-100 rounded-lg p-4"},Ii={class:"flex gap-3"},Oi={key:0,class:"space-y-3"},qi={class:"flex items-center gap-2 pb-2 border-b border"},Ni={class:"font-semibold text-heading text-fluid-sm"},Li={key:0,class:"flex justify-end"},Ei={__name:"OpportunityManagementWidget",props:{opportunity:{type:Object,required:!0},scheduledAppointment:{type:Object,default:null},activities:{type:Array,default:()=>[]}},emits:["vehicle-selected","offer-created","appointment-scheduled"],setup(t,{emit:y}){const s=t,d=y,l=nt(),o=Ye(),c=A(!1),r=A(!1),m=A(!1),i=A(!1),a=A(!1),u=A(!1),f=A(!1),g=A(!1),$=A(!1),I=A(!1),N=A([]),w=S(()=>{var Q,R;return((Q=s.opportunity)==null?void 0:Q.displayStage)||((R=s.opportunity)==null?void 0:R.stage)||"Qualified"});S(()=>ut(w.value,"opportunity"));function h(Q){return Q?new Date(Q).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):""}const v={"schedule-appointment":()=>{c.value=!0},"view-or-schedule-appointment":()=>{s.scheduledAppointment?$.value=!0:c.value=!0},"select-vehicle":()=>{f.value=!0},"create-offer":()=>{!s.opportunity.selectedVehicle&&!s.opportunity.vehicle?f.value=!0:r.value=!0},"call-prospect":()=>{g.value=!0},"follow-up-offer":()=>{g.value=!0},"request-decision":()=>{g.value=!0},"finalize-contract":()=>{i.value=!0},"schedule-delivery":()=>{a.value=!0},"confirm-delivery":()=>{a.value=!0},"collect-feedback":()=>{g.value=!0},reschedule:()=>{I.value=!0},"cancel-appointment":()=>{confirm("Are you sure you want to cancel this appointment?")&&E()},"close-won":()=>{i.value=!0},"add-offer":()=>{r.value=!0},"add-contract":()=>{i.value=!0},"extend-deadline":()=>{g.value=!0},"close-lost":()=>{m.value=!0},reopen:()=>{ve()},requalify:()=>{u.value=!0}},{primaryAction:x,secondaryActions:L,activeTaskWidget:z,taskWidgetTitle:P,isClosed:ee}=Qa(Me(s,"opportunity"),Me(s,"scheduledAppointment"),Me(s,"activities"),v,h);function ne(Q){}function J(){}function F(Q){f.value=!1,d("vehicle-selected",Q),setTimeout(()=>{r.value=!0},300)}function U(Q){r.value=!1,d("offer-created",Q)}function M(Q){c.value=!1,d("appointment-scheduled",{...Q,opportunityId:s.opportunity.id,customer:s.opportunity.customer.name})}function E(){s.scheduledAppointment&&d("appointment-cancelled",s.scheduledAppointment.id)}function V(Q){i.value=!1,o.updateOpportunity(s.opportunity.id,{stage:"Closed Won",contractDate:Q.contractDate})}function j(Q){a.value=!1,o.addActivity(s.opportunity.id,{type:"delivery",user:"You",action:"marked as delivered",data:Q})}function de(Q){m.value=!1,o.updateOpportunity(s.opportunity.id,{stage:"Closed Lost",lossReason:Q})}function ve(){o.updateOpportunity(s.opportunity.id,{stage:"Qualified"})}function be(Q){u.value=!1,l.push(`/customer/${Q.id}?type=lead`)}function me(Q){$.value=!1}function ge(Q){I.value=!1}function he(Q){o.updateOpportunity(s.opportunity.id,{callbackDate:Q.callbackDate})}function xe(Q){o.updateOpportunity(s.opportunity.id,{stage:"Closed Lost",lossReason:Q.reason||"Multiple no-shows (NS3)"})}return lt(async()=>{try{const R=(await bt({})).data||[];N.value=R.filter(ae=>ae.stockDays!==null&&ae.stockDays!==void 0).slice(0,5)}catch(Q){console.error("Failed to load recommended cars:",Q),N.value=[]}}),(Q,R)=>(p(),b(pe,null,[C(St,{task:t.opportunity,"container-class":"mb-8"},{"closed-state":D(()=>[n(ee)&&!n(z)?(p(),b("div",Ti,[R[15]||(R[15]=e("div",{class:"flex justify-between items-start mb-3"},[e("div",null,[e("h4",{class:"font-bold text-heading text-fluid-sm"},"Opportunity Closed"),e("p",{class:"text-fluid-xs text-gray-500 mt-0.5"}," This opportunity has been closed. Reopen it to restart the management process, or requalify as a lead. ")])],-1)),e("div",Ii,[C(n(X),{variant:"primary",size:"small",onClick:ve,class:"flex items-center gap-2 bg-green-600 hover:bg-green-700"},{default:D(()=>[...R[13]||(R[13]=[e("span",null,"Reopen",-1),e("i",{class:"fa-solid fa-rotate-left"},null,-1)])]),_:1}),C(n(X),{variant:"outline",size:"small",onClick:R[0]||(R[0]=ae=>u.value=!0),class:"flex items-center gap-2 bg-white hover:bg-yellow-50 text-yellow-700 border-yellow-300"},{default:D(()=>[...R[14]||(R[14]=[e("span",null,"Requalify as Lead",-1),e("i",{class:"fa-solid fa-arrow-left"},null,-1)])]),_:1})])])):T("",!0)]),"primary-action":D(()=>[!n(ee)&&n(x)?(p(),H(At,{key:0,action:n(x),"color-scheme":n(x).colorScheme,onActionClicked:R[1]||(R[1]=ae=>n(x).handler())},null,8,["action","color-scheme"])):T("",!0)]),"task-widgets":D(()=>[n(z)&&n(z).component?(p(),b("div",Oi,[e("div",qi,[R[16]||(R[16]=e("i",{class:"fa-solid fa-clipboard-check text-blue-600 text-sm"},null,-1)),e("h5",Ni,O(n(P)),1)]),(p(),H(Vt(n(z).component),Rt(n(z).props,{onClose:J,onSetCallback:he,onAutoCloseLost:xe}),null,16))])):T("",!0)]),"secondary-actions":D(()=>[n(L).length>0?(p(),b("div",Li,[C(Ja,{actions:n(L),onActionSelected:ne},null,8,["actions"])])):T("",!0)]),_:1},8,["task"]),c.value?(p(),H(rs,{key:0,show:c.value,customer:t.opportunity.customer,assignee:t.opportunity.assignee,"disabled-fields":["customer"],onCreate:M,onCancel:R[2]||(R[2]=ae=>c.value=!1)},null,8,["show","customer","assignee"])):T("",!0),f.value?(p(),H(bi,{key:1,opportunity:t.opportunity,"requested-car":t.opportunity.requestedCar,"recommended-cars":N.value,onVehicleSelected:F,onClose:R[3]||(R[3]=ae=>f.value=!1)},null,8,["opportunity","requested-car","recommended-cars"])):T("",!0),r.value?(p(),H(as,{key:2,opportunity:t.opportunity,vehicle:t.opportunity.selectedVehicle||t.opportunity.vehicle||t.opportunity.requestedCar,onOfferCreated:U,onClose:R[4]||(R[4]=ae=>r.value=!1)},null,8,["opportunity","vehicle"])):T("",!0),i.value?(p(),H(wi,{key:3,opportunity:t.opportunity,onContractSet:V,onClose:R[5]||(R[5]=ae=>i.value=!1)},null,8,["opportunity"])):T("",!0),a.value?(p(),H($i,{key:4,opportunity:t.opportunity,onDelivered:j,onClose:R[6]||(R[6]=ae=>a.value=!1)},null,8,["opportunity"])):T("",!0),m.value?(p(),H(Ai,{key:5,opportunity:t.opportunity,onClosed:de,onClose:R[7]||(R[7]=ae=>m.value=!1)},null,8,["opportunity"])):T("",!0),u.value?(p(),H(Di,{key:6,opportunity:t.opportunity,onRequalified:be,onClose:R[8]||(R[8]=ae=>u.value=!1)},null,8,["opportunity"])):T("",!0),g.value?(p(),H(is,{key:7,onClose:R[9]||(R[9]=ae=>g.value=!1)})):T("",!0),$.value&&t.scheduledAppointment?(p(),H(ds,{key:8,show:$.value,event:t.scheduledAppointment,onClose:R[10]||(R[10]=ae=>$.value=!1),onEdit:R[11]||(R[11]=ae=>{$.value=!1,I.value=!0}),onDelete:me},null,8,["show","event"])):T("",!0),I.value&&t.scheduledAppointment?(p(),H(us,{key:9,show:I.value,event:t.scheduledAppointment,customer:t.opportunity.customer,"disabled-fields":["customer"],onSave:ge,onCancel:R[12]||(R[12]=ae=>I.value=!1)},null,8,["show","event","customer"])):T("",!0)],64))}};function Bi(t){const y=je(),s=Ye(),d=S(()=>t.value?t.value.type==="lead"?ka:Ei:null),l=S(()=>t.value?t.value.type==="lead"?{currentActivities:S(()=>y.currentLeadActivities),addActivity:(c,r)=>y.addActivity(c,r),updateActivity:(c,r,m)=>y.updateActivity(c,r,m),deleteActivity:(c,r)=>y.deleteActivity(c,r),updateLead:(c,r)=>y.updateLead(c,r),loadLeadById:c=>y.fetchLeadById(c)}:{currentActivities:S(()=>s.currentOpportunityActivities),addActivity:(c,r)=>s.addActivity(c,r),updateActivity:(c,r,m)=>s.updateActivity(c,r,m),deleteActivity:(c,r)=>s.deleteActivity(c,r),addVehicle:(c,r)=>s.addVehicle(c,r),createOffer:(c,r)=>s.createOffer(c,r),updateOpportunity:(c,r)=>s.updateOpportunity(c,r),loadOpportunityById:c=>s.fetchOpportunityById(c)}:null),o=S(()=>t.value?{overviewActions:["financing","tradein","purchase"],tabActions:["note","call","email","sms","whatsapp","attachment"]}:{overviewActions:[],tabActions:[]});return{managementWidget:d,storeAdapter:l,addNewConfig:o}}function Mi(){const t=a=>{if(!a)return"No deadline";const u=mt(a);return u.type==="overdue"?"OVERDUE":u.type==="today"||u.type==="urgent"?u.relativeTime:ft(a)},y=a=>{const u=a.type==="lead"?a.requestedCar:a.vehicle;return!u||!u.type?null:{New:{type:"new",label:"New"},"New 0km":{type:"0km",label:"New 0km"},Used:{type:"used",label:"Used"},Demo:{type:"demo",label:"Demo"}}[u.type]||{type:u.type.toLowerCase(),label:u.type}},s=a=>a?{new:"bg-green-50 text-green-700","0km":"bg-blue-50 text-blue-700",used:"bg-orange-50 text-orange-700",demo:"bg-purple-50 text-purple-700"}[a.type]||"bg-gray-50 text-gray-700":"",d=a=>{if(!a||!a.assignee)return{name:"Unassigned",initials:"?"};const u=a.assigneeInitials||a.assignee.split(" ").map(f=>f[0]).join("");return{name:a.assignee,initials:u}},l=a=>{if(!a||!a.customer||!a.customer.address)return null;const f=a.customer.address.split(",");return f.length>1&&f[f.length-1].trim().replace(/^\d+\s*/,"").trim()||null};return{getDateDisplay:t,getVehicleType:y,getVehicleTypeBadgeClass:s,getOwnerInfo:d,getCustomerCity:l,getLocationDisplay:a=>{const u=l(a),f=a.source||"Unknown";return u?`${u} â€¢ ${f}`:f},getAssigneeInitials:a=>{if(!a)return"?";const u=a.split(" ");return u.length>=2?(u[0][0]+u[u.length-1][0]).toUpperCase():a.substring(0,2).toUpperCase()},getVehicleStatusDisplay:a=>{const u=a.type==="lead"?a.requestedCar:a.vehicle;if(!u)return"No vehicle";const f=y(a),g=f?f.label:u.type||"Unknown";let $="";return u.kilometers!==void 0&&u.kilometers!==null&&(u.kilometers>=1e3?$=`${(u.kilometers/1e3).toFixed(0)}k`:$=`${u.kilometers}`),$?`${g} / ${$}`:g},getTaskStatusDisplay:a=>a.type==="lead"?a.status||"Unknown":a.stage||"Unknown",getStageBadgeClass:vt,getUnselectedClass:a=>a.type==="lead"?"bg-white border border-gray-200 hover:border-blue-300":"bg-white border border-gray-200 hover:border-purple-300"}}function Ui(t){const y=je(),s=Ye(),d=Ae(),l=S(()=>{const m=(t.value?y.leads:y.leads.filter(u=>!u.isDisqualified)).map(u=>{const f=pt(u,"lead"),g={...u,type:"lead",compositeId:`lead-${u.id}`,displayStage:f};return!g.customer&&u.customer&&(g.customer=u.customer),g}),i=s.opportunities.map(u=>{const f={...u,type:"opportunity",compositeId:`opportunity-${u.id}`};return!f.customer&&u.customer&&(f.customer=u.customer),f});let a=[];return d.isOperator()?a=m:d.isSalesman()?a=i:a=[...m,...i],a}),o=(r,m)=>m==="all"?r:r.filter(i=>i.type===m),c=S(()=>{const r=l.value.some(i=>i.type==="lead"),m=l.value.some(i=>i.type==="opportunity");return r&&m});return{allTasks:l,filterByType:o,shouldShowTypeFilter:c}}function Fi(){const t=Ae(),y=We(),s=Se();return{sortTasks:(l,o)=>{if(o==="none")return[...l].sort((c,r)=>{const m=new Date(c.lastActivity||c.createdAt||0);return new Date(r.lastActivity||r.createdAt||0)-m});if(o==="urgent-first")return s.getSetting("urgencyEnabled")!==!1?[...l.map(m=>{if(m.type==="lead"&&!m.urgencyScore){const i=wt(m);return{...m,urgencyScore:i.score,urgencyLevel:i.level}}return m})].sort((m,i)=>{if(m.type==="lead"&&i.type==="lead"){const f=m.urgencyScore||0,g=i.urgencyScore||0;if(f!==g)return g-f;const $=new Date(m.createdAt||0);return new Date(i.createdAt||0)-$}if(m.type==="lead"&&i.type==="opportunity")return-1;if(m.type==="opportunity"&&i.type==="lead")return 1;if(m.priority==="Hot"&&i.priority!=="Hot")return-1;if(m.priority!=="Hot"&&i.priority==="Hot")return 1;const a=new Date(m.lastActivity||m.createdAt||0);return new Date(i.lastActivity||i.createdAt||0)-a}):[...l].sort((r,m)=>{if(r.priority==="Hot"&&m.priority!=="Hot")return-1;if(r.priority!=="Hot"&&m.priority==="Hot")return 1;const i=new Date(r.lastActivity||r.createdAt||0);return new Date(m.lastActivity||m.createdAt||0)-i});if(o==="assigned-to-me"){const c=t.currentUser.name;return[...l.filter(m=>m.assignee===c)].sort((m,i)=>{const a=new Date(m.lastActivity||m.createdAt||0);return new Date(i.lastActivity||i.createdAt||0)-a})}if(o==="assigned-to-my-team"){const c=t.currentUser;let r=[];return c.role==="manager"?r=y.users.map(i=>i.name):c.role==="salesman"?r=y.users.filter(i=>i.role==="salesman").map(i=>i.name):c.role==="operator"&&(r=y.users.filter(i=>i.role==="operator").map(i=>i.name)),[...l.filter(i=>r.includes(i.assignee))].sort((i,a)=>{const u=new Date(i.lastActivity||i.createdAt||0);return new Date(a.lastActivity||a.createdAt||0)-u})}return l}}}const Vi={class:"h-full flex flex-col lg:flex-row overflow-hidden bg-surface"},Ri={key:0,class:"flex-1 flex flex-col lg:flex-row overflow-hidden min-w-0"},ji={key:0,class:"flex items-center gap-2"},Wi={class:"w-3 h-3 rounded-full bg-black text-white font-medium flex items-center justify-center text-[6px] shrink-0"},zi={class:"text-gray-600 font-medium"},Hi={key:1},Pi={key:0},Qi={key:1},Yi={key:2},Ki={key:1,class:"hidden lg:flex flex-1 flex-col overflow-hidden lg:border-l border"},Gi={key:1,class:"flex-1 flex flex-col lg:flex-row overflow-hidden min-w-0"},Ji={__name:"Tasks",setup(t){const y=jt(),s=nt(),d=je(),l=Ye();Ae(),We();const o=Se(),{getDateDisplay:c,getVehicleType:r,getVehicleTypeBadgeClass:m,getOwnerInfo:i,getCustomerCity:a,getAssigneeInitials:u,getUnselectedClass:f}=Mi(),g=A(localStorage.getItem("tasksViewMode")||"table"),$=A(""),I=S(()=>y.query.highlight||null);ye(g,q=>{localStorage.setItem("tasksViewMode",q)});const N=(q,Y="")=>{g.value;const te=U.value;if(g.value=q,q==="card"&&Y&&($.value=Y),q==="table"&&te)$.value="",s.push({path:"/tasks",query:{highlight:te.compositeId}});else if(q==="card"&&I.value){const[ie,B]=I.value.split("-");s.push({path:`/tasks/${B}`,query:{type:ie}})}else q==="card"&&!I.value&&!U.value&&s.push({path:"/tasks"})},w=A("all"),h=A("none"),v=A(!1),x=A(null);A(!1);const L=A(!1),z=A(null),{allTasks:P,filterByType:ee,shouldShowTypeFilter:ne}=Ui(v),{sortTasks:J}=Fi(),F=S(()=>{let q=ee(P.value,w.value);return q=J(q,h.value),q}),U=S(()=>{if(!y.params.id)return null;const q=parseInt(y.params.id);if(isNaN(q))return null;const Y=y.query.type;if(Y){const re=`${Y}-${q}`;return P.value.find(le=>le.compositeId===re)||null}const te=w.value!=="all"?P.value.filter(re=>re.type===w.value):P.value,ie=`lead-${q}`,B=`opportunity-${q}`,G=te.find(re=>re.compositeId===ie||re.compositeId===B);return G||P.value.find(re=>re.compositeId===ie||re.compositeId===B)||null});S(()=>U.value?U.value.type==="lead"?d.currentLeadActivities:l.currentOpportunityActivities:[]);const M=Bi(U),E=M.managementWidget,V=M.storeAdapter,j=M.addNewConfig,de=f;lt(()=>{d.fetchLeads(),l.fetchOpportunities();const q=y.params.id;q&&ve(q)}),ye(()=>y.params.id,q=>{q&&ve(q)}),ye(U,q=>{q&&(q.type==="lead"?d.fetchLeadById(q.id):l.fetchOpportunityById(q.id))},{immediate:!0});const ve=q=>{const Y=parseInt(q),te=P.value.find(ie=>ie.id===Y);te&&(te.type==="lead"?d.fetchLeadById(Y):l.fetchOpportunityById(Y))},be=q=>{const[Y,te]=q.split("-"),ie=P.value.find(B=>B.compositeId===q);g.value="card",ie&&ie.customer&&ie.customer.name?$.value=ie.customer.name:$.value=te,s.push({path:`/tasks/${te}`,query:{type:Y}})},me=()=>{s.push({path:"/tasks"})},ge=q=>{x.value=x.value===q?null:q},he=q=>{z.value=q,L.value=!0,x.value=null},xe=q=>{h.value=q},Q=async q=>{if(!z.value)return;const Y=z.value,te=q.name;Y.type==="lead"?await d.updateLead(Y.id,{assignee:te,assigneeType:q.type,teamId:q.type==="team"?q.id:null}):Y.type==="opportunity"&&await l.updateOpportunity(Y.id,{assignee:te,assigneeType:q.type,teamId:q.type==="team"?q.id:null}),L.value=!1,z.value=null},R=async q=>{x.value=null,q.type==="lead"?await d.updateLead(q.id,{priority:"Hot"}):q.type==="opportunity"&&await l.updateOpportunity(q.id,{priority:"Hot"})},ae=async q=>{x.value=null,q.type==="lead"?await d.updateLead(q.id,{priority:"Normal"}):q.type==="opportunity"&&await l.updateOpportunity(q.id,{priority:"Normal"})},$e=async q=>{if(x.value=null,q.type==="lead")try{const Y=q.displayStage||q.stage||Be.NEW,te=Be.NEW,ie=Ze(Y,te);if(ie){const{updates:B,activities:G}=ie(q);await d.updateLead(q.id,B);for(const re of G)await d.addActivity(q.id,re)}else await d.updateLead(q.id,{isDisqualified:!1,disqualifyReason:null,disqualifyCategory:null,isDuplicate:!1,stage:"Open Lead",status:"Open",nextActionDue:null,scheduledAppointment:null}),await d.addActivity(q.id,{type:"note",user:"You",action:"reopened lead",content:"Lead has been reopened for qualification"});await d.fetchLeadById(q.id)}catch(Y){console.error("Failed to reopen lead:",Y)}},Fe=q=>{const Y=[];return q.type==="lead"&&q.isDisqualified===!0&&Y.push({key:"reopen",label:"Reopen Lead",onClick:()=>$e(q)}),Y.push({key:"reassign",label:"Reassign",onClick:()=>he(q)}),q.priority!=="Hot"?Y.push({key:"mark-hot",label:"Mark as hot",onClick:()=>R(q)}):Y.push({key:"unmark-hot",label:"Unmark as hot",onClick:()=>ae(q)}),Y};return(q,Y)=>{var te,ie;return p(),b("div",Vi,[C(yn,{show:!!U.value,"back-label":"Back to task list",onBack:me},null,8,["show"]),g.value==="card"?(p(),b("div",Ri,[e("div",{class:K(["flex flex-col overflow-hidden",U.value?"hidden lg:flex shrink-0":"w-full lg:w-auto lg:shrink-0"])},[C(Qs,{title:"Tasks",items:F.value,"selected-id":(te=U.value)==null?void 0:te.compositeId,"type-filter":w.value,"view-mode":g.value,"initial-search-query":$.value,onViewChange:N,"selected-class":B=>B.type==="lead"?"bg-surface border-2 border-blue-500 shadow-md":"bg-surface border-2 border-purple-500 shadow-md","unselected-class":n(de),"open-menu-id":x.value,getName:B=>{const G=B.customer;return G&&G.name?G.name:G&&!G.name&&G.email&&G.email.split("@")[0]||"Unknown"},getInitials:B=>{const G=B.customer;return G&&G.initials?G.initials:G&&G.name&&G.name.split(" ").map(le=>le[0]).filter(Boolean).join("").toUpperCase().slice(0,2)||"?"},getVehicleInfo:B=>{if(B.type==="lead"){if(!B.requestedCar)return"No vehicle specified";const le=B.requestedCar,Ee=[`${le.brand} ${le.model}`];return le.kilometers!==void 0&&le.kilometers!==null&&Ee.push(`${le.kilometers} km`),le.status&&Ee.push(le.status),Ee.join(" â€¢ ")}const G=B.vehicle||B.requestedCar;if(!G)return"No vehicle specified";const re=[`${G.brand} ${G.model}`];return G.kilometers!==void 0&&G.kilometers!==null&&re.push(`${G.kilometers} km`),G.status&&re.push(G.status),re.join(" â€¢ ")},avatarClass:B=>B.type==="lead"?"bg-orange-100 text-orange-600":"bg-purple-100 text-purple-600","get-menu-items":Fe,"show-mobile-close":!1,onSelect:be,onMenuClick:ge,onMenuClose:Y[0]||(Y[0]=B=>x.value=null),onClose:me,"show-type-filter":n(ne),onFilterChange:Y[1]||(Y[1]=B=>w.value=B),onSortChange:xe},{badges:D(({item:B})=>[B&&B.type?(p(),H(n(Pe),{key:0,text:B.type==="lead"?"Lead":"Opportunity",size:"small",theme:B.type==="lead"?"blue":"gray"},null,8,["text","theme"])):T("",!0),B&&B.type==="lead"&&n(o).getSetting("urgencyEnabled")!==!1&&B.urgencyLevel?(p(),H(n(Pe),{key:1,text:`${n(kt)(B.urgencyLevel)} ${B.urgencyLevel}`,size:"small",class:K(n(Ct)(B.urgencyLevel))},null,8,["text","class"])):T("",!0),B&&B.priority==="Hot"&&(n(o).getSetting("urgencyEnabled")===!1||B.type!=="lead")?(p(),H(n(Pe),{key:2,text:"HOT",size:"small",theme:"red"})):T("",!0)]),location:D(({item:B})=>[W(O(n(a)(B)||"Unknown"),1)]),source:D(({item:B})=>{var G;return[W(O(B.source||((G=B.customer)==null?void 0:G.source)||"Unknown"),1)]}),owner:D(({item:B})=>[B.assignee?(p(),b("div",ji,[e("div",Wi,O(n(u)(B.assignee)),1),e("span",zi,O(B.assignee),1)])):(p(),b("span",Hi,"Unassigned"))]),dates:D(({item:B})=>[B.type==="lead"&&B.nextActionDue?(p(),b("span",Pi,"Due: "+O(n(c)(B.nextActionDue)),1)):B.type==="opportunity"&&B.nextActionDue?(p(),b("span",Qi,"Due: "+O(n(c)(B.nextActionDue)),1)):(p(),b("span",Yi,"Due: No deadline"))]),_:1},8,["items","selected-id","type-filter","view-mode","initial-search-query","selected-class","unselected-class","open-menu-id","getName","getInitials","getVehicleInfo","avatarClass","show-type-filter"])],2),U.value?(p(),H(it,{key:0,task:U.value,"management-widget":n(E),"store-adapter":n(V),"add-new-config":n(j)},null,8,["task","management-widget","store-adapter","add-new-config"])):T("",!0),U.value?T("",!0):(p(),b("div",Ki,[...Y[6]||(Y[6]=[Qe('<div class="flex-1 flex items-center justify-center p-8" data-v-74c8e906><div class="text-center max-w-sm" data-v-74c8e906><div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-surfaceSecondary flex items-center justify-center" data-v-74c8e906><i class="fa-solid fa-tasks text-2xl text-sub" data-v-74c8e906></i></div><h3 class="text-content-bold mb-2" data-v-74c8e906>No task selected</h3><p class="text-meta" data-v-74c8e906>Select a task from the list to view its details and manage activities</p></div></div>',1)])]))])):T("",!0),g.value==="table"?(p(),b("div",Gi,[C(an,{tasks:F.value,"current-task-id":(ie=U.value)==null?void 0:ie.compositeId,"highlight-id":I.value,"type-filter":w.value,"sort-option":h.value,"show-type-filter":n(ne),"show-closed":v.value,"show-mobile-close":!1,"open-menu-id":x.value,"get-vehicle-type":n(r),"get-vehicle-type-badge-class":n(m),"get-owner-info":n(i),"get-stage-badge-class":n(vt),"view-mode":g.value,onSelect:be,onMenuClick:ge,onMenuClose:Y[2]||(Y[2]=B=>x.value=null),onFilterChange:Y[3]||(Y[3]=B=>w.value=B),onSortChange:xe,onToggleClosed:Y[4]||(Y[4]=B=>v.value=B),onReassign:he,onClose:me,onViewChange:N,class:K(U.value?"hidden lg:flex shrink-0":"flex-1 w-full")},null,8,["tasks","current-task-id","highlight-id","type-filter","sort-option","show-type-filter","show-closed","open-menu-id","get-vehicle-type","get-vehicle-type-badge-class","get-owner-info","get-stage-badge-class","view-mode","class"]),U.value?(p(),H(it,{key:0,task:U.value,"management-widget":n(E),"store-adapter":n(V),"add-new-config":n(j)},null,8,["task","management-widget","store-adapter","add-new-config"])):T("",!0)])):T("",!0),C(gt,{show:L.value,onClose:Y[5]||(Y[5]=B=>L.value=!1),onConfirm:Q},null,8,["show"])])}}},dr=st(Ji,[["__scopeId","data-v-74c8e906"]]);export{dr as default};
