import{n as F,f as j,F as z,L as O,g as K,h as L,K as W,d as q}from"./toggle-group-item.vue_vue_type_script_setup_true_lang-Csij51_o-BDHqZScF.js";import{u as H,c as C,r as E,l as V,m as P,d as u,o as n,e as s,g as A,p as v,v as U,j as G,N as k,F as D,i as S,t as w,y as o,k as T,s as m,x as B,B as b}from"./index-Db_3peLd.js";import{u as I}from"./users-Dyw3oNPt.js";const J={class:"space-y-4"},Q={class:"grid grid-cols-2 gap-4"},R=["disabled"],X=["disabled"],Y={label:"Teams"},Z=["value"],_={label:"Users"},ee=["value"],te={key:0,class:"text-fluid-xs text-sub mt-1"},le=["value"],se={key:0,class:"flex flex-col sm:flex-row justify-end items-stretch sm:items-center gap-3 pt-2"},ae={__name:"CreateEventForm",props:{customer:{type:Object,default:null},assignee:{type:String,default:null},disabledFields:{type:Array,default:()=>[]},initialDate:{type:String,default:""},dealerships:{type:Array,default:()=>[]},showActions:{type:Boolean,default:!0},resetTrigger:{type:[Boolean,Number,String],default:null}},emits:["create","cancel"],setup(i,{emit:x}){const a=i,f=x,c=H(),g=I(),y=C(()=>g.assignableUsers||[]),p=C(()=>g.assignableTeams||[]),r=C(()=>l.value.assignee&&l.value.assignee.startsWith("team-")),l=E({type:"test-drive",title:"",date:"",time:"",customer:"",assignee:"",dealership:""});function N(){var e,t;const d=a.assignee||`user-${((e=c.currentUser)==null?void 0:e.id)||1}`;l.value={type:"test-drive",title:"",date:a.initialDate||"",time:"",customer:((t=a.customer)==null?void 0:t.name)||"",assignee:d,dealership:""}}V(()=>a.resetTrigger,()=>{N()},{immediate:!0}),V(()=>[a.customer,a.initialDate],()=>{var d;(d=a.customer)!=null&&d.name&&(l.value.customer=a.customer.name),a.initialDate&&(l.value.date=a.initialDate)}),P(()=>{var d,e;l.value.assignee||(l.value.assignee=a.assignee||`user-${((d=c.currentUser)==null?void 0:d.id)||1}`),(e=a.customer)!=null&&e.name&&!l.value.customer&&(l.value.customer=a.customer.name)});const $=()=>{l.value.title&&l.value.date&&f("create",{...l.value})},M=()=>{f("cancel")};return(d,e)=>(n(),u("div",J,[s("div",null,[e[8]||(e[8]=s("label",{class:"block label-upper mb-2"},"Event Type",-1)),v(s("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>l.value.type=t),class:"input"},[...e[7]||(e[7]=[G('<option value="test-drive">Test Drive</option><option value="appointment">Dealership Visit</option><option value="offsite">Offsite Visit</option><option value="workshop">Workshop</option><option value="call">Call</option><option value="delivery">Delivery</option><option value="meeting">Meeting</option>',7)])],512),[[U,l.value.type]])]),s("div",null,[e[9]||(e[9]=s("label",{class:"block label-upper mb-2"},"Title",-1)),v(s("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>l.value.title=t),type:"text",placeholder:"Event title...",class:"input"},null,512),[[k,l.value.title]])]),s("div",Q,[s("div",null,[e[10]||(e[10]=s("label",{class:"block label-upper mb-2"},"Date",-1)),v(s("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>l.value.date=t),type:"date",class:"input"},null,512),[[k,l.value.date]])]),s("div",null,[e[11]||(e[11]=s("label",{class:"block label-upper mb-2"},"Time",-1)),v(s("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>l.value.time=t),type:"time",class:"input"},null,512),[[k,l.value.time]])])]),s("div",null,[e[12]||(e[12]=s("label",{class:"block label-upper mb-2"},"Customer",-1)),v(s("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>l.value.customer=t),type:"text",placeholder:"Customer name...",class:"input",disabled:i.disabledFields.includes("customer")},null,8,R),[[k,l.value.customer]])]),s("div",null,[e[14]||(e[14]=s("label",{class:"block label-upper mb-2"},"Assign to",-1)),v(s("select",{"onUpdate:modelValue":e[5]||(e[5]=t=>l.value.assignee=t),class:"input",disabled:i.disabledFields.includes("assignee")},[s("optgroup",Y,[(n(!0),u(D,null,S(p.value,t=>(n(),u("option",{key:`team-${t.id}`,value:`team-${t.id}`},w(t.name)+" Team ",9,Z))),128))]),s("optgroup",_,[(n(!0),u(D,null,S(y.value,t=>{var h;return n(),u("option",{key:`user-${t.id}`,value:`user-${t.id}`},w(t.name)+w(t.id===((h=o(c).currentUser)==null?void 0:h.id)?" (Me)":""),9,ee)}),128))])],8,X),[[U,l.value.assignee]]),r.value?(n(),u("p",te,[...e[13]||(e[13]=[s("i",{class:"fa-solid fa-users text-sub"},null,-1),T(" Any available team member will be assigned ",-1)])])):A("",!0)]),s("div",null,[e[16]||(e[16]=s("label",{class:"block label-upper mb-2"},"Dealership",-1)),v(s("select",{"onUpdate:modelValue":e[6]||(e[6]=t=>l.value.dealership=t),class:"input"},[e[15]||(e[15]=s("option",{value:""},"Select dealership...",-1)),(n(!0),u(D,null,S(i.dealerships,t=>(n(),u("option",{key:t,value:t},w(t),9,le))),128))],512),[[U,l.value.dealership]])]),i.showActions?(n(),u("div",se,[m(o(F),{label:"Cancel",variant:"outline",size:"small",class:"rounded-sm w-full sm:w-auto",onClick:M}),m(o(F),{label:"Create Event",variant:"primary",size:"small",class:"rounded-sm w-full sm:w-auto !bg-brand-red !hover:bg-brand-red-dark !text-white !border-brand-red",onClick:$})])):A("",!0)]))}},ue={__name:"CreateEventModal",props:{show:{type:Boolean,required:!0},initialDate:{type:String,default:""},dealerships:{type:Array,default:()=>[]},customer:{type:Object,default:null},assignee:{type:String,default:null},disabledFields:{type:Array,default:()=>[]}},emits:["create","cancel"],setup(i,{emit:x}){const a=i,f=x,c=E(0);V(()=>a.show,p=>{p&&(c.value+=1)});const g=p=>{p||y()},y=()=>{f("cancel")};return(p,r)=>(n(),B(o(q),{open:i.show,"onUpdate:open":g},{default:b(()=>[m(o(j),null,{default:b(()=>[m(o(z),{class:"fixed inset-0 z-50 bg-black/50"}),m(o(O),{class:"w-full sm:max-w-lg"},{default:b(()=>[m(o(K),null,{default:b(()=>[m(o(L),null,{default:b(()=>[...r[1]||(r[1]=[T("Create New Event",-1)])]),_:1}),m(o(W),null,{default:b(()=>[...r[2]||(r[2]=[T("Fill in the details for the new event.",-1)])]),_:1})]),_:1}),(n(),B(ae,{key:c.value,customer:i.customer,assignee:i.assignee,"disabled-fields":i.disabledFields,"initial-date":i.initialDate,dealerships:i.dealerships,"show-actions":!0,"reset-trigger":i.show,onCreate:r[0]||(r[0]=l=>p.$emit("create",l)),onCancel:y},null,8,["customer","assignee","disabled-fields","initial-date","dealerships","reset-trigger"]))]),_:1})]),_:1})]),_:1},8,["open"]))}};export{ue as _,ae as a};
