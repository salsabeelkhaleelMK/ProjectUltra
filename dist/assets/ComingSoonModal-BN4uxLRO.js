import{r as D,d as n,o as l,e,g as f,n as A,t as m,C as se,z as $,w as R,j as T,F,i as z,c as E,Z as xe,l as j,G as le,B as O,k as K,A as J,V as ve,h as he,p as I,y as Z,m as S,$ as ke,U as we,L as $e,H as W}from"./index-DhXdPUMX.js";import{_ as Ce}from"./ReassignUserModal-D0SwpBMR.js";import{_ as Se}from"./CreateEventModal-BDHz8pKw.js";import{_ as Ae}from"./ModalShell-CHgAd1m8.js";const De={class:"w-full"},Te={class:"flex items-center justify-between gap-3 md:gap-4"},Oe={class:"flex items-center gap-3 md:gap-4 flex-1"},qe={class:"min-w-0 flex-1"},Ne={class:"flex items-center gap-2"},Ee={class:"heading-main truncate"},Ve={class:"flex flex-wrap items-center gap-2 mt-1"},Ie={class:"flex items-center gap-1 ml-2"},Fe={class:"relative"},Ue={key:0,class:"absolute top-full right-0 mt-2 w-48 bg-white border border-gray-200 rounded-xl shadow-lg shadow-gray-100/50 z-50 overflow-hidden flex flex-col p-1"},Me={key:0,class:"border-t border-gray-100 my-1"},je={key:0,class:"mt-4 pt-4 border-t-2 border-dashed border-gray-300 animate-fade-in relative"},We={class:"flex items-center gap-4"},Le={class:"flex flex-wrap items-center gap-x-6 gap-y-2"},Be={class:"flex items-center gap-2"},Pe={class:"text-xs text-gray-900 font-medium"},Re={class:"flex items-center gap-2"},ze={class:"text-xs text-gray-900 font-medium"},Ye={class:"flex items-center gap-2"},Ke={class:"w-6 h-6 rounded bg-gray-100 flex items-center justify-center shrink-0"},He={key:0,class:"fa-solid fa-map-marker-alt text-gray-500 text-[10px]"},Qe={key:1,class:"fa-regular fa-calendar text-gray-500 text-[10px]"},Ge={class:"text-xs text-gray-900 font-medium"},Je={key:0,class:"absolute -bottom-6 left-0 px-2 py-1 bg-gray-900 text-white text-[10px] rounded shadow-lg whitespace-nowrap"},Ze={__name:"ContactInfo",props:{initials:{type:String,required:!0},name:{type:String,required:!0},avatarColorClass:{type:String,default:"bg-orange-100 text-orange-600"},email:{type:String,required:!0},phone:{type:String,required:!0},thirdFieldValue:{type:String,required:!0},emailLabel:{type:String,default:"Email"},phoneLabel:{type:String,default:"Phone"},thirdFieldLabel:{type:String,default:"Expected Close"},taskType:{type:String,default:"lead"}},emits:["action"],setup(t,{emit:g}){const s={mounted(i,u){i.clickOutsideEvent=h=>{i===h.target||i.contains(h.target)||u.value()},document.addEventListener("click",i.clickOutsideEvent)},unmounted(i){document.removeEventListener("click",i.clickOutsideEvent)}},y=g,a=D(!1),o=D(!1),p=D(null),d=i=>{o.value=!1,y("action",i)},r=async(i,u)=>{try{await navigator.clipboard.writeText(i),p.value=u,setTimeout(()=>{p.value=null},1500)}catch(h){console.error("Failed to copy:",h)}};return(i,u)=>(l(),n("div",De,[e("div",Te,[e("div",Oe,[e("div",{class:A(["w-12 h-12 rounded-full flex items-center justify-center text-lg font-bold border-2 border-white shadow-sm shrink-0",t.avatarColorClass])},m(t.initials),3),e("div",qe,[e("div",Ne,[e("h1",Ee,m(t.name),1),se(i.$slots,"name-action")]),e("div",Ve,[se(i.$slots,"tags")])])]),e("div",Ie,[e("div",Fe,[e("button",{onClick:u[0]||(u[0]=R(h=>o.value=!o.value,["stop"])),class:"w-9 h-9 flex items-center justify-center bg-blue-600 hover:bg-blue-700 text-white rounded-lg shrink-0 transition-colors"},[...u[14]||(u[14]=[e("i",{class:"fa-solid fa-plus text-sm"},null,-1)])]),o.value?$((l(),n("div",Ue,[e("button",{onClick:u[1]||(u[1]=h=>d("note")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Note "),e("button",{onClick:u[2]||(u[2]=h=>d("financing")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Financing "),e("button",{onClick:u[3]||(u[3]=h=>d("tradein")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Trade-in "),e("button",{onClick:u[4]||(u[4]=h=>d("purchase")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Purchase "),e("button",{onClick:u[5]||(u[5]=h=>d("attachment")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Attachment "),u[19]||(u[19]=e("div",{class:"border-t border-gray-100 my-1"},null,-1)),e("button",{onClick:u[6]||(u[6]=h=>d("whatsapp")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...u[15]||(u[15]=[e("i",{class:"fa-brands fa-whatsapp text-xs text-gray-400"},null,-1),T(" WhatsApp msg ",-1)])]),e("button",{onClick:u[7]||(u[7]=h=>d("email")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...u[16]||(u[16]=[e("i",{class:"fa-regular fa-envelope text-xs text-gray-400"},null,-1),T(" Email ",-1)])]),e("button",{onClick:u[8]||(u[8]=h=>d("sms")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...u[17]||(u[17]=[e("i",{class:"fa-solid fa-comment-dots text-xs text-gray-400"},null,-1),T(" SMS ",-1)])]),e("button",{onClick:u[9]||(u[9]=h=>d("call")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...u[18]||(u[18]=[e("i",{class:"fa-solid fa-phone text-xs text-gray-400"},null,-1),T(" Call ",-1)])]),t.taskType==="opportunity"?(l(),n("div",Me)):f("",!0),t.taskType==="opportunity"?(l(),n("button",{key:1,onClick:u[10]||(u[10]=h=>d("appointment")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Appointment ")):f("",!0)])),[[s,()=>o.value=!1]]):f("",!0)]),e("button",{onClick:u[11]||(u[11]=h=>a.value=!a.value),class:"w-9 h-9 flex items-center justify-center bg-white border border-gray-200 rounded-lg hover:bg-gray-50 shrink-0"},[e("i",{class:A(["fa-solid fa-chevron-up text-sm transition-transform duration-200",{"rotate-180":a.value}])},null,2)])])]),a.value?(l(),n("div",je,[e("div",We,[e("div",Le,[e("div",Be,[u[21]||(u[21]=e("div",{class:"w-6 h-6 rounded bg-gray-100 flex items-center justify-center shrink-0"},[e("i",{class:"fa-regular fa-envelope text-gray-500 text-[10px]"})],-1)),e("span",Pe,m(t.email),1),e("button",{onClick:u[12]||(u[12]=R(h=>r(t.email,"email"),["stop"])),class:"w-5 h-5 flex items-center justify-center rounded hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors shrink-0",title:"Copy email"},[...u[20]||(u[20]=[e("i",{class:"fa-regular fa-copy text-[10px]"},null,-1)])])]),e("div",Re,[u[23]||(u[23]=e("div",{class:"w-6 h-6 rounded bg-gray-100 flex items-center justify-center shrink-0"},[e("i",{class:"fa-solid fa-phone text-gray-500 text-[10px]"})],-1)),e("span",ze,m(t.phone),1),e("button",{onClick:u[13]||(u[13]=R(h=>r(t.phone,"phone"),["stop"])),class:"w-5 h-5 flex items-center justify-center rounded hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors shrink-0",title:"Copy phone"},[...u[22]||(u[22]=[e("i",{class:"fa-regular fa-copy text-[10px]"},null,-1)])])]),e("div",Ye,[e("div",Ke,[t.thirdFieldLabel.toLowerCase().includes("address")?(l(),n("i",He)):(l(),n("i",Qe))]),e("span",Ge,m(t.thirdFieldValue),1)])])]),p.value?(l(),n("div",Je,m(p.value==="email"?"Email":"Phone")+" copied! ",1)):f("",!0)])):f("",!0)]))}},Xe={class:"flex gap-0 md:gap-8 text-base font-medium text-slate-500 py-1"},_e=["onClick"],et={class:"hidden md:inline whitespace-nowrap"},tt={__name:"Tabs",props:{modelValue:{type:String,required:!0},tabs:{type:Array,required:!0}},emits:["update:modelValue"],setup(t){const g={overview:"fa-solid fa-house",note:"fa-solid fa-note-sticky",communication:"fa-solid fa-comments",attachment:"fa-solid fa-paperclip"},s=y=>g[y]||"fa-solid fa-circle";return(y,a)=>(l(),n("div",Xe,[(l(!0),n(F,null,z(t.tabs,o=>(l(),n("div",{key:o.key,onClick:p=>y.$emit("update:modelValue",o.key),class:A(["flex-1 md:flex-none pb-2 border-b-2 cursor-pointer transition-colors flex items-center justify-center gap-1.5",t.modelValue===o.key?"border-slate-900 text-slate-900":"border-transparent hover:text-slate-700 hover:border-slate-200"])},[e("i",{class:A([s(o.key),"text-base md:text-base"])},null,2),e("span",et,m(o.label),1),o.count!==void 0?(l(),n("span",{key:0,class:A(["inline-flex items-center justify-center px-1.5 md:px-2 py-0.5 rounded-full text-xs font-semibold",t.modelValue===o.key?"bg-gray-200 text-gray-700":"bg-gray-100 text-gray-500"])},m(o.count),3)):f("",!0)],10,_e))),128))]))}},at={class:"metadata-bar w-full"},st={class:"flex items-center gap-1.5 md:gap-2 px-2 md:px-3 py-1.5"},lt={class:"flex items-center gap-1.5"},nt={class:"text-[10px] md:text-xs font-bold text-gray-800"},ot={class:"flex items-center gap-1.5 md:gap-2 px-2 md:px-3 py-1.5"},it={class:"flex items-center gap-1.5 md:gap-2 px-2 md:px-3 py-1.5"},rt={class:"text-[10px] md:text-xs font-bold text-gray-800"},dt={__name:"StageOwnerBar",props:{stage:{type:String,required:!0},owner:{type:String,required:!0},source:{type:String,default:""},deliverySubstatus:{type:String,default:null}},emits:["reassign"],setup(t){const g=t,s=E(()=>g.deliverySubstatus?xe(g.deliverySubstatus):"");return(y,a)=>(l(),n("div",at,[e("div",st,[a[1]||(a[1]=e("span",{class:"label-upper text-[9px] md:text-xs"},"Stage",-1)),e("div",lt,[e("span",nt,m(t.stage),1),t.deliverySubstatus?(l(),n("span",{key:0,class:A(["text-[9px] md:text-[10px] px-1.5 md:px-2 py-0.5 rounded-full font-medium border",s.value])},m(t.deliverySubstatus),3)):f("",!0)])]),a[5]||(a[5]=e("div",{class:"metadata-divider"},null,-1)),e("div",ot,[a[2]||(a[2]=e("span",{class:"label-upper text-[9px] md:text-xs"},"Owner",-1)),e("button",{onClick:a[0]||(a[0]=o=>y.$emit("reassign")),class:"text-[10px] md:text-xs font-bold text-blue-600 hover:text-blue-700 hover:underline transition-colors cursor-pointer"},m(t.owner),1)]),t.source?(l(),n(F,{key:0},[a[4]||(a[4]=e("div",{class:"metadata-divider"},null,-1)),e("div",it,[a[3]||(a[3]=e("span",{class:"label-upper text-[9px] md:text-xs"},"Source",-1)),e("span",rt,m(t.source),1)])],64)):f("",!0)]))}},ut={key:0,class:"flex-grow border-t border-gray-200"},ct={key:0,class:"absolute top-full right-0 md:left-1/2 md:-translate-x-1/2 mt-2 w-48 bg-white border border-gray-200 rounded-xl shadow-lg shadow-gray-100/50 z-10 overflow-hidden flex flex-col p-1"},mt={key:0,class:"border-t border-gray-100 my-1"},ft={key:1,class:"flex-grow border-t border-gray-200"},yt={__name:"AddNewButton",props:{show:{type:Boolean,default:!0},actions:{type:Array,default:()=>["note","financing","tradein","attachment","email","whatsapp","sms"]},activeTab:{type:String,default:"overview"},inline:{type:Boolean,default:!1}},emits:["action"],setup(t,{emit:g}){const s={mounted(x,c){x.clickOutsideEvent=b=>{x===b.target||x.contains(b.target)||c.value()},document.addEventListener("click",x.clickOutsideEvent)},unmounted(x){document.removeEventListener("click",x.clickOutsideEvent)}},y=t,a=g,o=D(!1),p=E(()=>y.inline?"bg-blue-600 hover:bg-blue-700 text-white font-medium w-9 h-9 rounded-lg shadow-sm transition-all flex items-center justify-center z-20 relative":"bg-gray-50 hover:bg-white border border-gray-200 text-slate-700 font-medium w-9 h-9 rounded-full text-sm shadow-sm transition-all flex items-center justify-center z-20 relative"),d={note:"note",attachment:"attachment",email:"communication",whatsapp:"communication",sms:"communication"},r=E(()=>{if(!y.activeTab||y.activeTab==="overview")return y.actions.filter(c=>!d[c]);const x=Object.entries(d).filter(([,c])=>c===y.activeTab).map(([c])=>c);return y.actions.filter(c=>x.includes(c))}),i=E(()=>r.value.some(x=>["email","whatsapp","sms"].includes(x))),u=E(()=>r.value.some(x=>["addVehicle","configureVehicle"].includes(x))),h=E(()=>r.value.some(x=>["note","financing","tradein","attachment","requestedCar","purchase"].includes(x))),N=x=>{o.value=!1,a("action",x)};return(x,c)=>t.show?(l(),n("div",{key:0,class:A(["relative flex items-center",t.inline?"justify-end mb-0 py-0":"py-1 mb-4"])},[t.inline?f("",!0):(l(),n("div",ut)),e("div",{class:A(["relative",t.inline?"mx-0":"mx-4"])},[e("button",{onClick:c[0]||(c[0]=R(b=>o.value=!o.value,["stop"])),class:A(p.value)},[...c[12]||(c[12]=[e("i",{class:"fa-solid fa-plus text-xs"},null,-1)])],2),o.value?$((l(),n("div",ct,[u.value?(l(),n(F,{key:0},[r.value.includes("addVehicle")?(l(),n("button",{key:0,onClick:c[1]||(c[1]=b=>N("addVehicle")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Add Vehicle ")):f("",!0),r.value.includes("configureVehicle")?(l(),n("button",{key:1,onClick:c[2]||(c[2]=b=>N("configureVehicle")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Configure Vehicle ")):f("",!0)],64)):f("",!0),h.value?(l(),n(F,{key:1},[u.value?(l(),n("div",mt)):f("",!0),r.value.includes("note")?(l(),n("button",{key:1,onClick:c[3]||(c[3]=b=>N("note")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Note ")):f("",!0),r.value.includes("financing")?(l(),n("button",{key:2,onClick:c[4]||(c[4]=b=>N("financing")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Financing ")):f("",!0),r.value.includes("tradein")?(l(),n("button",{key:3,onClick:c[5]||(c[5]=b=>N("tradein")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Trade-in ")):f("",!0),r.value.includes("requestedCar")?(l(),n("button",{key:4,onClick:c[6]||(c[6]=b=>N("requestedCar")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Requested car ")):f("",!0),r.value.includes("purchase")?(l(),n("button",{key:5,onClick:c[7]||(c[7]=b=>N("purchase")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Purchase ")):f("",!0),r.value.includes("attachment")?(l(),n("button",{key:6,onClick:c[8]||(c[8]=b=>N("attachment")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Attachment ")):f("",!0)],64)):f("",!0),i.value?(l(),n(F,{key:2},[c[16]||(c[16]=e("div",{class:"border-t border-gray-100 my-1"},null,-1)),r.value.includes("email")?(l(),n("button",{key:0,onClick:c[9]||(c[9]=b=>N("email")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...c[13]||(c[13]=[e("i",{class:"fa-regular fa-envelope text-xs text-gray-400"},null,-1),T(" Send Email ",-1)])])):f("",!0),r.value.includes("whatsapp")?(l(),n("button",{key:1,onClick:c[10]||(c[10]=b=>N("whatsapp")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...c[14]||(c[14]=[e("i",{class:"fa-brands fa-whatsapp text-xs text-gray-400"},null,-1),T(" Send WhatsApp ",-1)])])):f("",!0),r.value.includes("sms")?(l(),n("button",{key:2,onClick:c[11]||(c[11]=b=>N("sms")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...c[15]||(c[15]=[e("i",{class:"fa-solid fa-comment-dots text-xs text-gray-400"},null,-1),T(" Send SMS ",-1)])])):f("",!0)],64)):f("",!0)])),[[s,()=>o.value=!1]]):f("",!0)],2),t.inline?f("",!0):(l(),n("div",ft))],2)):f("",!0)}},gt={class:"bg-purple-50/50 border border-purple-100 rounded-lg p-4"},pt={class:"flex items-start gap-3"},bt={class:"flex-1 min-w-0"},xt={class:"font-bold text-sm text-slate-800 mb-2"},vt={class:"space-y-1.5 text-xs text-gray-600"},ht={class:"flex items-center gap-2"},kt={class:"flex items-center gap-2"},wt={class:"flex items-center gap-2"},$t={key:0,class:"mt-2"},Ct={__name:"AppointmentWidget",props:{appointmentData:{type:Object,required:!0}},setup(t){const g=t,s=E(()=>g.appointmentData.date?new Date(g.appointmentData.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""),y=E(()=>g.appointmentData.time?g.appointmentData.time:""),a=o=>({scheduled:"bg-blue-100 text-blue-700 border border-blue-200",confirmed:"bg-green-100 text-green-700 border border-green-200",pending:"bg-yellow-100 text-yellow-700 border border-yellow-200",cancelled:"bg-red-100 text-red-700 border border-red-200"})[o==null?void 0:o.toLowerCase()]||"bg-gray-100 text-gray-700 border border-gray-200";return(o,p)=>(l(),n("div",gt,[e("div",pt,[p[3]||(p[3]=e("div",{class:"w-10 h-10 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center shrink-0"},[e("i",{class:"fa-solid fa-calendar text-sm"})],-1)),e("div",bt,[e("h4",xt,m(t.appointmentData.type),1),e("div",vt,[e("div",ht,[p[0]||(p[0]=e("i",{class:"fa-regular fa-calendar text-gray-400"},null,-1)),e("span",null,m(s.value),1)]),e("div",kt,[p[1]||(p[1]=e("i",{class:"fa-regular fa-clock text-gray-400"},null,-1)),e("span",null,m(y.value),1)]),e("div",wt,[p[2]||(p[2]=e("i",{class:"fa-solid fa-user text-gray-400"},null,-1)),e("span",null,m(t.appointmentData.assignee),1)])]),t.appointmentData.status?(l(),n("div",$t,[e("span",{class:A(["inline-flex px-2 py-0.5 rounded text-[10px] font-semibold",a(t.appointmentData.status)])},m(t.appointmentData.status),3)])):f("",!0)])])]))}},St={class:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm flex gap-4 animate-fade-in mb-4 feed-item"},At={class:"flex-1"},Dt={class:"flex items-center gap-2 mb-1"},Tt={class:"text-xs font-bold text-slate-800"},Ot={class:"text-[10px] text-gray-400"},qt={class:"text-[10px] text-gray-400"},Nt={key:0,class:"bg-blue-50 text-blue-600 text-[9px] px-1.5 py-0.5 rounded border border-blue-100"},Et={class:"ml-auto relative"},Vt={key:0,class:"absolute right-0 top-full mt-1 w-32 bg-white border border-gray-200 rounded-lg shadow-lg z-10 overflow-hidden"},It={key:0,class:"text-sm text-slate-700"},Ft={key:1,class:"text-sm text-slate-700 flex items-center gap-2"},Ut={key:2,class:"mt-2"},Mt={key:0},jt={key:1,class:"bg-gray-50 border border-gray-200 rounded-lg p-3"},Wt={key:0},Lt={class:"text-sm font-bold text-slate-800"},Bt={key:0,class:"text-xs text-gray-600 mt-0.5"},Pt={class:"grid grid-cols-2 gap-x-4 gap-y-1 text-xs text-gray-500 mt-2"},Rt={key:0},zt={key:1},Yt={key:2},Kt={key:3},Ht={key:4},Qt={key:1},Gt={class:"text-sm font-bold text-slate-800 mb-2"},Jt={class:"grid grid-cols-2 gap-x-4 gap-y-2 text-xs"},Zt={key:0},Xt={class:"text-slate-700 font-medium ml-1"},_t={key:1},ea={class:"text-slate-700 font-medium ml-1"},ta={key:2},aa={class:"text-slate-700 font-medium ml-1"},sa={key:3},la={class:"text-slate-700 font-medium ml-1"},na={key:4},oa={class:"text-slate-700 font-medium ml-1"},ia={key:5},ra={class:"text-slate-700 font-medium ml-1"},da={key:2,class:"flex items-center gap-3"},ua={key:0,class:"w-16 h-16 bg-gray-200 rounded overflow-hidden flex-shrink-0"},ca=["src"],ma={class:"flex-1"},fa={class:"text-sm font-bold text-slate-800"},ya={class:"text-xs text-gray-500"},ga={key:1,class:"bg-purple-600 text-white text-[10px] font-bold px-2 py-0.5 rounded"},pa={key:3,class:"flex items-center gap-3"},ba={class:"flex-1"},xa={class:"text-sm font-bold text-slate-800"},va={class:"text-xs text-gray-500"},ha={key:0,class:"text-xs text-gray-400 mt-1"},ka={key:1,class:"text-xs text-gray-600 mt-1"},ue={__name:"FeedItemCard",props:{item:{type:Object,required:!0},taskType:{type:String,default:"lead"},customerInitials:{type:String,required:!0}},emits:["edit","delete"],setup(t,{emit:g}){const s=t,y=g,a=D(!1),o={mounted(x,c){x.clickOutsideEvent=b=>{x===b.target||x.contains(b.target)||c.value()},setTimeout(()=>{document.addEventListener("click",x.clickOutsideEvent)},0)},unmounted(x){document.removeEventListener("click",x.clickOutsideEvent)}},p=x=>({note:"fa-regular fa-note-sticky",communication:"fa-solid fa-comment-dots",email:"fa-regular fa-envelope",whatsapp:"fa-brands fa-whatsapp",sms:"fa-solid fa-comment-dots",attachment:"fa-solid fa-paperclip",tradein:"fa-solid fa-car-side",financing:"fa-solid fa-file-invoice-dollar",offer:"fa-solid fa-handshake",purchase:"fa-solid fa-shopping-cart",appointment:"fa-solid fa-calendar"})[x]||"fa-solid fa-circle",d=x=>({note:"bg-orange-100 text-orange-600 border-orange-200",communication:"bg-gray-100 text-gray-600 border-gray-200",email:"bg-blue-100 text-blue-600 border-blue-200",whatsapp:"bg-green-100 text-green-600 border-green-200",sms:"bg-gray-100 text-gray-600 border-gray-200",attachment:"bg-blue-50 text-blue-600 border-blue-100",tradein:"bg-green-50 text-green-600 border-green-100",financing:"bg-purple-50 text-purple-600 border-purple-100",offer:"bg-indigo-50 text-indigo-600 border-indigo-100",purchase:"bg-teal-50 text-teal-600 border-teal-100",appointment:"bg-purple-100 text-purple-600 border-purple-200"})[x]||"bg-gray-100 text-gray-600 border-gray-200",r=x=>{if(!x)return"Just now";const c=new Date(x),q=new Date-c,w=Math.floor(q/6e4),V=Math.floor(w/60),M=Math.floor(V/24);return w<1?"Just now":w<60?`${w} minutes ago`:V<24?`${V} hours ago`:M===1?"Yesterday":M<7?`${M} days ago`:c.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},i=x=>x?new Intl.NumberFormat("en-US").format(x):"0",u=x=>x?new Date(x).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",h=()=>{a.value=!1,y("edit",s.item)},N=()=>{a.value=!1,confirm("Are you sure you want to delete this item?")&&y("delete",s.item)};return(x,c)=>(l(),n("div",St,[e("div",{class:A(["w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold shrink-0 border",d(t.item.type)])},[e("i",{class:A([p(t.item.type),"text-sm"])},null,2)],2),e("div",At,[e("div",Dt,[e("span",Tt,m(t.customerInitials),1),e("span",Ot,m(t.item.action||"added"),1),e("span",qt,"• "+m(r(t.item.timestamp)),1),t.item.autoDetected?(l(),n("span",Nt,"Auto-detected")):f("",!0),e("div",Et,[e("button",{onClick:c[0]||(c[0]=R(b=>a.value=!a.value,["stop"])),class:"text-gray-400 hover:text-gray-600 transition-colors p-1",title:"More actions"},[...c[1]||(c[1]=[e("i",{class:"fa-solid fa-ellipsis-vertical text-sm"},null,-1)])]),a.value?$((l(),n("div",Vt,[e("button",{onClick:h,class:"w-full text-left px-3 py-2 text-xs text-slate-700 hover:bg-gray-50 flex items-center gap-2"},[...c[2]||(c[2]=[e("i",{class:"fa-solid fa-pencil text-gray-400"},null,-1),T(" Edit ",-1)])]),e("button",{onClick:N,class:"w-full text-left px-3 py-2 text-xs text-red-600 hover:bg-red-50 flex items-center gap-2"},[...c[3]||(c[3]=[e("i",{class:"fa-solid fa-trash text-red-400"},null,-1),T(" Delete ",-1)])])])),[[o,()=>a.value=!1]]):f("",!0)])]),t.item.content?(l(),n("div",It,m(t.item.content),1)):f("",!0),t.item.fileName?(l(),n("div",Ft,[c[4]||(c[4]=e("i",{class:"fa-solid fa-paperclip text-gray-400"},null,-1)),e("span",null,m(t.item.fileName),1)])):f("",!0),t.item.data?(l(),n("div",Ut,[t.item.type==="appointment"?(l(),n("div",Mt,[j(Ct,{"appointment-data":t.item.data},null,8,["appointment-data"])])):(l(),n("div",jt,[t.item.type==="tradein"?(l(),n("div",Wt,[e("h4",Lt,m(t.item.data.brand)+" "+m(t.item.data.model),1),t.item.data.version?(l(),n("p",Bt,m(t.item.data.version),1)):f("",!0),e("div",Pt,[t.item.data.year?(l(),n("div",Rt,[c[5]||(c[5]=e("i",{class:"fa-regular fa-calendar mr-1"},null,-1)),T(m(t.item.data.year),1)])):f("",!0),t.item.data.km?(l(),n("div",zt,[c[6]||(c[6]=e("i",{class:"fa-solid fa-road mr-1"},null,-1)),T(m(t.item.data.km)+" km ",1)])):f("",!0),t.item.data.plate?(l(),n("div",Yt,[c[7]||(c[7]=e("i",{class:"fa-solid fa-id-card mr-1"},null,-1)),T(m(t.item.data.plate),1)])):f("",!0),t.item.data.date?(l(),n("div",Kt,[c[8]||(c[8]=e("i",{class:"fa-regular fa-calendar-check mr-1"},null,-1)),T(m(u(t.item.data.date)),1)])):f("",!0),t.item.data.class?(l(),n("div",Ht,[c[9]||(c[9]=e("i",{class:"fa-solid fa-car mr-1"},null,-1)),T(m(t.item.data.class),1)])):f("",!0)])])):t.item.type==="financing"?(l(),n("div",Qt,[e("h4",Gt,m(t.item.data.product),1),e("div",Jt,[t.item.data.provider?(l(),n("div",Zt,[c[10]||(c[10]=e("span",{class:"text-gray-500"},"Provider:",-1)),e("span",Xt,m(t.item.data.provider),1)])):f("",!0),t.item.data.total?(l(),n("div",_t,[c[11]||(c[11]=e("span",{class:"text-gray-500"},"Total:",-1)),e("span",ea,"€"+m(i(t.item.data.total)),1)])):f("",!0),t.item.data.monthly?(l(),n("div",ta,[c[12]||(c[12]=e("span",{class:"text-gray-500"},"Monthly:",-1)),e("span",aa,"€"+m(i(t.item.data.monthly)),1)])):f("",!0),t.item.data.deposit?(l(),n("div",sa,[c[13]||(c[13]=e("span",{class:"text-gray-500"},"Deposit:",-1)),e("span",la,"€"+m(i(t.item.data.deposit)),1)])):f("",!0),t.item.data.startDate?(l(),n("div",na,[c[14]||(c[14]=e("span",{class:"text-gray-500"},"Start:",-1)),e("span",oa,m(u(t.item.data.startDate)),1)])):f("",!0),t.item.data.expDate?(l(),n("div",ia,[c[15]||(c[15]=e("span",{class:"text-gray-500"},"Expires:",-1)),e("span",ra,m(u(t.item.data.expDate)),1)])):f("",!0)])])):t.item.type==="offer"?(l(),n("div",da,[t.item.data.image?(l(),n("div",ua,[e("img",{src:t.item.data.image,alt:"Car",class:"w-full h-full object-cover"},null,8,ca)])):f("",!0),e("div",ma,[e("h4",fa,m(t.item.data.brand)+" "+m(t.item.data.model)+" ("+m(t.item.data.year)+")",1),e("p",ya,"€ "+m(i(t.item.data.price)),1)]),t.item.data.isMainOffer?(l(),n("span",ga,"Main Offer")):f("",!0)])):t.item.type==="purchase"?(l(),n("div",pa,[e("div",ba,[e("h4",xa,m(t.item.data.brand)+" "+m(t.item.data.model)+" ("+m(t.item.data.year)+")",1),e("p",va,"€ "+m(i(t.item.data.price)),1),t.item.data.purchaseDate?(l(),n("p",ha,"Purchased: "+m(u(t.item.data.purchaseDate)),1)):f("",!0),t.item.data.notes?(l(),n("p",ka,m(t.item.data.notes),1)):f("",!0)])])):f("",!0)]))])):f("",!0)])]))}},wa={class:"h-16 px-5 border-b border-gray-100 bg-gray-50/50 flex items-center justify-between gap-3"},$a={class:"flex items-center gap-3"},Ca=["title"],Sa={key:0,class:"fa-solid fa-arrow-left text-sm"},Aa={key:1,class:"fa-solid fa-arrow-right text-sm"},Da={key:2,class:"font-bold text-lg text-gray-800"},Ta={key:0,class:"flex-1 overflow-y-auto px-5 py-6 scrollbar-hide relative"},Oa={key:0,class:"absolute left-[39px] top-0 bottom-0 w-0.5 bg-gray-200 z-0"},qa={key:1,class:"text-center py-8 text-gray-400 relative z-10"},Na={class:"text-sm"},Ea={key:2,class:"space-y-6 relative z-10"},Va={key:0,class:"mb-4 pl-12"},Ia={class:"text-sm font-semibold text-gray-800"},Fa={class:"flex gap-4 relative mb-6"},Ua={class:"flex-1 min-w-0"},Ma={class:"text-sm text-slate-700 leading-snug"},ja={class:"font-bold"},Wa={key:0,class:"mt-2 bg-orange-50/50 border border-orange-100 p-3 rounded-lg text-sm text-gray-700"},La={class:"text-xs text-gray-400 mt-1"},Ba={key:1,class:"flex-1 overflow-y-auto py-6 scrollbar-hide relative flex flex-col items-center"},Pa={key:0,class:"absolute left-1/2 top-0 bottom-0 w-0.5 bg-gray-200 -translate-x-1/2 z-0"},Ra={key:1,class:"space-y-4 relative z-10"},za=["title"],Ya={key:2,class:"text-center py-8 text-gray-400 relative z-10"},Ka={__name:"ActivitySummarySidebar",props:{title:{type:String,default:"Activity summary"},activities:{type:Array,default:()=>[]},emptyMessage:{type:String,default:"No activities yet"},collapsed:{type:Boolean,default:!0},showCollapse:{type:Boolean,default:!0},show:{type:Boolean,default:!0},mobileFullscreen:{type:Boolean,default:!1}},emits:["toggle-collapse","close"],setup(t,{emit:g}){const s=t,y=r=>{const i={call:"fa-solid fa-phone text-blue-600",email:"fa-solid fa-envelope text-green-600",note:"fa-solid fa-sticky-note text-yellow-600",meeting:"fa-solid fa-calendar text-purple-600",task:"fa-solid fa-check-circle text-indigo-600",attachment:"fa-solid fa-paperclip text-gray-600",status:"fa-solid fa-tag text-orange-600",default:"fa-solid fa-circle text-gray-400"};return i[r]||i.default},a=r=>{const i={call:"bg-blue-100 text-blue-600",email:"bg-green-100 text-green-600",note:"bg-yellow-100 text-yellow-600",meeting:"bg-purple-100 text-purple-600",task:"bg-indigo-100 text-indigo-600",attachment:"bg-gray-100 text-gray-600",status:"bg-orange-100 text-orange-600",default:"bg-gray-100 text-gray-400"};return i[r]||i.default},o=r=>{if(!r)return"";const i=new Date(r),u=new Date,h=new Date(u);return h.setDate(h.getDate()-1),i.toDateString()===u.toDateString()?"Today":i.toDateString()===h.toDateString()?"Yesterday":i.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},p=r=>r?new Date(r).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",d=(r,i)=>{if(r===0)return!0;const u=s.activities[r-1];if(!u)return!0;const h=new Date(i.timestamp).toDateString(),N=new Date(u.timestamp).toDateString();return h!==N};return(r,i)=>t.show?(l(),n("div",{key:0,class:A(["bg-white border-l border-gray-200 shrink-0 flex flex-col transition-all duration-300",[t.collapsed?"w-16":"w-80",t.mobileFullscreen?"xl:relative xl:border-l":""]])},[e("div",wa,[e("div",$a,[t.mobileFullscreen?(l(),n("button",{key:0,onClick:i[0]||(i[0]=u=>r.$emit("close")),class:"xl:hidden w-8 h-8 flex items-center justify-center text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"},[...i[2]||(i[2]=[e("i",{class:"fa-solid fa-xmark text-lg"},null,-1)])])):t.showCollapse?(l(),n("button",{key:1,onClick:i[1]||(i[1]=u=>r.$emit("toggle-collapse")),class:"w-8 h-8 flex items-center justify-center rounded-md text-gray-400 hover:text-gray-900 hover:bg-gray-100 transition-colors shrink-0",title:t.collapsed?"Expand sidebar":"Collapse sidebar"},[t.collapsed?(l(),n("i",Sa)):(l(),n("i",Aa))],8,Ca)):f("",!0),t.collapsed?f("",!0):(l(),n("h2",Da,m(t.title),1))])]),t.collapsed?(l(),n("div",Ba,[t.activities.length>0?(l(),n("div",Pa)):f("",!0),t.activities.length>0?(l(),n("div",Ra,[(l(!0),n(F,null,z(t.activities,u=>(l(),n("div",{key:u.id,class:"relative"},[e("div",{class:A(["w-8 h-8 rounded-full flex items-center justify-center shrink-0 z-10 relative bg-white border-2 border-gray-200",a(u.type)]),title:`${u.user} ${u.action}`},[e("i",{class:A([y(u.type),"text-xs"])},null,2)],10,za)]))),128))])):(l(),n("div",Ya,[...i[4]||(i[4]=[e("i",{class:"fa-solid fa-clock text-2xl mb-2"},null,-1)])]))])):(l(),n("div",Ta,[t.activities.length>0?(l(),n("div",Oa)):f("",!0),t.activities.length===0?(l(),n("div",qa,[i[3]||(i[3]=e("i",{class:"fa-solid fa-clock text-4xl mb-2"},null,-1)),e("p",Na,m(t.emptyMessage),1)])):(l(),n("div",Ea,[(l(!0),n(F,null,z(t.activities,(u,h)=>(l(),n(F,{key:u.id},[d(h,u)?(l(),n("div",Va,[e("h3",Ia,m(o(u.timestamp)),1)])):f("",!0),e("div",Fa,[e("div",{class:A(["w-10 h-10 rounded-full flex items-center justify-center shrink-0 z-10 relative bg-white",a(u.type)])},[e("i",{class:A([y(u.type),"text-sm"])},null,2)],2),e("div",Ua,[e("div",Ma,[e("span",ja,m(u.user),1),T(" "+m(u.action),1)]),u.content?(l(),n("div",Wa,m(u.content),1)):f("",!0),e("div",La,m(p(u.timestamp)),1)])])],64))),128))]))]))],2)):f("",!0)}},Ha={class:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm mb-6 animate-fade-in relative"},Qa={class:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3"},Ga={class:"mb-3"},Ja={class:"flex justify-end gap-2"},Za={__name:"CommunicationWidget",props:{type:{type:String,required:!0},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(t,{emit:g}){const s=t,y=g,a=D(""),o=D(""),p=()=>{!a.value.trim()&&!o.value||y("save",{type:"communication",action:`sent via ${s.type}`,content:a.value||`Sent template: ${o.value}`,communicationType:s.type})};return(d,r)=>(l(),n("div",Ha,[r[5]||(r[5]=e("div",{class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-t border-l border-gray-200 rotate-45"},null,-1)),e("h5",Qa,m(t.type==="email"?"Send Email":t.type==="whatsapp"?"Send WhatsApp":t.type==="sms"?"Send SMS":"Send Message"),1),e("div",Ga,[r[4]||(r[4]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Template",-1)),$(e("select",{"onUpdate:modelValue":r[0]||(r[0]=i=>o.value=i),class:"w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500 cursor-pointer"},[...r[3]||(r[3]=[e("option",{value:""},"Select a template...",-1),e("option",null,"Follow-up",-1),e("option",null,"Meeting Confirmation",-1),e("option",null,"Quote Proposal",-1),e("option",null,"Unable to Reach",-1)])],512),[[le,o.value]])]),$(e("textarea",{"onUpdate:modelValue":r[1]||(r[1]=i=>a.value=i),class:"w-full bg-gray-50 border border-gray-200 rounded-lg p-3 text-sm focus:outline-none focus:border-blue-500 resize-none mb-3",rows:"4",placeholder:"Type your message here..."},null,512),[[O,a.value]]),e("div",Ja,[e("button",{onClick:r[2]||(r[2]=i=>d.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:p,class:"bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Send")])]))}},Xa={class:"bg-white border border-gray-200 rounded-xl p-5 shadow-sm mb-6 animate-fade-in relative"},_a={class:"flex justify-between items-center mb-4"},es={class:"text-sm font-bold text-slate-800"},ts={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},as={__name:"NoteWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(t,{emit:g}){const s=t,y=g,a=D("");K(()=>{s.item&&(a.value=s.item.content||"")});const o=()=>{var p,d;a.value.trim()&&y("save",{id:((p=s.item)==null?void 0:p.id)||Date.now(),type:"note",action:s.item?"updated a note":"added a note",content:a.value,timestamp:((d=s.item)==null?void 0:d.timestamp)||new Date().toISOString(),isEdit:!!s.item})};return(p,d)=>(l(),n("div",Xa,[d[5]||(d[5]=e("div",{class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-t border-l border-gray-200 rotate-45"},null,-1)),e("div",_a,[e("h5",es,m(t.item?"Edit Note":"Add Note"),1),e("button",{onClick:d[0]||(d[0]=r=>p.$emit("cancel")),class:"text-gray-400 hover:text-gray-600"},[...d[3]||(d[3]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),e("div",null,[d[4]||(d[4]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Note",-1)),$(e("textarea",{"onUpdate:modelValue":d[1]||(d[1]=r=>a.value=r),rows:"4",class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500 placeholder-gray-400 transition-colors shadow-sm resize-none",placeholder:"Enter your note..."},null,512),[[O,a.value]])]),e("div",ts,[e("button",{onClick:d[2]||(d[2]=r=>p.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:o,class:"bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save")])]))}},ss={class:"bg-white border border-gray-200 rounded-xl p-5 shadow-sm mb-6 animate-fade-in relative"},ls={class:"flex justify-between items-center mb-4"},ns={class:"text-sm font-bold text-slate-800"},os={class:"flex items-center gap-3"},is={key:0,class:"text-sm text-slate-600"},rs={key:1,class:"text-sm text-gray-400"},ds={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},us=["disabled"],cs={__name:"AttachmentWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(t,{emit:g}){const s=t,y=g,a=D(null),o=D("");K(()=>{s.item&&(o.value=s.item.fileName||"")});const p=r=>{const i=r.target.files[0];i&&(a.value=i,o.value=i.name)},d=()=>{var r,i;!a.value&&!s.item||y("save",{id:((r=s.item)==null?void 0:r.id)||Date.now(),type:"attachment",action:s.item?"updated an attachment":"added an attachment",fileName:o.value,timestamp:((i=s.item)==null?void 0:i.timestamp)||new Date().toISOString(),isEdit:!!s.item})};return(r,i)=>(l(),n("div",ss,[i[6]||(i[6]=e("div",{class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-t border-l border-gray-200 rotate-45"},null,-1)),e("div",ls,[e("h5",ns,m(t.item?"Edit Attachment":"Add Attachment"),1),e("button",{onClick:i[0]||(i[0]=u=>r.$emit("cancel")),class:"text-gray-400 hover:text-gray-600"},[...i[3]||(i[3]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),e("div",null,[i[5]||(i[5]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"File",-1)),e("div",os,[e("input",{type:"file",onChange:p,ref:"fileInput",class:"hidden"},null,544),e("button",{onClick:i[1]||(i[1]=u=>r.$refs.fileInput.click()),class:"bg-gray-50 hover:bg-gray-100 border border-gray-300 rounded-md px-4 py-2 text-sm text-slate-700 transition-colors"},[...i[4]||(i[4]=[e("i",{class:"fa-solid fa-paperclip mr-2"},null,-1),T("Choose File ",-1)])]),o.value?(l(),n("span",is,m(o.value),1)):(l(),n("span",rs,"No file selected"))])]),e("div",ds,[e("button",{onClick:i[2]||(i[2]=u=>r.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:d,disabled:!a.value,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save",8,us)])]))}},ms={class:"animate-fade-in"},fs={class:"space-y-4"},ys={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},gs={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ps={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},bs=["disabled"],xs={__name:"FinancingWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:[String,Number],required:!0}},emits:["save","cancel"],setup(t,{emit:g}){const s=t,y=g,a=D({startDate:"",expDate:"",productName:"",deposit:"",loanAmount:""});K(()=>{s.item&&s.item.data&&(a.value={startDate:s.item.data.startDate||"",expDate:s.item.data.expDate||"",productName:s.item.data.product||s.item.data.productName||"",deposit:s.item.data.deposit||"",loanAmount:s.item.data.total||s.item.data.loanAmount||""})});const o=()=>{var p,d;a.value.productName&&y("save",{id:((p=s.item)==null?void 0:p.id)||Date.now(),type:"financing",action:s.item?"updated a financing proposal":"added a financing proposal",data:{product:a.value.productName,provider:"Audi Financial",total:a.value.loanAmount||"0",monthly:Math.round(parseFloat(a.value.loanAmount||0)/36).toString(),startDate:a.value.startDate,expDate:a.value.expDate,deposit:a.value.deposit},timestamp:((d=s.item)==null?void 0:d.timestamp)||new Date().toISOString(),isEdit:!!s.item})};return(p,d)=>(l(),n("div",ms,[e("div",fs,[e("div",ys,[e("div",null,[d[6]||(d[6]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Start date",-1)),$(e("input",{type:"date","onUpdate:modelValue":d[0]||(d[0]=r=>a.value.startDate=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.startDate]])]),e("div",null,[d[7]||(d[7]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Expiration date",-1)),$(e("input",{type:"date","onUpdate:modelValue":d[1]||(d[1]=r=>a.value.expDate=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.expDate]])])]),e("div",null,[d[8]||(d[8]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Financial product name",-1)),$(e("input",{type:"text","onUpdate:modelValue":d[2]||(d[2]=r=>a.value.productName=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.productName]])]),e("div",gs,[e("div",null,[d[9]||(d[9]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Deposit",-1)),$(e("input",{type:"number","onUpdate:modelValue":d[3]||(d[3]=r=>a.value.deposit=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.deposit]])]),e("div",null,[d[10]||(d[10]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Total loan amount",-1)),$(e("input",{type:"number","onUpdate:modelValue":d[4]||(d[4]=r=>a.value.loanAmount=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.loanAmount]])])])]),e("div",ps,[e("button",{onClick:d[5]||(d[5]=r=>p.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:o,disabled:!a.value.productName,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save",8,bs)])]))}},vs={class:"animate-fade-in"},hs={class:"space-y-4"},ks={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ws={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},$s={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},Cs=["disabled"],Ss={__name:"TradeInWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:[String,Number],required:!0}},emits:["save","cancel"],setup(t,{emit:g}){const s=t,y=g,a=D({class:"Car",brand:"",model:"",version:"",km:"",plate:"",date:""});K(()=>{s.item&&s.item.data&&(a.value={class:s.item.data.class||"Car",brand:s.item.data.brand||"",model:s.item.data.model||"",version:s.item.data.version||"",km:s.item.data.km||"",plate:s.item.data.plate||"",date:s.item.data.date||""})});const o=()=>{var p,d;a.value.brand&&y("save",{id:((p=s.item)==null?void 0:p.id)||Date.now(),type:"tradein",action:s.item?"updated a trade-in":"added a trade-in",data:{class:a.value.class,brand:a.value.brand,model:a.value.model||"Unknown Model",year:a.value.date?new Date(a.value.date).getFullYear():"Unknown Year",km:a.value.km||"0",plate:a.value.plate||"",date:a.value.date||""},timestamp:((d=s.item)==null?void 0:d.timestamp)||new Date().toISOString(),isEdit:!!s.item})};return(p,d)=>(l(),n("div",vs,[e("div",hs,[e("div",null,[d[9]||(d[9]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Class",-1)),$(e("select",{"onUpdate:modelValue":d[0]||(d[0]=r=>a.value.class=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},[...d[8]||(d[8]=[e("option",{value:"Car"},"Car",-1),e("option",{value:"Motorcycle"},"Motorcycle",-1),e("option",{value:"Truck"},"Truck",-1)])],512),[[le,a.value.class]])]),e("div",ks,[e("div",null,[d[10]||(d[10]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Brand",-1)),$(e("input",{type:"text","onUpdate:modelValue":d[1]||(d[1]=r=>a.value.brand=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.brand]])]),e("div",null,[d[11]||(d[11]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Model",-1)),$(e("input",{type:"text","onUpdate:modelValue":d[2]||(d[2]=r=>a.value.model=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.model]])])]),e("div",null,[d[12]||(d[12]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Version",-1)),$(e("input",{type:"text","onUpdate:modelValue":d[3]||(d[3]=r=>a.value.version=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.version]])]),e("div",ws,[e("div",null,[d[13]||(d[13]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Km",-1)),$(e("input",{type:"number","onUpdate:modelValue":d[4]||(d[4]=r=>a.value.km=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.km]])]),e("div",null,[d[14]||(d[14]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Plate",-1)),$(e("input",{type:"text","onUpdate:modelValue":d[5]||(d[5]=r=>a.value.plate=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.plate]])])]),e("div",null,[d[15]||(d[15]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Registration date",-1)),$(e("input",{type:"date","onUpdate:modelValue":d[6]||(d[6]=r=>a.value.date=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.date]])])]),e("div",$s,[e("button",{onClick:d[7]||(d[7]=r=>p.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:o,disabled:!a.value.brand,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save",8,Cs)])]))}},As={class:"bg-white rounded-xl p-5 mb-6 animate-fade-in relative"},Ds={class:"flex justify-between items-center mb-4"},Ts={class:"text-sm font-bold text-slate-800"},Os={key:0,class:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200"},qs={class:"flex items-center gap-3"},Ns={class:"w-16 h-16 bg-gray-200 rounded overflow-hidden flex-shrink-0"},Es=["src"],Vs={key:1,class:"fa-solid fa-car text-gray-400 w-full h-full flex items-center justify-center"},Is={class:"font-bold text-sm text-gray-800"},Fs={class:"text-xs text-gray-500"},Us={class:"space-y-4"},Ms={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},js={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},Ws=["disabled"],Ls={__name:"OfferWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"opportunity"},taskId:{type:Number,required:!0},selectedVehicle:{type:Object,default:null}},emits:["save","cancel"],setup(t,{emit:g}){const s=t,y=g,a=D({price:0,financingType:"",downPayment:0,monthlyPayment:0,term:36,interestRate:3.5,deliveryDate:"",validUntil:"",notes:"",brand:"",model:"",year:"",image:""});K(()=>{if(s.selectedVehicle){a.value.price=s.selectedVehicle.price||0,a.value.brand=s.selectedVehicle.brand||"",a.value.model=s.selectedVehicle.model||"",a.value.year=s.selectedVehicle.year||"",a.value.image=s.selectedVehicle.image||"";const r=new Date;r.setDate(r.getDate()+30),a.value.validUntil=r.toISOString().split("T")[0]}s.item&&s.item.data&&(a.value={...a.value,...s.item.data,price:s.item.data.price||s.item.data.total||0,financingType:s.item.data.financingType||s.item.data.paymentMethod||"",notes:s.item.data.notes||s.item.data.description||""})}),J(()=>s.selectedVehicle,r=>{r&&!s.item&&(a.value.price=r.price||0,a.value.brand=r.brand||"",a.value.model=r.model||"",a.value.year=r.year||"",a.value.image=r.image||"")});const o=E(()=>a.value.price>0&&a.value.financingType!==""),p=r=>r?r.toLocaleString("en-US"):"0",d=()=>{var i,u;if(!o.value)return;const r={id:((i=s.item)==null?void 0:i.id)||Date.now(),type:"offer",action:s.item?"updated an offer":"created an offer",data:{brand:a.value.brand,model:a.value.model,year:a.value.year,price:a.value.price,total:a.value.price,paymentMethod:a.value.financingType,financingType:a.value.financingType,downPayment:a.value.downPayment,monthlyPayment:a.value.monthlyPayment,term:a.value.term,interestRate:a.value.interestRate,deliveryDate:a.value.deliveryDate,validUntil:a.value.validUntil,notes:a.value.notes,description:a.value.notes,image:a.value.image},timestamp:((u=s.item)==null?void 0:u.timestamp)||new Date().toISOString(),isEdit:!!s.item};y("save",r)};return(r,i)=>(l(),n("div",As,[e("div",Ds,[e("h5",Ts,m(t.item?"Edit Offer":"Create Offer"),1),e("button",{onClick:i[0]||(i[0]=u=>r.$emit("cancel")),class:"text-gray-400 hover:text-gray-600"},[...i[11]||(i[11]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),t.selectedVehicle?(l(),n("div",Os,[i[12]||(i[12]=e("p",{class:"text-xs text-gray-500 mb-2"},"Creating offer for:",-1)),e("div",qs,[e("div",Ns,[t.selectedVehicle.image?(l(),n("img",{key:0,src:t.selectedVehicle.image,alt:"Vehicle",class:"w-full h-full object-cover"},null,8,Es)):(l(),n("i",Vs))]),e("div",null,[e("h4",Is,m(t.selectedVehicle.brand)+" "+m(t.selectedVehicle.model)+" ("+m(t.selectedVehicle.year)+") ",1),e("p",Fs,"Base Price: € "+m(p(t.selectedVehicle.price)),1)])])])):f("",!0),e("div",Us,[e("div",null,[i[13]||(i[13]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},[T(" Offer Price (€) "),e("span",{class:"text-red-500"},"*")],-1)),$(e("input",{type:"number","onUpdate:modelValue":i[1]||(i[1]=u=>a.value.price=u),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500",placeholder:"Enter offer price"},null,512),[[O,a.value.price]])]),e("div",null,[i[15]||(i[15]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},[T(" Payment Method "),e("span",{class:"text-red-500"},"*")],-1)),$(e("select",{"onUpdate:modelValue":i[2]||(i[2]=u=>a.value.financingType=u),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500"},[...i[14]||(i[14]=[e("option",{value:""},"Select payment method",-1),e("option",{value:"cash"},"Cash",-1),e("option",{value:"finance"},"Finance",-1),e("option",{value:"lease"},"Lease",-1)])],512),[[le,a.value.financingType]])]),a.value.financingType==="finance"||a.value.financingType==="lease"?(l(),n("div",Ms,[e("div",null,[i[16]||(i[16]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Down Payment (€)",-1)),$(e("input",{type:"number","onUpdate:modelValue":i[3]||(i[3]=u=>a.value.downPayment=u),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500",placeholder:"0"},null,512),[[O,a.value.downPayment]])]),e("div",null,[i[17]||(i[17]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Monthly Payment (€)",-1)),$(e("input",{type:"number","onUpdate:modelValue":i[4]||(i[4]=u=>a.value.monthlyPayment=u),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500",placeholder:"Calculated automatically"},null,512),[[O,a.value.monthlyPayment]])]),e("div",null,[i[18]||(i[18]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Term (months)",-1)),$(e("input",{type:"number","onUpdate:modelValue":i[5]||(i[5]=u=>a.value.term=u),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500",placeholder:"36"},null,512),[[O,a.value.term]])]),e("div",null,[i[19]||(i[19]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Interest Rate (%)",-1)),$(e("input",{type:"number",step:"0.1","onUpdate:modelValue":i[6]||(i[6]=u=>a.value.interestRate=u),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500",placeholder:"3.5"},null,512),[[O,a.value.interestRate]])])])):f("",!0),e("div",null,[i[20]||(i[20]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Expected Delivery Date",-1)),$(e("input",{type:"date","onUpdate:modelValue":i[7]||(i[7]=u=>a.value.deliveryDate=u),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500"},null,512),[[O,a.value.deliveryDate]])]),e("div",null,[i[21]||(i[21]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Offer Valid Until",-1)),$(e("input",{type:"date","onUpdate:modelValue":i[8]||(i[8]=u=>a.value.validUntil=u),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500"},null,512),[[O,a.value.validUntil]])]),e("div",null,[i[22]||(i[22]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Notes / Special Terms",-1)),$(e("textarea",{"onUpdate:modelValue":i[9]||(i[9]=u=>a.value.notes=u),rows:"3",class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500 resize-none",placeholder:"Any special terms, conditions, or notes about this offer..."},null,512),[[O,a.value.notes]])])]),e("div",js,[e("button",{onClick:i[10]||(i[10]=u=>r.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"}," Cancel "),e("button",{onClick:d,disabled:!o.value,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},m(t.item?"Update Offer":"Create Offer"),9,Ws)])]))}},Bs={key:0,class:"mb-8"},Ps={class:"flex items-center gap-2 mb-4"},Rs={class:"font-bold text-gray-800 text-sm"},zs={class:"bg-white border border-gray-200 rounded-xl shadow-sm mb-6 overflow-hidden"},Ys={class:"p-4"},Ks={class:"flex items-center justify-between"},Hs={class:"flex items-center gap-4"},Qs={class:"w-16 h-12 bg-gray-200 rounded-md overflow-hidden shrink-0 border border-gray-100"},Gs=["src"],Js={key:1,class:"fa-solid fa-car text-3xl text-gray-400 w-full h-full flex items-center justify-center"},Zs={class:"flex items-center gap-2"},Xs={class:"font-bold text-slate-800 text-sm md:text-base"},_s={class:"mt-1.5 flex items-center gap-2"},el={key:0,class:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-green-50 border border-green-100 text-green-700 text-[10px] font-semibold rounded-md"},tl={key:1,class:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-orange-50 border border-orange-100 text-orange-700 text-[10px] font-semibold rounded-md"},al={key:2,class:"hidden sm:flex items-center gap-1.5 bg-gray-100 hover:bg-gray-200 border border-gray-200 text-slate-700 text-xs font-semibold px-3 py-1.5 rounded-full transition-colors group/btn"},sl={class:"flex items-center gap-4"},ll={key:0,class:"text-right"},nl={class:"font-bold text-slate-800"},ol={class:"border-t border-gray-200"},il={class:"font-medium"},rl={key:0,class:"border-t border-gray-100 p-6 bg-gray-50/30 text-sm animate-fade-in"},dl={class:"mb-6"},ul={class:"grid grid-cols-2 md:grid-cols-4 gap-y-4 gap-x-6"},cl={key:0},ml={class:"font-medium text-slate-700"},fl={key:1},yl={class:"font-medium text-slate-700"},gl={key:2},pl={class:"font-medium text-slate-700"},bl={class:"font-medium text-slate-700"},xl={class:"grid grid-cols-2 md:grid-cols-4 gap-y-4 gap-x-6"},vl={key:0},hl={class:"font-medium text-slate-700"},kl={key:1},wl={class:"font-medium text-slate-700"},$l={key:2},Cl={class:"font-medium text-slate-700"},Sl={key:3},Al={class:"font-medium text-slate-700"},Dl={key:4},Tl={class:"font-mono text-xs bg-white border border-gray-200 px-2 py-1 rounded inline-block text-gray-600"},Ol={key:5},ql={class:"font-medium text-slate-700"},Nl={key:0,class:"mt-6 flex justify-end"},El={key:0,class:"border-t border-gray-200 my-6"},Vl={key:1,class:"mb-6 px-6"},Il={class:"bg-white border border-gray-200 rounded-lg p-4"},Fl={class:"text-sm text-slate-700 leading-relaxed"},Ul={__name:"VehicleWidget",props:{show:{type:Boolean,default:!0},label:{type:String,default:"Requested Car"},brand:{type:String,required:!0},model:{type:String,required:!0},year:{type:[Number,String],required:!0},image:{type:String,default:""},price:{type:Number,default:null},requestMessage:{type:String,default:""},requestType:{type:String,default:""},source:{type:String,default:""},dealership:{type:String,default:""},registration:{type:String,default:""},kilometers:{type:Number,default:null},fuelType:{type:String,default:""},gearType:{type:String,default:""},vin:{type:String,default:""},stockDays:{type:Number,default:null},showOpenAd:{type:Boolean,default:!0},showTechnicalSpecs:{type:Boolean,default:!0},channel:{type:String,default:"Email"},adCampaign:{type:String,default:""},expectedPurchaseDate:{type:String,default:""},fiscalEntity:{type:String,default:""},sourceDetails:{type:String,default:""},adMedium:{type:String,default:""},adSource:{type:String,default:""}},setup(t){const g=D(!1),s=a=>new Intl.NumberFormat("en-US").format(a),y=a=>new Intl.NumberFormat("en-US").format(a);return(a,o)=>t.show?(l(),n("div",Bs,[e("div",Ps,[o[1]||(o[1]=e("i",{class:"fa-solid fa-thumbtack text-gray-400 text-xs"},null,-1)),e("h3",Rs,m(t.label),1)]),e("div",zs,[e("div",Ys,[e("div",Ks,[e("div",Hs,[e("div",Qs,[t.image?(l(),n("img",{key:0,src:t.image,alt:"Car",class:"w-full h-full object-cover"},null,8,Gs)):(l(),n("i",Js))]),e("div",null,[e("div",Zs,[e("div",Xs,m(t.brand)+" "+m(t.model)+" ("+m(t.year)+")",1)]),e("div",_s,[t.stockDays!==void 0&&t.stockDays!==null?(l(),n("div",el,[o[2]||(o[2]=e("div",{class:"w-1 h-1 bg-green-500 rounded-full"},null,-1)),T(" In stock ("+m(t.stockDays)+" days) ",1)])):(l(),n("div",tl,[...o[3]||(o[3]=[e("div",{class:"w-1 h-1 bg-orange-500 rounded-full"},null,-1),T(" Out of stock ",-1)])])),t.showOpenAd&&t.price?(l(),n("button",al,[...o[4]||(o[4]=[T(" Open Ad ",-1),e("i",{class:"fa-solid fa-arrow-up-right-from-square text-[10px] text-gray-400 group-hover/btn:text-gray-800"},null,-1)])])):f("",!0)])])]),e("div",sl,[t.price?(l(),n("div",ll,[o[5]||(o[5]=e("div",{class:"text-xs text-gray-500 font-medium mb-0.5"},"Price",-1)),e("div",nl,"€ "+m(s(t.price)),1)])):f("",!0)])])]),e("div",ol,[e("button",{onClick:o[0]||(o[0]=p=>g.value=!g.value),class:"w-full p-3 flex items-center justify-center gap-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-50 transition-colors"},[e("span",il,m(g.value?"Hide":"View")+" Details",1),e("i",{class:A(["fa-solid fa-chevron-down text-xs transition-transform duration-200",{"rotate-180":g.value}])},null,2)])]),g.value?(l(),n("div",rl,[e("div",dl,[o[16]||(o[16]=e("h4",{class:"text-xs font-bold uppercase text-gray-500 tracking-wider mb-4"},"REQUEST DETAILS",-1)),e("div",ul,[t.requestType?(l(),n("div",cl,[o[6]||(o[6]=e("div",{class:"text-xs text-gray-500 mb-1"},"Request type",-1)),e("div",ml,m(t.requestType),1)])):f("",!0),t.source?(l(),n("div",fl,[o[7]||(o[7]=e("div",{class:"text-xs text-gray-500 mb-1"},"Source",-1)),e("div",yl,m(t.source),1)])):f("",!0),e("div",null,[o[8]||(o[8]=e("div",{class:"text-xs text-gray-500 mb-1"},"Source details",-1)),e("div",{class:A(["font-medium",t.sourceDetails?"text-slate-700":"text-gray-400"])},m(t.sourceDetails||"--"),3)]),t.dealership?(l(),n("div",gl,[o[9]||(o[9]=e("div",{class:"text-xs text-gray-500 mb-1"},"Dealership",-1)),e("div",pl,m(t.dealership),1)])):f("",!0),e("div",null,[o[10]||(o[10]=e("div",{class:"text-xs text-gray-500 mb-1"},"Channel",-1)),e("div",bl,m(t.channel||"Email"),1)]),e("div",null,[o[11]||(o[11]=e("div",{class:"text-xs text-gray-500 mb-1"},"AdCampaign",-1)),e("div",{class:A(["font-medium",t.adCampaign?"text-slate-700":"text-gray-400"])},m(t.adCampaign||"--"),3)]),e("div",null,[o[12]||(o[12]=e("div",{class:"text-xs text-gray-500 mb-1"},"AdMedium",-1)),e("div",{class:A(["font-medium",t.adMedium?"text-slate-700":"text-gray-400"])},m(t.adMedium||"--"),3)]),e("div",null,[o[13]||(o[13]=e("div",{class:"text-xs text-gray-500 mb-1"},"AdSource",-1)),e("div",{class:A(["font-medium",t.adSource?"text-slate-700":"text-gray-400"])},m(t.adSource||"--"),3)]),e("div",null,[o[14]||(o[14]=e("div",{class:"text-xs text-gray-500 mb-1"},"Expected purchase date",-1)),e("div",{class:A(["font-medium",t.expectedPurchaseDate?"text-slate-700":"text-gray-400"])},m(t.expectedPurchaseDate||"--"),3)]),e("div",null,[o[15]||(o[15]=e("div",{class:"text-xs text-gray-500 mb-1"},"Fiscal entity",-1)),e("div",{class:A(["font-medium",t.fiscalEntity?"text-slate-700":"text-gray-400"])},m(t.fiscalEntity||"--"),3)])])]),o[26]||(o[26]=e("div",{class:"border-t border-gray-200 my-4"},null,-1)),e("div",null,[o[24]||(o[24]=e("div",{class:"flex justify-between items-center mb-4"},[e("h4",{class:"text-xs font-bold uppercase text-gray-500 tracking-wider"},"VEHICLE DETAILS")],-1)),e("div",xl,[t.registration?(l(),n("div",vl,[o[17]||(o[17]=e("div",{class:"text-xs text-gray-500 mb-1"},"Registration",-1)),e("div",hl,m(t.registration),1)])):f("",!0),t.kilometers!==void 0&&t.kilometers!==null?(l(),n("div",kl,[o[18]||(o[18]=e("div",{class:"text-xs text-gray-500 mb-1"},"Kilometers",-1)),e("div",wl,m(y(t.kilometers))+" Km",1)])):f("",!0),t.fuelType?(l(),n("div",$l,[o[19]||(o[19]=e("div",{class:"text-xs text-gray-500 mb-1"},"Fuel type",-1)),e("div",Cl,m(t.fuelType),1)])):f("",!0),t.gearType?(l(),n("div",Sl,[o[20]||(o[20]=e("div",{class:"text-xs text-gray-500 mb-1"},"Gear type",-1)),e("div",Al,m(t.gearType),1)])):f("",!0),t.vin?(l(),n("div",Dl,[o[21]||(o[21]=e("div",{class:"text-xs text-gray-500 mb-1"},"VIN Number",-1)),e("div",Tl,m(t.vin),1)])):f("",!0),t.dealership?(l(),n("div",Ol,[o[22]||(o[22]=e("div",{class:"text-xs text-gray-500 mb-1"},"Dealership",-1)),e("div",ql,m(t.dealership),1)])):f("",!0)]),t.showTechnicalSpecs?(l(),n("div",Nl,[...o[23]||(o[23]=[e("button",{class:"bg-white border border-gray-200 text-slate-700 hover:text-blue-600 hover:border-blue-200 font-medium px-4 py-2 rounded-lg text-xs transition-colors flex items-center gap-2 group"},[e("i",{class:"fa-solid fa-list-check text-gray-400 group-hover:text-blue-500"}),T(" View technical specs ")],-1)])])):f("",!0)]),t.requestMessage?(l(),n("div",El)):f("",!0),t.requestMessage?(l(),n("div",Vl,[o[25]||(o[25]=e("h4",{class:"text-xs font-bold uppercase text-gray-500 tracking-wider mb-4"},"REQUEST MESSAGE",-1)),e("div",Il,[e("p",Fl,m(t.requestMessage),1)])])):f("",!0)])):f("",!0)])])):f("",!0)}},te={note:"note",communication:"communication",email:"communication",call:"communication",sms:"communication",whatsapp:"communication",attachment:"attachment",document:"attachment",file:"attachment",tradein:"tradein","trade-in":"tradein",financing:"financing",offer:"offers",purchase:"offers",appointment:"appointments",survey:"surveys",default:"overview"};function ce(t){if(!t)return te.default;const g=t.toLowerCase().trim();return te[g]||te.default}function Ml({store:t,taskId:g,getTabForItemType:s,isOverviewModalAction:y}){const a=D(null),o=D(null),p=D("overview"),d=D("email"),r=D([]);J(p,()=>{a.value=null,o.value=null});const i=E(()=>[...t.currentActivities.value,...r.value.filter(q=>!q.activityId)].filter(q=>{const w=s(q.type);return p.value==="overview"?w==="overview":w===p.value}).sort((q,w)=>{const V=new Date(q.timestamp||0);return new Date(w.timestamp||0)-V})),u=b=>(o.value=null,p.value==="overview"&&y&&y(b)?{type:"overview-modal",action:b}:(["email","sms","whatsapp","call"].includes(b)?(d.value=b,a.value="communication"):a.value=b,null)),h=async b=>{var q;if(b.isEdit){const w=r.value.findIndex(V=>V.id===b.id);w>-1&&(r.value[w]={...r.value[w],...b}),(q=o.value)!=null&&q.activityId&&await t.updateActivity(g.value,o.value.activityId,{type:b.communicationType||b.type,user:"You",action:b.action,content:b.content,fileName:b.fileName,data:b.data})}else{const w=b.communicationType||b.type,V=await t.addActivity(g.value,{type:w,user:"You",action:b.action,content:b.content,fileName:b.fileName,data:b.data});r.value.push({id:V.id,type:w==="email"||w==="whatsapp"||w==="sms"?"communication":w,action:b.action,content:b.content,fileName:b.fileName,data:b.data,timestamp:V.timestamp,activityId:V.id})}a.value=null,o.value=null},N=()=>{a.value=null,o.value=null},x=b=>{s(b.type)&&(a.value=b.type==="email"||b.type==="whatsapp"||b.type==="sms"||b.type==="communication"?"communication":b.type,o.value=b)},c=async b=>{try{await t.deleteActivity(g.value,b)}catch(q){throw console.error("Error deleting item:",q),q}};return{activeTab:p,showInlineWidget:a,inlineWidgetType:E(()=>a.value),editingItem:o,isEditing:E(()=>o.value!==null),communicationType:d,inlineContent:r,filteredInlineContent:i,handleAddNewAction:u,handleWidgetSave:h,handleWidgetCancel:N,handleEditItem:x,handleDeleteItem:c}}const jl={class:"flex-1 flex flex-col overflow-hidden h-full"},Wl={class:"bg-white border-b border-gray-200 shrink-0 shadow-sm"},Ll={class:"px-4 md:px-8 py-4 md:py-6"},Bl={class:"flex-1 flex flex-row overflow-hidden"},Pl={class:"flex-1 flex flex-col overflow-hidden min-w-0"},Rl={class:"flex-1 overflow-y-auto p-4 md:p-8 scrollbar-hide"},zl={class:"mb-4"},Yl={key:0},Kl={key:0,class:"mb-6"},Hl={key:2,class:"mb-6"},Ql={class:"space-y-6 mb-6"},Gl={key:3,class:"space-y-4 mb-6 px-1"},Jl={key:1},Zl={key:0,class:"space-y-4 mb-6 px-1"},Xl={key:0,class:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"},_l={class:"p-6"},en={class:"flex justify-between items-center mb-4"},tn={class:"text-sm font-bold text-slate-800"},an={key:1,class:"max-w-2xl w-full max-h-[90vh] overflow-y-auto"},dn={__name:"CustomerShell",props:{task:{type:Object,required:!0},type:{type:String,required:!0},managementWidget:{type:Object,required:!0},storeAdapter:{type:Object,required:!0},addNewConfig:{type:Object,required:!0}},emits:["car-added","convert-to-lead","convert-to-opportunity"],setup(t,{emit:g}){const s=t,y=ve(),a=he(),o=E(()=>s.task.id),p=E(()=>s.type==="contact"?"bg-blue-100 text-blue-600":s.type==="lead"?"bg-orange-100 text-orange-600":"bg-purple-100 text-purple-600"),d=E(()=>y.path.startsWith("/tasks")&&!y.path.startsWith("/customer")),r=D(y.path.startsWith("/tasks")&&!y.path.startsWith("/customer"));J(()=>y.path,v=>{r.value=v.startsWith("/tasks")&&!v.startsWith("/customer")});const i=()=>{a.push({path:`/customer/${s.task.id}`,query:{type:s.type}})};function u(v){b.value=!1,console.log("Appointment created:",v)}const h=()=>{q.value=!0},N=async v=>{var C,L,G,U;const k=v.name;s.type==="lead"?await((L=(C=s.storeAdapter).updateLead)==null?void 0:L.call(C,s.task.id,{assignee:k,assigneeType:v.type,teamId:v.type==="team"?v.id:null})):s.type==="opportunity"&&await((U=(G=s.storeAdapter).updateOpportunity)==null?void 0:U.call(G,s.task.id,{assignee:k,assigneeType:v.type,teamId:v.type==="team"?v.id:null})),q.value=!1},x=D(!1),c=D(null),b=D(!1),q=D(!1),{activeTab:w,showInlineWidget:V,editingItem:M,communicationType:me,inlineContent:oe,filteredInlineContent:H,handleAddNewAction:fe,handleWidgetSave:Q,handleWidgetCancel:X,handleEditItem:ie,handleDeleteItem:re}=Ml({store:s.storeAdapter,taskId:o,getTabForItemType:ce,isOverviewModalAction:v=>w.value==="overview"&&s.addNewConfig.overviewActions.includes(v)});J(()=>s.task.id,()=>{w.value="overview"});const _=v=>{const k=fe(v);k&&k.modalAction&&(c.value=k.modalAction,x.value=!0)},ye=v=>{if(v==="appointment"){b.value=!0;return}const k={note:"note",attachment:"attachment",email:"communication",whatsapp:"communication",sms:"communication",call:"communication",appointment:"overview"};if(["financing","tradein","purchase"].includes(v))c.value=v,x.value=!0;else{const C=k[v];C?(w.value=C,setTimeout(()=>{_(v),setTimeout(()=>{const L=document.querySelector(".animate-fade-in");L&&L.scrollIntoView({behavior:"smooth",block:"start"})},100)},50)):_(v)}},P=()=>{x.value=!1,c.value=null},ee=async v=>{await Q(v),P()},ge=E(()=>{const v=[...s.storeAdapter.currentActivities.value,...oe.value],k=v.filter(U=>ce(U.type)==="overview").length,C=v.filter(U=>["call","email","sms","whatsapp","communication"].includes(U.type)).length,L=v.filter(U=>U.type==="note").length,G=v.filter(U=>U.type==="attachment").length;return[{key:"overview",label:"Overview",count:k},{key:"note",label:"Notes",count:L},{key:"communication",label:"Communication",count:C},{key:"attachment",label:"Attachments",count:G}]}),de=E(()=>[...s.storeAdapter.currentActivities.value,...oe.value]),pe=async v=>{if(s.type==="opportunity")try{await s.storeAdapter.addVehicle(s.task.id,v.vehicleData),s.storeAdapter.loadOpportunityById&&await s.storeAdapter.loadOpportunityById(s.task.id)}catch(k){console.error("Error selecting vehicle:",k)}},be=async v=>{if(s.type==="opportunity")try{await s.storeAdapter.createOffer(s.task.id,v.offerData),s.storeAdapter.loadOpportunityById&&await s.storeAdapter.loadOpportunityById(s.task.id)}catch(k){console.error("Error creating offer:",k)}};return(v,k)=>(l(),n("div",jl,[e("header",Wl,[e("div",Ll,[j(Ze,{initials:t.task.customer.initials,name:t.task.customer.name,email:t.task.customer.email,phone:t.task.customer.phone,"third-field-value":t.task.customer.address,"avatar-color-class":p.value,"task-type":t.type,"email-label":"Email","phone-label":"Phone","third-field-label":"Address",onAction:ye},{tags:Z(()=>[(l(!0),n(F,null,z(t.task.tags,C=>(l(),n("span",{key:C,class:"badge-ui bg-blue-50 border-blue-100 text-blue-700 font-semibold"},m(C),1))),128))]),"name-action":Z(()=>[d.value?(l(),n("button",{key:0,onClick:i,class:"w-7 h-7 flex items-center justify-center bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-lg text-blue-600 hover:text-blue-700 transition-colors shrink-0",title:"Open in new page"},[...k[7]||(k[7]=[e("i",{class:"fa-solid fa-external-link text-xs"},null,-1)])])):f("",!0)]),_:1},8,["initials","name","email","phone","third-field-value","avatar-color-class","task-type"])])]),e("div",Bl,[e("div",Pl,[e("main",Rl,[e("div",zl,[j(tt,{modelValue:S(w),"onUpdate:modelValue":k[0]||(k[0]=C=>ke(w)?w.value=C:null),tabs:ge.value,class:"mb-0"},null,8,["modelValue","tabs"])]),S(w)==="overview"?(l(),n("div",Yl,[t.type!=="contact"?(l(),n("div",Kl,[j(dt,{stage:t.task.displayStage||t.task.stage,owner:t.task.assignee,source:t.task.source||"","delivery-substatus":t.task.deliverySubstatus,onReassign:h},null,8,["stage","owner","source","delivery-substatus"])])):f("",!0),t.task.requestedCar?(l(),I(Ul,{key:1,brand:t.task.requestedCar.brand,model:t.task.requestedCar.model,year:t.task.requestedCar.year,image:t.task.requestedCar.image||"",price:t.task.requestedCar.price||null,"request-message":t.task.requestedCar.requestMessage||"","request-type":t.task.requestedCar.requestType||"",source:t.task.source||"",dealership:t.task.requestedCar.dealership||"",registration:t.task.requestedCar.registration||"",kilometers:t.task.requestedCar.kilometers||null,"fuel-type":t.task.requestedCar.fuelType||"","gear-type":t.task.requestedCar.gearType||"",vin:t.task.requestedCar.vin||"","stock-days":t.task.requestedCar.stockDays!==void 0?t.task.requestedCar.stockDays:null,channel:t.task.requestedCar.channel||"Email","ad-campaign":t.task.requestedCar.adCampaign||"","expected-purchase-date":t.task.requestedCar.expectedPurchaseDate||"","fiscal-entity":t.task.requestedCar.fiscalEntity||"","source-details":t.task.requestedCar.sourceDetails||"","ad-medium":t.task.requestedCar.adMedium||"","ad-source":t.task.requestedCar.adSource||"",label:"Requested Car",class:"mb-6"},null,8,["brand","model","year","image","price","request-message","request-type","source","dealership","registration","kilometers","fuel-type","gear-type","vin","stock-days","channel","ad-campaign","expected-purchase-date","fiscal-entity","source-details","ad-medium","ad-source"])):f("",!0),t.managementWidget?(l(),n("div",Hl,[(l(),I(we(t.managementWidget),{lead:t.type==="lead"?t.task:void 0,opportunity:t.type==="opportunity"?t.task:void 0,contact:t.type==="contact"?t.task:void 0,activities:de.value,onCarAdded:k[1]||(k[1]=C=>v.$emit("car-added",C)),onConvertToLead:k[2]||(k[2]=C=>v.$emit("convert-to-lead")),onConvertToOpportunity:k[3]||(k[3]=C=>v.$emit("convert-to-opportunity")),onVehicleSelected:pe,onCreateOffer:be},null,40,["lead","opportunity","contact","activities"]))])):f("",!0),e("div",Ql,[se(v.$slots,"pinned-extra",{task:t.task})]),S(H).length>0?(l(),n("div",Gl,[(l(!0),n(F,null,z(S(H),C=>(l(),I(ue,{key:C.id,item:C,"task-type":t.type,"customer-initials":"SK",onEdit:S(ie),onDelete:S(re)},null,8,["item","task-type","onEdit","onDelete"]))),128))])):f("",!0)])):(l(),n("div",Jl,[j(yt,{actions:t.addNewConfig.tabActions,"active-tab":S(w),onAction:_},null,8,["actions","active-tab"]),e("div",null,[S(V)==="communication"?(l(),I(Za,{key:0,type:S(me),"task-type":t.type,"task-id":t.task.id,item:S(M),onSave:S(Q),onCancel:S(X)},null,8,["type","task-type","task-id","item","onSave","onCancel"])):f("",!0),S(V)==="note"?(l(),I(as,{key:1,item:S(M),"task-type":t.type,"task-id":t.task.id,onSave:S(Q),onCancel:S(X)},null,8,["item","task-type","task-id","onSave","onCancel"])):f("",!0),S(V)==="attachment"?(l(),I(cs,{key:2,item:S(M),"task-type":t.type,"task-id":t.task.id,onSave:S(Q),onCancel:S(X)},null,8,["item","task-type","task-id","onSave","onCancel"])):f("",!0)]),S(H).length>0?(l(),n("div",Zl,[(l(!0),n(F,null,z(S(H),C=>(l(),I(ue,{key:C.id,item:C,"task-type":t.type,"customer-initials":"SK",onEdit:S(ie),onDelete:S(re)},null,8,["item","task-type","onEdit","onDelete"]))),128))])):f("",!0)]))])]),j(Ka,{title:"Activity summary",activities:de.value,collapsed:r.value,"show-collapse":!0,show:!0,class:"hidden lg:flex",onToggleCollapse:k[4]||(k[4]=C=>r.value=!r.value)},null,8,["activities","collapsed"])]),(l(),I($e,{to:"body"},[x.value?(l(),n("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",onClick:R(P,["self"])},[c.value==="financing"||c.value==="tradein"?(l(),n("div",Xl,[e("div",_l,[e("div",en,[e("h5",tn,m(c.value==="financing"?"Add Financing":"Add Trade-in"),1),e("button",{onClick:P,class:"text-gray-400 hover:text-gray-600"},[...k[8]||(k[8]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),c.value==="financing"?(l(),I(xs,{key:0,item:null,"task-type":t.type,"task-id":t.task.id,onSave:ee,onCancel:P},null,8,["task-type","task-id"])):f("",!0),c.value==="tradein"?(l(),I(Ss,{key:1,item:null,"task-type":t.type,"task-id":t.task.id,onSave:ee,onCancel:P},null,8,["task-type","task-id"])):f("",!0)])])):f("",!0),c.value==="purchase"?(l(),n("div",an,[j(Ls,{item:null,"task-type":t.type,"task-id":t.task.id,"requested-car":t.type==="lead"?t.task.requestedCar:null,"recommended-cars":[],onSave:ee,onCancel:P},null,8,["task-type","task-id","requested-car"])])):f("",!0)])):f("",!0)])),j(Ce,{show:q.value,onClose:k[5]||(k[5]=C=>q.value=!1),onConfirm:N},null,8,["show"]),b.value?(l(),I(Se,{key:0,show:b.value,customer:t.task.customer,assignee:t.task.assignee,"disabled-fields":["customer"],onCreate:u,onCancel:k[6]||(k[6]=C=>b.value=!1)},null,8,["show","customer","assignee"])):f("",!0)]))}},ne={Qualified:{primaryAction:{key:"schedule-appointment",title:"Schedule First Appointment",description:"Begin the sales process by scheduling an appointment with the customer",label:"Schedule Appointment",icon:"fa-solid fa-calendar-plus",buttonClass:"bg-blue-600 hover:bg-blue-700 text-white",colorScheme:{background:"bg-blue-50/50",border:"border-blue-100"}},secondaryActions:[{key:"select-vehicle",label:"Select Vehicle",icon:"fa-solid fa-car",description:"Choose a vehicle for this opportunity"},{key:"schedule-appointment",label:"Schedule Appointment",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"OOFB",condition:"qualified-no-offers-7-13-days"},{type:"UFB",condition:"qualified-no-offers-14-plus-days"}]},"Awaiting Appointment":{primaryAction:{key:"view-or-schedule-appointment",title:t=>t.scheduledAppointment?"Next Appointment":"Schedule Appointment",description:t=>t.scheduledAppointment?`Scheduled for ${t.formatDateTime(t.scheduledAppointment.start)}`:"Schedule an appointment to move forward",label:t=>t.scheduledAppointment?"View Appointment":"Schedule Appointment",icon:"fa-solid fa-calendar-check",buttonClass:"bg-purple-600 hover:bg-purple-700 text-white",colorScheme:{background:"bg-purple-50/50",border:"border-purple-100"}},secondaryActions:[{key:"reschedule",label:"Reschedule",icon:"fa-solid fa-calendar-days",description:"Change appointment date/time"},{key:"cancel-appointment",label:"Cancel Appointment",icon:"fa-solid fa-calendar-xmark"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"NS",condition:"appointment-past-not-completed"}]},"To be Called Back":{primaryAction:{key:"call-prospect",title:"Call Prospect",description:"Customer requested a callback. Follow up to maintain engagement",label:"Initiate Call",icon:"fa-solid fa-phone",buttonClass:"bg-indigo-600 hover:bg-indigo-700 text-white",colorScheme:{background:"bg-indigo-50/50",border:"border-indigo-100"}},secondaryActions:[{key:"schedule-appointment",label:"Schedule Appointment",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[]},"In Negotiation":{primaryAction:{key:"create-offer",title:"Create Offer",description:t=>t.hasOffers?"Add another offer or refine existing proposal":"Create initial offer to move forward with negotiation",label:t=>t.hasOffers?"Add Another Offer":"Create Offer",icon:"fa-solid fa-file-invoice-dollar",buttonClass:"bg-yellow-600 hover:bg-yellow-700 text-white",colorScheme:{background:"bg-yellow-50/50",border:"border-yellow-100"}},secondaryActions:[{key:"schedule-appointment",label:"Schedule Appointment",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"OFB",condition:"negotiation-5-plus-days-no-contract-has-offers"},{type:"NFU",condition:"negotiation-5-plus-days-no-contract-no-future-appointment-has-offers"}]},"Offer Sent":{primaryAction:{key:"follow-up-offer",title:"Follow Up on Offer",description:"Offer recently sent. Follow up to gauge customer interest",label:"Log Follow-up",icon:"fa-solid fa-phone-volume",buttonClass:"bg-orange-600 hover:bg-orange-700 text-white",colorScheme:{background:"bg-orange-50/50",border:"border-orange-100"}},secondaryActions:[{key:"add-offer",label:"Add Another Offer",icon:"fa-solid fa-file-invoice-dollar"},{key:"schedule-appointment",label:"Schedule Follow-up",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"OFB",condition:"negotiation-5-plus-days-no-contract-has-offers"},{type:"NFU",condition:"negotiation-5-plus-days-no-contract-no-future-appointment-has-offers"}]},"Awaiting Response":{primaryAction:{key:"request-decision",title:"Request Customer Decision",description:"Offer has been pending. Time to request a decision from the prospect",label:"Request Decision",icon:"fa-solid fa-circle-question",buttonClass:"bg-pink-600 hover:bg-pink-700 text-white",colorScheme:{background:"bg-pink-50/50",border:"border-pink-100"}},secondaryActions:[{key:"add-contract",label:"Add Contract",icon:"fa-solid fa-file-contract",description:"Customer accepted - add contract to proceed"},{key:"add-offer",label:"Send New Offer",icon:"fa-solid fa-file-invoice-dollar"},{key:"schedule-appointment",label:"Schedule Meeting",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"OFB",condition:"negotiation-5-plus-days-no-contract-has-offers"},{type:"NFU",condition:"negotiation-5-plus-days-no-contract-no-future-appointment-has-offers"}]},"Contract Pending":{primaryAction:{key:"finalize-contract",title:"Finalize Contract",description:"Collect e-signatures and finalize contract documentation",label:"Collect Signatures",icon:"fa-solid fa-file-signature",buttonClass:"bg-emerald-600 hover:bg-emerald-700 text-white",colorScheme:{background:"bg-emerald-50/50",border:"border-emerald-100"}},secondaryActions:[{key:"close-won",label:"Close as Won",icon:"fa-solid fa-check-circle",description:"Mark deal as won and finalize"},{key:"extend-deadline",label:"Extend Deadline",icon:"fa-solid fa-clock"},{key:"add-offer",label:"Revise Offer",icon:"fa-solid fa-file-invoice-dollar"},{key:"schedule-appointment",label:"Schedule Appointment",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[]},"Closed Won":{primaryAction:t=>{const g=t.deliverySubstatus;return g==="Delivered"?{key:"collect-feedback",title:"Post-Delivery Follow-up",description:"Vehicle delivered. Collect customer feedback",label:"Collect Feedback",icon:"fa-solid fa-comment",buttonClass:"bg-green-600 hover:bg-green-700 text-white",colorScheme:{background:"bg-green-50/50",border:"border-green-100"}}:g==="Awaiting Delivery"?{key:"confirm-delivery",title:"Confirm Delivery Details",description:"Delivery scheduled. Confirm date/time with customer",label:"Confirm Delivery",icon:"fa-solid fa-calendar-check",buttonClass:"bg-teal-600 hover:bg-teal-700 text-white",colorScheme:{background:"bg-teal-50/50",border:"border-teal-100"}}:{key:"schedule-delivery",title:"Set Delivery Date",description:"Contract signed! Schedule vehicle delivery with the customer",label:"Schedule Delivery",icon:"fa-solid fa-truck",buttonClass:"bg-green-600 hover:bg-green-700 text-white",colorScheme:{background:"bg-green-50/50",border:"border-green-100"}}},secondaryActions:[{key:"collect-feedback",label:"Collect Feedback",icon:"fa-solid fa-comment",conditional:"is-delivered"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"CFB",condition:"contract-7-plus-days-no-delivery"},{type:"DFB",condition:"delivery-date-set"},{type:"DFB",condition:"delivery-3-plus-days"}]},Abandoned:{primaryAction:{key:"reopen",title:"Opportunity Abandoned",description:"This opportunity has been inactive for an extended period. Reopen it to continue the sales process.",label:"Reopen Opportunity",icon:"fa-solid fa-rotate-left",buttonClass:"bg-gray-600 hover:bg-gray-700 text-white",colorScheme:{background:"bg-gray-50/50",border:"border-gray-100"}},secondaryActions:[{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark",description:"Mark this opportunity as lost"},{key:"requalify",label:"Requalify as Lead",icon:"fa-solid fa-arrow-left",description:"Convert back to a lead"}],taskWidgets:[{type:"ABANDONED",condition:"opportunity-abandoned"}]}},ae={reopen:{key:"reopen",label:"Reopen Opportunity",icon:"fa-solid fa-rotate-left",description:"Restart the management process"},requalify:{key:"requalify",label:"Requalify as Lead",icon:"fa-solid fa-arrow-left",description:"Convert back to a lead"},closeLost:{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}};function B(t){if(!t)return 0;const g=new Date(t),y=Math.abs(new Date-g);return Math.ceil(y/(1e3*60*60*24))}const Y={"no-appointment":t=>!t.scheduledAppointment,"has-appointment":t=>!!t.scheduledAppointment,"appointment-past-not-completed":t=>t.scheduledAppointment?new Date(t.scheduledAppointment.start)<new Date&&t.scheduledAppointment.status!=="completed":!1,"has-future-appointment":t=>t.scheduledAppointment?new Date(t.scheduledAppointment.start)>new Date:!1,"no-offers":t=>!t.hasOffers,"has-offers":t=>t.hasOffers,"qualified-no-offers-7-13-days":t=>{const g=W(),s=g.getSetting("oofbMinDays"),y=g.getSetting("oofbMaxDays"),a=B(t.opportunity.createdAt);return a>=s&&a<y+1&&!t.hasOffers},"qualified-no-offers-14-plus-days":t=>{const s=W().getSetting("ufbDays");return B(t.opportunity.createdAt)>=s&&!t.hasOffers},"negotiation-5-plus-days-no-contract-has-offers":t=>{if(t.stage==="In Negotiation"&&!t.hasOffers)return!1;const s=W().getSetting("ofbDays");return B(t.opportunity.lastActivity||t.opportunity.createdAt)>=s&&!t.opportunity.contractDate&&t.hasOffers},"negotiation-5-plus-days-no-contract-no-future-appointment-has-offers":t=>{if(t.stage==="In Negotiation"&&!t.hasOffers)return!1;const s=W().getSetting("nfuDays"),y=B(t.opportunity.lastActivity||t.opportunity.createdAt),a=t.scheduledAppointment&&new Date(t.scheduledAppointment.start)>new Date;return y>=s&&!t.opportunity.contractDate&&!a&&t.hasOffers},"contract-7-plus-days-no-delivery":t=>{var o;if(!t.opportunity.contractDate)return!1;const s=W().getSetting("cfbDays"),y=B(t.opportunity.contractDate),a=(o=t.activities)==null?void 0:o.some(p=>{var d;return p.type==="delivery"||((d=p.action)==null?void 0:d.toLowerCase().includes("delivered"))});return y>=s&&!a},"delivery-date-set":t=>!!t.opportunity.deliveryDate,"delivery-3-plus-days":t=>{var o;const g=(o=t.activities)==null?void 0:o.find(p=>{var d;return p.type==="delivery"||((d=p.action)==null?void 0:d.toLowerCase().includes("delivered"))});if(!g)return!1;const y=W().getSetting("dfbDays");return B(g.timestamp)>=y},"is-awaiting-delivery":t=>t.deliverySubstatus==="Awaiting Delivery","is-delivered":t=>t.deliverySubstatus==="Delivered","has-no-delivery":t=>!t.deliverySubstatus||t.deliverySubstatus===null,"is-closed":t=>{const g=t.stage;return g==="Closed Won"||g==="Closed Lost"},"is-closed-with-task-widget":t=>Y["is-closed"](t)&&t.hasActiveTaskWidget,"opportunity-abandoned":t=>{if(Y["is-closed"](t))return!1;const g=W(),s=g.getSetting("abandonedOpportunityDays");if(!g.getSetting("abandonedEligibleStages").includes(t.stage))return!1;const a=t.opportunity.lastActivity||t.opportunity.createdAt;return B(a)>=s}};function un(t,g){if(Y["is-closed-with-task-widget"](g))return[ae.reopen,ae.requalify,ae.closeLost];const s=ne[t];return!s||!s.secondaryActions?[]:s.secondaryActions.filter(y=>{if(!y.conditional)return!0;const a=Y[y.conditional];return a?a(g):!0})}function cn(t,g){const s=ne[t];if(!s||!s.taskWidgets)return null;const a=W().getSetting("autoCloseWidgetsOnClose"),o=Y["is-closed"]({stage:t});for(const p of s.taskWidgets){if(a&&o&&(p.type==="NFU"||p.type==="OFB"))continue;const d=Y[p.condition];if(d&&d(g))return p.type}return null}function mn(t,g){const s=ne[t];if(!s||!s.primaryAction)return null;const y=s.primaryAction;return{...y,title:typeof y.title=="function"?y.title(g):y.title,description:typeof y.description=="function"?y.description(g):y.description,label:typeof y.label=="function"?y.label(g):y.label}}function fn(t){return{OOFB:"Overdue Offer Follow-up Task",UFB:"Urgent Follow-up Task",NFU:"No Future Updates Task",OFB:"Offer Follow-up Task",CFB:"Contract Follow-up Task",DFB:"Delivery Follow-up Task",NS:"No-Show Follow-up Task",ABANDONED:"Abandoned Opportunity Task"}[t]||"Task"}function yn(t){return t==="Closed Won"||t==="Closed Lost"||t==="Delivered"}const gn={__name:"ComingSoonModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Coming Soon"}},emits:["close"],setup(t,{emit:g}){const s=g,y=()=>{s("close")};return(a,o)=>(l(),I(Ae,{show:t.show,title:t.title,onCancel:y},{footer:Z(()=>[e("div",{class:"px-6 py-4 border-t border-gray-200 flex justify-end"},[e("button",{onClick:y,class:"bg-gray-800 hover:bg-gray-900 text-white font-medium px-6 py-2 rounded-lg text-sm transition-colors"}," Close ")])]),default:Z(()=>[o[0]||(o[0]=e("div",{class:"py-8 flex items-center justify-center"},[e("p",{class:"text-gray-600 text-lg font-medium"},"Coming soon")],-1))]),_:1},8,["show","title"]))}};export{as as _,mn as a,un as b,fn as c,Ls as d,gn as e,dn as f,cn as g,Ul as h,yn as i};
