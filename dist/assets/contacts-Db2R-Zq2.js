const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Be589Dcd.js","assets/index-Cw8_K5p7.css"])))=>i.map(i=>d[i]);
import{W as c,X as y,S as _,r as v,c as q}from"./index-Be589Dcd.js";const l=(a=300)=>new Promise(e=>setTimeout(e,a)),I=async(a={})=>{await l();let e=[...c];if(a.search){const t=a.search.toLowerCase();e=e.filter(n=>{var u;return n.name.toLowerCase().includes(t)||n.email.toLowerCase().includes(t)||((u=n.company)==null?void 0:u.toLowerCase().includes(t))})}return{data:e,total:e.length}},x=async a=>{await l();const e=c.find(t=>t.id===parseInt(a));if(!e)throw new Error("Contact not found");return e},T=async a=>{await l();const e={id:c.length+1,...a,createdAt:new Date().toISOString()};return c.push(e),e},D=async(a,e)=>{await l();const t=c.findIndex(n=>n.id===parseInt(a));if(t===-1)throw new Error("Contact not found");return c[t]={...c[t],...e},c[t]},S=async a=>{await l();const e=c.findIndex(t=>t.id===parseInt(a));if(e===-1)throw new Error("Contact not found");return c.splice(e,1),{success:!0}},P=async(a,e)=>{await l();const t=c.find(n=>n.id===parseInt(a));if(!t)throw new Error("Contact not found");return t.requestedCar={...e,id:Date.now()},{...t}},R=async a=>{await l();const e=c.find(u=>u.id===parseInt(a));if(!e)throw new Error("Contact not found");if(!e.requestedCar)throw new Error("Contact must have requested car");const{createLead:t}=await y(async()=>{const{createLead:u}=await import("./index-Be589Dcd.js").then(i=>i.aj);return{createLead:u}},__vite__mapDeps([0,1]));return await t({customer:{name:e.name,email:e.email,phone:e.phone,address:e.address||"",initials:e.initials},requestedCar:e.requestedCar,source:e.source||"Direct",tags:e.tags||[],stage:"Open Lead",status:"Open",priority:"Normal"})},A=async a=>{await l();const e=c.find(u=>u.id===parseInt(a));if(!e)throw new Error("Contact not found");if(!e.requestedCar)throw new Error("Contact must have requested car");const{createOpportunity:t}=await y(async()=>{const{createOpportunity:u}=await import("./index-Be589Dcd.js").then(i=>i.ak);return{createOpportunity:u}},__vite__mapDeps([0,1]));return await t({customer:{name:e.name,email:e.email,phone:e.phone,address:e.address||"",initials:e.initials},vehicle:e.requestedCar,source:e.source||"Direct",tags:e.tags||[],stage:"Qualified",value:e.requestedCar.price||0})},k=_("contacts",()=>{const a=v([]),e=v(null),t=v(!1),n=v(null),u=v(""),i=q(()=>a.value.length);async function w(){t.value=!0,n.value=null;try{const o=await I({search:u.value});a.value=o.data}catch(o){n.value=o.message}finally{t.value=!1}}async function h(o){t.value=!0,n.value=null;try{return e.value=await x(o),e.value}catch(r){throw n.value=r.message,r}finally{t.value=!1}}async function C(o){t.value=!0,n.value=null;try{const r=await T(o);return a.value.unshift(r),r}catch(r){throw n.value=r.message,r}finally{t.value=!1}}async function p(o,r){t.value=!0,n.value=null;try{const s=await D(o,r),d=a.value.findIndex(f=>f.id===o);return d!==-1&&(a.value[d]=s),s}catch(s){throw n.value=s.message,s}finally{t.value=!1}}async function m(o){t.value=!0,n.value=null;try{await S(o),a.value=a.value.filter(r=>r.id!==o)}catch(r){throw n.value=r.message,r}finally{t.value=!1}}function g(o){u.value=o,w()}async function L(o,r){t.value=!0,n.value=null;try{const s=await P(o,r),d=a.value.findIndex(f=>f.id===o);return d!==-1&&(a.value[d]=s),e.value&&e.value.id===o&&(e.value=s),s}catch(s){throw n.value=s.message,s}finally{t.value=!1}}async function E(o){t.value=!0,n.value=null;try{const r=await R(o);return a.value=a.value.filter(s=>s.id!==o),e.value=null,r}catch(r){throw n.value=r.message,r}finally{t.value=!1}}async function O(o){t.value=!0,n.value=null;try{const r=await A(o);return a.value=a.value.filter(s=>s.id!==o),e.value=null,r}catch(r){throw n.value=r.message,r}finally{t.value=!1}}return{contacts:a,currentContact:e,loading:t,error:n,searchQuery:u,totalContacts:i,loadContacts:w,loadContactById:h,addContact:C,modifyContact:p,removeContact:m,setSearchQuery:g,addRequestedCar:L,convertToLead:E,convertToOpportunity:O}});export{k as u};
