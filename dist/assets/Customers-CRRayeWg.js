const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ContactsTab-BGV8CrhI.js","assets/index-DmX4Eg8G.js","assets/index-Dr28XGEp.css","assets/components-NGMN9vly.js","assets/toggle-group-item.vue_vue_type_script_setup_true_lang-Csij51_o-B0oMcpqR.js","assets/opportunities-XVgMwMKa.js","assets/useCustomersTable-Dwmgxyqc.js","assets/OpenLeadsTab-BEx5Cy_l.js","assets/formatters-B1RFjlNy.js","assets/OpenOpportunitiesTab-ClwASDaZ.js","assets/InNegotiationTab-DeIQYvMb.js","assets/WonTab-DSjqVkVD.js","assets/LostTab-BTjQdOzJ.js"])))=>i.map(i=>d[i]);
import{r as T,l as z,c as h,x as D,o as v,D as c,s as p,y as u,e as t,k as A,t as S,d as x,p as r,K as i,Q as U,u as B,C as W,ak as w,F as j,i as F,al as M,h as q,a3 as C,n as H,z as K,R as Q}from"./index-DmX4Eg8G.js";import{_ as G}from"./PageHeader-DH3AabU1.js";import{a as J,F as X,L as Y,H as Z,j as ee,K as te,C as le,W as oe}from"./toggle-group-item.vue_vue_type_script_setup_true_lang-Csij51_o-B0oMcpqR.js";import{a as ae,u as ne}from"./opportunities-XVgMwMKa.js";const se={class:"space-y-4"},re={key:0},ie={key:1},ue={key:2},pe={key:3},de=["placeholder"],me={__name:"AddCustomerModal",props:{show:{type:Boolean,default:!1},activeTab:{type:String,required:!0},initialData:{type:Object,default:()=>({})}},emits:["close","save"],setup(g,{emit:V}){const s=g,N=V,l=T({customerName:"",email:"",phone:"",company:"",vehicle:"",value:"",reason:""});z(()=>s.show,d=>{d&&(l.value={customerName:s.initialData.customerName||"",email:s.initialData.email||"",phone:s.initialData.phone||"",company:s.initialData.company||"",vehicle:s.initialData.vehicle||"",value:s.initialData.value||"",reason:s.initialData.reason||""})});const O=d=>{d||N("close")},y=h(()=>({contacts:"Add New Contact","open-leads":"Add New Lead","open-opportunities":"Add New Opportunity","in-negotiation":"Add Opportunity in Negotiation",won:"Add Won Opportunity",lost:"Add Lost Opportunity"})[s.activeTab]||"Add New Item"),E=h(()=>({contacts:"Contact","open-leads":"Lead","open-opportunities":"Opportunity","in-negotiation":"Opportunity",won:"Won Opportunity",lost:"Lost Opportunity"})[s.activeTab]||"Item"),f=()=>{N("save",{...l.value}),l.value={customerName:"",email:"",phone:"",company:"",vehicle:"",value:"",reason:""}};return(d,e)=>(v(),D(u(oe),{open:g.show,"onUpdate:open":O},{default:c(()=>[p(u(J),null,{default:c(()=>[p(u(X),{class:"fixed inset-0 z-50 bg-black/50"}),p(u(Y),{class:"w-full sm:max-w-md"},{default:c(()=>[p(u(Z),null,{default:c(()=>[p(u(ee),null,{default:c(()=>[A(S(y.value),1)]),_:1}),p(u(te),null,{default:c(()=>[...e[14]||(e[14]=[A("Fill in the details below",-1)])]),_:1})]),_:1}),t("div",se,[g.activeTab==="contacts"?(v(),x("div",re,[e[15]||(e[15]=t("label",{class:"block label-upper mb-2"},"Contact Name",-1)),r(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>l.value.customerName=o),type:"text",placeholder:"Enter contact name...",class:"input"},null,512),[[i,l.value.customerName]]),e[16]||(e[16]=t("label",{class:"block label-upper mb-2 mt-4"},"Email",-1)),r(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>l.value.email=o),type:"email",placeholder:"contact@example.com",class:"input"},null,512),[[i,l.value.email]]),e[17]||(e[17]=t("label",{class:"block label-upper mb-2 mt-4"},"Phone",-1)),r(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>l.value.phone=o),type:"tel",placeholder:"+49...",class:"input"},null,512),[[i,l.value.phone]]),e[18]||(e[18]=t("label",{class:"block label-upper mb-2 mt-4"},"Company (optional)",-1)),r(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>l.value.company=o),type:"text",placeholder:"Company name...",class:"input"},null,512),[[i,l.value.company]])])):g.activeTab==="open-leads"?(v(),x("div",ie,[e[19]||(e[19]=t("label",{class:"block label-upper mb-2"},"Customer Name",-1)),r(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>l.value.customerName=o),type:"text",placeholder:"Enter customer name...",class:"input"},null,512),[[i,l.value.customerName]]),e[20]||(e[20]=t("label",{class:"block label-upper mb-2 mt-4"},"Email",-1)),r(t("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>l.value.email=o),type:"email",placeholder:"customer@example.com",class:"input"},null,512),[[i,l.value.email]]),e[21]||(e[21]=t("label",{class:"block label-upper mb-2 mt-4"},"Requested Vehicle",-1)),r(t("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>l.value.vehicle=o),type:"text",placeholder:"e.g., Volkswagen ID.4",class:"input"},null,512),[[i,l.value.vehicle]])])):g.activeTab==="open-opportunities"||g.activeTab==="in-negotiation"?(v(),x("div",ue,[e[22]||(e[22]=t("label",{class:"block label-upper mb-2"},"Customer Name",-1)),r(t("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>l.value.customerName=o),type:"text",placeholder:"Enter customer name...",class:"input"},null,512),[[i,l.value.customerName]]),e[23]||(e[23]=t("label",{class:"block label-upper mb-2 mt-4"},"Vehicle",-1)),r(t("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>l.value.vehicle=o),type:"text",placeholder:"e.g., Porsche Taycan",class:"input"},null,512),[[i,l.value.vehicle]]),e[24]||(e[24]=t("label",{class:"block label-upper mb-2 mt-4"},"Opportunity Value",-1)),r(t("input",{"onUpdate:modelValue":e[9]||(e[9]=o=>l.value.value=o),type:"number",placeholder:"0",class:"input"},null,512),[[i,l.value.value]])])):(v(),x("div",pe,[e[25]||(e[25]=t("label",{class:"block label-upper mb-2"},"Customer Name",-1)),r(t("input",{"onUpdate:modelValue":e[10]||(e[10]=o=>l.value.customerName=o),type:"text",placeholder:"Enter customer name...",class:"input"},null,512),[[i,l.value.customerName]]),e[26]||(e[26]=t("label",{class:"block label-upper mb-2 mt-4"},"Vehicle",-1)),r(t("input",{"onUpdate:modelValue":e[11]||(e[11]=o=>l.value.vehicle=o),type:"text",placeholder:"Vehicle model",class:"input"},null,512),[[i,l.value.vehicle]]),e[27]||(e[27]=t("label",{class:"block label-upper mb-2 mt-4"},"Reason",-1)),r(t("textarea",{"onUpdate:modelValue":e[12]||(e[12]=o=>l.value.reason=o),rows:"3",placeholder:`Reason for ${g.activeTab==="won"?"win":"loss"}...`,class:"input resize-none"},null,8,de),[[i,l.value.reason]])]))]),p(u(le),{class:"flex flex-col sm:flex-row justify-end items-stretch sm:items-center gap-3"},{default:c(()=>[p(u(U),{label:"Cancel",variant:"outline",size:"small",class:"rounded-sm w-full sm:w-auto",onClick:e[13]||(e[13]=o=>d.$emit("close"))}),p(u(U),{label:`Create ${E.value}`,variant:"primary",size:"small",class:"rounded-sm w-full sm:w-auto !bg-brand-red !hover:bg-brand-red-dark !text-white !border-brand-red",onClick:f},null,8,["label"])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]))}},be={class:"page-container"},ce={class:"p-4 md:p-8"},ve={class:"flex items-center gap-3 mb-6 overflow-x-auto pb-2 scrollbar-hide"},ge=["onClick"],ye={class:"heading-tab whitespace-nowrap"},ke={__name:"Customers",setup(g){const V=q(),s=B(),N=W(),l=ae(),O=ne(),y=h(()=>{const m=N.leads.filter(b=>!b.isDisqualified),a=l.opportunities.filter(b=>b.stage!=="Closed Won"&&b.stage!=="Closed Lost"),n=l.opportunities.filter(b=>b.stage==="In Negotiation"||b.stage==="In negotiation"),k=l.opportunities.filter(b=>b.stage==="Closed Won"),L=l.opportunities.filter(b=>b.stage==="Closed Lost");return{contacts:O.totalCustomers,openLeads:m.length,openOpportunities:a.length-n.length,inNegotiation:n.length,won:k.length,lost:L.length}}),f=T("contacts"),d=T(!1),e=T({customerName:"",email:"",phone:"",company:"",vehicle:"",value:"",reason:""}),o={contacts:w(()=>C(()=>import("./ContactsTab-BGV8CrhI.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),"open-leads":w(()=>C(()=>import("./OpenLeadsTab-BEx5Cy_l.js"),__vite__mapDeps([7,1,2,3,4,8,6]))),"open-opportunities":w(()=>C(()=>import("./OpenOpportunitiesTab-ClwASDaZ.js"),__vite__mapDeps([9,1,2,3,4,5,8,6]))),"in-negotiation":w(()=>C(()=>import("./InNegotiationTab-DeIQYvMb.js"),__vite__mapDeps([10,1,2,3,4,5,8,6]))),won:w(()=>C(()=>import("./WonTab-DSjqVkVD.js"),__vite__mapDeps([11,1,2,3,4,5,8,6]))),lost:w(()=>C(()=>import("./LostTab-BTjQdOzJ.js"),__vite__mapDeps([12,1,2,3,4,5,8,6])))},$=h(()=>o[f.value]||o.contacts),I=h(()=>{const m=[{key:"contacts",label:"Customers",count:y.value.contacts,borderColor:"border-t-purple-600",badgeColor:"bg-purple-600 text-white"},{key:"open-leads",label:"Open leads",count:y.value.openLeads,borderColor:"border-t-blue-600",badgeColor:"bg-blue-600 text-white"},{key:"open-opportunities",label:"Open opportunities",count:y.value.openOpportunities,borderColor:"border-t-orange-500",badgeColor:"bg-orange-500 text-white"},{key:"in-negotiation",label:"In negotiation",count:y.value.inNegotiation,borderColor:"border-t-blue-500",badgeColor:"bg-blue-500 text-white"},{key:"won",label:"Won",count:y.value.won,borderColor:"border-t-green-500",badgeColor:"bg-green-500 text-white"},{key:"lost",label:"Lost",count:y.value.lost,borderColor:"border-t-red-500",badgeColor:"bg-red-500 text-white"}];return s.isOperator()?m.filter(a=>a.key==="contacts"||a.key==="open-leads"):s.isSalesman()?m.filter(a=>a.key!=="open-leads"):m}),R=()=>{e.value={customerName:"",email:"",phone:"",company:"",vehicle:"",value:"",reason:""},d.value=!1},_=m=>{f.value=m},P=(m,a)=>{if(!a||!m)return"gray";const k={contacts:"gray","open-leads":"blue","open-opportunities":"blue","in-negotiation":"blue",won:"green",lost:"red"}[m]||"gray";return["blue","green","red","gray"].includes(k)?k:"gray"};return(m,a)=>(v(),x("div",be,[p(G,{title:"Customers"},{actions:c(()=>[t("button",{onClick:a[0]||(a[0]=n=>u(V).push("/add-new")),class:"group flex items-center gap-2 rounded-2xl border border-E5E7EB px-3 py-1.5 text-fluid-sm font-medium text-body hover:border-red-100 hover:bg-red-50 hover:text-brand-red transition-all"},[...a[2]||(a[2]=[t("i",{class:"fa-solid fa-plus text-gray-400 group-hover:text-brand-red"},null,-1),t("span",{class:"hidden sm:inline"},"Add new",-1)])])]),_:1}),t("div",ce,[t("div",ve,[(v(!0),x(j,null,F(I.value,n=>(v(),x("button",{key:n.key,onClick:k=>_(n.key),class:H(["flex items-center justify-between gap-3 px-4 py-3 bg-surface border border-border rounded-lg cursor-pointer hover:shadow-sm transition-all shrink-0 min-w-40 border-t-4",f.value===n.key?n.borderColor:"border-t-border"])},[t("span",ye,S(n.label),1),p(u(K),{text:String(n.count),size:"small",theme:P(n.key,f.value===n.key)},null,8,["text","theme"])],10,ge))),128))]),(v(),D(M,null,{fallback:c(()=>[...a[3]||(a[3]=[t("div",{class:"flex items-center justify-center py-12"},[t("div",{class:"text-center"},[t("i",{class:"fa-solid fa-spinner fa-spin text-gray-400 text-2xl mb-2"}),t("p",{class:"text-meta"},"Loading...")])],-1)])]),default:c(()=>[(v(),D(Q($.value),{key:f.value}))]),_:1}))]),p(me,{show:d.value,"active-tab":f.value,"initial-data":e.value,onClose:a[1]||(a[1]=n=>d.value=!1),onSave:R},null,8,["show","active-tab","initial-data"])]))}};export{ke as default};
