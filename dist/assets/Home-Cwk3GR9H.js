import{u as G,r as k,c as A,f as Te,a as De,b as Ce,d as n,o as r,e,n as N,t as g,g as w,F as E,h as Z,i as V,j as ee,k as K,w as he,l as Ee,m as we,p as Ae,v as Se,q as J,s as q,x as z,y as _,z as W,Q as X,A as Be,B as Oe}from"./index-BZwEnuDT.js";import{f as Re,a as Me}from"./calendar-ClUs2tzv.js";import{u as je}from"./users-Bg_sNy2B.js";import{_ as Ne}from"./ReassignUserModal-X-LKnpVU.js";import{f as Ie,a as Ue,b as Pe}from"./dashboard--NuRmJri.js";import"./toggle-group-item.vue_vue_type_script_setup_true_lang-Csij51_o-D2e1bD8Q.js";const _e="actionable-questions-dismissals";function ke(){try{const f=localStorage.getItem(_e);return f?JSON.parse(f):[]}catch{return[]}}function Le(f,m){const u=ke();u.some(b=>b.questionId===f&&b.userId===m)||(u.push({id:`dismissed-${f}-user-${m}`,questionId:f,userId:m,dismissedAt:new Date().toISOString()}),localStorage.setItem(_e,JSON.stringify(u)))}function ye(f,m){return ke().some(p=>p.questionId===f&&p.userId===m)}function $e(){const f=G(),m=k([]),u=k(!1),p=A(()=>f.currentUser),b=A(()=>{var y;return(y=f.currentUser)==null?void 0:y.role}),v=A(()=>p.value?m.value.filter(T=>!ye(T.id,p.value.id)).slice(0,5):[]),o=A(()=>p.value?m.value.filter(y=>!ye(y.id,p.value.id)).length:0);async function i(){if(!p.value){m.value=[];return}if(!f.isSalesman()&&!f.isManager()&&!f.isOperator()){m.value=[];return}u.value=!0;try{const y=await Te(p.value.id,b.value);m.value=y}catch(y){console.error("Error loading actionable questions:",y),m.value=[]}finally{u.value=!1}}function h(y){m.value=m.value.filter(T=>T.id!==y)}function O(y){m.value.unshift(y)}return{questions:v,totalQuestionsCount:o,loading:u,loadQuestions:i,dismissQuestion:h,addFollowUpQuestion:O}}function Ve(){const f=G(),{questions:m,totalQuestionsCount:u,loading:p,loadQuestions:b}=$e(),v=k([]),o=k([]),i=k([]),h=k([]),O=k(!0),y=k(!0),T=A(()=>{const a=o.value.map(d=>({...d,type:"lead",taskType:"Lead",dueTime:d.nextActionDue?new Date(d.nextActionDue).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):null,dueDate:d.nextActionDue?new Date(d.nextActionDue):null})),x=i.value.map(d=>({...d,type:"opportunity",taskType:"Opportunity",dueTime:d.expectedCloseDate?new Date(d.expectedCloseDate).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):null,dueDate:d.expectedCloseDate?new Date(d.expectedCloseDate):null}));return[...a,...x]}),S=A(()=>{const a=[],x=v.value.map(s=>({...s,todoType:"appointment",sortTime:new Date(s.start).getTime(),time:new Date(s.start).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),date:new Date(s.start)}));a.push(...x);const d=T.value.map(s=>{const t=s.dueDate||(s.nextActionDue?new Date(s.nextActionDue):null),c=t&&t<new Date;return{...s,todoType:"task",sortTime:t?t.getTime():0,isOverdue:c,priority:s.priority==="Hot"?1:2}});return a.push(...d),a.sort((s,t)=>s.todoType==="appointment"&&t.todoType!=="appointment"?-1:s.todoType!=="appointment"&&t.todoType==="appointment"?1:s.todoType==="appointment"&&t.todoType==="appointment"?s.sortTime-t.sortTime:s.isOverdue&&!t.isOverdue?-1:!s.isOverdue&&t.isOverdue?1:s.priority!==t.priority?s.priority-t.priority:s.sortTime-t.sortTime)}),B=A(()=>v.value.map(a=>({...a,time:new Date(a.start).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),date:new Date(a.start)})).sort((a,x)=>a.date.getTime()-x.date.getTime())),D=A(()=>T.value.filter(a=>{const x=a.dueDate||(a.nextActionDue?new Date(a.nextActionDue):null);if(!x)return!1;const d=new Date;d.setHours(0,0,0,0);const s=new Date(d);s.setDate(s.getDate()+1);const t=new Date(x);return t.setHours(0,0,0,0),t>=d&&t<s}).sort((a,x)=>{var l,c;const d=new Date,s=a.dueDate<d,t=x.dueDate<d;return s&&!t?-1:!s&&t?1:a.priority!==x.priority?(a.priority==="Hot"?1:2)-(x.priority==="Hot"?1:2):(((l=a.dueDate)==null?void 0:l.getTime())||0)-(((c=x.dueDate)==null?void 0:c.getTime())||0)})),$=A(()=>m.value);async function C(){Promise.all([b(),Re().then(a=>{v.value=a,O.value=!1}),Promise.all([f.canAccessLeads()?De().then(a=>{o.value=a}):Promise.resolve(),f.canAccessOpportunities()?Ce().then(a=>{i.value=a}):Promise.resolve()]).then(()=>{y.value=!1}),Me(1).then(a=>{h.value=a})]).catch(a=>{console.error("Error loading dashboard:",a),O.value=!1,y.value=!1})}return{notifications:$,totalNotificationsCount:u,appointmentsToday:B,tasksDueToday:D,prioritizedTodos:S,loadingNotifications:p,loadingAppointments:A(()=>O.value),loadingTasks:A(()=>y.value),loadDashboard:C}}const Qe={class:"flex items-center gap-2 mb-2"},qe={class:"text-fluid-xs"},He={class:"text-fluid-xs"},ze={class:"ml-auto flex items-center gap-2"},Ge={key:1,class:"bg-surface border border-E5E7EB rounded-lg shadow-lg p-1.5 flex items-center gap-1.5 z-10"},Ye=["innerHTML"],Fe={class:"flex gap-2 flex-wrap justify-end mt-3"},Je={__name:"ActionableQuestionCard",props:{question:{type:Object,required:!0}},emits:["answer-yes","answer-no","reassign","view-task","dismiss"],setup(f,{emit:m}){const u=f,p=m,b=k(!1),v=k(!1),o=G();je();const i=()=>{var d,s,t;const x=((d=u.question.opportunity)==null?void 0:d.assignee)||((s=u.question.lead)==null?void 0:s.assignee);return x?x===((t=o.currentUser)==null?void 0:t.name)?"me":x:"Unknown"},h=()=>{const x=u.question.customer.name,d=u.question.question,s=`<a href="#" class="font-bold text-brand-red hover:text-brand-red-dark hover:underline" onclick="event.preventDefault()">${x}</a>`;return d.replace(new RegExp(x,"g"),s)},O=x=>x===1?"bg-red-50 text-red-600 border-red-100":x<=3?"bg-amber-50 text-amber-600 border-amber-100":"bg-emerald-50 text-emerald-600 border-emerald-100",y=x=>x===1?"CRITICAL":x<=3?"HIGH":"MEDIUM",T=()=>{if(!u.question.createdAt&&!u.question.appointmentDate)return"Just now";const x=new Date(u.question.createdAt||u.question.appointmentDate),s=new Date-x,t=Math.floor(s/6e4),l=Math.floor(t/60),c=Math.floor(l/24);return t<1?"Just now":t<60?`${t} min ago`:l<24?`${l} hours ago`:c===1?"1 day ago":c<7?`${c} days ago`:`${Math.floor(c/7)} weeks ago`},S=()=>p("answer-yes",u.question),B=()=>p("answer-no",u.question),D=()=>p("reassign",u.question),$=()=>p("view-task",u.question),C=x=>{x.target.tagName==="A"&&(x.preventDefault(),$())},a=()=>{v.value=!0,setTimeout(()=>{p("dismiss",u.question)},200)};return(x,d)=>(r(),n("div",{class:N(["bg-surface border border-E5E7EB rounded-lg p-4 hover:border-blue-300 hover:shadow-sm transition-all",v.value?"opacity-50":""])},[e("div",Qe,[e("span",{class:N(["text-xs font-bold px-2 py-0.5 rounded border whitespace-nowrap",O(f.question.priority)])},g(y(f.question.priority)),3),e("span",qe,g(T()),1),e("span",He,"• Owner: "+g(i()),1),e("div",ze,[b.value?(r(),n("div",Ge,[d[3]||(d[3]=e("span",{class:"text-fluid-xs whitespace-nowrap"},"Dismiss?",-1)),e("button",{onClick:a,class:"px-2 py-0.5 text-fluid-xs font-medium text-rose-700 bg-rose-50 hover:bg-rose-100 border border-rose-200 rounded transition-colors"}," Yes "),e("button",{onClick:d[1]||(d[1]=s=>b.value=!1),class:"px-2 py-0.5 text-fluid-xs font-medium text-body hover:text-heading transition-colors"}," No ")])):(r(),n("button",{key:0,onClick:d[0]||(d[0]=s=>b.value=!0),class:"w-7 h-7 flex items-center justify-center rounded text-sub hover:text-body hover:bg-surfaceSecondary transition-colors",title:"Dismiss"},[...d[2]||(d[2]=[e("i",{class:"fa-solid fa-xmark text-sm"},null,-1)])]))])]),e("div",{class:"mb-2",onClick:C},[e("p",{class:"text-heading text-fluid-sm mb-1",innerHTML:h()},null,8,Ye)]),e("div",Fe,[f.question.type==="appointment-followup"?(r(),n(E,{key:0},[e("button",{onClick:S,class:"px-3 py-1.5 text-fluid-xs font-medium !bg-brand-dark !text-white border border-brand-dark rounded-2xl hover:!bg-brand-darkDarker hover:border-brand-darkDarker transition-colors"}," Yes "),e("button",{onClick:B,class:"px-3 py-1.5 text-fluid-xs font-medium bg-surface text-brand-dark border border-D1D5DB rounded-2xl hover:brightness-95 transition-colors"}," No ")],64)):f.question.type==="ns-followup"?(r(),n(E,{key:1},[e("button",{onClick:S,class:"px-3 py-1.5 text-fluid-xs font-medium !bg-brand-dark !text-white border border-brand-dark rounded-2xl hover:!bg-brand-darkDarker hover:border-brand-darkDarker transition-colors"}," Yes "),e("button",{onClick:B,class:"px-3 py-1.5 text-fluid-xs font-medium bg-surface text-brand-dark border border-D1D5DB rounded-2xl hover:brightness-95 transition-colors"}," No "),e("button",{onClick:D,class:"px-3 py-1.5 text-fluid-xs font-medium bg-surface text-brand-dark border border-D1D5DB rounded-2xl hover:brightness-95 transition-colors"}," Reassign ")],64)):f.question.type==="offer-followup"?(r(),n("button",{key:2,onClick:$,class:"px-3 py-1.5 text-fluid-xs font-medium !bg-brand-dark !text-white border border-brand-dark rounded-2xl hover:!bg-brand-darkDarker hover:border-brand-darkDarker transition-colors"}," View Opportunity ")):f.question.type==="stuck-opportunity"?(r(),n(E,{key:3},[e("button",{onClick:S,class:"px-3 py-1.5 text-fluid-xs font-medium !bg-brand-dark !text-white border border-brand-dark rounded-2xl hover:!bg-brand-darkDarker hover:border-brand-darkDarker transition-colors"}," Yes "),e("button",{onClick:B,class:"px-3 py-1.5 text-fluid-xs font-medium bg-surface text-brand-dark border border-D1D5DB rounded-2xl hover:brightness-95 transition-colors"}," No "),e("button",{onClick:D,class:"px-3 py-1.5 text-fluid-xs font-medium bg-surface text-brand-dark border border-D1D5DB rounded-2xl hover:brightness-95 transition-colors"}," Reassign ")],64)):f.question.type==="lead-qualification-urgency"?(r(),n(E,{key:4},[e("button",{onClick:S,class:"px-3 py-1.5 text-fluid-xs font-medium !bg-brand-dark !text-white border border-brand-dark rounded-2xl hover:!bg-brand-darkDarker hover:border-brand-darkDarker transition-colors"}," Yes "),e("button",{onClick:B,class:"px-3 py-1.5 text-fluid-xs font-medium bg-surface text-brand-dark border border-D1D5DB rounded-2xl hover:brightness-95 transition-colors"}," No "),e("button",{onClick:D,class:"px-3 py-1.5 text-fluid-xs font-medium bg-surface text-brand-dark border border-D1D5DB rounded-2xl hover:brightness-95 transition-colors"}," Reassign ")],64)):w("",!0)])],2))}},We={class:"space-y-3"},Xe={key:0,class:"text-center py-8 text-sub"},Ke=["onClick"],Ze={class:"flex items-start justify-between gap-4"},et={class:"flex-1 min-w-0"},tt={class:"flex items-center gap-2 mb-1"},st={class:"text-fluid-sm font-semibold text-heading mb-1"},ot={class:"text-fluid-xs mb-2"},rt={key:0},nt={class:"flex items-center gap-2 text-fluid-xs text-sub"},it={key:0},lt={key:1},at=["onClick"],dt={__name:"TodaysAppointments",props:{appointments:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},setup(f){const m=Z(),u=v=>{const o=new Date,h=(new Date(v)-o)/(1e3*60*60);return h<0?"bg-red-100 text-red-700 border-red-200":h<2?"bg-orange-100 text-orange-700 border-orange-200":"bg-blue-100 text-blue-700 border-blue-200"},p=v=>({confirmed:"bg-green-50 text-green-700 border-green-200",scheduled:"bg-blue-50 text-blue-700 border-blue-200",pending:"bg-yellow-50 text-yellow-700 border-yellow-200",cancelled:"bg-red-50 text-red-700 border-red-200","no-show":"bg-surfaceSecondary text-body border"})[v]||"bg-surfaceSecondary text-body border",b=v=>{v.opportunityId?m.push(`/tasks/${v.opportunityId}?type=opportunity`):v.leadId?m.push(`/tasks/${v.leadId}?type=lead`):m.push("/calendar")};return(v,o)=>(r(),n("div",We,[f.loading?(r(),n(E,{key:0},V(3,i=>e("div",{key:`skeleton-${i}`,class:"bg-surface border border-E5E7EB rounded-lg p-4"},[...o[0]||(o[0]=[ee('<div class="flex items-start justify-between gap-4"><div class="flex-1 min-w-0 space-y-2"><div class="flex items-center gap-2"><div class="h-5 bg-surfaceTertiary rounded w-16 animate-pulse"></div><div class="h-5 bg-surfaceTertiary rounded w-20 animate-pulse"></div></div><div class="h-4 bg-surfaceTertiary rounded w-32 animate-pulse"></div><div class="h-3 bg-surfaceTertiary rounded w-24 animate-pulse"></div><div class="h-3 bg-surfaceTertiary rounded w-20 animate-pulse"></div></div><div class="h-4 w-4 bg-surfaceTertiary rounded animate-pulse"></div></div>',1)])])),64)):(r(),n(E,{key:1},[f.appointments.length===0?(r(),n("div",Xe,[...o[1]||(o[1]=[e("i",{class:"fa-solid fa-calendar-check text-4xl mb-2 text-gray-300"},null,-1),e("p",{class:"text-fluid-sm"},"No appointments scheduled for today",-1)])])):w("",!0),(r(!0),n(E,null,V(f.appointments,i=>(r(),n("div",{key:i.id,onClick:h=>b(i),class:"bg-surface border border-E5E7EB rounded-lg p-4 hover:border-blue-300 hover:shadow-sm transition-all cursor-pointer"},[e("div",Ze,[e("div",et,[e("div",tt,[e("span",{class:N(["text-fluid-xs font-bold px-2 py-0.5 rounded",u(i.date)])},g(i.time),3),e("span",{class:N(["text-fluid-xs font-medium px-2 py-0.5 rounded border",p(i.status)])},g(i.status),3)]),e("h4",st,g(i.customer||i.title),1),e("p",ot,[K(g(i.type)+" ",1),i.vehicle?(r(),n("span",rt," - "+g(i.vehicle),1)):w("",!0)]),e("div",nt,[o[2]||(o[2]=e("i",{class:"fa-solid fa-user text-sub"},null,-1)),i.assigneeType==="team"?(r(),n("span",it,g(i.team)+" Team ",1)):(r(),n("span",lt,g(i.assignee||"Unassigned"),1))])]),e("button",{onClick:he(h=>b(i),["stop"]),class:"text-sub hover:text-blue-600 transition-colors"},[...o[3]||(o[3]=[e("i",{class:"fa-solid fa-chevron-right"},null,-1)])],8,at)])],8,Ke))),128))],64))]))}},ut={class:"space-y-3"},ct={key:0,class:"text-center py-8 text-sub"},ft=["onClick"],pt={class:"flex items-start justify-between gap-4"},vt={class:"flex-1 min-w-0"},xt={class:"flex items-center gap-2 mb-1"},gt={key:0,class:"text-fluid-xs font-bold px-2 py-0.5 rounded bg-red-50 text-red-700 border border-red-200 flex items-center gap-1"},bt={key:1,class:"text-fluid-xs font-medium px-2 py-0.5 rounded bg-surfaceSecondary text-body border border-E5E7EB"},mt={key:3,class:"text-fluid-xs font-bold px-2 py-0.5 rounded bg-red-100 text-red-700 border border-red-200"},yt={class:"text-fluid-sm font-semibold text-heading mb-1"},ht={class:"text-fluid-xs mb-2"},wt={key:0},_t={class:"flex items-center gap-2 text-fluid-xs text-sub"},kt={key:0,class:"text-sub"},$t=["onClick"],Tt={__name:"TodaysTasks",props:{tasks:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},setup(f){const m=Z(),u=b=>{if(!b)return"bg-surfaceSecondary text-body border";const v=new Date,i=(new Date(b)-v)/(1e3*60*60);return i<0?"bg-red-100 text-red-700 border-red-200":i<2?"bg-orange-100 text-orange-700 border-orange-200":"bg-blue-100 text-blue-700 border-blue-200"},p=b=>{m.push(`/tasks/${b.id}?type=${b.type}`)};return(b,v)=>(r(),n("div",ut,[f.loading?(r(),n(E,{key:0},V(3,o=>e("div",{key:`skeleton-${o}`,class:"bg-surface border border-E5E7EB rounded-lg p-4"},[...v[0]||(v[0]=[ee('<div class="flex items-start justify-between gap-4"><div class="flex-1 min-w-0 space-y-2"><div class="flex items-center gap-2"><div class="h-5 bg-surfaceTertiary rounded w-16 animate-pulse"></div><div class="h-5 bg-surfaceTertiary rounded w-20 animate-pulse"></div></div><div class="h-4 bg-surfaceTertiary rounded w-32 animate-pulse"></div><div class="h-3 bg-surfaceTertiary rounded w-24 animate-pulse"></div><div class="flex items-center gap-2"><div class="h-4 bg-surfaceTertiary rounded w-16 animate-pulse"></div><div class="h-3 bg-surfaceTertiary rounded w-20 animate-pulse"></div></div></div><div class="h-4 w-4 bg-surfaceTertiary rounded animate-pulse"></div></div>',1)])])),64)):(r(),n(E,{key:1},[f.tasks.length===0?(r(),n("div",ct,[...v[1]||(v[1]=[e("i",{class:"fa-solid fa-tasks text-4xl mb-2 text-gray-300"},null,-1),e("p",{class:"text-fluid-sm"},"No tasks due today",-1)])])):w("",!0),(r(!0),n(E,null,V(f.tasks,o=>{var i;return r(),n("div",{key:`${o.type}-${o.id}`,onClick:h=>p(o),class:"bg-surface border border-E5E7EB rounded-lg p-4 hover:border-blue-300 hover:shadow-sm transition-all cursor-pointer"},[e("div",pt,[e("div",vt,[e("div",xt,[o.priority==="Hot"?(r(),n("span",gt,[...v[2]||(v[2]=[e("i",{class:"fa-solid fa-fire text-fluid-xs"},null,-1),K(" HOT ",-1)])])):(r(),n("span",bt," Normal ")),o.dueTime?(r(),n("span",{key:2,class:N(["text-fluid-xs font-bold px-2 py-0.5 rounded",u(o.dueDate)])},g(o.dueTime),3)):w("",!0),o.isOverdue?(r(),n("span",mt," OVERDUE ")):w("",!0)]),e("h4",yt,g(((i=o.customer)==null?void 0:i.name)||"Unknown Customer"),1),e("p",ht,[K(g(o.taskType)+" ",1),o.requestedCar||o.vehicle?(r(),n("span",wt," - "+g(o.requestedCar?`${o.requestedCar.brand} ${o.requestedCar.model}`:`${o.vehicle.brand} ${o.vehicle.model}`),1)):w("",!0)]),e("div",_t,[e("span",{class:N(["px-2 py-0.5 rounded border text-fluid-xs font-bold uppercase",o.type==="lead"?"bg-blue-50 text-blue-700 border-blue-200":"bg-purple-50 text-purple-700 border-purple-200"])},g(o.type==="lead"?"Lead":"Opportunity"),3),o.stage||o.displayStage?(r(),n("span",kt,g(o.displayStage||o.stage),1)):w("",!0)])]),e("button",{onClick:he(h=>p(o),["stop"]),class:"text-sub hover:text-blue-600 transition-colors"},[...v[3]||(v[3]=[e("i",{class:"fa-solid fa-chevron-right"},null,-1)])],8,$t)])],8,ft)}),128))],64))]))}},Dt={class:"rounded-card flex flex-col",style:{"background-color":"var(--base-muted, #f5f5f5)"}},Ct={class:"px-4 py-4 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-0 shrink-0"},Et={class:"bg-white rounded-lg p-4 shadow-sm flex flex-col",style:{"box-shadow":"var(--nsc-card-shadow)"}},At={key:0,class:"space-y-4"},St={key:1,class:"space-y-4"},Bt={class:"bg-surface rounded-lg p-3 border border-E5E7EB"},Ot={class:"flex items-center justify-between mb-2"},Rt={class:"text-fluid-xs text-gray-600"},Mt={class:"bg-surface rounded-lg p-3 border border-E5E7EB"},jt={class:"flex items-center justify-between mb-2"},Nt={class:"w-full bg-gray-200 rounded-full h-2 mt-2"},It={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},Ut={class:"bg-surface rounded-lg p-3 border border-E5E7EB"},Pt={class:"flex items-start justify-between gap-2"},Lt={class:"flex-1"},Vt={class:"text-fluid-sm font-bold text-gray-900 mb-1"},Qt={key:0,class:"h-12 w-16 flex-shrink-0"},qt={class:"w-full h-full overflow-visible",viewBox:"0 0 100 40",preserveAspectRatio:"none"},Ht=["d"],zt=["d"],Gt={class:"bg-surface rounded-lg p-3 border border-E5E7EB"},Yt={class:"flex items-start justify-between gap-2"},Ft={class:"flex-1"},Jt={class:"text-fluid-sm font-bold text-gray-900 mb-1"},Wt={key:0,class:"h-12 w-16 flex-shrink-0"},Xt={class:"w-full h-full overflow-visible",viewBox:"0 0 100 40",preserveAspectRatio:"none"},Kt=["d"],Zt=["d"],es={key:2,class:"space-y-4"},ts={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},ss={class:"bg-surface rounded-lg p-3 border border-E5E7EB"},os={class:"flex items-start justify-between gap-2"},rs={class:"flex-1"},ns={class:"text-fluid-sm font-bold text-gray-900 mb-1"},is={key:0,class:"h-12 w-16 flex-shrink-0"},ls={class:"w-full h-full overflow-visible",viewBox:"0 0 100 40",preserveAspectRatio:"none"},as=["d"],ds=["d"],us={class:"bg-surface rounded-lg p-3 border border-E5E7EB"},cs={class:"flex items-start justify-between gap-2"},fs={class:"flex-1"},ps={class:"text-fluid-sm font-bold text-gray-900 mb-1"},vs={key:0,class:"h-12 w-16 flex-shrink-0"},xs={class:"w-full h-full overflow-visible",viewBox:"0 0 100 40",preserveAspectRatio:"none"},gs=["d"],bs=["d"],ms={class:"space-y-2"},ys={class:"flex items-center justify-between text-fluid-xs"},hs={class:"font-bold"},ws={class:"w-full bg-gray-200 rounded-full h-2"},_s={class:"flex items-center justify-between text-fluid-xs"},ks={class:"font-bold"},$s={class:"w-full bg-gray-200 rounded-full h-2"},Ts={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},Ds={class:"bg-surface rounded-lg p-3 border border-E5E7EB"},Cs={class:"flex items-start justify-between gap-2"},Es={class:"flex-1"},As={class:"text-fluid-sm font-bold text-gray-900 mb-1"},Ss={key:0,class:"h-12 w-16 flex-shrink-0"},Bs={class:"w-full h-full overflow-visible",viewBox:"0 0 100 40",preserveAspectRatio:"none"},Os=["d"],Rs=["d"],Ms={class:"bg-surface rounded-lg p-3 border border-E5E7EB"},js={class:"flex items-start justify-between gap-2"},Ns={class:"flex-1"},Is={class:"text-fluid-sm font-bold text-gray-900 mb-1"},Us={key:0,class:"h-12 w-16 flex-shrink-0"},Ps={class:"w-full h-full overflow-visible",viewBox:"0 0 100 40",preserveAspectRatio:"none"},Ls=["d"],Vs=["d"],Qs={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},qs={class:"bg-surface rounded-lg p-3 border border-E5E7EB"},Hs={class:"flex items-start justify-between gap-2"},zs={class:"flex-1"},Gs={class:"text-fluid-sm font-bold text-gray-900 mb-1"},Ys={key:0,class:"h-12 w-16 flex-shrink-0"},Fs={class:"w-full h-full overflow-visible",viewBox:"0 0 100 40",preserveAspectRatio:"none"},Js=["d"],Ws=["d"],Xs={class:"bg-surface rounded-lg p-3 border border-E5E7EB"},Ks={class:"flex items-start justify-between gap-2"},Zs={class:"flex-1"},eo={class:"text-fluid-sm font-bold text-red-600 mb-1"},to={key:0,class:"h-12 w-16 flex-shrink-0"},so={class:"w-full h-full overflow-visible",viewBox:"0 0 100 40",preserveAspectRatio:"none"},oo=["d"],ro=["d"],no={key:3,class:"space-y-4"},io={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},lo={class:"bg-surface border border-E5E7EB rounded-lg p-6 flex flex-col items-center justify-center"},ao={class:"relative w-24 h-24 sm:w-28 sm:h-28 mb-3"},uo={class:"w-full h-full transform -rotate-90",viewBox:"0 0 100 100"},co=["stroke-dasharray"],fo={class:"absolute inset-0 flex items-center justify-center"},po={class:"text-center"},vo={class:"text-fluid-sm font-bold text-green-700"},xo={class:"text-fluid-xs text-green-600 text-center"},go={class:"lg:col-span-2 bg-surface rounded-lg p-6 md:p-8"},bo={class:"space-y-3"},mo={class:"flex items-center gap-3 mb-1"},yo={class:"text-fluid-xs font-medium text-body w-32 sm:w-40 flex-shrink-0"},ho={class:"flex-1 relative"},wo={class:"w-full bg-gray-200 rounded-full h-6 overflow-hidden"},_o={class:"text-fluid-xs font-bold text-gray-900"},ko={class:"text-fluid-xs font-bold text-gray-900 w-12 text-right flex-shrink-0"},$o={key:4,class:"text-center py-8 text-gray-500"},To={__name:"PerformanceWidget",setup(f){const m=G(),u=A(()=>m.userRole()),p=A(()=>{var s;return(s=m.currentUser)==null?void 0:s.id}),b=k("month"),v=k(!0),o=k(null),i=k(null),h=k(null),O=A(()=>{var l;if(!((l=o.value)!=null&&l.slaCompliance))return 0;const{completed:s,total:t}=o.value.slaCompliance;return t>0?Math.round(s/t*100*10)/10:0}),y=(s=!1)=>{var l,c;const t=((c=(l=o.value)==null?void 0:l.tasksPerDay)==null?void 0:c.current)||0;return t>=40?s?"bg-green-600":"text-green-600":t>=20?s?"bg-yellow-600":"text-yellow-600":s?"bg-red-600":"text-red-600"},T=s=>{var c,R;if(!i.value)return 0;const t=((c=i.value.revenue)==null?void 0:c[s])||0,l=((R=i.value.revenueTargets)==null?void 0:R[s])||1;return Math.round(t/l*100)},S=s=>s>=1e6?(s/1e6).toFixed(1)+"M":s>=1e3?(s/1e3).toFixed(0)+"k":s.toString(),B=s=>s>=1e3?(s/1e3).toFixed(1)+"k":s.toString(),D=s=>({red:"bg-red-300",orange:"bg-orange-300",blue:"bg-blue-300",gray:"bg-gray-300"})[s]||"bg-gray-300",$=s=>{var t,l,c;return i.value?s==="contractsClosed"?((t=i.value.contractsClosed)==null?void 0:t[`${b.value}Trend`])||null:s==="revenue"?((l=i.value.revenue)==null?void 0:l[`${b.value}Trend`])||null:s==="newOpportunities"&&((c=i.value.newOpportunities)==null?void 0:c[`${b.value}Trend`])||null:null},C=s=>{if(!s||s.length===0)return"";const t=Math.max(...s),l=Math.min(...s),c=t-l||1,R=100,Q=40,I=4,U=s.map((P,M)=>({x:M/(s.length-1)*(R-I*2)+I,y:Q-I-(P-l)/c*(Q-I*2)}));if(U.length<2)return"";let H=`M ${U[0].x},${U[0].y}`;for(let P=0;P<U.length-1;P++){const M=U[P],L=U[P+1],Y=M.x+(L.x-M.x)/2,F=M.x+(L.x-M.x)/2;H+=` C ${Y},${M.y} ${F},${L.y} ${L.x},${L.y}`}return H},a=s=>{const t=C(s);if(!t)return"";const l=100,c=40,R=4,Q=R,I=l-R;return`${t} L ${I},${c} L ${Q},${c} Z`},x=s=>s>=20?"Excellent performance":s>=15?"Good performance":s>=10?"Average performance":"Needs improvement",d=async()=>{v.value=!0;try{u.value==="operator"?o.value=await Ie(p.value,b.value):u.value==="salesman"?i.value=await Ue(p.value,b.value):u.value==="manager"&&(h.value=await Pe(b.value))}catch(s){console.error("Error loading performance metrics:",s)}finally{v.value=!1}};return Ee([p,u],()=>{d()},{immediate:!1}),we(()=>{d()}),(s,t)=>{var l,c,R,Q,I,U,H,P,M,L,Y,F,te,se,oe,re,ne,ie,le,ae,de,ue,ce,fe,pe,ve,xe,ge,be,me;return r(),n("div",Dt,[e("div",Ct,[t[2]||(t[2]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fa-solid fa-chart-line text-heading"}),e("h2",{class:"text-fluid-sm font-medium text-heading leading-5"},"Performance")],-1)),Ae(e("select",{"onUpdate:modelValue":t[0]||(t[0]=j=>b.value=j),onChange:d,class:"input text-fluid-xs w-full sm:w-auto"},[...t[1]||(t[1]=[e("option",{value:"month"},"Month",-1),e("option",{value:"quarter"},"Quarter",-1),e("option",{value:"year"},"Year",-1)])],544),[[Se,b.value]])]),e("div",Et,[v.value?(r(),n("div",At,[(r(),n(E,null,V(4,j=>e("div",{key:`skeleton-${j}`,class:"h-16 bg-gray-100 rounded animate-pulse"})),64))])):u.value==="operator"?(r(),n("div",St,[e("div",Bt,[e("div",Ot,[t[3]||(t[3]=e("span",{class:"text-fluid-xs font-medium text-body"},"SLA Compliance",-1)),e("span",{class:N(["text-fluid-xs font-bold",O.value>=90?"text-green-600":"text-yellow-600"])},g(O.value)+"% ",3)]),e("div",Rt,g(((c=(l=o.value)==null?void 0:l.slaCompliance)==null?void 0:c.withinSLA)||0)+" / "+g(((Q=(R=o.value)==null?void 0:R.slaCompliance)==null?void 0:Q.total)||0)+" tasks completed within SLA ",1)]),e("div",Mt,[e("div",jt,[t[4]||(t[4]=e("span",{class:"text-fluid-xs font-medium text-body"},"Tasks Per Day",-1)),e("span",{class:N(["text-fluid-xs font-bold",y()])},g(((U=(I=o.value)==null?void 0:I.tasksPerDay)==null?void 0:U.current)||0)+" / "+g(((P=(H=o.value)==null?void 0:H.tasksPerDay)==null?void 0:P.target)||0),3)]),e("div",Nt,[e("div",{class:N(["h-2 rounded-full transition-all",y(!0)]),style:J({width:`${Math.min((((L=(M=o.value)==null?void 0:M.tasksPerDay)==null?void 0:L.current)||0)/50*100,100)}%`})},null,6)]),t[5]||(t[5]=e("div",{class:"text-fluid-xs text-gray-500 mt-1"},"Target: 20-50 tasks/day",-1))]),e("div",It,[e("div",Ut,[e("div",Pt,[e("div",Lt,[t[6]||(t[6]=e("div",{class:"text-fluid-xs text-gray-500 mb-1"},"Appointments Reserved",-1)),e("div",Vt,g(((Y=o.value)==null?void 0:Y.appointmentsReserved)||0),1)]),(F=o.value)!=null&&F.appointmentsReservedTrend?(r(),n("div",Qt,[(r(),n("svg",qt,[t[7]||(t[7]=e("defs",null,[e("linearGradient",{id:"gradient-appointments",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[e("stop",{offset:"0%",style:{"stop-color":"var(--brand-blue)","stop-opacity":"0.2"}}),e("stop",{offset:"100%",style:{"stop-color":"var(--brand-blue)","stop-opacity":"0"}})])],-1)),e("path",{d:a(o.value.appointmentsReservedTrend),fill:"url(#gradient-appointments)",class:"transition-all duration-700"},null,8,Ht),e("path",{d:C(o.value.appointmentsReservedTrend),stroke:"var(--brand-blue)","stroke-width":"2.5",fill:"none","stroke-linecap":"round","stroke-linejoin":"round",class:"transition-all duration-700"},null,8,zt)]))])):w("",!0)])]),e("div",Gt,[e("div",Yt,[e("div",Ft,[t[8]||(t[8]=e("div",{class:"text-fluid-xs text-gray-500 mb-1"},"Lead-to-Opportunity Rate",-1)),e("div",Jt,g(((te=o.value)==null?void 0:te.leadToOpportunityConversion)||0)+"%",1)]),(se=o.value)!=null&&se.leadToOpportunityConversionTrend?(r(),n("div",Wt,[(r(),n("svg",Xt,[t[9]||(t[9]=e("defs",null,[e("linearGradient",{id:"gradient-lead-opp",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[e("stop",{offset:"0%",style:{"stop-color":"var(--color-success)","stop-opacity":"0.2"}}),e("stop",{offset:"100%",style:{"stop-color":"var(--color-success)","stop-opacity":"0"}})])],-1)),e("path",{d:a(o.value.leadToOpportunityConversionTrend),fill:"url(#gradient-lead-opp)",class:"transition-all duration-700"},null,8,Kt),e("path",{d:C(o.value.leadToOpportunityConversionTrend),stroke:"var(--color-success)","stroke-width":"2.5",fill:"none","stroke-linecap":"round","stroke-linejoin":"round",class:"transition-all duration-700"},null,8,Zt)]))])):w("",!0)])])])])):u.value==="salesman"?(r(),n("div",es,[e("div",ts,[e("div",ss,[e("div",os,[e("div",rs,[t[10]||(t[10]=e("div",{class:"text-fluid-xs text-gray-500 mb-1"},"Contracts Closed",-1)),e("div",ns,g(((re=(oe=i.value)==null?void 0:oe.contractsClosed)==null?void 0:re[b.value])||0),1)]),$("contractsClosed")?(r(),n("div",is,[(r(),n("svg",ls,[t[11]||(t[11]=e("defs",null,[e("linearGradient",{id:"gradient-contracts",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[e("stop",{offset:"0%",style:{"stop-color":"var(--color-success)","stop-opacity":"0.2"}}),e("stop",{offset:"100%",style:{"stop-color":"var(--color-success)","stop-opacity":"0"}})])],-1)),e("path",{d:a($("contractsClosed")),fill:"url(#gradient-contracts)",class:"transition-all duration-700"},null,8,as),e("path",{d:C($("contractsClosed")),stroke:"var(--color-success)","stroke-width":"2.5",fill:"none","stroke-linecap":"round","stroke-linejoin":"round",class:"transition-all duration-700"},null,8,ds)]))])):w("",!0)])]),e("div",us,[e("div",cs,[e("div",fs,[t[12]||(t[12]=e("div",{class:"text-fluid-xs text-gray-500 mb-1"},"Revenue",-1)),e("div",ps,"€"+g(S(((ie=(ne=i.value)==null?void 0:ne.revenue)==null?void 0:ie[b.value])||0)),1)]),$("revenue")?(r(),n("div",vs,[(r(),n("svg",xs,[t[13]||(t[13]=e("defs",null,[e("linearGradient",{id:"gradient-revenue",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[e("stop",{offset:"0%",style:{"stop-color":"var(--brand-blue)","stop-opacity":"0.2"}}),e("stop",{offset:"100%",style:{"stop-color":"var(--brand-blue)","stop-opacity":"0"}})])],-1)),e("path",{d:a($("revenue")),fill:"url(#gradient-revenue)",class:"transition-all duration-700"},null,8,gs),e("path",{d:C($("revenue")),stroke:"var(--brand-blue)","stroke-width":"2.5",fill:"none","stroke-linecap":"round","stroke-linejoin":"round",class:"transition-all duration-700"},null,8,bs)]))])):w("",!0)])])]),e("div",ms,[e("div",ys,[t[14]||(t[14]=e("span",{class:"text-body"},"Monthly Target",-1)),e("span",hs,g(T("month"))+"%",1)]),e("div",ws,[e("div",{class:"h-2 rounded-full bg-brand-blue transition-all",style:J({width:`${Math.min(T("month"),100)}%`})},null,4)]),e("div",_s,[t[15]||(t[15]=e("span",{class:"text-body"},"Quarterly Target",-1)),e("span",ks,g(T("quarter"))+"%",1)]),e("div",$s,[e("div",{class:"h-2 rounded-full bg-brand-blue transition-all",style:J({width:`${Math.min(T("quarter"),100)}%`})},null,4)])]),e("div",Ts,[e("div",Ds,[e("div",Cs,[e("div",Es,[t[16]||(t[16]=e("div",{class:"text-fluid-xs text-gray-500 mb-1"},"Pipeline Value",-1)),e("div",As,"€"+g(S(((le=i.value)==null?void 0:le.pipelineValue)||0)),1)]),(ae=i.value)!=null&&ae.pipelineValueTrend?(r(),n("div",Ss,[(r(),n("svg",Bs,[t[17]||(t[17]=e("defs",null,[e("linearGradient",{id:"gradient-pipeline",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[e("stop",{offset:"0%",style:{"stop-color":"var(--brand-blue)","stop-opacity":"0.2"}}),e("stop",{offset:"100%",style:{"stop-color":"var(--brand-blue)","stop-opacity":"0"}})])],-1)),e("path",{d:a(i.value.pipelineValueTrend),fill:"url(#gradient-pipeline)",class:"transition-all duration-700"},null,8,Os),e("path",{d:C(i.value.pipelineValueTrend),stroke:"var(--brand-blue)","stroke-width":"2.5",fill:"none","stroke-linecap":"round","stroke-linejoin":"round",class:"transition-all duration-700"},null,8,Rs)]))])):w("",!0)])]),e("div",Ms,[e("div",js,[e("div",Ns,[t[18]||(t[18]=e("div",{class:"text-fluid-xs text-gray-500 mb-1"},"Win Rate",-1)),e("div",Is,g(((de=i.value)==null?void 0:de.winRate)||0)+"%",1)]),(ue=i.value)!=null&&ue.winRateTrend?(r(),n("div",Us,[(r(),n("svg",Ps,[t[19]||(t[19]=e("defs",null,[e("linearGradient",{id:"gradient-winrate",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[e("stop",{offset:"0%",style:{"stop-color":"var(--color-success)","stop-opacity":"0.2"}}),e("stop",{offset:"100%",style:{"stop-color":"var(--color-success)","stop-opacity":"0"}})])],-1)),e("path",{d:a(i.value.winRateTrend),fill:"url(#gradient-winrate)",class:"transition-all duration-700"},null,8,Ls),e("path",{d:C(i.value.winRateTrend),stroke:"var(--color-success)","stroke-width":"2.5",fill:"none","stroke-linecap":"round","stroke-linejoin":"round",class:"transition-all duration-700"},null,8,Vs)]))])):w("",!0)])])]),e("div",Qs,[e("div",qs,[e("div",Hs,[e("div",zs,[t[20]||(t[20]=e("div",{class:"text-fluid-xs text-gray-500 mb-1"},"New Opportunities",-1)),e("div",Gs,g(((fe=(ce=i.value)==null?void 0:ce.newOpportunities)==null?void 0:fe[b.value])||0),1)]),$("newOpportunities")?(r(),n("div",Ys,[(r(),n("svg",Fs,[t[21]||(t[21]=e("defs",null,[e("linearGradient",{id:"gradient-new-opp",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[e("stop",{offset:"0%",style:{"stop-color":"var(--color-success)","stop-opacity":"0.2"}}),e("stop",{offset:"100%",style:{"stop-color":"var(--color-success)","stop-opacity":"0"}})])],-1)),e("path",{d:a($("newOpportunities")),fill:"url(#gradient-new-opp)",class:"transition-all duration-700"},null,8,Js),e("path",{d:C($("newOpportunities")),stroke:"var(--color-success)","stroke-width":"2.5",fill:"none","stroke-linecap":"round","stroke-linejoin":"round",class:"transition-all duration-700"},null,8,Ws)]))])):w("",!0)])]),e("div",Xs,[e("div",Ks,[e("div",Zs,[t[22]||(t[22]=e("div",{class:"text-fluid-xs text-gray-500 mb-1"},"Dormant Opportunities",-1)),e("div",eo,g(((pe=i.value)==null?void 0:pe.dormantOpportunities)||0),1)]),(ve=i.value)!=null&&ve.dormantOpportunitiesTrend?(r(),n("div",to,[(r(),n("svg",so,[t[23]||(t[23]=e("defs",null,[e("linearGradient",{id:"gradient-dormant",x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[e("stop",{offset:"0%",style:{"stop-color":"var(--brand-red)","stop-opacity":"0.2"}}),e("stop",{offset:"100%",style:{"stop-color":"var(--brand-red)","stop-opacity":"0"}})])],-1)),e("path",{d:a(i.value.dormantOpportunitiesTrend),fill:"url(#gradient-dormant)",class:"transition-all duration-700"},null,8,oo),e("path",{d:C(i.value.dormantOpportunitiesTrend),stroke:"var(--brand-red)","stroke-width":"2.5",fill:"none","stroke-linecap":"round","stroke-linejoin":"round",class:"transition-all duration-700"},null,8,ro)]))])):w("",!0)])])])])):u.value==="manager"?(r(),n("div",no,[e("div",io,[e("div",lo,[e("div",ao,[(r(),n("svg",uo,[t[24]||(t[24]=e("circle",{cx:"50",cy:"50",r:"42",fill:"none",stroke:"var(--color-success-light)","stroke-width":"8"},null,-1)),e("circle",{cx:"50",cy:"50",r:"42",fill:"none",stroke:"#10b981","stroke-width":"8","stroke-dasharray":`${(((xe=h.value)==null?void 0:xe.conversionRate)||0)*2.64} 265`,"stroke-linecap":"round",class:"transition-all duration-700"},null,8,co)])),e("div",fo,[e("div",po,[e("div",vo,g(((ge=h.value)==null?void 0:ge.conversionRate)||0)+"% ",1)])])]),t[25]||(t[25]=e("div",{class:"text-fluid-sm font-bold text-green-800 mb-1"},"Conversion Rate",-1)),e("div",xo,g(x(((be=h.value)==null?void 0:be.conversionRate)||0)),1)]),e("div",go,[t[26]||(t[26]=e("h3",{class:"text-fluid-sm font-bold text-gray-900 mb-4"},"Sales Funnel",-1)),e("div",bo,[(r(!0),n(E,null,V(((me=h.value)==null?void 0:me.stages)||[],(j,zo)=>(r(),n("div",{key:j.name,class:"relative"},[e("div",mo,[e("span",yo,g(j.name),1),e("div",ho,[e("div",wo,[e("div",{class:N(["h-full rounded-full transition-all duration-700 flex items-center justify-end pr-2",D(j.color)]),style:J({width:`${j.percentage}%`,minWidth:"2px"})},[e("span",_o,g(B(j.count)),1)],6)])]),e("span",ko,g(j.percentage)+"%",1)])]))),128))])])])])):(r(),n("div",$o,[...t[27]||(t[27]=[e("i",{class:"fa-solid fa-chart-line text-4xl mb-2 text-gray-300"},null,-1),e("p",{class:"text-fluid-sm"},"Performance metrics not available",-1),e("p",{class:"text-fluid-xs text-sub mt-1"},"Contact your administrator",-1)])]))])])}}},Do={class:"page-container"},Co={class:"p-4 md:p-6 lg:p-8"},Eo={class:"grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6 items-start"},Ao={class:"lg:col-span-2 space-y-4 md:space-y-6"},So={class:"rounded-card flex flex-col",style:{"background-color":"var(--base-muted, #f5f5f5)"}},Bo={class:"px-4 py-4 flex items-center justify-between shrink-0"},Oo={class:"flex items-center gap-2"},Ro={class:"bg-white rounded-lg p-4 shadow-sm flex flex-col",style:{"box-shadow":"var(--nsc-card-shadow)"}},Mo={class:"space-y-3"},jo={key:0,class:"text-center py-8 text-sub"},No={class:"space-y-4 md:space-y-6"},Io={class:"rounded-card flex flex-col",style:{"background-color":"var(--base-muted, #f5f5f5)"}},Uo={class:"px-4 py-4 flex items-center justify-between shrink-0"},Po={class:"flex items-center gap-2"},Lo={class:"bg-white rounded-lg p-4 shadow-sm flex flex-col",style:{"box-shadow":"var(--nsc-card-shadow)"}},Vo={class:"rounded-card flex flex-col",style:{"background-color":"var(--base-muted, #f5f5f5)"}},Qo={class:"px-4 py-4 flex items-center justify-between shrink-0"},qo={class:"flex items-center gap-2"},Ho={class:"bg-white rounded-lg p-4 shadow-sm flex flex-col",style:{"box-shadow":"var(--nsc-card-shadow)"}},Ko={__name:"Home",setup(f){const m=Z(),u=G(),{dismissQuestion:p,addFollowUpQuestion:b}=$e(),{notifications:v,totalNotificationsCount:o,appointmentsToday:i,tasksDueToday:h,loadingNotifications:O,loadingAppointments:y,loadingTasks:T,loadDashboard:S}=Ve(),B=k(!1),D=k(null);we(async()=>{await S()});const $=async t=>{t.type==="appointment-followup"?(p(t.id),b({id:`offer-followup-${t.opportunityId}`,type:"offer-followup",priority:5,question:`What was the offer given to ${t.customer.name}?`,customer:t.customer,opportunityId:t.opportunityId,opportunity:t.opportunity,createdAt:new Date().toISOString()})):(t.type==="ns-followup"||t.type==="stuck-opportunity"||t.type==="lead-qualification-urgency")&&p(t.id)},C=async t=>{var l;if(t.type==="appointment-followup")try{const c=(l=u.currentUser)==null?void 0:l.id;c&&(await Oe(t.opportunityId,c),p(t.id),await S())}catch(c){console.error("Error creating NS task:",c)}else t.type==="ns-followup"?p(t.id):t.type==="stuck-opportunity"?m.push(`/tasks/${t.opportunityId}?type=opportunity`):t.type==="lead-qualification-urgency"&&m.push(`/tasks/${t.leadId}?type=lead`)},a=t=>{D.value=t,B.value=!0},x=async t=>{if(D.value)try{const l=D.value.opportunityId||D.value.leadId;D.value.opportunityId&&await Be(l,t),p(D.value.id),B.value=!1,D.value=null,await S()}catch(l){console.error("Error reassigning:",l)}},d=t=>{t.opportunityId?m.push(`/tasks/${t.opportunityId}?type=opportunity`):t.leadId&&m.push(`/tasks/${t.leadId}?type=lead`)},s=t=>{u.currentUser&&Le(t.id,u.currentUser.id),p(t.id)};return(t,l)=>(r(),n("div",Do,[e("div",Co,[e("div",Eo,[e("div",Ao,[q(To),e("div",So,[e("div",Bo,[e("div",Oo,[l[4]||(l[4]=e("i",{class:"fa-solid fa-bolt text-heading"},null,-1)),l[5]||(l[5]=e("h2",{class:"text-fluid-sm font-medium text-heading leading-5"},"Quick Actions",-1)),_(o)>0?(r(),z(_(W),{key:0,text:String(_(o)),size:"small",theme:"blue"},null,8,["text"])):w("",!0)]),_(o)>5?(r(),z(_(X),{key:0,label:"View all →",variant:"ghost",size:"small",onClick:l[0]||(l[0]=c=>t.$router.push("/tasks")),class:"text-fluid-xs"})):w("",!0)]),e("div",Ro,[e("div",Mo,[_(O)?(r(),n(E,{key:0},V(3,c=>e("div",{key:`skeleton-${c}`,class:"bg-surfaceSecondary border border-E5E7EB rounded-lg p-4"},[...l[6]||(l[6]=[ee('<div class="space-y-2"><div class="h-4 bg-surfaceTertiary rounded w-3/4 animate-pulse"></div><div class="h-3 bg-surfaceTertiary rounded w-1/2 animate-pulse"></div><div class="flex gap-2 mt-3"><div class="h-8 bg-surfaceTertiary rounded flex-1 animate-pulse"></div><div class="h-8 bg-surfaceTertiary rounded flex-1 animate-pulse"></div></div></div>',1)])])),64)):(r(),n(E,{key:1},[_(v).length===0?(r(),n("div",jo,[...l[7]||(l[7]=[e("i",{class:"fa-solid fa-check-circle text-4xl mb-2 text-sub opacity-50"},null,-1),e("p",{class:"text-fluid-sm"},"All caught up!",-1),e("p",{class:"text-fluid-xs mt-1"},"No quick actions needed",-1)])])):w("",!0),(r(!0),n(E,null,V(_(v).slice(0,5),c=>(r(),z(Je,{key:c.id,question:c,onAnswerYes:$,onAnswerNo:C,onReassign:a,onViewTask:d,onDismiss:s},null,8,["question"]))),128))],64))])])])]),e("div",No,[e("div",Io,[e("div",Uo,[e("div",Po,[l[8]||(l[8]=e("i",{class:"fa-solid fa-tasks text-heading"},null,-1)),l[9]||(l[9]=e("h2",{class:"text-fluid-sm font-medium text-heading leading-5"},"Tasks Due Today",-1)),_(h).length>0?(r(),z(_(W),{key:0,text:String(_(h).length),size:"small",theme:"red"},null,8,["text"])):w("",!0)]),q(_(X),{label:"View all tasks →",variant:"ghost",size:"small",onClick:l[1]||(l[1]=c=>t.$router.push("/tasks")),class:"text-fluid-xs"})]),e("div",Lo,[q(Tt,{tasks:_(h),loading:_(T)},null,8,["tasks","loading"])])]),e("div",Vo,[e("div",Qo,[e("div",qo,[l[10]||(l[10]=e("i",{class:"fa-solid fa-calendar text-heading"},null,-1)),l[11]||(l[11]=e("h2",{class:"text-fluid-sm font-medium text-heading leading-5"},"Appointments Today",-1)),_(i).length>0?(r(),z(_(W),{key:0,text:String(_(i).length),size:"small",theme:"blue"},null,8,["text"])):w("",!0)]),q(_(X),{label:"View calendar →",variant:"ghost",size:"small",onClick:l[2]||(l[2]=c=>t.$router.push("/calendar")),class:"text-fluid-xs"})]),e("div",Ho,[q(dt,{appointments:_(i),loading:_(y)},null,8,["appointments","loading"])])])])])]),q(Ne,{show:B.value,onClose:l[3]||(l[3]=c=>B.value=!1),onConfirm:x},null,8,["show"])]))}};export{Ko as default};
