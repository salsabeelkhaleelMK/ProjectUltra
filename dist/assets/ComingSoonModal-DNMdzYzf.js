import{r as D,d as n,o as s,e,g as f,n as A,t as m,C as ae,z as $,w as P,j as T,F,i as R,c as I,Y as be,l as M,G as se,B as O,k as z,A as G,U as xe,h as ve,p as E,y as H,m as S,Z as he,S as ke,K as we}from"./index-C9aAcNW4.js";import{_ as $e}from"./ReassignUserModal-CEAB0Ty1.js";import{_ as Ce}from"./CreateEventModal-CGc8z-Ts.js";import{_ as Se}from"./ModalShell-DIYenJ39.js";const Ae={class:"w-full"},De={class:"flex items-center justify-between gap-3 md:gap-4"},Te={class:"flex items-center gap-3 md:gap-4 flex-1"},Oe={class:"min-w-0 flex-1"},qe={class:"flex items-center gap-2"},Ne={class:"heading-main truncate"},Ie={class:"flex flex-wrap items-center gap-2 mt-1"},Ve={class:"flex items-center gap-1 ml-2"},Ee={class:"relative"},Fe={key:0,class:"absolute top-full right-0 mt-2 w-48 bg-white border border-gray-200 rounded-xl shadow-lg shadow-gray-100/50 z-50 overflow-hidden flex flex-col p-1"},Ue={key:0,class:"border-t border-gray-100 my-1"},je={key:0,class:"mt-4 pt-4 border-t-2 border-dashed border-gray-300 animate-fade-in relative"},Me={class:"flex items-center gap-4"},We={class:"flex flex-wrap items-center gap-x-6 gap-y-2"},Le={class:"flex items-center gap-2"},Be={class:"text-xs text-gray-900 font-medium"},Pe={class:"flex items-center gap-2"},Re={class:"text-xs text-gray-900 font-medium"},ze={class:"flex items-center gap-2"},Ye={class:"w-6 h-6 rounded bg-gray-100 flex items-center justify-center shrink-0"},Ke={key:0,class:"fa-solid fa-map-marker-alt text-gray-500 text-[10px]"},Qe={key:1,class:"fa-regular fa-calendar text-gray-500 text-[10px]"},Ge={class:"text-xs text-gray-900 font-medium"},He={key:0,class:"absolute -bottom-6 left-0 px-2 py-1 bg-gray-900 text-white text-[10px] rounded shadow-lg whitespace-nowrap"},Je={__name:"ContactInfo",props:{initials:{type:String,required:!0},name:{type:String,required:!0},avatarColorClass:{type:String,default:"bg-orange-100 text-orange-600"},email:{type:String,required:!0},phone:{type:String,required:!0},thirdFieldValue:{type:String,required:!0},emailLabel:{type:String,default:"Email"},phoneLabel:{type:String,default:"Phone"},thirdFieldLabel:{type:String,default:"Expected Close"},taskType:{type:String,default:"lead"}},emits:["action"],setup(t,{emit:y}){const l={mounted(i,d){i.clickOutsideEvent=h=>{i===h.target||i.contains(h.target)||d.value()},document.addEventListener("click",i.clickOutsideEvent)},unmounted(i){document.removeEventListener("click",i.clickOutsideEvent)}},g=y,a=D(!1),o=D(!1),b=D(null),u=i=>{o.value=!1,g("action",i)},r=async(i,d)=>{try{await navigator.clipboard.writeText(i),b.value=d,setTimeout(()=>{b.value=null},1500)}catch(h){console.error("Failed to copy:",h)}};return(i,d)=>(s(),n("div",Ae,[e("div",De,[e("div",Te,[e("div",{class:A(["w-12 h-12 rounded-full flex items-center justify-center text-lg font-bold border-2 border-white shadow-sm shrink-0",t.avatarColorClass])},m(t.initials),3),e("div",Oe,[e("div",qe,[e("h1",Ne,m(t.name),1),ae(i.$slots,"name-action")]),e("div",Ie,[ae(i.$slots,"tags")])])]),e("div",Ve,[e("div",Ee,[e("button",{onClick:d[0]||(d[0]=P(h=>o.value=!o.value,["stop"])),class:"w-9 h-9 flex items-center justify-center bg-blue-600 hover:bg-blue-700 text-white rounded-lg shrink-0 transition-colors"},[...d[14]||(d[14]=[e("i",{class:"fa-solid fa-plus text-sm"},null,-1)])]),o.value?$((s(),n("div",Fe,[e("button",{onClick:d[1]||(d[1]=h=>u("note")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Note "),e("button",{onClick:d[2]||(d[2]=h=>u("financing")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Financing "),e("button",{onClick:d[3]||(d[3]=h=>u("tradein")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Trade-in "),e("button",{onClick:d[4]||(d[4]=h=>u("purchase")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Purchase "),e("button",{onClick:d[5]||(d[5]=h=>u("attachment")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Attachment "),d[19]||(d[19]=e("div",{class:"border-t border-gray-100 my-1"},null,-1)),e("button",{onClick:d[6]||(d[6]=h=>u("whatsapp")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...d[15]||(d[15]=[e("i",{class:"fa-brands fa-whatsapp text-xs text-gray-400"},null,-1),T(" WhatsApp msg ",-1)])]),e("button",{onClick:d[7]||(d[7]=h=>u("email")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...d[16]||(d[16]=[e("i",{class:"fa-regular fa-envelope text-xs text-gray-400"},null,-1),T(" Email ",-1)])]),e("button",{onClick:d[8]||(d[8]=h=>u("sms")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...d[17]||(d[17]=[e("i",{class:"fa-solid fa-comment-dots text-xs text-gray-400"},null,-1),T(" SMS ",-1)])]),e("button",{onClick:d[9]||(d[9]=h=>u("call")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...d[18]||(d[18]=[e("i",{class:"fa-solid fa-phone text-xs text-gray-400"},null,-1),T(" Call ",-1)])]),t.taskType==="opportunity"?(s(),n("div",Ue)):f("",!0),t.taskType==="opportunity"?(s(),n("button",{key:1,onClick:d[10]||(d[10]=h=>u("appointment")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Appointment ")):f("",!0)])),[[l,()=>o.value=!1]]):f("",!0)]),e("button",{onClick:d[11]||(d[11]=h=>a.value=!a.value),class:"w-9 h-9 flex items-center justify-center bg-white border border-gray-200 rounded-lg hover:bg-gray-50 shrink-0"},[e("i",{class:A(["fa-solid fa-chevron-up text-sm transition-transform duration-200",{"rotate-180":a.value}])},null,2)])])]),a.value?(s(),n("div",je,[e("div",Me,[e("div",We,[e("div",Le,[d[21]||(d[21]=e("div",{class:"w-6 h-6 rounded bg-gray-100 flex items-center justify-center shrink-0"},[e("i",{class:"fa-regular fa-envelope text-gray-500 text-[10px]"})],-1)),e("span",Be,m(t.email),1),e("button",{onClick:d[12]||(d[12]=P(h=>r(t.email,"email"),["stop"])),class:"w-5 h-5 flex items-center justify-center rounded hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors shrink-0",title:"Copy email"},[...d[20]||(d[20]=[e("i",{class:"fa-regular fa-copy text-[10px]"},null,-1)])])]),e("div",Pe,[d[23]||(d[23]=e("div",{class:"w-6 h-6 rounded bg-gray-100 flex items-center justify-center shrink-0"},[e("i",{class:"fa-solid fa-phone text-gray-500 text-[10px]"})],-1)),e("span",Re,m(t.phone),1),e("button",{onClick:d[13]||(d[13]=P(h=>r(t.phone,"phone"),["stop"])),class:"w-5 h-5 flex items-center justify-center rounded hover:bg-gray-100 text-gray-400 hover:text-gray-600 transition-colors shrink-0",title:"Copy phone"},[...d[22]||(d[22]=[e("i",{class:"fa-regular fa-copy text-[10px]"},null,-1)])])]),e("div",ze,[e("div",Ye,[t.thirdFieldLabel.toLowerCase().includes("address")?(s(),n("i",Ke)):(s(),n("i",Qe))]),e("span",Ge,m(t.thirdFieldValue),1)])])]),b.value?(s(),n("div",He,m(b.value==="email"?"Email":"Phone")+" copied! ",1)):f("",!0)])):f("",!0)]))}},Ze={class:"flex gap-0 md:gap-8 text-base font-medium text-slate-500 py-1"},Xe=["onClick"],_e={class:"hidden md:inline whitespace-nowrap"},et={__name:"Tabs",props:{modelValue:{type:String,required:!0},tabs:{type:Array,required:!0}},emits:["update:modelValue"],setup(t){const y={overview:"fa-solid fa-house",note:"fa-solid fa-note-sticky",communication:"fa-solid fa-comments",attachment:"fa-solid fa-paperclip"},l=g=>y[g]||"fa-solid fa-circle";return(g,a)=>(s(),n("div",Ze,[(s(!0),n(F,null,R(t.tabs,o=>(s(),n("div",{key:o.key,onClick:b=>g.$emit("update:modelValue",o.key),class:A(["flex-1 md:flex-none pb-2 border-b-2 cursor-pointer transition-colors flex items-center justify-center gap-1.5",t.modelValue===o.key?"border-slate-900 text-slate-900":"border-transparent hover:text-slate-700 hover:border-slate-200"])},[e("i",{class:A([l(o.key),"text-base md:text-base"])},null,2),e("span",_e,m(o.label),1),o.count!==void 0?(s(),n("span",{key:0,class:A(["inline-flex items-center justify-center px-1.5 md:px-2 py-0.5 rounded-full text-xs font-semibold",t.modelValue===o.key?"bg-gray-200 text-gray-700":"bg-gray-100 text-gray-500"])},m(o.count),3)):f("",!0)],10,Xe))),128))]))}},tt={class:"metadata-bar w-full"},at={class:"flex items-center gap-1.5 md:gap-2 px-2 md:px-3 py-1.5"},st={class:"flex items-center gap-1.5"},lt={class:"text-[10px] md:text-xs font-bold text-gray-800"},nt={class:"flex items-center gap-1.5 md:gap-2 px-2 md:px-3 py-1.5"},ot={class:"flex items-center gap-1.5 md:gap-2 px-2 md:px-3 py-1.5"},it={class:"text-[10px] md:text-xs font-bold text-gray-800"},rt={__name:"StageOwnerBar",props:{stage:{type:String,required:!0},owner:{type:String,required:!0},source:{type:String,default:""},deliverySubstatus:{type:String,default:null}},emits:["reassign"],setup(t){const y=t,l=I(()=>y.deliverySubstatus?be(y.deliverySubstatus):"");return(g,a)=>(s(),n("div",tt,[e("div",at,[a[1]||(a[1]=e("span",{class:"label-upper text-[9px] md:text-xs"},"Stage",-1)),e("div",st,[e("span",lt,m(t.stage),1),t.deliverySubstatus?(s(),n("span",{key:0,class:A(["text-[9px] md:text-[10px] px-1.5 md:px-2 py-0.5 rounded-full font-medium border",l.value])},m(t.deliverySubstatus),3)):f("",!0)])]),a[5]||(a[5]=e("div",{class:"metadata-divider"},null,-1)),e("div",nt,[a[2]||(a[2]=e("span",{class:"label-upper text-[9px] md:text-xs"},"Owner",-1)),e("button",{onClick:a[0]||(a[0]=o=>g.$emit("reassign")),class:"text-[10px] md:text-xs font-bold text-blue-600 hover:text-blue-700 hover:underline transition-colors cursor-pointer"},m(t.owner),1)]),t.source?(s(),n(F,{key:0},[a[4]||(a[4]=e("div",{class:"metadata-divider"},null,-1)),e("div",ot,[a[3]||(a[3]=e("span",{class:"label-upper text-[9px] md:text-xs"},"Source",-1)),e("span",it,m(t.source),1)])],64)):f("",!0)]))}},dt={key:0,class:"flex-grow border-t border-gray-200"},ut={key:0,class:"absolute top-full right-0 md:left-1/2 md:-translate-x-1/2 mt-2 w-48 bg-white border border-gray-200 rounded-xl shadow-lg shadow-gray-100/50 z-10 overflow-hidden flex flex-col p-1"},ct={key:0,class:"border-t border-gray-100 my-1"},mt={key:1,class:"flex-grow border-t border-gray-200"},ft={__name:"AddNewButton",props:{show:{type:Boolean,default:!0},actions:{type:Array,default:()=>["note","financing","tradein","attachment","email","whatsapp","sms"]},activeTab:{type:String,default:"overview"},inline:{type:Boolean,default:!1}},emits:["action"],setup(t,{emit:y}){const l={mounted(x,c){x.clickOutsideEvent=p=>{x===p.target||x.contains(p.target)||c.value()},document.addEventListener("click",x.clickOutsideEvent)},unmounted(x){document.removeEventListener("click",x.clickOutsideEvent)}},g=t,a=y,o=D(!1),b=I(()=>g.inline?"bg-blue-600 hover:bg-blue-700 text-white font-medium w-9 h-9 rounded-lg shadow-sm transition-all flex items-center justify-center z-20 relative":"bg-gray-50 hover:bg-white border border-gray-200 text-slate-700 font-medium w-9 h-9 rounded-full text-sm shadow-sm transition-all flex items-center justify-center z-20 relative"),u={note:"note",attachment:"attachment",email:"communication",whatsapp:"communication",sms:"communication"},r=I(()=>{if(!g.activeTab||g.activeTab==="overview")return g.actions.filter(c=>!u[c]);const x=Object.entries(u).filter(([,c])=>c===g.activeTab).map(([c])=>c);return g.actions.filter(c=>x.includes(c))}),i=I(()=>r.value.some(x=>["email","whatsapp","sms"].includes(x))),d=I(()=>r.value.some(x=>["addVehicle","configureVehicle"].includes(x))),h=I(()=>r.value.some(x=>["note","financing","tradein","attachment","requestedCar","purchase"].includes(x))),N=x=>{o.value=!1,a("action",x)};return(x,c)=>t.show?(s(),n("div",{key:0,class:A(["relative flex items-center",t.inline?"justify-end mb-0 py-0":"py-1 mb-4"])},[t.inline?f("",!0):(s(),n("div",dt)),e("div",{class:A(["relative",t.inline?"mx-0":"mx-4"])},[e("button",{onClick:c[0]||(c[0]=P(p=>o.value=!o.value,["stop"])),class:A(b.value)},[...c[12]||(c[12]=[e("i",{class:"fa-solid fa-plus text-xs"},null,-1)])],2),o.value?$((s(),n("div",ut,[d.value?(s(),n(F,{key:0},[r.value.includes("addVehicle")?(s(),n("button",{key:0,onClick:c[1]||(c[1]=p=>N("addVehicle")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Add Vehicle ")):f("",!0),r.value.includes("configureVehicle")?(s(),n("button",{key:1,onClick:c[2]||(c[2]=p=>N("configureVehicle")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Configure Vehicle ")):f("",!0)],64)):f("",!0),h.value?(s(),n(F,{key:1},[d.value?(s(),n("div",ct)):f("",!0),r.value.includes("note")?(s(),n("button",{key:1,onClick:c[3]||(c[3]=p=>N("note")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Note ")):f("",!0),r.value.includes("financing")?(s(),n("button",{key:2,onClick:c[4]||(c[4]=p=>N("financing")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Financing ")):f("",!0),r.value.includes("tradein")?(s(),n("button",{key:3,onClick:c[5]||(c[5]=p=>N("tradein")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Trade-in ")):f("",!0),r.value.includes("requestedCar")?(s(),n("button",{key:4,onClick:c[6]||(c[6]=p=>N("requestedCar")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Requested car ")):f("",!0),r.value.includes("purchase")?(s(),n("button",{key:5,onClick:c[7]||(c[7]=p=>N("purchase")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Purchase ")):f("",!0),r.value.includes("attachment")?(s(),n("button",{key:6,onClick:c[8]||(c[8]=p=>N("attachment")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium"}," Attachment ")):f("",!0)],64)):f("",!0),i.value?(s(),n(F,{key:2},[c[16]||(c[16]=e("div",{class:"border-t border-gray-100 my-1"},null,-1)),r.value.includes("email")?(s(),n("button",{key:0,onClick:c[9]||(c[9]=p=>N("email")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...c[13]||(c[13]=[e("i",{class:"fa-regular fa-envelope text-xs text-gray-400"},null,-1),T(" Send Email ",-1)])])):f("",!0),r.value.includes("whatsapp")?(s(),n("button",{key:1,onClick:c[10]||(c[10]=p=>N("whatsapp")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...c[14]||(c[14]=[e("i",{class:"fa-brands fa-whatsapp text-xs text-gray-400"},null,-1),T(" Send WhatsApp ",-1)])])):f("",!0),r.value.includes("sms")?(s(),n("button",{key:2,onClick:c[11]||(c[11]=p=>N("sms")),class:"w-full text-left px-3 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg transition-colors font-medium flex items-center gap-2"},[...c[15]||(c[15]=[e("i",{class:"fa-solid fa-comment-dots text-xs text-gray-400"},null,-1),T(" Send SMS ",-1)])])):f("",!0)],64)):f("",!0)])),[[l,()=>o.value=!1]]):f("",!0)],2),t.inline?f("",!0):(s(),n("div",mt))],2)):f("",!0)}},yt={class:"bg-purple-50/50 border border-purple-100 rounded-lg p-4"},gt={class:"flex items-start gap-3"},pt={class:"flex-1 min-w-0"},bt={class:"font-bold text-sm text-slate-800 mb-2"},xt={class:"space-y-1.5 text-xs text-gray-600"},vt={class:"flex items-center gap-2"},ht={class:"flex items-center gap-2"},kt={class:"flex items-center gap-2"},wt={key:0,class:"mt-2"},$t={__name:"AppointmentWidget",props:{appointmentData:{type:Object,required:!0}},setup(t){const y=t,l=I(()=>y.appointmentData.date?new Date(y.appointmentData.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""),g=I(()=>y.appointmentData.time?y.appointmentData.time:""),a=o=>({scheduled:"bg-blue-100 text-blue-700 border border-blue-200",confirmed:"bg-green-100 text-green-700 border border-green-200",pending:"bg-yellow-100 text-yellow-700 border border-yellow-200",cancelled:"bg-red-100 text-red-700 border border-red-200"})[o==null?void 0:o.toLowerCase()]||"bg-gray-100 text-gray-700 border border-gray-200";return(o,b)=>(s(),n("div",yt,[e("div",gt,[b[3]||(b[3]=e("div",{class:"w-10 h-10 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center shrink-0"},[e("i",{class:"fa-solid fa-calendar text-sm"})],-1)),e("div",pt,[e("h4",bt,m(t.appointmentData.type),1),e("div",xt,[e("div",vt,[b[0]||(b[0]=e("i",{class:"fa-regular fa-calendar text-gray-400"},null,-1)),e("span",null,m(l.value),1)]),e("div",ht,[b[1]||(b[1]=e("i",{class:"fa-regular fa-clock text-gray-400"},null,-1)),e("span",null,m(g.value),1)]),e("div",kt,[b[2]||(b[2]=e("i",{class:"fa-solid fa-user text-gray-400"},null,-1)),e("span",null,m(t.appointmentData.assignee),1)])]),t.appointmentData.status?(s(),n("div",wt,[e("span",{class:A(["inline-flex px-2 py-0.5 rounded text-[10px] font-semibold",a(t.appointmentData.status)])},m(t.appointmentData.status),3)])):f("",!0)])])]))}},Ct={class:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm flex gap-4 animate-fade-in mb-4 feed-item"},St={class:"flex-1"},At={class:"flex items-center gap-2 mb-1"},Dt={class:"text-xs font-bold text-slate-800"},Tt={class:"text-[10px] text-gray-400"},Ot={class:"text-[10px] text-gray-400"},qt={key:0,class:"bg-blue-50 text-blue-600 text-[9px] px-1.5 py-0.5 rounded border border-blue-100"},Nt={class:"ml-auto relative"},It={key:0,class:"absolute right-0 top-full mt-1 w-32 bg-white border border-gray-200 rounded-lg shadow-lg z-10 overflow-hidden"},Vt={key:0,class:"text-sm text-slate-700"},Et={key:1,class:"text-sm text-slate-700 flex items-center gap-2"},Ft={key:2,class:"mt-2"},Ut={key:0},jt={key:1,class:"bg-gray-50 border border-gray-200 rounded-lg p-3"},Mt={key:0},Wt={class:"text-sm font-bold text-slate-800"},Lt={key:0,class:"text-xs text-gray-600 mt-0.5"},Bt={class:"grid grid-cols-2 gap-x-4 gap-y-1 text-xs text-gray-500 mt-2"},Pt={key:0},Rt={key:1},zt={key:2},Yt={key:3},Kt={key:4},Qt={key:1},Gt={class:"text-sm font-bold text-slate-800 mb-2"},Ht={class:"grid grid-cols-2 gap-x-4 gap-y-2 text-xs"},Jt={key:0},Zt={class:"text-slate-700 font-medium ml-1"},Xt={key:1},_t={class:"text-slate-700 font-medium ml-1"},ea={key:2},ta={class:"text-slate-700 font-medium ml-1"},aa={key:3},sa={class:"text-slate-700 font-medium ml-1"},la={key:4},na={class:"text-slate-700 font-medium ml-1"},oa={key:5},ia={class:"text-slate-700 font-medium ml-1"},ra={key:2,class:"flex items-center gap-3"},da={key:0,class:"w-16 h-16 bg-gray-200 rounded overflow-hidden flex-shrink-0"},ua=["src"],ca={class:"flex-1"},ma={class:"text-sm font-bold text-slate-800"},fa={class:"text-xs text-gray-500"},ya={key:1,class:"bg-purple-600 text-white text-[10px] font-bold px-2 py-0.5 rounded"},ga={key:3,class:"flex items-center gap-3"},pa={class:"flex-1"},ba={class:"text-sm font-bold text-slate-800"},xa={class:"text-xs text-gray-500"},va={key:0,class:"text-xs text-gray-400 mt-1"},ha={key:1,class:"text-xs text-gray-600 mt-1"},de={__name:"FeedItemCard",props:{item:{type:Object,required:!0},taskType:{type:String,default:"lead"},customerInitials:{type:String,required:!0}},emits:["edit","delete"],setup(t,{emit:y}){const l=t,g=y,a=D(!1),o={mounted(x,c){x.clickOutsideEvent=p=>{x===p.target||x.contains(p.target)||c.value()},setTimeout(()=>{document.addEventListener("click",x.clickOutsideEvent)},0)},unmounted(x){document.removeEventListener("click",x.clickOutsideEvent)}},b=x=>({note:"fa-regular fa-note-sticky",communication:"fa-solid fa-comment-dots",email:"fa-regular fa-envelope",whatsapp:"fa-brands fa-whatsapp",sms:"fa-solid fa-comment-dots",attachment:"fa-solid fa-paperclip",tradein:"fa-solid fa-car-side",financing:"fa-solid fa-file-invoice-dollar",offer:"fa-solid fa-handshake",purchase:"fa-solid fa-shopping-cart",appointment:"fa-solid fa-calendar"})[x]||"fa-solid fa-circle",u=x=>({note:"bg-orange-100 text-orange-600 border-orange-200",communication:"bg-gray-100 text-gray-600 border-gray-200",email:"bg-blue-100 text-blue-600 border-blue-200",whatsapp:"bg-green-100 text-green-600 border-green-200",sms:"bg-gray-100 text-gray-600 border-gray-200",attachment:"bg-blue-50 text-blue-600 border-blue-100",tradein:"bg-green-50 text-green-600 border-green-100",financing:"bg-purple-50 text-purple-600 border-purple-100",offer:"bg-indigo-50 text-indigo-600 border-indigo-100",purchase:"bg-teal-50 text-teal-600 border-teal-100",appointment:"bg-purple-100 text-purple-600 border-purple-200"})[x]||"bg-gray-100 text-gray-600 border-gray-200",r=x=>{if(!x)return"Just now";const c=new Date(x),q=new Date-c,w=Math.floor(q/6e4),V=Math.floor(w/60),j=Math.floor(V/24);return w<1?"Just now":w<60?`${w} minutes ago`:V<24?`${V} hours ago`:j===1?"Yesterday":j<7?`${j} days ago`:c.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},i=x=>x?new Intl.NumberFormat("en-US").format(x):"0",d=x=>x?new Date(x).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",h=()=>{a.value=!1,g("edit",l.item)},N=()=>{a.value=!1,confirm("Are you sure you want to delete this item?")&&g("delete",l.item)};return(x,c)=>(s(),n("div",Ct,[e("div",{class:A(["w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold shrink-0 border",u(t.item.type)])},[e("i",{class:A([b(t.item.type),"text-sm"])},null,2)],2),e("div",St,[e("div",At,[e("span",Dt,m(t.customerInitials),1),e("span",Tt,m(t.item.action||"added"),1),e("span",Ot,"• "+m(r(t.item.timestamp)),1),t.item.autoDetected?(s(),n("span",qt,"Auto-detected")):f("",!0),e("div",Nt,[e("button",{onClick:c[0]||(c[0]=P(p=>a.value=!a.value,["stop"])),class:"text-gray-400 hover:text-gray-600 transition-colors p-1",title:"More actions"},[...c[1]||(c[1]=[e("i",{class:"fa-solid fa-ellipsis-vertical text-sm"},null,-1)])]),a.value?$((s(),n("div",It,[e("button",{onClick:h,class:"w-full text-left px-3 py-2 text-xs text-slate-700 hover:bg-gray-50 flex items-center gap-2"},[...c[2]||(c[2]=[e("i",{class:"fa-solid fa-pencil text-gray-400"},null,-1),T(" Edit ",-1)])]),e("button",{onClick:N,class:"w-full text-left px-3 py-2 text-xs text-red-600 hover:bg-red-50 flex items-center gap-2"},[...c[3]||(c[3]=[e("i",{class:"fa-solid fa-trash text-red-400"},null,-1),T(" Delete ",-1)])])])),[[o,()=>a.value=!1]]):f("",!0)])]),t.item.content?(s(),n("div",Vt,m(t.item.content),1)):f("",!0),t.item.fileName?(s(),n("div",Et,[c[4]||(c[4]=e("i",{class:"fa-solid fa-paperclip text-gray-400"},null,-1)),e("span",null,m(t.item.fileName),1)])):f("",!0),t.item.data?(s(),n("div",Ft,[t.item.type==="appointment"?(s(),n("div",Ut,[M($t,{"appointment-data":t.item.data},null,8,["appointment-data"])])):(s(),n("div",jt,[t.item.type==="tradein"?(s(),n("div",Mt,[e("h4",Wt,m(t.item.data.brand)+" "+m(t.item.data.model),1),t.item.data.version?(s(),n("p",Lt,m(t.item.data.version),1)):f("",!0),e("div",Bt,[t.item.data.year?(s(),n("div",Pt,[c[5]||(c[5]=e("i",{class:"fa-regular fa-calendar mr-1"},null,-1)),T(m(t.item.data.year),1)])):f("",!0),t.item.data.km?(s(),n("div",Rt,[c[6]||(c[6]=e("i",{class:"fa-solid fa-road mr-1"},null,-1)),T(m(t.item.data.km)+" km ",1)])):f("",!0),t.item.data.plate?(s(),n("div",zt,[c[7]||(c[7]=e("i",{class:"fa-solid fa-id-card mr-1"},null,-1)),T(m(t.item.data.plate),1)])):f("",!0),t.item.data.date?(s(),n("div",Yt,[c[8]||(c[8]=e("i",{class:"fa-regular fa-calendar-check mr-1"},null,-1)),T(m(d(t.item.data.date)),1)])):f("",!0),t.item.data.class?(s(),n("div",Kt,[c[9]||(c[9]=e("i",{class:"fa-solid fa-car mr-1"},null,-1)),T(m(t.item.data.class),1)])):f("",!0)])])):t.item.type==="financing"?(s(),n("div",Qt,[e("h4",Gt,m(t.item.data.product),1),e("div",Ht,[t.item.data.provider?(s(),n("div",Jt,[c[10]||(c[10]=e("span",{class:"text-gray-500"},"Provider:",-1)),e("span",Zt,m(t.item.data.provider),1)])):f("",!0),t.item.data.total?(s(),n("div",Xt,[c[11]||(c[11]=e("span",{class:"text-gray-500"},"Total:",-1)),e("span",_t,"€"+m(i(t.item.data.total)),1)])):f("",!0),t.item.data.monthly?(s(),n("div",ea,[c[12]||(c[12]=e("span",{class:"text-gray-500"},"Monthly:",-1)),e("span",ta,"€"+m(i(t.item.data.monthly)),1)])):f("",!0),t.item.data.deposit?(s(),n("div",aa,[c[13]||(c[13]=e("span",{class:"text-gray-500"},"Deposit:",-1)),e("span",sa,"€"+m(i(t.item.data.deposit)),1)])):f("",!0),t.item.data.startDate?(s(),n("div",la,[c[14]||(c[14]=e("span",{class:"text-gray-500"},"Start:",-1)),e("span",na,m(d(t.item.data.startDate)),1)])):f("",!0),t.item.data.expDate?(s(),n("div",oa,[c[15]||(c[15]=e("span",{class:"text-gray-500"},"Expires:",-1)),e("span",ia,m(d(t.item.data.expDate)),1)])):f("",!0)])])):t.item.type==="offer"?(s(),n("div",ra,[t.item.data.image?(s(),n("div",da,[e("img",{src:t.item.data.image,alt:"Car",class:"w-full h-full object-cover"},null,8,ua)])):f("",!0),e("div",ca,[e("h4",ma,m(t.item.data.brand)+" "+m(t.item.data.model)+" ("+m(t.item.data.year)+")",1),e("p",fa,"€ "+m(i(t.item.data.price)),1)]),t.item.data.isMainOffer?(s(),n("span",ya,"Main Offer")):f("",!0)])):t.item.type==="purchase"?(s(),n("div",ga,[e("div",pa,[e("h4",ba,m(t.item.data.brand)+" "+m(t.item.data.model)+" ("+m(t.item.data.year)+")",1),e("p",xa,"€ "+m(i(t.item.data.price)),1),t.item.data.purchaseDate?(s(),n("p",va,"Purchased: "+m(d(t.item.data.purchaseDate)),1)):f("",!0),t.item.data.notes?(s(),n("p",ha,m(t.item.data.notes),1)):f("",!0)])])):f("",!0)]))])):f("",!0)])]))}},ka={class:"h-16 px-5 border-b border-gray-100 bg-gray-50/50 flex items-center justify-between gap-3"},wa={class:"flex items-center gap-3"},$a=["title"],Ca={key:0,class:"fa-solid fa-arrow-left text-sm"},Sa={key:1,class:"fa-solid fa-arrow-right text-sm"},Aa={key:2,class:"font-bold text-lg text-gray-800"},Da={key:0,class:"flex-1 overflow-y-auto px-5 py-6 scrollbar-hide relative"},Ta={key:0,class:"absolute left-[39px] top-0 bottom-0 w-0.5 bg-gray-200 z-0"},Oa={key:1,class:"text-center py-8 text-gray-400 relative z-10"},qa={class:"text-sm"},Na={key:2,class:"space-y-6 relative z-10"},Ia={key:0,class:"mb-4 pl-12"},Va={class:"text-sm font-semibold text-gray-800"},Ea={class:"flex gap-4 relative mb-6"},Fa={class:"flex-1 min-w-0"},Ua={class:"text-sm text-slate-700 leading-snug"},ja={class:"font-bold"},Ma={key:0,class:"mt-2 bg-orange-50/50 border border-orange-100 p-3 rounded-lg text-sm text-gray-700"},Wa={class:"text-xs text-gray-400 mt-1"},La={key:1,class:"flex-1 overflow-y-auto py-6 scrollbar-hide relative flex flex-col items-center"},Ba={key:0,class:"absolute left-1/2 top-0 bottom-0 w-0.5 bg-gray-200 -translate-x-1/2 z-0"},Pa={key:1,class:"space-y-4 relative z-10"},Ra=["title"],za={key:2,class:"text-center py-8 text-gray-400 relative z-10"},Ya={__name:"ActivitySummarySidebar",props:{title:{type:String,default:"Activity summary"},activities:{type:Array,default:()=>[]},emptyMessage:{type:String,default:"No activities yet"},collapsed:{type:Boolean,default:!0},showCollapse:{type:Boolean,default:!0},show:{type:Boolean,default:!0},mobileFullscreen:{type:Boolean,default:!1}},emits:["toggle-collapse","close"],setup(t,{emit:y}){const l=t,g=r=>{const i={call:"fa-solid fa-phone text-blue-600",email:"fa-solid fa-envelope text-green-600",note:"fa-solid fa-sticky-note text-yellow-600",meeting:"fa-solid fa-calendar text-purple-600",task:"fa-solid fa-check-circle text-indigo-600",attachment:"fa-solid fa-paperclip text-gray-600",status:"fa-solid fa-tag text-orange-600",default:"fa-solid fa-circle text-gray-400"};return i[r]||i.default},a=r=>{const i={call:"bg-blue-100 text-blue-600",email:"bg-green-100 text-green-600",note:"bg-yellow-100 text-yellow-600",meeting:"bg-purple-100 text-purple-600",task:"bg-indigo-100 text-indigo-600",attachment:"bg-gray-100 text-gray-600",status:"bg-orange-100 text-orange-600",default:"bg-gray-100 text-gray-400"};return i[r]||i.default},o=r=>{if(!r)return"";const i=new Date(r),d=new Date,h=new Date(d);return h.setDate(h.getDate()-1),i.toDateString()===d.toDateString()?"Today":i.toDateString()===h.toDateString()?"Yesterday":i.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},b=r=>r?new Date(r).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"",u=(r,i)=>{if(r===0)return!0;const d=l.activities[r-1];if(!d)return!0;const h=new Date(i.timestamp).toDateString(),N=new Date(d.timestamp).toDateString();return h!==N};return(r,i)=>t.show?(s(),n("div",{key:0,class:A(["bg-white border-l border-gray-200 shrink-0 flex flex-col transition-all duration-300",[t.collapsed?"w-16":"w-80",t.mobileFullscreen?"xl:relative xl:border-l":""]])},[e("div",ka,[e("div",wa,[t.mobileFullscreen?(s(),n("button",{key:0,onClick:i[0]||(i[0]=d=>r.$emit("close")),class:"xl:hidden w-8 h-8 flex items-center justify-center text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"},[...i[2]||(i[2]=[e("i",{class:"fa-solid fa-xmark text-lg"},null,-1)])])):t.showCollapse?(s(),n("button",{key:1,onClick:i[1]||(i[1]=d=>r.$emit("toggle-collapse")),class:"w-8 h-8 flex items-center justify-center rounded-md text-gray-400 hover:text-gray-900 hover:bg-gray-100 transition-colors shrink-0",title:t.collapsed?"Expand sidebar":"Collapse sidebar"},[t.collapsed?(s(),n("i",Ca)):(s(),n("i",Sa))],8,$a)):f("",!0),t.collapsed?f("",!0):(s(),n("h2",Aa,m(t.title),1))])]),t.collapsed?(s(),n("div",La,[t.activities.length>0?(s(),n("div",Ba)):f("",!0),t.activities.length>0?(s(),n("div",Pa,[(s(!0),n(F,null,R(t.activities,d=>(s(),n("div",{key:d.id,class:"relative"},[e("div",{class:A(["w-8 h-8 rounded-full flex items-center justify-center shrink-0 z-10 relative bg-white border-2 border-gray-200",a(d.type)]),title:`${d.user} ${d.action}`},[e("i",{class:A([g(d.type),"text-xs"])},null,2)],10,Ra)]))),128))])):(s(),n("div",za,[...i[4]||(i[4]=[e("i",{class:"fa-solid fa-clock text-2xl mb-2"},null,-1)])]))])):(s(),n("div",Da,[t.activities.length>0?(s(),n("div",Ta)):f("",!0),t.activities.length===0?(s(),n("div",Oa,[i[3]||(i[3]=e("i",{class:"fa-solid fa-clock text-4xl mb-2"},null,-1)),e("p",qa,m(t.emptyMessage),1)])):(s(),n("div",Na,[(s(!0),n(F,null,R(t.activities,(d,h)=>(s(),n(F,{key:d.id},[u(h,d)?(s(),n("div",Ia,[e("h3",Va,m(o(d.timestamp)),1)])):f("",!0),e("div",Ea,[e("div",{class:A(["w-10 h-10 rounded-full flex items-center justify-center shrink-0 z-10 relative bg-white",a(d.type)])},[e("i",{class:A([g(d.type),"text-sm"])},null,2)],2),e("div",Fa,[e("div",Ua,[e("span",ja,m(d.user),1),T(" "+m(d.action),1)]),d.content?(s(),n("div",Ma,m(d.content),1)):f("",!0),e("div",Wa,m(b(d.timestamp)),1)])])],64))),128))]))]))],2)):f("",!0)}},Ka={class:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm mb-6 animate-fade-in relative"},Qa={class:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3"},Ga={class:"mb-3"},Ha={class:"flex justify-end gap-2"},Ja={__name:"CommunicationWidget",props:{type:{type:String,required:!0},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(t,{emit:y}){const l=t,g=y,a=D(""),o=D(""),b=()=>{!a.value.trim()&&!o.value||g("save",{type:"communication",action:`sent via ${l.type}`,content:a.value||`Sent template: ${o.value}`,communicationType:l.type})};return(u,r)=>(s(),n("div",Ka,[r[5]||(r[5]=e("div",{class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-t border-l border-gray-200 rotate-45"},null,-1)),e("h5",Qa,m(t.type==="email"?"Send Email":t.type==="whatsapp"?"Send WhatsApp":t.type==="sms"?"Send SMS":"Send Message"),1),e("div",Ga,[r[4]||(r[4]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Template",-1)),$(e("select",{"onUpdate:modelValue":r[0]||(r[0]=i=>o.value=i),class:"w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500 cursor-pointer"},[...r[3]||(r[3]=[e("option",{value:""},"Select a template...",-1),e("option",null,"Follow-up",-1),e("option",null,"Meeting Confirmation",-1),e("option",null,"Quote Proposal",-1),e("option",null,"Unable to Reach",-1)])],512),[[se,o.value]])]),$(e("textarea",{"onUpdate:modelValue":r[1]||(r[1]=i=>a.value=i),class:"w-full bg-gray-50 border border-gray-200 rounded-lg p-3 text-sm focus:outline-none focus:border-blue-500 resize-none mb-3",rows:"4",placeholder:"Type your message here..."},null,512),[[O,a.value]]),e("div",Ha,[e("button",{onClick:r[2]||(r[2]=i=>u.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:b,class:"bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Send")])]))}},Za={class:"bg-white border border-gray-200 rounded-xl p-5 shadow-sm mb-6 animate-fade-in relative"},Xa={class:"flex justify-between items-center mb-4"},_a={class:"text-sm font-bold text-slate-800"},es={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},ts={__name:"NoteWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(t,{emit:y}){const l=t,g=y,a=D("");z(()=>{l.item&&(a.value=l.item.content||"")});const o=()=>{var b,u;a.value.trim()&&g("save",{id:((b=l.item)==null?void 0:b.id)||Date.now(),type:"note",action:l.item?"updated a note":"added a note",content:a.value,timestamp:((u=l.item)==null?void 0:u.timestamp)||new Date().toISOString(),isEdit:!!l.item})};return(b,u)=>(s(),n("div",Za,[u[5]||(u[5]=e("div",{class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-t border-l border-gray-200 rotate-45"},null,-1)),e("div",Xa,[e("h5",_a,m(t.item?"Edit Note":"Add Note"),1),e("button",{onClick:u[0]||(u[0]=r=>b.$emit("cancel")),class:"text-gray-400 hover:text-gray-600"},[...u[3]||(u[3]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),e("div",null,[u[4]||(u[4]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Note",-1)),$(e("textarea",{"onUpdate:modelValue":u[1]||(u[1]=r=>a.value=r),rows:"4",class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500 placeholder-gray-400 transition-colors shadow-sm resize-none",placeholder:"Enter your note..."},null,512),[[O,a.value]])]),e("div",es,[e("button",{onClick:u[2]||(u[2]=r=>b.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:o,class:"bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save")])]))}},as={class:"bg-white border border-gray-200 rounded-xl p-5 shadow-sm mb-6 animate-fade-in relative"},ss={class:"flex justify-between items-center mb-4"},ls={class:"text-sm font-bold text-slate-800"},ns={class:"flex items-center gap-3"},os={key:0,class:"text-sm text-slate-600"},is={key:1,class:"text-sm text-gray-400"},rs={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},ds=["disabled"],us={__name:"AttachmentWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:Number,required:!0}},emits:["save","cancel"],setup(t,{emit:y}){const l=t,g=y,a=D(null),o=D("");z(()=>{l.item&&(o.value=l.item.fileName||"")});const b=r=>{const i=r.target.files[0];i&&(a.value=i,o.value=i.name)},u=()=>{var r,i;!a.value&&!l.item||g("save",{id:((r=l.item)==null?void 0:r.id)||Date.now(),type:"attachment",action:l.item?"updated an attachment":"added an attachment",fileName:o.value,timestamp:((i=l.item)==null?void 0:i.timestamp)||new Date().toISOString(),isEdit:!!l.item})};return(r,i)=>(s(),n("div",as,[i[6]||(i[6]=e("div",{class:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-t border-l border-gray-200 rotate-45"},null,-1)),e("div",ss,[e("h5",ls,m(t.item?"Edit Attachment":"Add Attachment"),1),e("button",{onClick:i[0]||(i[0]=d=>r.$emit("cancel")),class:"text-gray-400 hover:text-gray-600"},[...i[3]||(i[3]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),e("div",null,[i[5]||(i[5]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"File",-1)),e("div",ns,[e("input",{type:"file",onChange:b,ref:"fileInput",class:"hidden"},null,544),e("button",{onClick:i[1]||(i[1]=d=>r.$refs.fileInput.click()),class:"bg-gray-50 hover:bg-gray-100 border border-gray-300 rounded-md px-4 py-2 text-sm text-slate-700 transition-colors"},[...i[4]||(i[4]=[e("i",{class:"fa-solid fa-paperclip mr-2"},null,-1),T("Choose File ",-1)])]),o.value?(s(),n("span",os,m(o.value),1)):(s(),n("span",is,"No file selected"))])]),e("div",rs,[e("button",{onClick:i[2]||(i[2]=d=>r.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:u,disabled:!a.value,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save",8,ds)])]))}},cs={class:"animate-fade-in"},ms={class:"space-y-4"},fs={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ys={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},gs={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},ps=["disabled"],bs={__name:"FinancingWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:[String,Number],required:!0}},emits:["save","cancel"],setup(t,{emit:y}){const l=t,g=y,a=D({startDate:"",expDate:"",productName:"",deposit:"",loanAmount:""});z(()=>{l.item&&l.item.data&&(a.value={startDate:l.item.data.startDate||"",expDate:l.item.data.expDate||"",productName:l.item.data.product||l.item.data.productName||"",deposit:l.item.data.deposit||"",loanAmount:l.item.data.total||l.item.data.loanAmount||""})});const o=()=>{var b,u;a.value.productName&&g("save",{id:((b=l.item)==null?void 0:b.id)||Date.now(),type:"financing",action:l.item?"updated a financing proposal":"added a financing proposal",data:{product:a.value.productName,provider:"Audi Financial",total:a.value.loanAmount||"0",monthly:Math.round(parseFloat(a.value.loanAmount||0)/36).toString(),startDate:a.value.startDate,expDate:a.value.expDate,deposit:a.value.deposit},timestamp:((u=l.item)==null?void 0:u.timestamp)||new Date().toISOString(),isEdit:!!l.item})};return(b,u)=>(s(),n("div",cs,[e("div",ms,[e("div",fs,[e("div",null,[u[6]||(u[6]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Start date",-1)),$(e("input",{type:"date","onUpdate:modelValue":u[0]||(u[0]=r=>a.value.startDate=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.startDate]])]),e("div",null,[u[7]||(u[7]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Expiration date",-1)),$(e("input",{type:"date","onUpdate:modelValue":u[1]||(u[1]=r=>a.value.expDate=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.expDate]])])]),e("div",null,[u[8]||(u[8]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Financial product name",-1)),$(e("input",{type:"text","onUpdate:modelValue":u[2]||(u[2]=r=>a.value.productName=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.productName]])]),e("div",ys,[e("div",null,[u[9]||(u[9]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Deposit",-1)),$(e("input",{type:"number","onUpdate:modelValue":u[3]||(u[3]=r=>a.value.deposit=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.deposit]])]),e("div",null,[u[10]||(u[10]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Total loan amount",-1)),$(e("input",{type:"number","onUpdate:modelValue":u[4]||(u[4]=r=>a.value.loanAmount=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.loanAmount]])])])]),e("div",gs,[e("button",{onClick:u[5]||(u[5]=r=>b.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:o,disabled:!a.value.productName,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save",8,ps)])]))}},xs={class:"animate-fade-in"},vs={class:"space-y-4"},hs={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ks={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ws={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},$s=["disabled"],Cs={__name:"TradeInWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"lead"},taskId:{type:[String,Number],required:!0}},emits:["save","cancel"],setup(t,{emit:y}){const l=t,g=y,a=D({class:"Car",brand:"",model:"",version:"",km:"",plate:"",date:""});z(()=>{l.item&&l.item.data&&(a.value={class:l.item.data.class||"Car",brand:l.item.data.brand||"",model:l.item.data.model||"",version:l.item.data.version||"",km:l.item.data.km||"",plate:l.item.data.plate||"",date:l.item.data.date||""})});const o=()=>{var b,u;a.value.brand&&g("save",{id:((b=l.item)==null?void 0:b.id)||Date.now(),type:"tradein",action:l.item?"updated a trade-in":"added a trade-in",data:{class:a.value.class,brand:a.value.brand,model:a.value.model||"Unknown Model",year:a.value.date?new Date(a.value.date).getFullYear():"Unknown Year",km:a.value.km||"0",plate:a.value.plate||"",date:a.value.date||""},timestamp:((u=l.item)==null?void 0:u.timestamp)||new Date().toISOString(),isEdit:!!l.item})};return(b,u)=>(s(),n("div",xs,[e("div",vs,[e("div",null,[u[9]||(u[9]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Class",-1)),$(e("select",{"onUpdate:modelValue":u[0]||(u[0]=r=>a.value.class=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},[...u[8]||(u[8]=[e("option",{value:"Car"},"Car",-1),e("option",{value:"Motorcycle"},"Motorcycle",-1),e("option",{value:"Truck"},"Truck",-1)])],512),[[se,a.value.class]])]),e("div",hs,[e("div",null,[u[10]||(u[10]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Brand",-1)),$(e("input",{type:"text","onUpdate:modelValue":u[1]||(u[1]=r=>a.value.brand=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.brand]])]),e("div",null,[u[11]||(u[11]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Model",-1)),$(e("input",{type:"text","onUpdate:modelValue":u[2]||(u[2]=r=>a.value.model=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.model]])])]),e("div",null,[u[12]||(u[12]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Version",-1)),$(e("input",{type:"text","onUpdate:modelValue":u[3]||(u[3]=r=>a.value.version=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.version]])]),e("div",ks,[e("div",null,[u[13]||(u[13]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Km",-1)),$(e("input",{type:"number","onUpdate:modelValue":u[4]||(u[4]=r=>a.value.km=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.km]])]),e("div",null,[u[14]||(u[14]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Plate",-1)),$(e("input",{type:"text","onUpdate:modelValue":u[5]||(u[5]=r=>a.value.plate=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.plate]])])]),e("div",null,[u[15]||(u[15]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Registration date",-1)),$(e("input",{type:"date","onUpdate:modelValue":u[6]||(u[6]=r=>a.value.date=r),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700"},null,512),[[O,a.value.date]])])]),e("div",ws,[e("button",{onClick:u[7]||(u[7]=r=>b.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e("button",{onClick:o,disabled:!a.value.brand,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},"Save",8,$s)])]))}},Ss={class:"bg-white rounded-xl p-5 mb-6 animate-fade-in relative"},As={class:"flex justify-between items-center mb-4"},Ds={class:"text-sm font-bold text-slate-800"},Ts={key:0,class:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200"},Os={class:"flex items-center gap-3"},qs={class:"w-16 h-16 bg-gray-200 rounded overflow-hidden flex-shrink-0"},Ns=["src"],Is={key:1,class:"fa-solid fa-car text-gray-400 w-full h-full flex items-center justify-center"},Vs={class:"font-bold text-sm text-gray-800"},Es={class:"text-xs text-gray-500"},Fs={class:"space-y-4"},Us={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},js={class:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4"},Ms=["disabled"],Ws={__name:"OfferWidget",props:{item:{type:Object,default:null},taskType:{type:String,default:"opportunity"},taskId:{type:Number,required:!0},selectedVehicle:{type:Object,default:null}},emits:["save","cancel"],setup(t,{emit:y}){const l=t,g=y,a=D({price:0,financingType:"",downPayment:0,monthlyPayment:0,term:36,interestRate:3.5,deliveryDate:"",validUntil:"",notes:"",brand:"",model:"",year:"",image:""});z(()=>{if(l.selectedVehicle){a.value.price=l.selectedVehicle.price||0,a.value.brand=l.selectedVehicle.brand||"",a.value.model=l.selectedVehicle.model||"",a.value.year=l.selectedVehicle.year||"",a.value.image=l.selectedVehicle.image||"";const r=new Date;r.setDate(r.getDate()+30),a.value.validUntil=r.toISOString().split("T")[0]}l.item&&l.item.data&&(a.value={...a.value,...l.item.data,price:l.item.data.price||l.item.data.total||0,financingType:l.item.data.financingType||l.item.data.paymentMethod||"",notes:l.item.data.notes||l.item.data.description||""})}),G(()=>l.selectedVehicle,r=>{r&&!l.item&&(a.value.price=r.price||0,a.value.brand=r.brand||"",a.value.model=r.model||"",a.value.year=r.year||"",a.value.image=r.image||"")});const o=I(()=>a.value.price>0&&a.value.financingType!==""),b=r=>r?r.toLocaleString("en-US"):"0",u=()=>{var i,d;if(!o.value)return;const r={id:((i=l.item)==null?void 0:i.id)||Date.now(),type:"offer",action:l.item?"updated an offer":"created an offer",data:{brand:a.value.brand,model:a.value.model,year:a.value.year,price:a.value.price,total:a.value.price,paymentMethod:a.value.financingType,financingType:a.value.financingType,downPayment:a.value.downPayment,monthlyPayment:a.value.monthlyPayment,term:a.value.term,interestRate:a.value.interestRate,deliveryDate:a.value.deliveryDate,validUntil:a.value.validUntil,notes:a.value.notes,description:a.value.notes,image:a.value.image},timestamp:((d=l.item)==null?void 0:d.timestamp)||new Date().toISOString(),isEdit:!!l.item};g("save",r)};return(r,i)=>(s(),n("div",Ss,[e("div",As,[e("h5",Ds,m(t.item?"Edit Offer":"Create Offer"),1),e("button",{onClick:i[0]||(i[0]=d=>r.$emit("cancel")),class:"text-gray-400 hover:text-gray-600"},[...i[11]||(i[11]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),t.selectedVehicle?(s(),n("div",Ts,[i[12]||(i[12]=e("p",{class:"text-xs text-gray-500 mb-2"},"Creating offer for:",-1)),e("div",Os,[e("div",qs,[t.selectedVehicle.image?(s(),n("img",{key:0,src:t.selectedVehicle.image,alt:"Vehicle",class:"w-full h-full object-cover"},null,8,Ns)):(s(),n("i",Is))]),e("div",null,[e("h4",Vs,m(t.selectedVehicle.brand)+" "+m(t.selectedVehicle.model)+" ("+m(t.selectedVehicle.year)+") ",1),e("p",Es,"Base Price: € "+m(b(t.selectedVehicle.price)),1)])])])):f("",!0),e("div",Fs,[e("div",null,[i[13]||(i[13]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},[T(" Offer Price (€) "),e("span",{class:"text-red-500"},"*")],-1)),$(e("input",{type:"number","onUpdate:modelValue":i[1]||(i[1]=d=>a.value.price=d),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500",placeholder:"Enter offer price"},null,512),[[O,a.value.price]])]),e("div",null,[i[15]||(i[15]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},[T(" Payment Method "),e("span",{class:"text-red-500"},"*")],-1)),$(e("select",{"onUpdate:modelValue":i[2]||(i[2]=d=>a.value.financingType=d),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500"},[...i[14]||(i[14]=[e("option",{value:""},"Select payment method",-1),e("option",{value:"cash"},"Cash",-1),e("option",{value:"finance"},"Finance",-1),e("option",{value:"lease"},"Lease",-1)])],512),[[se,a.value.financingType]])]),a.value.financingType==="finance"||a.value.financingType==="lease"?(s(),n("div",Us,[e("div",null,[i[16]||(i[16]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Down Payment (€)",-1)),$(e("input",{type:"number","onUpdate:modelValue":i[3]||(i[3]=d=>a.value.downPayment=d),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500",placeholder:"0"},null,512),[[O,a.value.downPayment]])]),e("div",null,[i[17]||(i[17]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Monthly Payment (€)",-1)),$(e("input",{type:"number","onUpdate:modelValue":i[4]||(i[4]=d=>a.value.monthlyPayment=d),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500",placeholder:"Calculated automatically"},null,512),[[O,a.value.monthlyPayment]])]),e("div",null,[i[18]||(i[18]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Term (months)",-1)),$(e("input",{type:"number","onUpdate:modelValue":i[5]||(i[5]=d=>a.value.term=d),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500",placeholder:"36"},null,512),[[O,a.value.term]])]),e("div",null,[i[19]||(i[19]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Interest Rate (%)",-1)),$(e("input",{type:"number",step:"0.1","onUpdate:modelValue":i[6]||(i[6]=d=>a.value.interestRate=d),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500",placeholder:"3.5"},null,512),[[O,a.value.interestRate]])])])):f("",!0),e("div",null,[i[20]||(i[20]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Expected Delivery Date",-1)),$(e("input",{type:"date","onUpdate:modelValue":i[7]||(i[7]=d=>a.value.deliveryDate=d),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500"},null,512),[[O,a.value.deliveryDate]])]),e("div",null,[i[21]||(i[21]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Offer Valid Until",-1)),$(e("input",{type:"date","onUpdate:modelValue":i[8]||(i[8]=d=>a.value.validUntil=d),class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500"},null,512),[[O,a.value.validUntil]])]),e("div",null,[i[22]||(i[22]=e("label",{class:"block text-xs font-medium text-slate-700 mb-1"},"Notes / Special Terms",-1)),$(e("textarea",{"onUpdate:modelValue":i[9]||(i[9]=d=>a.value.notes=d),rows:"3",class:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-sm text-slate-700 focus:outline-none focus:border-blue-500 resize-none",placeholder:"Any special terms, conditions, or notes about this offer..."},null,512),[[O,a.value.notes]])])]),e("div",js,[e("button",{onClick:i[10]||(i[10]=d=>r.$emit("cancel")),class:"text-xs font-medium text-gray-500 hover:text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"}," Cancel "),e("button",{onClick:u,disabled:!o.value,class:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white text-xs font-medium px-4 py-2 rounded-lg transition-colors shadow-sm shadow-blue-200"},m(t.item?"Update Offer":"Create Offer"),9,Ms)])]))}},Ls={key:0,class:"mb-8"},Bs={class:"flex items-center gap-2 mb-4"},Ps={class:"font-bold text-gray-800 text-sm"},Rs={class:"bg-white border border-gray-200 rounded-xl shadow-sm mb-6 overflow-hidden"},zs={class:"p-4"},Ys={class:"flex items-center justify-between"},Ks={class:"flex items-center gap-4"},Qs={class:"w-16 h-12 bg-gray-200 rounded-md overflow-hidden shrink-0 border border-gray-100"},Gs=["src"],Hs={key:1,class:"fa-solid fa-car text-3xl text-gray-400 w-full h-full flex items-center justify-center"},Js={class:"flex items-center gap-2"},Zs={class:"font-bold text-slate-800 text-sm md:text-base"},Xs={class:"mt-1.5 flex items-center gap-2"},_s={key:0,class:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-green-50 border border-green-100 text-green-700 text-[10px] font-semibold rounded-md"},el={key:1,class:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-orange-50 border border-orange-100 text-orange-700 text-[10px] font-semibold rounded-md"},tl={key:2,class:"hidden sm:flex items-center gap-1.5 bg-gray-100 hover:bg-gray-200 border border-gray-200 text-slate-700 text-xs font-semibold px-3 py-1.5 rounded-full transition-colors group/btn"},al={class:"flex items-center gap-4"},sl={key:0,class:"text-right"},ll={class:"font-bold text-slate-800"},nl={class:"border-t border-gray-200"},ol={class:"font-medium"},il={key:0,class:"border-t border-gray-100 p-6 bg-gray-50/30 text-sm animate-fade-in"},rl={class:"mb-6"},dl={class:"grid grid-cols-2 md:grid-cols-4 gap-y-4 gap-x-6"},ul={key:0},cl={class:"font-medium text-slate-700"},ml={key:1},fl={class:"font-medium text-slate-700"},yl={key:2},gl={class:"font-medium text-slate-700"},pl={class:"font-medium text-slate-700"},bl={class:"grid grid-cols-2 md:grid-cols-4 gap-y-4 gap-x-6"},xl={key:0},vl={class:"font-medium text-slate-700"},hl={key:1},kl={class:"font-medium text-slate-700"},wl={key:2},$l={class:"font-medium text-slate-700"},Cl={key:3},Sl={class:"font-medium text-slate-700"},Al={key:4},Dl={class:"font-mono text-xs bg-white border border-gray-200 px-2 py-1 rounded inline-block text-gray-600"},Tl={key:5},Ol={class:"font-medium text-slate-700"},ql={key:0,class:"mt-6 flex justify-end"},Nl={key:0,class:"border-t border-gray-200 my-6"},Il={key:1,class:"mb-6 px-6"},Vl={class:"bg-white border border-gray-200 rounded-lg p-4"},El={class:"text-sm text-slate-700 leading-relaxed"},Fl={__name:"VehicleWidget",props:{show:{type:Boolean,default:!0},label:{type:String,default:"Requested Car"},brand:{type:String,required:!0},model:{type:String,required:!0},year:{type:[Number,String],required:!0},image:{type:String,default:""},price:{type:Number,default:null},requestMessage:{type:String,default:""},requestType:{type:String,default:""},source:{type:String,default:""},dealership:{type:String,default:""},registration:{type:String,default:""},kilometers:{type:Number,default:null},fuelType:{type:String,default:""},gearType:{type:String,default:""},vin:{type:String,default:""},stockDays:{type:Number,default:null},showOpenAd:{type:Boolean,default:!0},showTechnicalSpecs:{type:Boolean,default:!0},channel:{type:String,default:"Email"},adCampaign:{type:String,default:""},expectedPurchaseDate:{type:String,default:""},fiscalEntity:{type:String,default:""},sourceDetails:{type:String,default:""},adMedium:{type:String,default:""},adSource:{type:String,default:""}},setup(t){const y=D(!1),l=a=>new Intl.NumberFormat("en-US").format(a),g=a=>new Intl.NumberFormat("en-US").format(a);return(a,o)=>t.show?(s(),n("div",Ls,[e("div",Bs,[o[1]||(o[1]=e("i",{class:"fa-solid fa-thumbtack text-gray-400 text-xs"},null,-1)),e("h3",Ps,m(t.label),1)]),e("div",Rs,[e("div",zs,[e("div",Ys,[e("div",Ks,[e("div",Qs,[t.image?(s(),n("img",{key:0,src:t.image,alt:"Car",class:"w-full h-full object-cover"},null,8,Gs)):(s(),n("i",Hs))]),e("div",null,[e("div",Js,[e("div",Zs,m(t.brand)+" "+m(t.model)+" ("+m(t.year)+")",1)]),e("div",Xs,[t.stockDays!==void 0&&t.stockDays!==null?(s(),n("div",_s,[o[2]||(o[2]=e("div",{class:"w-1 h-1 bg-green-500 rounded-full"},null,-1)),T(" In stock ("+m(t.stockDays)+" days) ",1)])):(s(),n("div",el,[...o[3]||(o[3]=[e("div",{class:"w-1 h-1 bg-orange-500 rounded-full"},null,-1),T(" Out of stock ",-1)])])),t.showOpenAd&&t.price?(s(),n("button",tl,[...o[4]||(o[4]=[T(" Open Ad ",-1),e("i",{class:"fa-solid fa-arrow-up-right-from-square text-[10px] text-gray-400 group-hover/btn:text-gray-800"},null,-1)])])):f("",!0)])])]),e("div",al,[t.price?(s(),n("div",sl,[o[5]||(o[5]=e("div",{class:"text-xs text-gray-500 font-medium mb-0.5"},"Price",-1)),e("div",ll,"€ "+m(l(t.price)),1)])):f("",!0)])])]),e("div",nl,[e("button",{onClick:o[0]||(o[0]=b=>y.value=!y.value),class:"w-full p-3 flex items-center justify-center gap-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-50 transition-colors"},[e("span",ol,m(y.value?"Hide":"View")+" Details",1),e("i",{class:A(["fa-solid fa-chevron-down text-xs transition-transform duration-200",{"rotate-180":y.value}])},null,2)])]),y.value?(s(),n("div",il,[e("div",rl,[o[16]||(o[16]=e("h4",{class:"text-xs font-bold uppercase text-gray-500 tracking-wider mb-4"},"REQUEST DETAILS",-1)),e("div",dl,[t.requestType?(s(),n("div",ul,[o[6]||(o[6]=e("div",{class:"text-xs text-gray-500 mb-1"},"Request type",-1)),e("div",cl,m(t.requestType),1)])):f("",!0),t.source?(s(),n("div",ml,[o[7]||(o[7]=e("div",{class:"text-xs text-gray-500 mb-1"},"Source",-1)),e("div",fl,m(t.source),1)])):f("",!0),e("div",null,[o[8]||(o[8]=e("div",{class:"text-xs text-gray-500 mb-1"},"Source details",-1)),e("div",{class:A(["font-medium",t.sourceDetails?"text-slate-700":"text-gray-400"])},m(t.sourceDetails||"--"),3)]),t.dealership?(s(),n("div",yl,[o[9]||(o[9]=e("div",{class:"text-xs text-gray-500 mb-1"},"Dealership",-1)),e("div",gl,m(t.dealership),1)])):f("",!0),e("div",null,[o[10]||(o[10]=e("div",{class:"text-xs text-gray-500 mb-1"},"Channel",-1)),e("div",pl,m(t.channel||"Email"),1)]),e("div",null,[o[11]||(o[11]=e("div",{class:"text-xs text-gray-500 mb-1"},"AdCampaign",-1)),e("div",{class:A(["font-medium",t.adCampaign?"text-slate-700":"text-gray-400"])},m(t.adCampaign||"--"),3)]),e("div",null,[o[12]||(o[12]=e("div",{class:"text-xs text-gray-500 mb-1"},"AdMedium",-1)),e("div",{class:A(["font-medium",t.adMedium?"text-slate-700":"text-gray-400"])},m(t.adMedium||"--"),3)]),e("div",null,[o[13]||(o[13]=e("div",{class:"text-xs text-gray-500 mb-1"},"AdSource",-1)),e("div",{class:A(["font-medium",t.adSource?"text-slate-700":"text-gray-400"])},m(t.adSource||"--"),3)]),e("div",null,[o[14]||(o[14]=e("div",{class:"text-xs text-gray-500 mb-1"},"Expected purchase date",-1)),e("div",{class:A(["font-medium",t.expectedPurchaseDate?"text-slate-700":"text-gray-400"])},m(t.expectedPurchaseDate||"--"),3)]),e("div",null,[o[15]||(o[15]=e("div",{class:"text-xs text-gray-500 mb-1"},"Fiscal entity",-1)),e("div",{class:A(["font-medium",t.fiscalEntity?"text-slate-700":"text-gray-400"])},m(t.fiscalEntity||"--"),3)])])]),o[26]||(o[26]=e("div",{class:"border-t border-gray-200 my-4"},null,-1)),e("div",null,[o[24]||(o[24]=e("div",{class:"flex justify-between items-center mb-4"},[e("h4",{class:"text-xs font-bold uppercase text-gray-500 tracking-wider"},"VEHICLE DETAILS")],-1)),e("div",bl,[t.registration?(s(),n("div",xl,[o[17]||(o[17]=e("div",{class:"text-xs text-gray-500 mb-1"},"Registration",-1)),e("div",vl,m(t.registration),1)])):f("",!0),t.kilometers!==void 0&&t.kilometers!==null?(s(),n("div",hl,[o[18]||(o[18]=e("div",{class:"text-xs text-gray-500 mb-1"},"Kilometers",-1)),e("div",kl,m(g(t.kilometers))+" Km",1)])):f("",!0),t.fuelType?(s(),n("div",wl,[o[19]||(o[19]=e("div",{class:"text-xs text-gray-500 mb-1"},"Fuel type",-1)),e("div",$l,m(t.fuelType),1)])):f("",!0),t.gearType?(s(),n("div",Cl,[o[20]||(o[20]=e("div",{class:"text-xs text-gray-500 mb-1"},"Gear type",-1)),e("div",Sl,m(t.gearType),1)])):f("",!0),t.vin?(s(),n("div",Al,[o[21]||(o[21]=e("div",{class:"text-xs text-gray-500 mb-1"},"VIN Number",-1)),e("div",Dl,m(t.vin),1)])):f("",!0),t.dealership?(s(),n("div",Tl,[o[22]||(o[22]=e("div",{class:"text-xs text-gray-500 mb-1"},"Dealership",-1)),e("div",Ol,m(t.dealership),1)])):f("",!0)]),t.showTechnicalSpecs?(s(),n("div",ql,[...o[23]||(o[23]=[e("button",{class:"bg-white border border-gray-200 text-slate-700 hover:text-blue-600 hover:border-blue-200 font-medium px-4 py-2 rounded-lg text-xs transition-colors flex items-center gap-2 group"},[e("i",{class:"fa-solid fa-list-check text-gray-400 group-hover:text-blue-500"}),T(" View technical specs ")],-1)])])):f("",!0)]),t.requestMessage?(s(),n("div",Nl)):f("",!0),t.requestMessage?(s(),n("div",Il,[o[25]||(o[25]=e("h4",{class:"text-xs font-bold uppercase text-gray-500 tracking-wider mb-4"},"REQUEST MESSAGE",-1)),e("div",Vl,[e("p",El,m(t.requestMessage),1)])])):f("",!0)])):f("",!0)])])):f("",!0)}},ee={note:"note",communication:"communication",email:"communication",call:"communication",sms:"communication",whatsapp:"communication",attachment:"attachment",document:"attachment",file:"attachment",tradein:"tradein","trade-in":"tradein",financing:"financing",offer:"offers",purchase:"offers",appointment:"appointments",survey:"surveys",default:"overview"};function ue(t){if(!t)return ee.default;const y=t.toLowerCase().trim();return ee[y]||ee.default}function Ul({store:t,taskId:y,getTabForItemType:l,isOverviewModalAction:g}){const a=D(null),o=D(null),b=D("overview"),u=D("email"),r=D([]);G(b,()=>{a.value=null,o.value=null});const i=I(()=>[...t.currentActivities.value,...r.value.filter(q=>!q.activityId)].filter(q=>{const w=l(q.type);return b.value==="overview"?w==="overview":w===b.value}).sort((q,w)=>{const V=new Date(q.timestamp||0);return new Date(w.timestamp||0)-V})),d=p=>(o.value=null,b.value==="overview"&&g&&g(p)?{type:"overview-modal",action:p}:(["email","sms","whatsapp","call"].includes(p)?(u.value=p,a.value="communication"):a.value=p,null)),h=async p=>{var q;if(p.isEdit){const w=r.value.findIndex(V=>V.id===p.id);w>-1&&(r.value[w]={...r.value[w],...p}),(q=o.value)!=null&&q.activityId&&await t.updateActivity(y.value,o.value.activityId,{type:p.communicationType||p.type,user:"You",action:p.action,content:p.content,fileName:p.fileName,data:p.data})}else{const w=p.communicationType||p.type,V=await t.addActivity(y.value,{type:w,user:"You",action:p.action,content:p.content,fileName:p.fileName,data:p.data});r.value.push({id:V.id,type:w==="email"||w==="whatsapp"||w==="sms"?"communication":w,action:p.action,content:p.content,fileName:p.fileName,data:p.data,timestamp:V.timestamp,activityId:V.id})}a.value=null,o.value=null},N=()=>{a.value=null,o.value=null},x=p=>{l(p.type)&&(a.value=p.type==="email"||p.type==="whatsapp"||p.type==="sms"||p.type==="communication"?"communication":p.type,o.value=p)},c=async p=>{try{await t.deleteActivity(y.value,p)}catch(q){throw console.error("Error deleting item:",q),q}};return{activeTab:b,showInlineWidget:a,inlineWidgetType:I(()=>a.value),editingItem:o,isEditing:I(()=>o.value!==null),communicationType:u,inlineContent:r,filteredInlineContent:i,handleAddNewAction:d,handleWidgetSave:h,handleWidgetCancel:N,handleEditItem:x,handleDeleteItem:c}}const jl={class:"flex-1 flex flex-col overflow-hidden h-full"},Ml={class:"bg-white border-b border-gray-200 shrink-0 shadow-sm"},Wl={class:"px-4 md:px-8 py-4 md:py-6"},Ll={class:"flex-1 flex flex-row overflow-hidden"},Bl={class:"flex-1 flex flex-col overflow-hidden min-w-0"},Pl={class:"flex-1 overflow-y-auto p-4 md:p-8 scrollbar-hide"},Rl={class:"mb-4"},zl={key:0},Yl={key:0,class:"mb-6"},Kl={key:2,class:"mb-6"},Ql={class:"space-y-6 mb-6"},Gl={key:3,class:"space-y-4 mb-6 px-1"},Hl={key:1},Jl={key:0,class:"space-y-4 mb-6 px-1"},Zl={key:0,class:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"},Xl={class:"p-6"},_l={class:"flex justify-between items-center mb-4"},en={class:"text-sm font-bold text-slate-800"},tn={key:1,class:"max-w-2xl w-full max-h-[90vh] overflow-y-auto"},rn={__name:"CustomerShell",props:{task:{type:Object,required:!0},type:{type:String,required:!0},managementWidget:{type:Object,required:!0},storeAdapter:{type:Object,required:!0},addNewConfig:{type:Object,required:!0}},emits:["car-added","convert-to-lead","convert-to-opportunity"],setup(t,{emit:y}){const l=t,g=xe(),a=ve(),o=I(()=>l.task.id),b=I(()=>l.type==="contact"?"bg-blue-100 text-blue-600":l.type==="lead"?"bg-orange-100 text-orange-600":"bg-purple-100 text-purple-600"),u=I(()=>g.path.startsWith("/tasks")&&!g.path.startsWith("/customer")),r=D(g.path.startsWith("/tasks")&&!g.path.startsWith("/customer"));G(()=>g.path,v=>{r.value=v.startsWith("/tasks")&&!v.startsWith("/customer")});const i=()=>{a.push({path:`/customer/${l.task.id}`,query:{type:l.type}})};function d(v){p.value=!1,console.log("Appointment created:",v)}const h=()=>{q.value=!0},N=async v=>{var C,W,Q,U;const k=v.name;l.type==="lead"?await((W=(C=l.storeAdapter).updateLead)==null?void 0:W.call(C,l.task.id,{assignee:k,assigneeType:v.type,teamId:v.type==="team"?v.id:null})):l.type==="opportunity"&&await((U=(Q=l.storeAdapter).updateOpportunity)==null?void 0:U.call(Q,l.task.id,{assignee:k,assigneeType:v.type,teamId:v.type==="team"?v.id:null})),q.value=!1},x=D(!1),c=D(null),p=D(!1),q=D(!1),{activeTab:w,showInlineWidget:V,editingItem:j,communicationType:ce,inlineContent:ne,filteredInlineContent:Y,handleAddNewAction:me,handleWidgetSave:K,handleWidgetCancel:Z,handleEditItem:oe,handleDeleteItem:ie}=Ul({store:l.storeAdapter,taskId:o,getTabForItemType:ue,isOverviewModalAction:v=>w.value==="overview"&&l.addNewConfig.overviewActions.includes(v)});G(()=>l.task.id,()=>{w.value="overview"});const X=v=>{const k=me(v);k&&k.modalAction&&(c.value=k.modalAction,x.value=!0)},fe=v=>{if(v==="appointment"){p.value=!0;return}const k={note:"note",attachment:"attachment",email:"communication",whatsapp:"communication",sms:"communication",call:"communication",appointment:"overview"};if(["financing","tradein","purchase"].includes(v))c.value=v,x.value=!0;else{const C=k[v];C?(w.value=C,setTimeout(()=>{X(v),setTimeout(()=>{const W=document.querySelector(".animate-fade-in");W&&W.scrollIntoView({behavior:"smooth",block:"start"})},100)},50)):X(v)}},L=()=>{x.value=!1,c.value=null},_=async v=>{await K(v),L()},ye=I(()=>{const v=[...l.storeAdapter.currentActivities.value,...ne.value],k=v.filter(U=>ue(U.type)==="overview").length,C=v.filter(U=>["call","email","sms","whatsapp","communication"].includes(U.type)).length,W=v.filter(U=>U.type==="note").length,Q=v.filter(U=>U.type==="attachment").length;return[{key:"overview",label:"Overview",count:k},{key:"note",label:"Notes",count:W},{key:"communication",label:"Communication",count:C},{key:"attachment",label:"Attachments",count:Q}]}),re=I(()=>[...l.storeAdapter.currentActivities.value,...ne.value]),ge=async v=>{if(l.type==="opportunity")try{await l.storeAdapter.addVehicle(l.task.id,v.vehicleData),l.storeAdapter.loadOpportunityById&&await l.storeAdapter.loadOpportunityById(l.task.id)}catch(k){console.error("Error selecting vehicle:",k)}},pe=async v=>{if(l.type==="opportunity")try{await l.storeAdapter.createOffer(l.task.id,v.offerData),l.storeAdapter.loadOpportunityById&&await l.storeAdapter.loadOpportunityById(l.task.id)}catch(k){console.error("Error creating offer:",k)}};return(v,k)=>(s(),n("div",jl,[e("header",Ml,[e("div",Wl,[M(Je,{initials:t.task.customer.initials,name:t.task.customer.name,email:t.task.customer.email,phone:t.task.customer.phone,"third-field-value":t.task.customer.address,"avatar-color-class":b.value,"task-type":t.type,"email-label":"Email","phone-label":"Phone","third-field-label":"Address",onAction:fe},{tags:H(()=>[(s(!0),n(F,null,R(t.task.tags,C=>(s(),n("span",{key:C,class:"badge-ui bg-blue-50 border-blue-100 text-blue-700 font-semibold"},m(C),1))),128))]),"name-action":H(()=>[u.value?(s(),n("button",{key:0,onClick:i,class:"w-7 h-7 flex items-center justify-center bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-lg text-blue-600 hover:text-blue-700 transition-colors shrink-0",title:"Open in new page"},[...k[7]||(k[7]=[e("i",{class:"fa-solid fa-external-link text-xs"},null,-1)])])):f("",!0)]),_:1},8,["initials","name","email","phone","third-field-value","avatar-color-class","task-type"])])]),e("div",Ll,[e("div",Bl,[e("main",Pl,[e("div",Rl,[M(et,{modelValue:S(w),"onUpdate:modelValue":k[0]||(k[0]=C=>he(w)?w.value=C:null),tabs:ye.value,class:"mb-0"},null,8,["modelValue","tabs"])]),S(w)==="overview"?(s(),n("div",zl,[t.type!=="contact"?(s(),n("div",Yl,[M(rt,{stage:t.task.displayStage||t.task.stage,owner:t.task.assignee,source:t.task.source||"","delivery-substatus":t.task.deliverySubstatus,onReassign:h},null,8,["stage","owner","source","delivery-substatus"])])):f("",!0),t.task.requestedCar?(s(),E(Fl,{key:1,brand:t.task.requestedCar.brand,model:t.task.requestedCar.model,year:t.task.requestedCar.year,image:t.task.requestedCar.image||"",price:t.task.requestedCar.price||null,"request-message":t.task.requestedCar.requestMessage||"","request-type":t.task.requestedCar.requestType||"",source:t.task.source||"",dealership:t.task.requestedCar.dealership||"",registration:t.task.requestedCar.registration||"",kilometers:t.task.requestedCar.kilometers||null,"fuel-type":t.task.requestedCar.fuelType||"","gear-type":t.task.requestedCar.gearType||"",vin:t.task.requestedCar.vin||"","stock-days":t.task.requestedCar.stockDays!==void 0?t.task.requestedCar.stockDays:null,channel:t.task.requestedCar.channel||"Email","ad-campaign":t.task.requestedCar.adCampaign||"","expected-purchase-date":t.task.requestedCar.expectedPurchaseDate||"","fiscal-entity":t.task.requestedCar.fiscalEntity||"","source-details":t.task.requestedCar.sourceDetails||"","ad-medium":t.task.requestedCar.adMedium||"","ad-source":t.task.requestedCar.adSource||"",label:"Requested Car",class:"mb-6"},null,8,["brand","model","year","image","price","request-message","request-type","source","dealership","registration","kilometers","fuel-type","gear-type","vin","stock-days","channel","ad-campaign","expected-purchase-date","fiscal-entity","source-details","ad-medium","ad-source"])):f("",!0),t.managementWidget?(s(),n("div",Kl,[(s(),E(ke(t.managementWidget),{lead:t.type==="lead"?t.task:void 0,opportunity:t.type==="opportunity"?t.task:void 0,contact:t.type==="contact"?t.task:void 0,activities:re.value,onCarAdded:k[1]||(k[1]=C=>v.$emit("car-added",C)),onConvertToLead:k[2]||(k[2]=C=>v.$emit("convert-to-lead")),onConvertToOpportunity:k[3]||(k[3]=C=>v.$emit("convert-to-opportunity")),onVehicleSelected:ge,onCreateOffer:pe},null,40,["lead","opportunity","contact","activities"]))])):f("",!0),e("div",Ql,[ae(v.$slots,"pinned-extra",{task:t.task})]),S(Y).length>0?(s(),n("div",Gl,[(s(!0),n(F,null,R(S(Y),C=>(s(),E(de,{key:C.id,item:C,"task-type":t.type,"customer-initials":"SK",onEdit:S(oe),onDelete:S(ie)},null,8,["item","task-type","onEdit","onDelete"]))),128))])):f("",!0)])):(s(),n("div",Hl,[M(ft,{actions:t.addNewConfig.tabActions,"active-tab":S(w),onAction:X},null,8,["actions","active-tab"]),e("div",null,[S(V)==="communication"?(s(),E(Ja,{key:0,type:S(ce),"task-type":t.type,"task-id":t.task.id,item:S(j),onSave:S(K),onCancel:S(Z)},null,8,["type","task-type","task-id","item","onSave","onCancel"])):f("",!0),S(V)==="note"?(s(),E(ts,{key:1,item:S(j),"task-type":t.type,"task-id":t.task.id,onSave:S(K),onCancel:S(Z)},null,8,["item","task-type","task-id","onSave","onCancel"])):f("",!0),S(V)==="attachment"?(s(),E(us,{key:2,item:S(j),"task-type":t.type,"task-id":t.task.id,onSave:S(K),onCancel:S(Z)},null,8,["item","task-type","task-id","onSave","onCancel"])):f("",!0)]),S(Y).length>0?(s(),n("div",Jl,[(s(!0),n(F,null,R(S(Y),C=>(s(),E(de,{key:C.id,item:C,"task-type":t.type,"customer-initials":"SK",onEdit:S(oe),onDelete:S(ie)},null,8,["item","task-type","onEdit","onDelete"]))),128))])):f("",!0)]))])]),M(Ya,{title:"Activity summary",activities:re.value,collapsed:r.value,"show-collapse":!0,show:!0,class:"hidden lg:flex",onToggleCollapse:k[4]||(k[4]=C=>r.value=!r.value)},null,8,["activities","collapsed"])]),(s(),E(we,{to:"body"},[x.value?(s(),n("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",onClick:P(L,["self"])},[c.value==="financing"||c.value==="tradein"?(s(),n("div",Zl,[e("div",Xl,[e("div",_l,[e("h5",en,m(c.value==="financing"?"Add Financing":"Add Trade-in"),1),e("button",{onClick:L,class:"text-gray-400 hover:text-gray-600"},[...k[8]||(k[8]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),c.value==="financing"?(s(),E(bs,{key:0,item:null,"task-type":t.type,"task-id":t.task.id,onSave:_,onCancel:L},null,8,["task-type","task-id"])):f("",!0),c.value==="tradein"?(s(),E(Cs,{key:1,item:null,"task-type":t.type,"task-id":t.task.id,onSave:_,onCancel:L},null,8,["task-type","task-id"])):f("",!0)])])):f("",!0),c.value==="purchase"?(s(),n("div",tn,[M(Ws,{item:null,"task-type":t.type,"task-id":t.task.id,"requested-car":t.type==="lead"?t.task.requestedCar:null,"recommended-cars":[],onSave:_,onCancel:L},null,8,["task-type","task-id","requested-car"])])):f("",!0)])):f("",!0)])),M($e,{show:q.value,onClose:k[5]||(k[5]=C=>q.value=!1),onConfirm:N},null,8,["show"]),p.value?(s(),E(Ce,{key:0,show:p.value,customer:t.task.customer,assignee:t.task.assignee,"disabled-fields":["customer"],onCreate:d,onCancel:k[6]||(k[6]=C=>p.value=!1)},null,8,["show","customer","assignee"])):f("",!0)]))}},le={Qualified:{primaryAction:{key:"schedule-appointment",title:"Schedule First Appointment",description:"Begin the sales process by scheduling an appointment with the customer",label:"Schedule Appointment",icon:"fa-solid fa-calendar-plus",buttonClass:"bg-blue-600 hover:bg-blue-700 text-white",colorScheme:{background:"bg-blue-50/50",border:"border-blue-100"}},secondaryActions:[{key:"select-vehicle",label:"Select Vehicle",icon:"fa-solid fa-car",description:"Choose a vehicle for this opportunity"},{key:"schedule-appointment",label:"Schedule Appointment",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"OOFB",condition:"qualified-no-offers-7-13-days"},{type:"UFB",condition:"qualified-no-offers-14-plus-days"}]},"Awaiting Appointment":{primaryAction:{key:"view-or-schedule-appointment",title:t=>t.scheduledAppointment?"Next Appointment":"Schedule Appointment",description:t=>t.scheduledAppointment?`Scheduled for ${t.formatDateTime(t.scheduledAppointment.start)}`:"Schedule an appointment to move forward",label:t=>t.scheduledAppointment?"View Appointment":"Schedule Appointment",icon:"fa-solid fa-calendar-check",buttonClass:"bg-purple-600 hover:bg-purple-700 text-white",colorScheme:{background:"bg-purple-50/50",border:"border-purple-100"}},secondaryActions:[{key:"reschedule",label:"Reschedule",icon:"fa-solid fa-calendar-days",description:"Change appointment date/time"},{key:"cancel-appointment",label:"Cancel Appointment",icon:"fa-solid fa-calendar-xmark"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"NS",condition:"appointment-past-not-completed"}]},"To be Called Back":{primaryAction:{key:"call-prospect",title:"Call Prospect",description:"Customer requested a callback. Follow up to maintain engagement",label:"Initiate Call",icon:"fa-solid fa-phone",buttonClass:"bg-indigo-600 hover:bg-indigo-700 text-white",colorScheme:{background:"bg-indigo-50/50",border:"border-indigo-100"}},secondaryActions:[{key:"schedule-appointment",label:"Schedule Appointment",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[]},"In Negotiation":{primaryAction:{key:"create-offer",title:"Create Offer",description:t=>t.hasOffers?"Add another offer or refine existing proposal":"Create initial offer to move forward with negotiation",label:t=>t.hasOffers?"Add Another Offer":"Create Offer",icon:"fa-solid fa-file-invoice-dollar",buttonClass:"bg-yellow-600 hover:bg-yellow-700 text-white",colorScheme:{background:"bg-yellow-50/50",border:"border-yellow-100"}},secondaryActions:[{key:"schedule-appointment",label:"Schedule Appointment",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"OFB",condition:"negotiation-5-plus-days-no-contract-has-offers"},{type:"NFU",condition:"negotiation-5-plus-days-no-contract-no-future-appointment-has-offers"}]},"Offer Sent":{primaryAction:{key:"follow-up-offer",title:"Follow Up on Offer",description:"Offer recently sent. Follow up to gauge customer interest",label:"Log Follow-up",icon:"fa-solid fa-phone-volume",buttonClass:"bg-orange-600 hover:bg-orange-700 text-white",colorScheme:{background:"bg-orange-50/50",border:"border-orange-100"}},secondaryActions:[{key:"add-offer",label:"Add Another Offer",icon:"fa-solid fa-file-invoice-dollar"},{key:"schedule-appointment",label:"Schedule Follow-up",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"OFB",condition:"negotiation-5-plus-days-no-contract-has-offers"},{type:"NFU",condition:"negotiation-5-plus-days-no-contract-no-future-appointment-has-offers"}]},"Awaiting Response":{primaryAction:{key:"request-decision",title:"Request Customer Decision",description:"Offer has been pending. Time to request a decision from the prospect",label:"Request Decision",icon:"fa-solid fa-circle-question",buttonClass:"bg-pink-600 hover:bg-pink-700 text-white",colorScheme:{background:"bg-pink-50/50",border:"border-pink-100"}},secondaryActions:[{key:"add-contract",label:"Add Contract",icon:"fa-solid fa-file-contract",description:"Customer accepted - add contract to proceed"},{key:"add-offer",label:"Send New Offer",icon:"fa-solid fa-file-invoice-dollar"},{key:"schedule-appointment",label:"Schedule Meeting",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"OFB",condition:"negotiation-5-plus-days-no-contract-has-offers"},{type:"NFU",condition:"negotiation-5-plus-days-no-contract-no-future-appointment-has-offers"}]},"Contract Pending":{primaryAction:{key:"finalize-contract",title:"Finalize Contract",description:"Collect e-signatures and finalize contract documentation",label:"Collect Signatures",icon:"fa-solid fa-file-signature",buttonClass:"bg-emerald-600 hover:bg-emerald-700 text-white",colorScheme:{background:"bg-emerald-50/50",border:"border-emerald-100"}},secondaryActions:[{key:"close-won",label:"Close as Won",icon:"fa-solid fa-check-circle",description:"Mark deal as won and finalize"},{key:"extend-deadline",label:"Extend Deadline",icon:"fa-solid fa-clock"},{key:"add-offer",label:"Revise Offer",icon:"fa-solid fa-file-invoice-dollar"},{key:"schedule-appointment",label:"Schedule Appointment",icon:"fa-solid fa-calendar-plus",conditional:"no-appointment"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[]},"Closed Won":{primaryAction:t=>{const y=t.deliverySubstatus;return y==="Delivered"?{key:"collect-feedback",title:"Post-Delivery Follow-up",description:"Vehicle delivered. Collect customer feedback",label:"Collect Feedback",icon:"fa-solid fa-comment",buttonClass:"bg-green-600 hover:bg-green-700 text-white",colorScheme:{background:"bg-green-50/50",border:"border-green-100"}}:y==="Awaiting Delivery"?{key:"confirm-delivery",title:"Confirm Delivery Details",description:"Delivery scheduled. Confirm date/time with customer",label:"Confirm Delivery",icon:"fa-solid fa-calendar-check",buttonClass:"bg-teal-600 hover:bg-teal-700 text-white",colorScheme:{background:"bg-teal-50/50",border:"border-teal-100"}}:{key:"schedule-delivery",title:"Set Delivery Date",description:"Contract signed! Schedule vehicle delivery with the customer",label:"Schedule Delivery",icon:"fa-solid fa-truck",buttonClass:"bg-green-600 hover:bg-green-700 text-white",colorScheme:{background:"bg-green-50/50",border:"border-green-100"}}},secondaryActions:[{key:"collect-feedback",label:"Collect Feedback",icon:"fa-solid fa-comment",conditional:"is-delivered"},{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}],taskWidgets:[{type:"CFB",condition:"contract-7-plus-days-no-delivery"},{type:"DFB",condition:"delivery-3-plus-days"}]}},te={reopen:{key:"reopen",label:"Reopen Opportunity",icon:"fa-solid fa-rotate-left",description:"Restart the management process"},requalify:{key:"requalify",label:"Requalify as Lead",icon:"fa-solid fa-arrow-left",description:"Convert back to a lead"},closeLost:{key:"close-lost",label:"Close as Lost",icon:"fa-solid fa-xmark"}};function B(t){if(!t)return 0;const y=new Date(t),g=Math.abs(new Date-y);return Math.ceil(g/(1e3*60*60*24))}const J={"no-appointment":t=>!t.scheduledAppointment,"has-appointment":t=>!!t.scheduledAppointment,"appointment-past-not-completed":t=>t.scheduledAppointment?new Date(t.scheduledAppointment.start)<new Date&&t.scheduledAppointment.status!=="completed":!1,"has-future-appointment":t=>t.scheduledAppointment?new Date(t.scheduledAppointment.start)>new Date:!1,"no-offers":t=>!t.hasOffers,"has-offers":t=>t.hasOffers,"qualified-no-offers-7-13-days":t=>{const y=B(t.opportunity.createdAt);return y>=7&&y<14&&!t.hasOffers},"qualified-no-offers-14-plus-days":t=>B(t.opportunity.createdAt)>=14&&!t.hasOffers,"negotiation-5-plus-days-no-contract-has-offers":t=>t.stage==="In Negotiation"&&!t.hasOffers?!1:B(t.opportunity.lastActivity||t.opportunity.createdAt)>=5&&!t.opportunity.contractDate&&t.hasOffers,"negotiation-5-plus-days-no-contract-no-future-appointment-has-offers":t=>{if(t.stage==="In Negotiation"&&!t.hasOffers)return!1;const y=B(t.opportunity.lastActivity||t.opportunity.createdAt),l=t.scheduledAppointment&&new Date(t.scheduledAppointment.start)>new Date;return y>=5&&!t.opportunity.contractDate&&!l&&t.hasOffers},"contract-7-plus-days-no-delivery":t=>{var g;if(!t.opportunity.contractDate)return!1;const y=B(t.opportunity.contractDate),l=(g=t.activities)==null?void 0:g.some(a=>{var o;return a.type==="delivery"||((o=a.action)==null?void 0:o.toLowerCase().includes("delivered"))});return y>=7&&!l},"delivery-3-plus-days":t=>{var g;const y=(g=t.activities)==null?void 0:g.find(a=>{var o;return a.type==="delivery"||((o=a.action)==null?void 0:o.toLowerCase().includes("delivered"))});return y?B(y.timestamp)>=3:!1},"is-awaiting-delivery":t=>t.deliverySubstatus==="Awaiting Delivery","is-delivered":t=>t.deliverySubstatus==="Delivered","has-no-delivery":t=>!t.deliverySubstatus||t.deliverySubstatus===null,"is-closed":t=>{const y=t.stage;return y==="Closed Won"||y==="Closed Lost"},"is-closed-with-task-widget":t=>J["is-closed"](t)&&t.hasActiveTaskWidget};function dn(t,y){if(J["is-closed-with-task-widget"](y))return[te.reopen,te.requalify,te.closeLost];const l=le[t];return!l||!l.secondaryActions?[]:l.secondaryActions.filter(g=>{if(!g.conditional)return!0;const a=J[g.conditional];return a?a(y):!0})}function un(t,y){const l=le[t];if(!l||!l.taskWidgets)return null;for(const g of l.taskWidgets){const a=J[g.condition];if(a&&a(y))return g.type}return null}function cn(t,y){const l=le[t];if(!l||!l.primaryAction)return null;const g=l.primaryAction;return{...g,title:typeof g.title=="function"?g.title(y):g.title,description:typeof g.description=="function"?g.description(y):g.description,label:typeof g.label=="function"?g.label(y):g.label}}function mn(t){return{OOFB:"Overdue Offer Follow-up Task",UFB:"Urgent Follow-up Task",NFU:"No Future Updates Task",OFB:"Offer Follow-up Task",CFB:"Contract Follow-up Task",DFB:"Delivery Follow-up Task",NS:"No-Show Follow-up Task"}[t]||"Task"}function fn(t){return t==="Closed Won"||t==="Closed Lost"||t==="Delivered"}const yn={__name:"ComingSoonModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Coming Soon"}},emits:["close"],setup(t,{emit:y}){const l=y,g=()=>{l("close")};return(a,o)=>(s(),E(Se,{show:t.show,title:t.title,onCancel:g},{footer:H(()=>[e("div",{class:"px-6 py-4 border-t border-gray-200 flex justify-end"},[e("button",{onClick:g,class:"bg-gray-800 hover:bg-gray-900 text-white font-medium px-6 py-2 rounded-lg text-sm transition-colors"}," Close ")])]),default:H(()=>[o[0]||(o[0]=e("div",{class:"py-8 flex items-center justify-center"},[e("p",{class:"text-gray-600 text-lg font-medium"},"Coming soon")],-1))]),_:1},8,["show","title"]))}};export{ts as _,cn as a,dn as b,mn as c,Ws as d,yn as e,rn as f,un as g,Fl as h,fn as i};
