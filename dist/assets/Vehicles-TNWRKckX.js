import{P as u,R as B,r as d,c as b,k as S,K as c,e as $,l as I,h as f,m as y,j as K,L as N,o as D}from"./index-HNz1us-X.js";import{_ as U}from"./PageHeader-CWgBBom2.js";import{y as _}from"./components-BRQB_lDP.js";const g=(s=300)=>new Promise(a=>setTimeout(a,s)),q=async(s={})=>{await g();let a=[...u];if(s.status&&(a=a.filter(e=>e.status===s.status)),s.brand&&(a=a.filter(e=>e.brand===s.brand)),s.search){const e=s.search.toLowerCase();a=a.filter(l=>l.brand.toLowerCase().includes(e)||l.model.toLowerCase().includes(e)||l.vin.toLowerCase().includes(e))}return{data:a,total:a.length}},L=async s=>{await g();const a=u.find(e=>e.id===parseInt(s));if(!a)throw new Error("Vehicle not found");return a},E=async s=>{await g();const a={id:u.length+1,...s,stockDays:0};return u.push(a),a},P=async(s,a)=>{await g();const e=u.findIndex(l=>l.id===parseInt(s));if(e===-1)throw new Error("Vehicle not found");return u[e]={...u[e],...a},u[e]},j=async s=>{await g();const a=u.findIndex(e=>e.id===parseInt(s));if(a===-1)throw new Error("Vehicle not found");return u.splice(a,1),{success:!0}},A=B("vehicles",()=>{const s=d([]),a=d(null),e=d(!1),l=d(null),m=d({status:null,brand:null,search:""}),h=b(()=>s.value.length),w=b(()=>s.value.filter(n=>n.status==="Available")),x=b(()=>s.value.reduce((n,o)=>n+o.price,0));async function p(){e.value=!0,l.value=null;try{const n=await q(m.value);s.value=n.data}catch(n){l.value=n.message}finally{e.value=!1}}async function r(n){e.value=!0,l.value=null;try{a.value=await L(n)}catch(o){l.value=o.message}finally{e.value=!1}}async function t(n){e.value=!0,l.value=null;try{const o=await E(n);return s.value.unshift(o),o}catch(o){throw l.value=o.message,o}finally{e.value=!1}}async function i(n,o){e.value=!0,l.value=null;try{const v=await P(n,o),F=s.value.findIndex(C=>C.id===n);return F!==-1&&(s.value[F]=v),v}catch(v){throw l.value=v.message,v}finally{e.value=!1}}async function V(n){e.value=!0,l.value=null;try{await j(n),s.value=s.value.filter(o=>o.id!==n)}catch(o){throw l.value=o.message,o}finally{e.value=!1}}function k(n){m.value={...m.value,...n},p()}return{vehicles:s,currentVehicle:a,loading:e,error:l,filters:m,totalVehicles:h,availableVehicles:w,totalInventoryValue:x,loadVehicles:p,loadVehicleById:r,addVehicle:t,modifyVehicle:i,removeVehicle:V,setFilters:k}}),O={class:"page-container"},R={class:"p-4 md:p-8"},T={class:"table-wrapper w-full"},H={__name:"Vehicles",setup(s){const a=A(),e=d({pageIndex:0,pageSize:10}),l=d(""),m=d([]),h=d({status:void 0,brand:void 0});S(()=>{a.loadVehicles()});const w=r=>new Intl.NumberFormat("en-US").format(r),x=r=>new Intl.NumberFormat("en-US").format(r),p=b(()=>[{accessorKey:"brand",header:"Vehicle",meta:{title:"Vehicle"},enableColumnFilter:!0,cell:({row:r})=>{const t=r.original;return c("div",{class:"flex items-center gap-3"},[c("div",{class:"w-12 h-12 bg-gradient-to-br from-gray-100 to-gray-200 rounded-md flex items-center justify-center shrink-0"},[c("i",{class:"fa-solid fa-car text-2xl text-gray-400"})]),c("div",[c("div",{class:"text-content-bold"},`${t.brand} ${t.model}`),c("div",{class:"text-meta"},t.year)])])}},{accessorKey:"status",header:"Status",meta:{title:"Status"},enableColumnFilter:!0,cell:({row:r})=>{const t=r.original.status;return c("span",{class:`badge-ui font-semibold ${t==="Available"?"bg-green-100 text-green-700":t==="In Stock"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`},t)}},{accessorKey:"price",header:"Price",meta:{title:"Price"},cell:({row:r})=>c("span",{class:"text-content-bold"},`â‚¬${w(r.original.price)}`)},{accessorKey:"kilometers",header:"Kilometers",meta:{title:"Kilometers"},cell:({row:r})=>`${x(r.original.kilometers)} km`},{accessorKey:"stockDays",header:"Stock Days",meta:{title:"Stock Days"},cell:({row:r})=>{const t=r.original.stockDays,i=t>300?"text-red-600":"text-gray-600";return c("span",{class:`text-content font-medium ${i}`},`${t} days`)}},{accessorKey:"requestedBy",header:"Requested By",meta:{title:"Requested By"},cell:({row:r})=>{const t=r.original.requestedBy;if(t&&t.length>0){const i=t.slice(0,2).map(k=>c("span",{class:"badge-ui bg-blue-50 text-blue-700 font-semibold"},k)),V=t.length>2?c("span",{class:"badge-ui bg-gray-100 text-gray-600 font-semibold"},`+${t.length-2}`):null;return c("div",{class:"flex flex-wrap gap-1"},[...i,V].filter(Boolean))}return c("span",{class:"text-meta"},"-")}}]);return(r,t)=>(D(),$("div",O,[I(U,{title:"Vehicles Inventory",subtitle:`${y(a).totalVehicles} vehicles in inventory`},null,8,["subtitle"]),f("div",R,[t[5]||(t[5]=f("div",{class:"mb-6 flex justify-end"},[f("button",{class:"btn-primary-lg"},[f("i",{class:"fa-solid fa-plus"}),K(" Add new ")])],-1)),f("div",T,[I(y(_),{data:y(a).vehicles,columns:p.value,loading:y(a).loading,pagination:e.value,"onUpdate:pagination":t[0]||(t[0]=i=>e.value=i),globalFilter:l.value,"onUpdate:globalFilter":t[1]||(t[1]=i=>l.value=i),sorting:m.value,"onUpdate:sorting":t[2]||(t[2]=i=>m.value=i),columnFilters:h.value,"onUpdate:columnFilters":t[3]||(t[3]=i=>h.value=i),paginationOptions:{rowCount:y(a).totalVehicles},globalFilterOptions:{debounce:300}},{"empty-state":N(()=>[...t[4]||(t[4]=[f("div",{class:"empty-state"},[f("i",{class:"fa-solid fa-car empty-state-icon"}),f("p",{class:"empty-state-text"},"No vehicles found")],-1)])]),_:1},8,["data","columns","loading","pagination","globalFilter","sorting","columnFilters","paginationOptions"])])])]))}};export{H as default};
