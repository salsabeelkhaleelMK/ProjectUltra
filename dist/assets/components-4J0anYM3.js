import{a4 as Fa,aK as To,c as se,au as Be,aL as Je,aM as ge,r as xt,aN as Ea,m as Va,l as ht,aO as Da,Q as me,aP as Ve,d as H,o as w,e as Z,g as W,O as Ue,x as P,B as v,s as x,E as La,y as A,aQ as Ta,k as ae,t as U,F as X,i as ue,q as En,n as rt,w as ja,T as qa,av as Na,aR as jo,G as Ba,aS as Ha,aT as za,ac as Ua,V as Ee,aU as Ga,Y as Kt}from"./index-DqWyOYoU.js";import{p as Ot,i as no,q as qo,n as Ae,S as No,B as Wa,r as Ka,$ as Bo,T as Ho,D as on,x as Xa,I as Ja,s as zo,u as Qa,v as Vn,w as Ya,y as Za,E as so,M as Dn,N as ei,W as ti,U as ni,H as si,j as oi,G as ri,O as ai,P as Vt,_ as ii,a0 as li,a1 as ui,a2 as ci,a3 as di,a4 as hi,a5 as pi,a6 as fi,a7 as gi,a8 as mi,a9 as rn,aa as ns,ab as yi,ac as an,ad as ln,ae as un,af as cn,ag as dn,ah as At,ai as Mt,aj as hn,ak as oo,al as Dt,am as bi,an as wi,ao as vi,ap as _i,aq as Si,ar as xi,as as Ci,at as Ri,au as Ii}from"./toggle-group-item.vue_vue_type_script_setup_true_lang-SVS8Zwad-DVNwBQcn.js";const ki={production:"https://auth-proxy.k.motork.io/litellm",staging:"https://auth-proxy.beta.motork.io/litellm"};function Ai(e){return ki[e]}const Mi=Symbol.for("motork-ui.ai-config");function Pi(){return Fa(To(Mi,void 0))}const Oi=Symbol.for("motork-ui.app-env");function $i(){return To(Oi,se(()=>"production"))}var Ln={};const Fi=Ve("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),Ei=Ve("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),Vi=Ve("arrow-up-right",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),Di=Ve("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),Li=Ve("box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),Ti=Ve("chevrons-up-down",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]),ji=Ve("columns-3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),qi=Ve("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),ro=Ve("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);function Ni(){return{accessor:(e,t)=>typeof e=="function"?{...t,accessorFn:e}:{...t,accessorKey:e},display:e=>e,group:e=>e}}function qe(e,t){return typeof e=="function"?e(t):e}function ve(e,t){return n=>{t.setState(s=>({...s,[e]:qe(n,s[e])}))}}function Sn(e){return e instanceof Function}function Bi(e){return Array.isArray(e)&&e.every(t=>typeof t=="number")}function Hi(e,t){const n=[],s=o=>{o.forEach(r=>{n.push(r);const a=t(r);a!=null&&a.length&&s(a)})};return s(e),n}function T(e,t,n){let s=[],o;return r=>{let a;n.key&&n.debug&&(a=Date.now());const i=e(r);if(!(i.length!==s.length||i.some((c,f)=>s[f]!==c)))return o;s=i;let l;if(n.key&&n.debug&&(l=Date.now()),o=t(...i),n==null||n.onChange==null||n.onChange(o),n.key&&n.debug&&n!=null&&n.debug()){const c=Math.round((Date.now()-a)*100)/100,f=Math.round((Date.now()-l)*100)/100,p=f/16,d=(u,h)=>{for(u=String(u);u.length<h;)u=" "+u;return u};console.info(`%câ± ${d(f,5)} /${d(c,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*p,120))}deg 100% 31%);`,n==null?void 0:n.key)}return o}}function j(e,t,n,s){return{debug:()=>{var o;return(o=e==null?void 0:e.debugAll)!=null?o:e[t]},key:!1,onChange:s}}function zi(e,t,n,s){const o=()=>{var a;return(a=r.getValue())!=null?a:e.options.renderFallbackValue},r={id:`${t.id}_${n.id}`,row:t,column:n,getValue:()=>t.getValue(s),renderValue:o,getContext:T(()=>[e,n,t,r],(a,i,l,c)=>({table:a,column:i,row:l,cell:c,getValue:c.getValue,renderValue:c.renderValue}),j(e.options,"debugCells"))};return e._features.forEach(a=>{a.createCell==null||a.createCell(r,n,t,e)},{}),r}function Ui(e,t,n,s){var o,r;const a={...e._getDefaultColumnDef(),...t},i=a.accessorKey;let l=(o=(r=a.id)!=null?r:i?typeof String.prototype.replaceAll=="function"?i.replaceAll(".","_"):i.replace(/\./g,"_"):void 0)!=null?o:typeof a.header=="string"?a.header:void 0,c;if(a.accessorFn?c=a.accessorFn:i&&(i.includes(".")?c=p=>{let d=p;for(const h of i.split(".")){var u;d=(u=d)==null?void 0:u[h]}return d}:c=p=>p[a.accessorKey]),!l)throw new Error;let f={id:`${String(l)}`,accessorFn:c,parent:s,depth:n,columnDef:a,columns:[],getFlatColumns:T(()=>[!0],()=>{var p;return[f,...(p=f.columns)==null?void 0:p.flatMap(d=>d.getFlatColumns())]},j(e.options,"debugColumns")),getLeafColumns:T(()=>[e._getOrderColumnsFn()],p=>{var d;if((d=f.columns)!=null&&d.length){let u=f.columns.flatMap(h=>h.getLeafColumns());return p(u)}return[f]},j(e.options,"debugColumns"))};for(const p of e._features)p.createColumn==null||p.createColumn(f,e);return f}const de="debugHeaders";function ao(e,t,n){var s;let o={id:(s=n.id)!=null?s:t.id,column:t,index:n.index,isPlaceholder:!!n.isPlaceholder,placeholderId:n.placeholderId,depth:n.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const r=[],a=i=>{i.subHeaders&&i.subHeaders.length&&i.subHeaders.map(a),r.push(i)};return a(o),r},getContext:()=>({table:e,header:o,column:t})};return e._features.forEach(r=>{r.createHeader==null||r.createHeader(o,e)}),o}const Gi={createTable:e=>{e.getHeaderGroups=T(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,n,s,o)=>{var r,a;const i=(r=s==null?void 0:s.map(f=>n.find(p=>p.id===f)).filter(Boolean))!=null?r:[],l=(a=o==null?void 0:o.map(f=>n.find(p=>p.id===f)).filter(Boolean))!=null?a:[],c=n.filter(f=>!(s!=null&&s.includes(f.id))&&!(o!=null&&o.includes(f.id)));return Lt(t,[...i,...c,...l],e)},j(e.options,de)),e.getCenterHeaderGroups=T(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,n,s,o)=>(n=n.filter(r=>!(s!=null&&s.includes(r.id))&&!(o!=null&&o.includes(r.id))),Lt(t,n,e,"center")),j(e.options,de)),e.getLeftHeaderGroups=T(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left],(t,n,s)=>{var o;const r=(o=s==null?void 0:s.map(a=>n.find(i=>i.id===a)).filter(Boolean))!=null?o:[];return Lt(t,r,e,"left")},j(e.options,de)),e.getRightHeaderGroups=T(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.right],(t,n,s)=>{var o;const r=(o=s==null?void 0:s.map(a=>n.find(i=>i.id===a)).filter(Boolean))!=null?o:[];return Lt(t,r,e,"right")},j(e.options,de)),e.getFooterGroups=T(()=>[e.getHeaderGroups()],t=>[...t].reverse(),j(e.options,de)),e.getLeftFooterGroups=T(()=>[e.getLeftHeaderGroups()],t=>[...t].reverse(),j(e.options,de)),e.getCenterFooterGroups=T(()=>[e.getCenterHeaderGroups()],t=>[...t].reverse(),j(e.options,de)),e.getRightFooterGroups=T(()=>[e.getRightHeaderGroups()],t=>[...t].reverse(),j(e.options,de)),e.getFlatHeaders=T(()=>[e.getHeaderGroups()],t=>t.map(n=>n.headers).flat(),j(e.options,de)),e.getLeftFlatHeaders=T(()=>[e.getLeftHeaderGroups()],t=>t.map(n=>n.headers).flat(),j(e.options,de)),e.getCenterFlatHeaders=T(()=>[e.getCenterHeaderGroups()],t=>t.map(n=>n.headers).flat(),j(e.options,de)),e.getRightFlatHeaders=T(()=>[e.getRightHeaderGroups()],t=>t.map(n=>n.headers).flat(),j(e.options,de)),e.getCenterLeafHeaders=T(()=>[e.getCenterFlatHeaders()],t=>t.filter(n=>{var s;return!((s=n.subHeaders)!=null&&s.length)}),j(e.options,de)),e.getLeftLeafHeaders=T(()=>[e.getLeftFlatHeaders()],t=>t.filter(n=>{var s;return!((s=n.subHeaders)!=null&&s.length)}),j(e.options,de)),e.getRightLeafHeaders=T(()=>[e.getRightFlatHeaders()],t=>t.filter(n=>{var s;return!((s=n.subHeaders)!=null&&s.length)}),j(e.options,de)),e.getLeafHeaders=T(()=>[e.getLeftHeaderGroups(),e.getCenterHeaderGroups(),e.getRightHeaderGroups()],(t,n,s)=>{var o,r,a,i,l,c;return[...(o=(r=t[0])==null?void 0:r.headers)!=null?o:[],...(a=(i=n[0])==null?void 0:i.headers)!=null?a:[],...(l=(c=s[0])==null?void 0:c.headers)!=null?l:[]].map(f=>f.getLeafHeaders()).flat()},j(e.options,de))}};function Lt(e,t,n,s){var o,r;let a=0;const i=function(d,u){u===void 0&&(u=1),a=Math.max(a,u),d.filter(h=>h.getIsVisible()).forEach(h=>{var m;(m=h.columns)!=null&&m.length&&i(h.columns,u+1)},0)};i(e);let l=[];const c=(d,u)=>{const h={depth:u,id:[s,`${u}`].filter(Boolean).join("_"),headers:[]},m=[];d.forEach(y=>{const C=[...m].reverse()[0],S=y.column.depth===h.depth;let R,V=!1;if(S&&y.column.parent?R=y.column.parent:(R=y.column,V=!0),C&&(C==null?void 0:C.column)===R)C.subHeaders.push(y);else{const z=ao(n,R,{id:[s,u,R.id,y==null?void 0:y.id].filter(Boolean).join("_"),isPlaceholder:V,placeholderId:V?`${m.filter(q=>q.column===R).length}`:void 0,depth:u,index:m.length});z.subHeaders.push(y),m.push(z)}h.headers.push(y),y.headerGroup=h}),l.push(h),u>0&&c(m,u-1)},f=t.map((d,u)=>ao(n,d,{depth:a,index:u}));c(f,a-1),l.reverse();const p=d=>d.filter(u=>u.column.getIsVisible()).map(u=>{let h=0,m=0,y=[0];u.subHeaders&&u.subHeaders.length?(y=[],p(u.subHeaders).forEach(S=>{let{colSpan:R,rowSpan:V}=S;h+=R,y.push(V)})):h=1;const C=Math.min(...y);return m=m+C,u.colSpan=h,u.rowSpan=m,{colSpan:h,rowSpan:m}});return p((o=(r=l[0])==null?void 0:r.headers)!=null?o:[]),l}const Wi=(e,t,n,s,o,r,a)=>{let i={id:t,index:s,original:n,depth:o,parentId:a,_valuesCache:{},_uniqueValuesCache:{},getValue:l=>{if(i._valuesCache.hasOwnProperty(l))return i._valuesCache[l];const c=e.getColumn(l);if(c!=null&&c.accessorFn)return i._valuesCache[l]=c.accessorFn(i.original,s),i._valuesCache[l]},getUniqueValues:l=>{if(i._uniqueValuesCache.hasOwnProperty(l))return i._uniqueValuesCache[l];const c=e.getColumn(l);if(c!=null&&c.accessorFn)return c.columnDef.getUniqueValues?(i._uniqueValuesCache[l]=c.columnDef.getUniqueValues(i.original,s),i._uniqueValuesCache[l]):(i._uniqueValuesCache[l]=[i.getValue(l)],i._uniqueValuesCache[l])},renderValue:l=>{var c;return(c=i.getValue(l))!=null?c:e.options.renderFallbackValue},subRows:[],getLeafRows:()=>Hi(i.subRows,l=>l.subRows),getParentRow:()=>i.parentId?e.getRow(i.parentId,!0):void 0,getParentRows:()=>{let l=[],c=i;for(;;){const f=c.getParentRow();if(!f)break;l.push(f),c=f}return l.reverse()},getAllCells:T(()=>[e.getAllLeafColumns()],l=>l.map(c=>zi(e,i,c,c.id)),j(e.options,"debugRows")),_getAllCellsByColumnId:T(()=>[i.getAllCells()],l=>l.reduce((c,f)=>(c[f.column.id]=f,c),{}),j(e.options,"debugRows"))};for(let l=0;l<e._features.length;l++){const c=e._features[l];c==null||c.createRow==null||c.createRow(i,e)}return i},Ki={createColumn:(e,t)=>{e._getFacetedRowModel=t.options.getFacetedRowModel&&t.options.getFacetedRowModel(t,e.id),e.getFacetedRowModel=()=>e._getFacetedRowModel?e._getFacetedRowModel():t.getPreFilteredRowModel(),e._getFacetedUniqueValues=t.options.getFacetedUniqueValues&&t.options.getFacetedUniqueValues(t,e.id),e.getFacetedUniqueValues=()=>e._getFacetedUniqueValues?e._getFacetedUniqueValues():new Map,e._getFacetedMinMaxValues=t.options.getFacetedMinMaxValues&&t.options.getFacetedMinMaxValues(t,e.id),e.getFacetedMinMaxValues=()=>{if(e._getFacetedMinMaxValues)return e._getFacetedMinMaxValues()}}},Uo=(e,t,n)=>{var s,o;const r=n==null||(s=n.toString())==null?void 0:s.toLowerCase();return!!(!((o=e.getValue(t))==null||(o=o.toString())==null||(o=o.toLowerCase())==null)&&o.includes(r))};Uo.autoRemove=e=>Ce(e);const Go=(e,t,n)=>{var s;return!!(!((s=e.getValue(t))==null||(s=s.toString())==null)&&s.includes(n))};Go.autoRemove=e=>Ce(e);const Wo=(e,t,n)=>{var s;return((s=e.getValue(t))==null||(s=s.toString())==null?void 0:s.toLowerCase())===(n==null?void 0:n.toLowerCase())};Wo.autoRemove=e=>Ce(e);const Ko=(e,t,n)=>{var s;return(s=e.getValue(t))==null?void 0:s.includes(n)};Ko.autoRemove=e=>Ce(e);const Xo=(e,t,n)=>!n.some(s=>{var o;return!((o=e.getValue(t))!=null&&o.includes(s))});Xo.autoRemove=e=>Ce(e)||!(e!=null&&e.length);const Jo=(e,t,n)=>n.some(s=>{var o;return(o=e.getValue(t))==null?void 0:o.includes(s)});Jo.autoRemove=e=>Ce(e)||!(e!=null&&e.length);const Qo=(e,t,n)=>e.getValue(t)===n;Qo.autoRemove=e=>Ce(e);const Yo=(e,t,n)=>e.getValue(t)==n;Yo.autoRemove=e=>Ce(e);const Ss=(e,t,n)=>{let[s,o]=n;const r=e.getValue(t);return r>=s&&r<=o};Ss.resolveFilterValue=e=>{let[t,n]=e,s=typeof t!="number"?parseFloat(t):t,o=typeof n!="number"?parseFloat(n):n,r=t===null||Number.isNaN(s)?-1/0:s,a=n===null||Number.isNaN(o)?1/0:o;if(r>a){const i=r;r=a,a=i}return[r,a]};Ss.autoRemove=e=>Ce(e)||Ce(e[0])&&Ce(e[1]);const je={includesString:Uo,includesStringSensitive:Go,equalsString:Wo,arrIncludes:Ko,arrIncludesAll:Xo,arrIncludesSome:Jo,equals:Qo,weakEquals:Yo,inNumberRange:Ss};function Ce(e){return e==null||e===""}const Xi={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:e=>({columnFilters:[],...e}),getDefaultOptions:e=>({onColumnFiltersChange:ve("columnFilters",e),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(e,t)=>{e.getAutoFilterFn=()=>{const n=t.getCoreRowModel().flatRows[0],s=n==null?void 0:n.getValue(e.id);return typeof s=="string"?je.includesString:typeof s=="number"?je.inNumberRange:typeof s=="boolean"||s!==null&&typeof s=="object"?je.equals:Array.isArray(s)?je.arrIncludes:je.weakEquals},e.getFilterFn=()=>{var n,s;return Sn(e.columnDef.filterFn)?e.columnDef.filterFn:e.columnDef.filterFn==="auto"?e.getAutoFilterFn():(n=(s=t.options.filterFns)==null?void 0:s[e.columnDef.filterFn])!=null?n:je[e.columnDef.filterFn]},e.getCanFilter=()=>{var n,s,o;return((n=e.columnDef.enableColumnFilter)!=null?n:!0)&&((s=t.options.enableColumnFilters)!=null?s:!0)&&((o=t.options.enableFilters)!=null?o:!0)&&!!e.accessorFn},e.getIsFiltered=()=>e.getFilterIndex()>-1,e.getFilterValue=()=>{var n;return(n=t.getState().columnFilters)==null||(n=n.find(s=>s.id===e.id))==null?void 0:n.value},e.getFilterIndex=()=>{var n,s;return(n=(s=t.getState().columnFilters)==null?void 0:s.findIndex(o=>o.id===e.id))!=null?n:-1},e.setFilterValue=n=>{t.setColumnFilters(s=>{const o=e.getFilterFn(),r=s==null?void 0:s.find(f=>f.id===e.id),a=qe(n,r?r.value:void 0);if(io(o,a,e)){var i;return(i=s==null?void 0:s.filter(f=>f.id!==e.id))!=null?i:[]}const l={id:e.id,value:a};if(r){var c;return(c=s==null?void 0:s.map(f=>f.id===e.id?l:f))!=null?c:[]}return s!=null&&s.length?[...s,l]:[l]})}},createRow:(e,t)=>{e.columnFilters={},e.columnFiltersMeta={}},createTable:e=>{e.setColumnFilters=t=>{const n=e.getAllLeafColumns(),s=o=>{var r;return(r=qe(t,o))==null?void 0:r.filter(a=>{const i=n.find(l=>l.id===a.id);if(i){const l=i.getFilterFn();if(io(l,a.value,i))return!1}return!0})};e.options.onColumnFiltersChange==null||e.options.onColumnFiltersChange(s)},e.resetColumnFilters=t=>{var n,s;e.setColumnFilters(t?[]:(n=(s=e.initialState)==null?void 0:s.columnFilters)!=null?n:[])},e.getPreFilteredRowModel=()=>e.getCoreRowModel(),e.getFilteredRowModel=()=>(!e._getFilteredRowModel&&e.options.getFilteredRowModel&&(e._getFilteredRowModel=e.options.getFilteredRowModel(e)),e.options.manualFiltering||!e._getFilteredRowModel?e.getPreFilteredRowModel():e._getFilteredRowModel())}};function io(e,t,n){return(e&&e.autoRemove?e.autoRemove(t,n):!1)||typeof t>"u"||typeof t=="string"&&!t}const Ji=(e,t,n)=>n.reduce((s,o)=>{const r=o.getValue(e);return s+(typeof r=="number"?r:0)},0),Qi=(e,t,n)=>{let s;return n.forEach(o=>{const r=o.getValue(e);r!=null&&(s>r||s===void 0&&r>=r)&&(s=r)}),s},Yi=(e,t,n)=>{let s;return n.forEach(o=>{const r=o.getValue(e);r!=null&&(s<r||s===void 0&&r>=r)&&(s=r)}),s},Zi=(e,t,n)=>{let s,o;return n.forEach(r=>{const a=r.getValue(e);a!=null&&(s===void 0?a>=a&&(s=o=a):(s>a&&(s=a),o<a&&(o=a)))}),[s,o]},el=(e,t)=>{let n=0,s=0;if(t.forEach(o=>{let r=o.getValue(e);r!=null&&(r=+r)>=r&&(++n,s+=r)}),n)return s/n},tl=(e,t)=>{if(!t.length)return;const n=t.map(r=>r.getValue(e));if(!Bi(n))return;if(n.length===1)return n[0];const s=Math.floor(n.length/2),o=n.sort((r,a)=>r-a);return n.length%2!==0?o[s]:(o[s-1]+o[s])/2},nl=(e,t)=>Array.from(new Set(t.map(n=>n.getValue(e))).values()),sl=(e,t)=>new Set(t.map(n=>n.getValue(e))).size,ol=(e,t)=>t.length,Tn={sum:Ji,min:Qi,max:Yi,extent:Zi,mean:el,median:tl,unique:nl,uniqueCount:sl,count:ol},rl={getDefaultColumnDef:()=>({aggregatedCell:e=>{var t,n;return(t=(n=e.getValue())==null||n.toString==null?void 0:n.toString())!=null?t:null},aggregationFn:"auto"}),getInitialState:e=>({grouping:[],...e}),getDefaultOptions:e=>({onGroupingChange:ve("grouping",e),groupedColumnMode:"reorder"}),createColumn:(e,t)=>{e.toggleGrouping=()=>{t.setGrouping(n=>n!=null&&n.includes(e.id)?n.filter(s=>s!==e.id):[...n??[],e.id])},e.getCanGroup=()=>{var n,s;return((n=e.columnDef.enableGrouping)!=null?n:!0)&&((s=t.options.enableGrouping)!=null?s:!0)&&(!!e.accessorFn||!!e.columnDef.getGroupingValue)},e.getIsGrouped=()=>{var n;return(n=t.getState().grouping)==null?void 0:n.includes(e.id)},e.getGroupedIndex=()=>{var n;return(n=t.getState().grouping)==null?void 0:n.indexOf(e.id)},e.getToggleGroupingHandler=()=>{const n=e.getCanGroup();return()=>{n&&e.toggleGrouping()}},e.getAutoAggregationFn=()=>{const n=t.getCoreRowModel().flatRows[0],s=n==null?void 0:n.getValue(e.id);if(typeof s=="number")return Tn.sum;if(Object.prototype.toString.call(s)==="[object Date]")return Tn.extent},e.getAggregationFn=()=>{var n,s;if(!e)throw new Error;return Sn(e.columnDef.aggregationFn)?e.columnDef.aggregationFn:e.columnDef.aggregationFn==="auto"?e.getAutoAggregationFn():(n=(s=t.options.aggregationFns)==null?void 0:s[e.columnDef.aggregationFn])!=null?n:Tn[e.columnDef.aggregationFn]}},createTable:e=>{e.setGrouping=t=>e.options.onGroupingChange==null?void 0:e.options.onGroupingChange(t),e.resetGrouping=t=>{var n,s;e.setGrouping(t?[]:(n=(s=e.initialState)==null?void 0:s.grouping)!=null?n:[])},e.getPreGroupedRowModel=()=>e.getFilteredRowModel(),e.getGroupedRowModel=()=>(!e._getGroupedRowModel&&e.options.getGroupedRowModel&&(e._getGroupedRowModel=e.options.getGroupedRowModel(e)),e.options.manualGrouping||!e._getGroupedRowModel?e.getPreGroupedRowModel():e._getGroupedRowModel())},createRow:(e,t)=>{e.getIsGrouped=()=>!!e.groupingColumnId,e.getGroupingValue=n=>{if(e._groupingValuesCache.hasOwnProperty(n))return e._groupingValuesCache[n];const s=t.getColumn(n);return s!=null&&s.columnDef.getGroupingValue?(e._groupingValuesCache[n]=s.columnDef.getGroupingValue(e.original),e._groupingValuesCache[n]):e.getValue(n)},e._groupingValuesCache={}},createCell:(e,t,n,s)=>{e.getIsGrouped=()=>t.getIsGrouped()&&t.id===n.groupingColumnId,e.getIsPlaceholder=()=>!e.getIsGrouped()&&t.getIsGrouped(),e.getIsAggregated=()=>{var o;return!e.getIsGrouped()&&!e.getIsPlaceholder()&&!!((o=n.subRows)!=null&&o.length)}}};function al(e,t,n){if(!(t!=null&&t.length)||!n)return e;const s=e.filter(o=>!t.includes(o.id));return n==="remove"?s:[...t.map(o=>e.find(r=>r.id===o)).filter(Boolean),...s]}const il={getInitialState:e=>({columnOrder:[],...e}),getDefaultOptions:e=>({onColumnOrderChange:ve("columnOrder",e)}),createColumn:(e,t)=>{e.getIndex=T(n=>[Ct(t,n)],n=>n.findIndex(s=>s.id===e.id),j(t.options,"debugColumns")),e.getIsFirstColumn=n=>{var s;return((s=Ct(t,n)[0])==null?void 0:s.id)===e.id},e.getIsLastColumn=n=>{var s;const o=Ct(t,n);return((s=o[o.length-1])==null?void 0:s.id)===e.id}},createTable:e=>{e.setColumnOrder=t=>e.options.onColumnOrderChange==null?void 0:e.options.onColumnOrderChange(t),e.resetColumnOrder=t=>{var n;e.setColumnOrder(t?[]:(n=e.initialState.columnOrder)!=null?n:[])},e._getOrderColumnsFn=T(()=>[e.getState().columnOrder,e.getState().grouping,e.options.groupedColumnMode],(t,n,s)=>o=>{let r=[];if(!(t!=null&&t.length))r=o;else{const a=[...t],i=[...o];for(;i.length&&a.length;){const l=a.shift(),c=i.findIndex(f=>f.id===l);c>-1&&r.push(i.splice(c,1)[0])}r=[...r,...i]}return al(r,n,s)},j(e.options,"debugTable"))}},jn=()=>({left:[],right:[]}),ll={getInitialState:e=>({columnPinning:jn(),...e}),getDefaultOptions:e=>({onColumnPinningChange:ve("columnPinning",e)}),createColumn:(e,t)=>{e.pin=n=>{const s=e.getLeafColumns().map(o=>o.id).filter(Boolean);t.setColumnPinning(o=>{var r,a;if(n==="right"){var i,l;return{left:((i=o==null?void 0:o.left)!=null?i:[]).filter(p=>!(s!=null&&s.includes(p))),right:[...((l=o==null?void 0:o.right)!=null?l:[]).filter(p=>!(s!=null&&s.includes(p))),...s]}}if(n==="left"){var c,f;return{left:[...((c=o==null?void 0:o.left)!=null?c:[]).filter(p=>!(s!=null&&s.includes(p))),...s],right:((f=o==null?void 0:o.right)!=null?f:[]).filter(p=>!(s!=null&&s.includes(p)))}}return{left:((r=o==null?void 0:o.left)!=null?r:[]).filter(p=>!(s!=null&&s.includes(p))),right:((a=o==null?void 0:o.right)!=null?a:[]).filter(p=>!(s!=null&&s.includes(p)))}})},e.getCanPin=()=>e.getLeafColumns().some(n=>{var s,o,r;return((s=n.columnDef.enablePinning)!=null?s:!0)&&((o=(r=t.options.enableColumnPinning)!=null?r:t.options.enablePinning)!=null?o:!0)}),e.getIsPinned=()=>{const n=e.getLeafColumns().map(i=>i.id),{left:s,right:o}=t.getState().columnPinning,r=n.some(i=>s==null?void 0:s.includes(i)),a=n.some(i=>o==null?void 0:o.includes(i));return r?"left":a?"right":!1},e.getPinnedIndex=()=>{var n,s;const o=e.getIsPinned();return o?(n=(s=t.getState().columnPinning)==null||(s=s[o])==null?void 0:s.indexOf(e.id))!=null?n:-1:0}},createRow:(e,t)=>{e.getCenterVisibleCells=T(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left,t.getState().columnPinning.right],(n,s,o)=>{const r=[...s??[],...o??[]];return n.filter(a=>!r.includes(a.column.id))},j(t.options,"debugRows")),e.getLeftVisibleCells=T(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left],(n,s)=>(s??[]).map(o=>n.find(r=>r.column.id===o)).filter(Boolean).map(o=>({...o,position:"left"})),j(t.options,"debugRows")),e.getRightVisibleCells=T(()=>[e._getAllVisibleCells(),t.getState().columnPinning.right],(n,s)=>(s??[]).map(o=>n.find(r=>r.column.id===o)).filter(Boolean).map(o=>({...o,position:"right"})),j(t.options,"debugRows"))},createTable:e=>{e.setColumnPinning=t=>e.options.onColumnPinningChange==null?void 0:e.options.onColumnPinningChange(t),e.resetColumnPinning=t=>{var n,s;return e.setColumnPinning(t?jn():(n=(s=e.initialState)==null?void 0:s.columnPinning)!=null?n:jn())},e.getIsSomeColumnsPinned=t=>{var n;const s=e.getState().columnPinning;if(!t){var o,r;return!!((o=s.left)!=null&&o.length||(r=s.right)!=null&&r.length)}return!!((n=s[t])!=null&&n.length)},e.getLeftLeafColumns=T(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left],(t,n)=>(n??[]).map(s=>t.find(o=>o.id===s)).filter(Boolean),j(e.options,"debugColumns")),e.getRightLeafColumns=T(()=>[e.getAllLeafColumns(),e.getState().columnPinning.right],(t,n)=>(n??[]).map(s=>t.find(o=>o.id===s)).filter(Boolean),j(e.options,"debugColumns")),e.getCenterLeafColumns=T(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,n,s)=>{const o=[...n??[],...s??[]];return t.filter(r=>!o.includes(r.id))},j(e.options,"debugColumns"))}};function ul(e){return e||(typeof document<"u"?document:null)}const Tt={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},qn=()=>({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),cl={getDefaultColumnDef:()=>Tt,getInitialState:e=>({columnSizing:{},columnSizingInfo:qn(),...e}),getDefaultOptions:e=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:ve("columnSizing",e),onColumnSizingInfoChange:ve("columnSizingInfo",e)}),createColumn:(e,t)=>{e.getSize=()=>{var n,s,o;const r=t.getState().columnSizing[e.id];return Math.min(Math.max((n=e.columnDef.minSize)!=null?n:Tt.minSize,(s=r??e.columnDef.size)!=null?s:Tt.size),(o=e.columnDef.maxSize)!=null?o:Tt.maxSize)},e.getStart=T(n=>[n,Ct(t,n),t.getState().columnSizing],(n,s)=>s.slice(0,e.getIndex(n)).reduce((o,r)=>o+r.getSize(),0),j(t.options,"debugColumns")),e.getAfter=T(n=>[n,Ct(t,n),t.getState().columnSizing],(n,s)=>s.slice(e.getIndex(n)+1).reduce((o,r)=>o+r.getSize(),0),j(t.options,"debugColumns")),e.resetSize=()=>{t.setColumnSizing(n=>{let{[e.id]:s,...o}=n;return o})},e.getCanResize=()=>{var n,s;return((n=e.columnDef.enableResizing)!=null?n:!0)&&((s=t.options.enableColumnResizing)!=null?s:!0)},e.getIsResizing=()=>t.getState().columnSizingInfo.isResizingColumn===e.id},createHeader:(e,t)=>{e.getSize=()=>{let n=0;const s=o=>{if(o.subHeaders.length)o.subHeaders.forEach(s);else{var r;n+=(r=o.column.getSize())!=null?r:0}};return s(e),n},e.getStart=()=>{if(e.index>0){const n=e.headerGroup.headers[e.index-1];return n.getStart()+n.getSize()}return 0},e.getResizeHandler=n=>{const s=t.getColumn(e.column.id),o=s==null?void 0:s.getCanResize();return r=>{if(!s||!o||(r.persist==null||r.persist(),Nn(r)&&r.touches&&r.touches.length>1))return;const a=e.getSize(),i=e?e.getLeafHeaders().map(C=>[C.column.id,C.column.getSize()]):[[s.id,s.getSize()]],l=Nn(r)?Math.round(r.touches[0].clientX):r.clientX,c={},f=(C,S)=>{typeof S=="number"&&(t.setColumnSizingInfo(R=>{var V,z;const q=t.options.columnResizeDirection==="rtl"?-1:1,K=(S-((V=R==null?void 0:R.startOffset)!=null?V:0))*q,G=Math.max(K/((z=R==null?void 0:R.startSize)!=null?z:0),-.999999);return R.columnSizingStart.forEach(he=>{let[N,oe]=he;c[N]=Math.round(Math.max(oe+oe*G,0)*100)/100}),{...R,deltaOffset:K,deltaPercentage:G}}),(t.options.columnResizeMode==="onChange"||C==="end")&&t.setColumnSizing(R=>({...R,...c})))},p=C=>f("move",C),d=C=>{f("end",C),t.setColumnSizingInfo(S=>({...S,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},u=ul(n),h={moveHandler:C=>p(C.clientX),upHandler:C=>{u==null||u.removeEventListener("mousemove",h.moveHandler),u==null||u.removeEventListener("mouseup",h.upHandler),d(C.clientX)}},m={moveHandler:C=>(C.cancelable&&(C.preventDefault(),C.stopPropagation()),p(C.touches[0].clientX),!1),upHandler:C=>{var S;u==null||u.removeEventListener("touchmove",m.moveHandler),u==null||u.removeEventListener("touchend",m.upHandler),C.cancelable&&(C.preventDefault(),C.stopPropagation()),d((S=C.touches[0])==null?void 0:S.clientX)}},y=dl()?{passive:!1}:!1;Nn(r)?(u==null||u.addEventListener("touchmove",m.moveHandler,y),u==null||u.addEventListener("touchend",m.upHandler,y)):(u==null||u.addEventListener("mousemove",h.moveHandler,y),u==null||u.addEventListener("mouseup",h.upHandler,y)),t.setColumnSizingInfo(C=>({...C,startOffset:l,startSize:a,deltaOffset:0,deltaPercentage:0,columnSizingStart:i,isResizingColumn:s.id}))}}},createTable:e=>{e.setColumnSizing=t=>e.options.onColumnSizingChange==null?void 0:e.options.onColumnSizingChange(t),e.setColumnSizingInfo=t=>e.options.onColumnSizingInfoChange==null?void 0:e.options.onColumnSizingInfoChange(t),e.resetColumnSizing=t=>{var n;e.setColumnSizing(t?{}:(n=e.initialState.columnSizing)!=null?n:{})},e.resetHeaderSizeInfo=t=>{var n;e.setColumnSizingInfo(t?qn():(n=e.initialState.columnSizingInfo)!=null?n:qn())},e.getTotalSize=()=>{var t,n;return(t=(n=e.getHeaderGroups()[0])==null?void 0:n.headers.reduce((s,o)=>s+o.getSize(),0))!=null?t:0},e.getLeftTotalSize=()=>{var t,n;return(t=(n=e.getLeftHeaderGroups()[0])==null?void 0:n.headers.reduce((s,o)=>s+o.getSize(),0))!=null?t:0},e.getCenterTotalSize=()=>{var t,n;return(t=(n=e.getCenterHeaderGroups()[0])==null?void 0:n.headers.reduce((s,o)=>s+o.getSize(),0))!=null?t:0},e.getRightTotalSize=()=>{var t,n;return(t=(n=e.getRightHeaderGroups()[0])==null?void 0:n.headers.reduce((s,o)=>s+o.getSize(),0))!=null?t:0}}};let jt=null;function dl(){if(typeof jt=="boolean")return jt;let e=!1;try{const t={get passive(){return e=!0,!1}},n=()=>{};window.addEventListener("test",n,t),window.removeEventListener("test",n)}catch{e=!1}return jt=e,jt}function Nn(e){return e.type==="touchstart"}const hl={getInitialState:e=>({columnVisibility:{},...e}),getDefaultOptions:e=>({onColumnVisibilityChange:ve("columnVisibility",e)}),createColumn:(e,t)=>{e.toggleVisibility=n=>{e.getCanHide()&&t.setColumnVisibility(s=>({...s,[e.id]:n??!e.getIsVisible()}))},e.getIsVisible=()=>{var n,s;const o=e.columns;return(n=o.length?o.some(r=>r.getIsVisible()):(s=t.getState().columnVisibility)==null?void 0:s[e.id])!=null?n:!0},e.getCanHide=()=>{var n,s;return((n=e.columnDef.enableHiding)!=null?n:!0)&&((s=t.options.enableHiding)!=null?s:!0)},e.getToggleVisibilityHandler=()=>n=>{e.toggleVisibility==null||e.toggleVisibility(n.target.checked)}},createRow:(e,t)=>{e._getAllVisibleCells=T(()=>[e.getAllCells(),t.getState().columnVisibility],n=>n.filter(s=>s.column.getIsVisible()),j(t.options,"debugRows")),e.getVisibleCells=T(()=>[e.getLeftVisibleCells(),e.getCenterVisibleCells(),e.getRightVisibleCells()],(n,s,o)=>[...n,...s,...o],j(t.options,"debugRows"))},createTable:e=>{const t=(n,s)=>T(()=>[s(),s().filter(o=>o.getIsVisible()).map(o=>o.id).join("_")],o=>o.filter(r=>r.getIsVisible==null?void 0:r.getIsVisible()),j(e.options,"debugColumns"));e.getVisibleFlatColumns=t("getVisibleFlatColumns",()=>e.getAllFlatColumns()),e.getVisibleLeafColumns=t("getVisibleLeafColumns",()=>e.getAllLeafColumns()),e.getLeftVisibleLeafColumns=t("getLeftVisibleLeafColumns",()=>e.getLeftLeafColumns()),e.getRightVisibleLeafColumns=t("getRightVisibleLeafColumns",()=>e.getRightLeafColumns()),e.getCenterVisibleLeafColumns=t("getCenterVisibleLeafColumns",()=>e.getCenterLeafColumns()),e.setColumnVisibility=n=>e.options.onColumnVisibilityChange==null?void 0:e.options.onColumnVisibilityChange(n),e.resetColumnVisibility=n=>{var s;e.setColumnVisibility(n?{}:(s=e.initialState.columnVisibility)!=null?s:{})},e.toggleAllColumnsVisible=n=>{var s;n=(s=n)!=null?s:!e.getIsAllColumnsVisible(),e.setColumnVisibility(e.getAllLeafColumns().reduce((o,r)=>({...o,[r.id]:n||!(r.getCanHide!=null&&r.getCanHide())}),{}))},e.getIsAllColumnsVisible=()=>!e.getAllLeafColumns().some(n=>!(n.getIsVisible!=null&&n.getIsVisible())),e.getIsSomeColumnsVisible=()=>e.getAllLeafColumns().some(n=>n.getIsVisible==null?void 0:n.getIsVisible()),e.getToggleAllColumnsVisibilityHandler=()=>n=>{var s;e.toggleAllColumnsVisible((s=n.target)==null?void 0:s.checked)}}};function Ct(e,t){return t?t==="center"?e.getCenterVisibleLeafColumns():t==="left"?e.getLeftVisibleLeafColumns():e.getRightVisibleLeafColumns():e.getVisibleLeafColumns()}const pl={createTable:e=>{e._getGlobalFacetedRowModel=e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,"__global__"),e.getGlobalFacetedRowModel=()=>e.options.manualFiltering||!e._getGlobalFacetedRowModel?e.getPreFilteredRowModel():e._getGlobalFacetedRowModel(),e._getGlobalFacetedUniqueValues=e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,"__global__"),e.getGlobalFacetedUniqueValues=()=>e._getGlobalFacetedUniqueValues?e._getGlobalFacetedUniqueValues():new Map,e._getGlobalFacetedMinMaxValues=e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,"__global__"),e.getGlobalFacetedMinMaxValues=()=>{if(e._getGlobalFacetedMinMaxValues)return e._getGlobalFacetedMinMaxValues()}}},fl={getInitialState:e=>({globalFilter:void 0,...e}),getDefaultOptions:e=>({onGlobalFilterChange:ve("globalFilter",e),globalFilterFn:"auto",getColumnCanGlobalFilter:t=>{var n;const s=(n=e.getCoreRowModel().flatRows[0])==null||(n=n._getAllCellsByColumnId()[t.id])==null?void 0:n.getValue();return typeof s=="string"||typeof s=="number"}}),createColumn:(e,t)=>{e.getCanGlobalFilter=()=>{var n,s,o,r;return((n=e.columnDef.enableGlobalFilter)!=null?n:!0)&&((s=t.options.enableGlobalFilter)!=null?s:!0)&&((o=t.options.enableFilters)!=null?o:!0)&&((r=t.options.getColumnCanGlobalFilter==null?void 0:t.options.getColumnCanGlobalFilter(e))!=null?r:!0)&&!!e.accessorFn}},createTable:e=>{e.getGlobalAutoFilterFn=()=>je.includesString,e.getGlobalFilterFn=()=>{var t,n;const{globalFilterFn:s}=e.options;return Sn(s)?s:s==="auto"?e.getGlobalAutoFilterFn():(t=(n=e.options.filterFns)==null?void 0:n[s])!=null?t:je[s]},e.setGlobalFilter=t=>{e.options.onGlobalFilterChange==null||e.options.onGlobalFilterChange(t)},e.resetGlobalFilter=t=>{e.setGlobalFilter(t?void 0:e.initialState.globalFilter)}}},gl={getInitialState:e=>({expanded:{},...e}),getDefaultOptions:e=>({onExpandedChange:ve("expanded",e),paginateExpandedRows:!0}),createTable:e=>{let t=!1,n=!1;e._autoResetExpanded=()=>{var s,o;if(!t){e._queue(()=>{t=!0});return}if((s=(o=e.options.autoResetAll)!=null?o:e.options.autoResetExpanded)!=null?s:!e.options.manualExpanding){if(n)return;n=!0,e._queue(()=>{e.resetExpanded(),n=!1})}},e.setExpanded=s=>e.options.onExpandedChange==null?void 0:e.options.onExpandedChange(s),e.toggleAllRowsExpanded=s=>{s??!e.getIsAllRowsExpanded()?e.setExpanded(!0):e.setExpanded({})},e.resetExpanded=s=>{var o,r;e.setExpanded(s?{}:(o=(r=e.initialState)==null?void 0:r.expanded)!=null?o:{})},e.getCanSomeRowsExpand=()=>e.getPrePaginationRowModel().flatRows.some(s=>s.getCanExpand()),e.getToggleAllRowsExpandedHandler=()=>s=>{s.persist==null||s.persist(),e.toggleAllRowsExpanded()},e.getIsSomeRowsExpanded=()=>{const s=e.getState().expanded;return s===!0||Object.values(s).some(Boolean)},e.getIsAllRowsExpanded=()=>{const s=e.getState().expanded;return typeof s=="boolean"?s===!0:!(!Object.keys(s).length||e.getRowModel().flatRows.some(o=>!o.getIsExpanded()))},e.getExpandedDepth=()=>{let s=0;return(e.getState().expanded===!0?Object.keys(e.getRowModel().rowsById):Object.keys(e.getState().expanded)).forEach(o=>{const r=o.split(".");s=Math.max(s,r.length)}),s},e.getPreExpandedRowModel=()=>e.getSortedRowModel(),e.getExpandedRowModel=()=>(!e._getExpandedRowModel&&e.options.getExpandedRowModel&&(e._getExpandedRowModel=e.options.getExpandedRowModel(e)),e.options.manualExpanding||!e._getExpandedRowModel?e.getPreExpandedRowModel():e._getExpandedRowModel())},createRow:(e,t)=>{e.toggleExpanded=n=>{t.setExpanded(s=>{var o;const r=s===!0?!0:!!(s!=null&&s[e.id]);let a={};if(s===!0?Object.keys(t.getRowModel().rowsById).forEach(i=>{a[i]=!0}):a=s,n=(o=n)!=null?o:!r,!r&&n)return{...a,[e.id]:!0};if(r&&!n){const{[e.id]:i,...l}=a;return l}return s})},e.getIsExpanded=()=>{var n;const s=t.getState().expanded;return!!((n=t.options.getIsRowExpanded==null?void 0:t.options.getIsRowExpanded(e))!=null?n:s===!0||s!=null&&s[e.id])},e.getCanExpand=()=>{var n,s,o;return(n=t.options.getRowCanExpand==null?void 0:t.options.getRowCanExpand(e))!=null?n:((s=t.options.enableExpanding)!=null?s:!0)&&!!((o=e.subRows)!=null&&o.length)},e.getIsAllParentsExpanded=()=>{let n=!0,s=e;for(;n&&s.parentId;)s=t.getRow(s.parentId,!0),n=s.getIsExpanded();return n},e.getToggleExpandedHandler=()=>{const n=e.getCanExpand();return()=>{n&&e.toggleExpanded()}}}},ss=0,os=10,Bn=()=>({pageIndex:ss,pageSize:os}),ml={getInitialState:e=>({...e,pagination:{...Bn(),...e==null?void 0:e.pagination}}),getDefaultOptions:e=>({onPaginationChange:ve("pagination",e)}),createTable:e=>{let t=!1,n=!1;e._autoResetPageIndex=()=>{var s,o;if(!t){e._queue(()=>{t=!0});return}if((s=(o=e.options.autoResetAll)!=null?o:e.options.autoResetPageIndex)!=null?s:!e.options.manualPagination){if(n)return;n=!0,e._queue(()=>{e.resetPageIndex(),n=!1})}},e.setPagination=s=>{const o=r=>qe(s,r);return e.options.onPaginationChange==null?void 0:e.options.onPaginationChange(o)},e.resetPagination=s=>{var o;e.setPagination(s?Bn():(o=e.initialState.pagination)!=null?o:Bn())},e.setPageIndex=s=>{e.setPagination(o=>{let r=qe(s,o.pageIndex);const a=typeof e.options.pageCount>"u"||e.options.pageCount===-1?Number.MAX_SAFE_INTEGER:e.options.pageCount-1;return r=Math.max(0,Math.min(r,a)),{...o,pageIndex:r}})},e.resetPageIndex=s=>{var o,r;e.setPageIndex(s?ss:(o=(r=e.initialState)==null||(r=r.pagination)==null?void 0:r.pageIndex)!=null?o:ss)},e.resetPageSize=s=>{var o,r;e.setPageSize(s?os:(o=(r=e.initialState)==null||(r=r.pagination)==null?void 0:r.pageSize)!=null?o:os)},e.setPageSize=s=>{e.setPagination(o=>{const r=Math.max(1,qe(s,o.pageSize)),a=o.pageSize*o.pageIndex,i=Math.floor(a/r);return{...o,pageIndex:i,pageSize:r}})},e.setPageCount=s=>e.setPagination(o=>{var r;let a=qe(s,(r=e.options.pageCount)!=null?r:-1);return typeof a=="number"&&(a=Math.max(-1,a)),{...o,pageCount:a}}),e.getPageOptions=T(()=>[e.getPageCount()],s=>{let o=[];return s&&s>0&&(o=[...new Array(s)].fill(null).map((r,a)=>a)),o},j(e.options,"debugTable")),e.getCanPreviousPage=()=>e.getState().pagination.pageIndex>0,e.getCanNextPage=()=>{const{pageIndex:s}=e.getState().pagination,o=e.getPageCount();return o===-1?!0:o===0?!1:s<o-1},e.previousPage=()=>e.setPageIndex(s=>s-1),e.nextPage=()=>e.setPageIndex(s=>s+1),e.firstPage=()=>e.setPageIndex(0),e.lastPage=()=>e.setPageIndex(e.getPageCount()-1),e.getPrePaginationRowModel=()=>e.getExpandedRowModel(),e.getPaginationRowModel=()=>(!e._getPaginationRowModel&&e.options.getPaginationRowModel&&(e._getPaginationRowModel=e.options.getPaginationRowModel(e)),e.options.manualPagination||!e._getPaginationRowModel?e.getPrePaginationRowModel():e._getPaginationRowModel()),e.getPageCount=()=>{var s;return(s=e.options.pageCount)!=null?s:Math.ceil(e.getRowCount()/e.getState().pagination.pageSize)},e.getRowCount=()=>{var s;return(s=e.options.rowCount)!=null?s:e.getPrePaginationRowModel().rows.length}}},Hn=()=>({top:[],bottom:[]}),yl={getInitialState:e=>({rowPinning:Hn(),...e}),getDefaultOptions:e=>({onRowPinningChange:ve("rowPinning",e)}),createRow:(e,t)=>{e.pin=(n,s,o)=>{const r=s?e.getLeafRows().map(l=>{let{id:c}=l;return c}):[],a=o?e.getParentRows().map(l=>{let{id:c}=l;return c}):[],i=new Set([...a,e.id,...r]);t.setRowPinning(l=>{var c,f;if(n==="bottom"){var p,d;return{top:((p=l==null?void 0:l.top)!=null?p:[]).filter(m=>!(i!=null&&i.has(m))),bottom:[...((d=l==null?void 0:l.bottom)!=null?d:[]).filter(m=>!(i!=null&&i.has(m))),...Array.from(i)]}}if(n==="top"){var u,h;return{top:[...((u=l==null?void 0:l.top)!=null?u:[]).filter(m=>!(i!=null&&i.has(m))),...Array.from(i)],bottom:((h=l==null?void 0:l.bottom)!=null?h:[]).filter(m=>!(i!=null&&i.has(m)))}}return{top:((c=l==null?void 0:l.top)!=null?c:[]).filter(m=>!(i!=null&&i.has(m))),bottom:((f=l==null?void 0:l.bottom)!=null?f:[]).filter(m=>!(i!=null&&i.has(m)))}})},e.getCanPin=()=>{var n;const{enableRowPinning:s,enablePinning:o}=t.options;return typeof s=="function"?s(e):(n=s??o)!=null?n:!0},e.getIsPinned=()=>{const n=[e.id],{top:s,bottom:o}=t.getState().rowPinning,r=n.some(i=>s==null?void 0:s.includes(i)),a=n.some(i=>o==null?void 0:o.includes(i));return r?"top":a?"bottom":!1},e.getPinnedIndex=()=>{var n,s;const o=e.getIsPinned();if(!o)return-1;const r=(n=o==="top"?t.getTopRows():t.getBottomRows())==null?void 0:n.map(a=>{let{id:i}=a;return i});return(s=r==null?void 0:r.indexOf(e.id))!=null?s:-1}},createTable:e=>{e.setRowPinning=t=>e.options.onRowPinningChange==null?void 0:e.options.onRowPinningChange(t),e.resetRowPinning=t=>{var n,s;return e.setRowPinning(t?Hn():(n=(s=e.initialState)==null?void 0:s.rowPinning)!=null?n:Hn())},e.getIsSomeRowsPinned=t=>{var n;const s=e.getState().rowPinning;if(!t){var o,r;return!!((o=s.top)!=null&&o.length||(r=s.bottom)!=null&&r.length)}return!!((n=s[t])!=null&&n.length)},e._getPinnedRows=(t,n,s)=>{var o;return((o=e.options.keepPinnedRows)==null||o?(n??[]).map(r=>{const a=e.getRow(r,!0);return a.getIsAllParentsExpanded()?a:null}):(n??[]).map(r=>t.find(a=>a.id===r))).filter(Boolean).map(r=>({...r,position:s}))},e.getTopRows=T(()=>[e.getRowModel().rows,e.getState().rowPinning.top],(t,n)=>e._getPinnedRows(t,n,"top"),j(e.options,"debugRows")),e.getBottomRows=T(()=>[e.getRowModel().rows,e.getState().rowPinning.bottom],(t,n)=>e._getPinnedRows(t,n,"bottom"),j(e.options,"debugRows")),e.getCenterRows=T(()=>[e.getRowModel().rows,e.getState().rowPinning.top,e.getState().rowPinning.bottom],(t,n,s)=>{const o=new Set([...n??[],...s??[]]);return t.filter(r=>!o.has(r.id))},j(e.options,"debugRows"))}},bl={getInitialState:e=>({rowSelection:{},...e}),getDefaultOptions:e=>({onRowSelectionChange:ve("rowSelection",e),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:e=>{e.setRowSelection=t=>e.options.onRowSelectionChange==null?void 0:e.options.onRowSelectionChange(t),e.resetRowSelection=t=>{var n;return e.setRowSelection(t?{}:(n=e.initialState.rowSelection)!=null?n:{})},e.toggleAllRowsSelected=t=>{e.setRowSelection(n=>{t=typeof t<"u"?t:!e.getIsAllRowsSelected();const s={...n},o=e.getPreGroupedRowModel().flatRows;return t?o.forEach(r=>{r.getCanSelect()&&(s[r.id]=!0)}):o.forEach(r=>{delete s[r.id]}),s})},e.toggleAllPageRowsSelected=t=>e.setRowSelection(n=>{const s=typeof t<"u"?t:!e.getIsAllPageRowsSelected(),o={...n};return e.getRowModel().rows.forEach(r=>{rs(o,r.id,s,!0,e)}),o}),e.getPreSelectedRowModel=()=>e.getCoreRowModel(),e.getSelectedRowModel=T(()=>[e.getState().rowSelection,e.getCoreRowModel()],(t,n)=>Object.keys(t).length?zn(e,n):{rows:[],flatRows:[],rowsById:{}},j(e.options,"debugTable")),e.getFilteredSelectedRowModel=T(()=>[e.getState().rowSelection,e.getFilteredRowModel()],(t,n)=>Object.keys(t).length?zn(e,n):{rows:[],flatRows:[],rowsById:{}},j(e.options,"debugTable")),e.getGroupedSelectedRowModel=T(()=>[e.getState().rowSelection,e.getSortedRowModel()],(t,n)=>Object.keys(t).length?zn(e,n):{rows:[],flatRows:[],rowsById:{}},j(e.options,"debugTable")),e.getIsAllRowsSelected=()=>{const t=e.getFilteredRowModel().flatRows,{rowSelection:n}=e.getState();let s=!!(t.length&&Object.keys(n).length);return s&&t.some(o=>o.getCanSelect()&&!n[o.id])&&(s=!1),s},e.getIsAllPageRowsSelected=()=>{const t=e.getPaginationRowModel().flatRows.filter(o=>o.getCanSelect()),{rowSelection:n}=e.getState();let s=!!t.length;return s&&t.some(o=>!n[o.id])&&(s=!1),s},e.getIsSomeRowsSelected=()=>{var t;const n=Object.keys((t=e.getState().rowSelection)!=null?t:{}).length;return n>0&&n<e.getFilteredRowModel().flatRows.length},e.getIsSomePageRowsSelected=()=>{const t=e.getPaginationRowModel().flatRows;return e.getIsAllPageRowsSelected()?!1:t.filter(n=>n.getCanSelect()).some(n=>n.getIsSelected()||n.getIsSomeSelected())},e.getToggleAllRowsSelectedHandler=()=>t=>{e.toggleAllRowsSelected(t.target.checked)},e.getToggleAllPageRowsSelectedHandler=()=>t=>{e.toggleAllPageRowsSelected(t.target.checked)}},createRow:(e,t)=>{e.toggleSelected=(n,s)=>{const o=e.getIsSelected();t.setRowSelection(r=>{var a;if(n=typeof n<"u"?n:!o,e.getCanSelect()&&o===n)return r;const i={...r};return rs(i,e.id,n,(a=s==null?void 0:s.selectChildren)!=null?a:!0,t),i})},e.getIsSelected=()=>{const{rowSelection:n}=t.getState();return xs(e,n)},e.getIsSomeSelected=()=>{const{rowSelection:n}=t.getState();return as(e,n)==="some"},e.getIsAllSubRowsSelected=()=>{const{rowSelection:n}=t.getState();return as(e,n)==="all"},e.getCanSelect=()=>{var n;return typeof t.options.enableRowSelection=="function"?t.options.enableRowSelection(e):(n=t.options.enableRowSelection)!=null?n:!0},e.getCanSelectSubRows=()=>{var n;return typeof t.options.enableSubRowSelection=="function"?t.options.enableSubRowSelection(e):(n=t.options.enableSubRowSelection)!=null?n:!0},e.getCanMultiSelect=()=>{var n;return typeof t.options.enableMultiRowSelection=="function"?t.options.enableMultiRowSelection(e):(n=t.options.enableMultiRowSelection)!=null?n:!0},e.getToggleSelectedHandler=()=>{const n=e.getCanSelect();return s=>{var o;n&&e.toggleSelected((o=s.target)==null?void 0:o.checked)}}}},rs=(e,t,n,s,o)=>{var r;const a=o.getRow(t,!0);n?(a.getCanMultiSelect()||Object.keys(e).forEach(i=>delete e[i]),a.getCanSelect()&&(e[t]=!0)):delete e[t],s&&(r=a.subRows)!=null&&r.length&&a.getCanSelectSubRows()&&a.subRows.forEach(i=>rs(e,i.id,n,s,o))};function zn(e,t){const n=e.getState().rowSelection,s=[],o={},r=function(a,i){return a.map(l=>{var c;const f=xs(l,n);if(f&&(s.push(l),o[l.id]=l),(c=l.subRows)!=null&&c.length&&(l={...l,subRows:r(l.subRows)}),f)return l}).filter(Boolean)};return{rows:r(t.rows),flatRows:s,rowsById:o}}function xs(e,t){var n;return(n=t[e.id])!=null?n:!1}function as(e,t,n){var s;if(!((s=e.subRows)!=null&&s.length))return!1;let o=!0,r=!1;return e.subRows.forEach(a=>{if(!(r&&!o)&&(a.getCanSelect()&&(xs(a,t)?r=!0:o=!1),a.subRows&&a.subRows.length)){const i=as(a,t);i==="all"?r=!0:(i==="some"&&(r=!0),o=!1)}}),o?"all":r?"some":!1}const is=/([0-9]+)/gm,wl=(e,t,n)=>Zo(Ne(e.getValue(n)).toLowerCase(),Ne(t.getValue(n)).toLowerCase()),vl=(e,t,n)=>Zo(Ne(e.getValue(n)),Ne(t.getValue(n))),_l=(e,t,n)=>Cs(Ne(e.getValue(n)).toLowerCase(),Ne(t.getValue(n)).toLowerCase()),Sl=(e,t,n)=>Cs(Ne(e.getValue(n)),Ne(t.getValue(n))),xl=(e,t,n)=>{const s=e.getValue(n),o=t.getValue(n);return s>o?1:s<o?-1:0},Cl=(e,t,n)=>Cs(e.getValue(n),t.getValue(n));function Cs(e,t){return e===t?0:e>t?1:-1}function Ne(e){return typeof e=="number"?isNaN(e)||e===1/0||e===-1/0?"":String(e):typeof e=="string"?e:""}function Zo(e,t){const n=e.split(is).filter(Boolean),s=t.split(is).filter(Boolean);for(;n.length&&s.length;){const o=n.shift(),r=s.shift(),a=parseInt(o,10),i=parseInt(r,10),l=[a,i].sort();if(isNaN(l[0])){if(o>r)return 1;if(r>o)return-1;continue}if(isNaN(l[1]))return isNaN(a)?-1:1;if(a>i)return 1;if(i>a)return-1}return n.length-s.length}const ct={alphanumeric:wl,alphanumericCaseSensitive:vl,text:_l,textCaseSensitive:Sl,datetime:xl,basic:Cl},Rl={getInitialState:e=>({sorting:[],...e}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:e=>({onSortingChange:ve("sorting",e),isMultiSortEvent:t=>t.shiftKey}),createColumn:(e,t)=>{e.getAutoSortingFn=()=>{const n=t.getFilteredRowModel().flatRows.slice(10);let s=!1;for(const o of n){const r=o==null?void 0:o.getValue(e.id);if(Object.prototype.toString.call(r)==="[object Date]")return ct.datetime;if(typeof r=="string"&&(s=!0,r.split(is).length>1))return ct.alphanumeric}return s?ct.text:ct.basic},e.getAutoSortDir=()=>{const n=t.getFilteredRowModel().flatRows[0];return typeof(n==null?void 0:n.getValue(e.id))=="string"?"asc":"desc"},e.getSortingFn=()=>{var n,s;if(!e)throw new Error;return Sn(e.columnDef.sortingFn)?e.columnDef.sortingFn:e.columnDef.sortingFn==="auto"?e.getAutoSortingFn():(n=(s=t.options.sortingFns)==null?void 0:s[e.columnDef.sortingFn])!=null?n:ct[e.columnDef.sortingFn]},e.toggleSorting=(n,s)=>{const o=e.getNextSortingOrder(),r=typeof n<"u"&&n!==null;t.setSorting(a=>{const i=a==null?void 0:a.find(u=>u.id===e.id),l=a==null?void 0:a.findIndex(u=>u.id===e.id);let c=[],f,p=r?n:o==="desc";if(a!=null&&a.length&&e.getCanMultiSort()&&s?i?f="toggle":f="add":a!=null&&a.length&&l!==a.length-1?f="replace":i?f="toggle":f="replace",f==="toggle"&&(r||o||(f="remove")),f==="add"){var d;c=[...a,{id:e.id,desc:p}],c.splice(0,c.length-((d=t.options.maxMultiSortColCount)!=null?d:Number.MAX_SAFE_INTEGER))}else f==="toggle"?c=a.map(u=>u.id===e.id?{...u,desc:p}:u):f==="remove"?c=a.filter(u=>u.id!==e.id):c=[{id:e.id,desc:p}];return c})},e.getFirstSortDir=()=>{var n,s;return((n=(s=e.columnDef.sortDescFirst)!=null?s:t.options.sortDescFirst)!=null?n:e.getAutoSortDir()==="desc")?"desc":"asc"},e.getNextSortingOrder=n=>{var s,o;const r=e.getFirstSortDir(),a=e.getIsSorted();return a?a!==r&&((s=t.options.enableSortingRemoval)==null||s)&&(!(n&&(o=t.options.enableMultiRemove)!=null)||o)?!1:a==="desc"?"asc":"desc":r},e.getCanSort=()=>{var n,s;return((n=e.columnDef.enableSorting)!=null?n:!0)&&((s=t.options.enableSorting)!=null?s:!0)&&!!e.accessorFn},e.getCanMultiSort=()=>{var n,s;return(n=(s=e.columnDef.enableMultiSort)!=null?s:t.options.enableMultiSort)!=null?n:!!e.accessorFn},e.getIsSorted=()=>{var n;const s=(n=t.getState().sorting)==null?void 0:n.find(o=>o.id===e.id);return s?s.desc?"desc":"asc":!1},e.getSortIndex=()=>{var n,s;return(n=(s=t.getState().sorting)==null?void 0:s.findIndex(o=>o.id===e.id))!=null?n:-1},e.clearSorting=()=>{t.setSorting(n=>n!=null&&n.length?n.filter(s=>s.id!==e.id):[])},e.getToggleSortingHandler=()=>{const n=e.getCanSort();return s=>{n&&(s.persist==null||s.persist(),e.toggleSorting==null||e.toggleSorting(void 0,e.getCanMultiSort()?t.options.isMultiSortEvent==null?void 0:t.options.isMultiSortEvent(s):!1))}}},createTable:e=>{e.setSorting=t=>e.options.onSortingChange==null?void 0:e.options.onSortingChange(t),e.resetSorting=t=>{var n,s;e.setSorting(t?[]:(n=(s=e.initialState)==null?void 0:s.sorting)!=null?n:[])},e.getPreSortedRowModel=()=>e.getGroupedRowModel(),e.getSortedRowModel=()=>(!e._getSortedRowModel&&e.options.getSortedRowModel&&(e._getSortedRowModel=e.options.getSortedRowModel(e)),e.options.manualSorting||!e._getSortedRowModel?e.getPreSortedRowModel():e._getSortedRowModel())}},Il=[Gi,hl,il,ll,Ki,Xi,pl,fl,Rl,rl,gl,ml,yl,bl,cl];function kl(e){var t,n;const s=[...Il,...(t=e._features)!=null?t:[]];let o={_features:s};const r=o._features.reduce((p,d)=>Object.assign(p,d.getDefaultOptions==null?void 0:d.getDefaultOptions(o)),{}),a=p=>o.options.mergeOptions?o.options.mergeOptions(r,p):{...r,...p};let i={...(n=e.initialState)!=null?n:{}};o._features.forEach(p=>{var d;i=(d=p.getInitialState==null?void 0:p.getInitialState(i))!=null?d:i});const l=[];let c=!1;const f={_features:s,options:{...r,...e},initialState:i,_queue:p=>{l.push(p),c||(c=!0,Promise.resolve().then(()=>{for(;l.length;)l.shift()();c=!1}).catch(d=>setTimeout(()=>{throw d})))},reset:()=>{o.setState(o.initialState)},setOptions:p=>{const d=qe(p,o.options);o.options=a(d)},getState:()=>o.options.state,setState:p=>{o.options.onStateChange==null||o.options.onStateChange(p)},_getRowId:(p,d,u)=>{var h;return(h=o.options.getRowId==null?void 0:o.options.getRowId(p,d,u))!=null?h:`${u?[u.id,d].join("."):d}`},getCoreRowModel:()=>(o._getCoreRowModel||(o._getCoreRowModel=o.options.getCoreRowModel(o)),o._getCoreRowModel()),getRowModel:()=>o.getPaginationRowModel(),getRow:(p,d)=>{let u=(d?o.getPrePaginationRowModel():o.getRowModel()).rowsById[p];if(!u&&(u=o.getCoreRowModel().rowsById[p],!u))throw new Error;return u},_getDefaultColumnDef:T(()=>[o.options.defaultColumn],p=>{var d;return p=(d=p)!=null?d:{},{header:u=>{const h=u.header.column.columnDef;return h.accessorKey?h.accessorKey:h.accessorFn?h.id:null},cell:u=>{var h,m;return(h=(m=u.renderValue())==null||m.toString==null?void 0:m.toString())!=null?h:null},...o._features.reduce((u,h)=>Object.assign(u,h.getDefaultColumnDef==null?void 0:h.getDefaultColumnDef()),{}),...p}},j(e,"debugColumns")),_getColumnDefs:()=>o.options.columns,getAllColumns:T(()=>[o._getColumnDefs()],p=>{const d=function(u,h,m){return m===void 0&&(m=0),u.map(y=>{const C=Ui(o,y,m,h),S=y;return C.columns=S.columns?d(S.columns,C,m+1):[],C})};return d(p)},j(e,"debugColumns")),getAllFlatColumns:T(()=>[o.getAllColumns()],p=>p.flatMap(d=>d.getFlatColumns()),j(e,"debugColumns")),_getAllFlatColumnsById:T(()=>[o.getAllFlatColumns()],p=>p.reduce((d,u)=>(d[u.id]=u,d),{}),j(e,"debugColumns")),getAllLeafColumns:T(()=>[o.getAllColumns(),o._getOrderColumnsFn()],(p,d)=>{let u=p.flatMap(h=>h.getLeafColumns());return d(u)},j(e,"debugColumns")),getColumn:p=>o._getAllFlatColumnsById()[p]};Object.assign(o,f);for(let p=0;p<o._features.length;p++){const d=o._features[p];d==null||d.createTable==null||d.createTable(o)}return o}function Al(){return e=>T(()=>[e.options.data],t=>{const n={rows:[],flatRows:[],rowsById:{}},s=function(o,r,a){r===void 0&&(r=0);const i=[];for(let c=0;c<o.length;c++){const f=Wi(e,e._getRowId(o[c],c,a),o[c],c,r,void 0,a==null?void 0:a.id);if(n.flatRows.push(f),n.rowsById[f.id]=f,i.push(f),e.options.getSubRows){var l;f.originalSubRows=e.options.getSubRows(o[c],c),(l=f.originalSubRows)!=null&&l.length&&(f.subRows=s(f.originalSubRows,r+1,f))}}return i};return n.rows=s(t),n},j(e.options,"debugTable","getRowModel",()=>e._autoResetPageIndex()))}function qt(){return!0}const Ml=Symbol("merge-proxy"),Pl={get(e,t,n){return t===Ml?n:e.get(t)},has(e,t){return e.has(t)},set:qt,deleteProperty:qt,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:qt,deleteProperty:qt}},ownKeys(e){return e.keys()}};function Un(e){return"value"in e?e.value:e}function pt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Proxy({get(s){for(let o=t.length-1;o>=0;o--){const r=Un(t[o])[s];if(r!==void 0)return r}},has(s){for(let o=t.length-1;o>=0;o--)if(s in Un(t[o]))return!0;return!1},keys(){const s=[];for(let o=0;o<t.length;o++)s.push(...Object.keys(Un(t[o])));return[...Array.from(new Set(s))]}},Pl)}const Gn=Be({props:["render","props"],setup:e=>()=>typeof e.render=="function"||typeof e.render=="object"?me(e.render,e.props):e.render});function lo(e){return pt(e,{data:A(e.data)})}function Ol(e){const t=Ba(e.data),n=pt({state:{},onStateChange:()=>{},renderFallbackValue:null,mergeOptions(r,a){return t?{...r,...a}:pt(r,a)}},t?lo(e):e),s=kl(n);if(t){const r=Ha(e.data);ht(r,()=>{s.setState(a=>({...a,data:r.value}))},{immediate:!0})}const o=xt(s.initialState);return za(()=>{s.setOptions(r=>{var a;const i=new Proxy({},{get:(l,c)=>o.value[c]});return pt(r,t?lo(e):e,{state:pt(i,(a=e.state)!=null?a:{}),onStateChange:l=>{l instanceof Function?o.value=l(o.value):o.value=l,e.onStateChange==null||e.onStateChange(l)}})})}),s}function D(e,t,n,s,o){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,n),n}function g(e,t,n,s){if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?s:n==="a"?s.call(e):s?s.value:t.get(e)}let er=function(){const{crypto:e}=globalThis;if(e!=null&&e.randomUUID)return er=e.randomUUID.bind(e),e.randomUUID();const t=new Uint8Array(1),n=e?()=>e.getRandomValues(t)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,s=>(+s^n()&15>>+s/4).toString(16))};function ls(e){return typeof e=="object"&&e!==null&&("name"in e&&e.name==="AbortError"||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}const us=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null){try{if(Object.prototype.toString.call(e)==="[object Error]"){const t=new Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch{}try{return new Error(JSON.stringify(e))}catch{}}return new Error(e)};class $ extends Error{}class ce extends ${constructor(t,n,s,o){super(`${ce.makeMessage(t,n,s)}`),this.status=t,this.headers=o,this.requestID=o==null?void 0:o.get("x-request-id"),this.error=n;const r=n;this.code=r==null?void 0:r.code,this.param=r==null?void 0:r.param,this.type=r==null?void 0:r.type}static makeMessage(t,n,s){const o=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):s;return t&&o?`${t} ${o}`:t?`${t} status code (no body)`:o||"(no status code or body)"}static generate(t,n,s,o){if(!t||!o)return new xn({message:s,cause:us(n)});const r=n==null?void 0:n.error;return t===400?new tr(t,r,s,o):t===401?new nr(t,r,s,o):t===403?new sr(t,r,s,o):t===404?new or(t,r,s,o):t===409?new rr(t,r,s,o):t===422?new ar(t,r,s,o):t===429?new ir(t,r,s,o):t>=500?new lr(t,r,s,o):new ce(t,r,s,o)}}class _e extends ce{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class xn extends ce{constructor({message:t,cause:n}){super(void 0,void 0,t||"Connection error.",void 0),n&&(this.cause=n)}}class Rs extends xn{constructor({message:t}={}){super({message:t??"Request timed out."})}}class tr extends ce{}class nr extends ce{}class sr extends ce{}class or extends ce{}class rr extends ce{}class ar extends ce{}class ir extends ce{}class lr extends ce{}class ur extends ${constructor(){super("Could not parse response content as the length limit was reached")}}class cr extends ${constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class ft extends Error{constructor(t){super(t)}}const $l=/^[a-z][a-z0-9+.-]*:/i,Fl=e=>$l.test(e);let fe=e=>(fe=Array.isArray,fe(e)),uo=fe;function dr(e){return typeof e!="object"?{}:e??{}}function El(e){if(!e)return!0;for(const t in e)return!1;return!0}function Vl(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Wn(e){return e!=null&&typeof e=="object"&&!Array.isArray(e)}const Dl=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new $(`${e} must be an integer`);if(t<0)throw new $(`${e} must be a positive integer`);return t},Ll=e=>{try{return JSON.parse(e)}catch{return}},$t=e=>new Promise(t=>setTimeout(t,e)),tt="6.9.1",Tl=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function jl(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const ql=()=>{var n;const e=jl();if(e==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":tt,"X-Stainless-OS":ho(Deno.build.os),"X-Stainless-Arch":co(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((n=Deno.version)==null?void 0:n.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":tt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(e==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":tt,"X-Stainless-OS":ho(globalThis.process.platform??"unknown"),"X-Stainless-Arch":co(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const t=Nl();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":tt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":tt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Nl(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const s=n.exec(navigator.userAgent);if(s){const o=s[1]||0,r=s[2]||0,a=s[3]||0;return{browser:t,version:`${o}.${r}.${a}`}}}return null}const co=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",ho=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let po;const Bl=()=>po??(po=ql());function Hl(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function hr(...e){const t=globalThis.ReadableStream;if(typeof t>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e)}function pr(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return hr({start(){},async pull(n){const{done:s,value:o}=await t.next();s?n.close():n.enqueue(o)},async cancel(){var n;await((n=t.return)==null?void 0:n.call(t))}})}function fr(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const n=await t.read();return n!=null&&n.done&&t.releaseLock(),n}catch(n){throw t.releaseLock(),n}},async return(){const n=t.cancel();return t.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function zl(e){var s,o;if(e===null||typeof e!="object")return;if(e[Symbol.asyncIterator]){await((o=(s=e[Symbol.asyncIterator]()).return)==null?void 0:o.call(s));return}const t=e.getReader(),n=t.cancel();t.releaseLock(),await n}const Ul=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)}),gr="RFC3986",mr=e=>String(e),fo={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:mr},Gl="RFC1738";let cs=(e,t)=>(cs=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),cs(e,t));const Ie=(()=>{const e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})(),Kn=1024,Wl=(e,t,n,s,o)=>{if(e.length===0)return e;let r=e;if(typeof e=="symbol"?r=Symbol.prototype.toString.call(e):typeof e!="string"&&(r=String(e)),n==="iso-8859-1")return escape(r).replace(/%u[0-9a-f]{4}/gi,function(i){return"%26%23"+parseInt(i.slice(2),16)+"%3B"});let a="";for(let i=0;i<r.length;i+=Kn){const l=r.length>=Kn?r.slice(i,i+Kn):r,c=[];for(let f=0;f<l.length;++f){let p=l.charCodeAt(f);if(p===45||p===46||p===95||p===126||p>=48&&p<=57||p>=65&&p<=90||p>=97&&p<=122||o===Gl&&(p===40||p===41)){c[c.length]=l.charAt(f);continue}if(p<128){c[c.length]=Ie[p];continue}if(p<2048){c[c.length]=Ie[192|p>>6]+Ie[128|p&63];continue}if(p<55296||p>=57344){c[c.length]=Ie[224|p>>12]+Ie[128|p>>6&63]+Ie[128|p&63];continue}f+=1,p=65536+((p&1023)<<10|l.charCodeAt(f)&1023),c[c.length]=Ie[240|p>>18]+Ie[128|p>>12&63]+Ie[128|p>>6&63]+Ie[128|p&63]}a+=c.join("")}return a};function Kl(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}function go(e,t){if(fe(e)){const n=[];for(let s=0;s<e.length;s+=1)n.push(t(e[s]));return n}return t(e)}const yr={brackets(e){return String(e)+"[]"},comma:"comma",indices(e,t){return String(e)+"["+t+"]"},repeat(e){return String(e)}},br=function(e,t){Array.prototype.push.apply(e,fe(t)?t:[t])};let mo;const ne={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Wl,encodeValuesOnly:!1,format:gr,formatter:mr,indices:!1,serializeDate(e){return(mo??(mo=Function.prototype.call.bind(Date.prototype.toISOString)))(e)},skipNulls:!1,strictNullHandling:!1};function Xl(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"}const Xn={};function wr(e,t,n,s,o,r,a,i,l,c,f,p,d,u,h,m,y,C){let S=e,R=C,V=0,z=!1;for(;(R=R.get(Xn))!==void 0&&!z;){const N=R.get(e);if(V+=1,typeof N<"u"){if(N===V)throw new RangeError("Cyclic object value");z=!0}typeof R.get(Xn)>"u"&&(V=0)}if(typeof c=="function"?S=c(t,S):S instanceof Date?S=d==null?void 0:d(S):n==="comma"&&fe(S)&&(S=go(S,function(N){return N instanceof Date?d==null?void 0:d(N):N})),S===null){if(r)return l&&!m?l(t,ne.encoder,y,"key",u):t;S=""}if(Xl(S)||Kl(S)){if(l){const N=m?t:l(t,ne.encoder,y,"key",u);return[(h==null?void 0:h(N))+"="+(h==null?void 0:h(l(S,ne.encoder,y,"value",u)))]}return[(h==null?void 0:h(t))+"="+(h==null?void 0:h(String(S)))]}const q=[];if(typeof S>"u")return q;let K;if(n==="comma"&&fe(S))m&&l&&(S=go(S,l)),K=[{value:S.length>0?S.join(",")||null:void 0}];else if(fe(c))K=c;else{const N=Object.keys(S);K=f?N.sort(f):N}const G=i?String(t).replace(/\./g,"%2E"):String(t),he=s&&fe(S)&&S.length===1?G+"[]":G;if(o&&fe(S)&&S.length===0)return he+"[]";for(let N=0;N<K.length;++N){const oe=K[N],lt=typeof oe=="object"&&typeof oe.value<"u"?oe.value:S[oe];if(a&&lt===null)continue;const Qe=p&&i?oe.replace(/\./g,"%2E"):oe,Fn=fe(S)?typeof n=="function"?n(he,Qe):he:he+(p?"."+Qe:"["+Qe+"]");C.set(e,V);const J=new WeakMap;J.set(Xn,C),br(q,wr(lt,Fn,n,s,o,r,a,i,n==="comma"&&m&&fe(S)?null:l,c,f,p,d,u,h,m,y,J))}return q}function Jl(e=ne){if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");const t=e.charset||ne.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=gr;if(typeof e.format<"u"){if(!cs(fo,e.format))throw new TypeError("Unknown format option provided.");n=e.format}const s=fo[n];let o=ne.filter;(typeof e.filter=="function"||fe(e.filter))&&(o=e.filter);let r;if(e.arrayFormat&&e.arrayFormat in yr?r=e.arrayFormat:"indices"in e?r=e.indices?"indices":"repeat":r=ne.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const a=typeof e.allowDots>"u"?e.encodeDotInKeys?!0:ne.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:ne.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:ne.allowEmptyArrays,arrayFormat:r,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:ne.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?ne.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:ne.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:ne.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:ne.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:ne.encodeValuesOnly,filter:o,format:n,formatter:s,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:ne.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:ne.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:ne.strictNullHandling}}function Ql(e,t={}){let n=e;const s=Jl(t);let o,r;typeof s.filter=="function"?(r=s.filter,n=r("",n)):fe(s.filter)&&(r=s.filter,o=r);const a=[];if(typeof n!="object"||n===null)return"";const i=yr[s.arrayFormat],l=i==="comma"&&s.commaRoundTrip;o||(o=Object.keys(n)),s.sort&&o.sort(s.sort);const c=new WeakMap;for(let d=0;d<o.length;++d){const u=o[d];s.skipNulls&&n[u]===null||br(a,wr(n[u],u,i,l,s.allowEmptyArrays,s.strictNullHandling,s.skipNulls,s.encodeDotInKeys,s.encode?s.encoder:null,s.filter,s.sort,s.allowDots,s.serializeDate,s.format,s.formatter,s.encodeValuesOnly,s.charset,c))}const f=a.join(s.delimiter);let p=s.addQueryPrefix===!0?"?":"";return s.charsetSentinel&&(s.charset==="iso-8859-1"?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),f.length>0?p+f:""}function Yl(e){let t=0;for(const o of e)t+=o.length;const n=new Uint8Array(t);let s=0;for(const o of e)n.set(o,s),s+=o.length;return n}let yo;function Is(e){let t;return(yo??(t=new globalThis.TextEncoder,yo=t.encode.bind(t)))(e)}let bo;function wo(e){let t;return(bo??(t=new globalThis.TextDecoder,bo=t.decode.bind(t)))(e)}var ye,be;class Cn{constructor(){ye.set(this,void 0),be.set(this,void 0),D(this,ye,new Uint8Array),D(this,be,null)}decode(t){if(t==null)return[];const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?Is(t):t;D(this,ye,Yl([g(this,ye,"f"),n]));const s=[];let o;for(;(o=Zl(g(this,ye,"f"),g(this,be,"f")))!=null;){if(o.carriage&&g(this,be,"f")==null){D(this,be,o.index);continue}if(g(this,be,"f")!=null&&(o.index!==g(this,be,"f")+1||o.carriage)){s.push(wo(g(this,ye,"f").subarray(0,g(this,be,"f")-1))),D(this,ye,g(this,ye,"f").subarray(g(this,be,"f"))),D(this,be,null);continue}const r=g(this,be,"f")!==null?o.preceding-1:o.preceding,a=wo(g(this,ye,"f").subarray(0,r));s.push(a),D(this,ye,g(this,ye,"f").subarray(o.index)),D(this,be,null)}return s}flush(){return g(this,ye,"f").length?this.decode(`
`):[]}}ye=new WeakMap,be=new WeakMap;Cn.NEWLINE_CHARS=new Set([`
`,"\r"]);Cn.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Zl(e,t){for(let n=t??0;n<e.length;n++){if(e[n]===10)return{preceding:n,index:n+1,carriage:!1};if(e[n]===13)return{preceding:n,index:n+1,carriage:!0}}return null}function eu(e){for(let t=0;t<e.length-1;t++){if(e[t]===10&&e[t+1]===10||e[t]===13&&e[t+1]===13)return t+2;if(e[t]===13&&e[t+1]===10&&t+3<e.length&&e[t+2]===13&&e[t+3]===10)return t+4}return-1}const pn={off:0,error:200,warn:300,info:400,debug:500},vo=(e,t,n)=>{if(e){if(Vl(pn,e))return e;ie(n).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(pn))}`)}};function gt(){}function Nt(e,t,n){return!t||pn[e]>pn[n]?gt:t[e].bind(t)}const tu={error:gt,warn:gt,info:gt,debug:gt};let _o=new WeakMap;function ie(e){const t=e.logger,n=e.logLevel??"off";if(!t)return tu;const s=_o.get(t);if(s&&s[0]===n)return s[1];const o={error:Nt("error",t,n),warn:Nt("warn",t,n),info:Nt("info",t,n),debug:Nt("debug",t,n)};return _o.set(t,[n,o]),o}const ze=e=>(e.options&&(e.options={...e.options},delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([t,n])=>[t,t.toLowerCase()==="authorization"||t.toLowerCase()==="cookie"||t.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);var dt;class Me{constructor(t,n,s){this.iterator=t,dt.set(this,void 0),this.controller=n,D(this,dt,s)}static fromSSEResponse(t,n,s){let o=!1;const r=s?ie(s):console;async function*a(){if(o)throw new $("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let i=!1;try{for await(const l of nu(t,n))if(!i){if(l.data.startsWith("[DONE]")){i=!0;continue}if(l.event===null||!l.event.startsWith("thread.")){let c;try{c=JSON.parse(l.data)}catch(f){throw r.error("Could not parse message into JSON:",l.data),r.error("From chunk:",l.raw),f}if(c&&c.error)throw new ce(void 0,c.error,void 0,t.headers);yield c}else{let c;try{c=JSON.parse(l.data)}catch(f){throw console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),f}if(l.event=="error")throw new ce(void 0,c.error,c.message,void 0);yield{event:l.event,data:c}}}i=!0}catch(l){if(ls(l))return;throw l}finally{i||n.abort()}}return new Me(a,n,s)}static fromReadableStream(t,n,s){let o=!1;async function*r(){const i=new Cn,l=fr(t);for await(const c of l)for(const f of i.decode(c))yield f;for(const c of i.flush())yield c}async function*a(){if(o)throw new $("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let i=!1;try{for await(const l of r())i||l&&(yield JSON.parse(l));i=!0}catch(l){if(ls(l))return;throw l}finally{i||n.abort()}}return new Me(a,n,s)}[(dt=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const t=[],n=[],s=this.iterator(),o=r=>({next:()=>{if(r.length===0){const a=s.next();t.push(a),n.push(a)}return r.shift()}});return[new Me(()=>o(t),this.controller,g(this,dt,"f")),new Me(()=>o(n),this.controller,g(this,dt,"f"))]}toReadableStream(){const t=this;let n;return hr({async start(){n=t[Symbol.asyncIterator]()},async pull(s){try{const{value:o,done:r}=await n.next();if(r)return s.close();const a=Is(JSON.stringify(o)+`
`);s.enqueue(a)}catch(o){s.error(o)}},async cancel(){var s;await((s=n.return)==null?void 0:s.call(n))}})}}async function*nu(e,t){if(!e.body)throw t.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new $("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new $("Attempted to iterate over a response with no body");const n=new ou,s=new Cn,o=fr(e.body);for await(const r of su(o))for(const a of s.decode(r)){const i=n.decode(a);i&&(yield i)}for(const r of s.flush()){const a=n.decode(r);a&&(yield a)}}async function*su(e){let t=new Uint8Array;for await(const n of e){if(n==null)continue;const s=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?Is(n):n;let o=new Uint8Array(t.length+s.length);o.set(t),o.set(s,t.length),t=o;let r;for(;(r=eu(t))!==-1;)yield t.slice(0,r),t=t.slice(r)}t.length>0&&(yield t)}class ou{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const r={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],r}if(this.chunks.push(t),t.startsWith(":"))return null;let[n,s,o]=ru(t,":");return o.startsWith(" ")&&(o=o.substring(1)),n==="event"?this.event=o:n==="data"&&this.data.push(o),null}}function ru(e,t){const n=e.indexOf(t);return n!==-1?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}async function vr(e,t){const{response:n,requestLogID:s,retryOfRequestLogID:o,startTime:r}=t,a=await(async()=>{var l,c;if(t.options.stream)return ie(e).debug("response",n.status,n.url,n.headers,n.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(n,t.controller,e):Me.fromSSEResponse(n,t.controller,e);if(n.status===204)return null;if(t.options.__binaryResponse)return n;const i=(c=(l=n.headers.get("content-type"))==null?void 0:l.split(";")[0])==null?void 0:c.trim();if(i!=null&&i.includes("application/json")||i!=null&&i.endsWith("+json")){const f=await n.json();return _r(f,n)}return await n.text()})();return ie(e).debug(`[${s}] response parsed`,ze({retryOfRequestLogID:o,url:n.url,status:n.status,body:a,durationMs:Date.now()-r})),a}function _r(e,t){return!e||typeof e!="object"||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}var mt;class Rn extends Promise{constructor(t,n,s=vr){super(o=>{o(null)}),this.responsePromise=n,this.parseResponse=s,mt.set(this,void 0),D(this,mt,t)}_thenUnwrap(t){return new Rn(g(this,mt,"f"),this.responsePromise,async(n,s)=>_r(t(await this.parseResponse(n,s),s),s.response))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(t=>this.parseResponse(g(this,mt,"f"),t))),this.parsedPromise}then(t,n){return this.parse().then(t,n)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}mt=new WeakMap;var Bt;class ks{constructor(t,n,s,o){Bt.set(this,void 0),D(this,Bt,t),this.options=o,this.response=n,this.body=s}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const t=this.nextPageRequestOptions();if(!t)throw new $("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await g(this,Bt,"f").requestAPIList(this.constructor,t)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(Bt=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const n of t.getPaginatedItems())yield n}}class au extends Rn{constructor(t,n,s){super(t,n,async(o,r)=>new s(o,r.response,await vr(o,r),r.options))}async*[Symbol.asyncIterator](){const t=await this;for await(const n of t)yield n}}class In extends ks{constructor(t,n,s,o){super(t,n,s,o),this.data=s.data||[],this.object=s.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class ee extends ks{constructor(t,n,s,o){super(t,n,s,o),this.data=s.data||[],this.has_more=s.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){var s;const t=this.getPaginatedItems(),n=(s=t[t.length-1])==null?void 0:s.id;return n?{...this.options,query:{...dr(this.options.query),after:n}}:null}}class fn extends ks{constructor(t,n,s,o){super(t,n,s,o),this.data=s.data||[],this.has_more=s.has_more||!1,this.last_id=s.last_id||""}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const t=this.last_id;return t?{...this.options,query:{...dr(this.options.query),after:t}}:null}}const Sr=()=>{var e;if(typeof File>"u"){const{process:t}=globalThis,n=typeof((e=t==null?void 0:t.versions)==null?void 0:e.node)=="string"&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Rt(e,t,n){return Sr(),new File(e,t??"unknown_file",n)}function Xt(e){return(typeof e=="object"&&e!==null&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}const As=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function",So=async(e,t)=>ds(e.body)?{...e,body:await xr(e.body,t)}:e,Xe=async(e,t)=>({...e,body:await xr(e.body,t)}),xo=new WeakMap;function iu(e){const t=typeof e=="function"?e:e.fetch,n=xo.get(t);if(n)return n;const s=(async()=>{try{const o="Response"in t?t.Response:(await t("data:,")).constructor,r=new FormData;return r.toString()!==await new o(r).text()}catch{return!0}})();return xo.set(t,s),s}const xr=async(e,t)=>{if(!await iu(t))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const n=new FormData;return await Promise.all(Object.entries(e||{}).map(([s,o])=>hs(n,s,o))),n},Cr=e=>e instanceof Blob&&"name"in e,lu=e=>typeof e=="object"&&e!==null&&(e instanceof Response||As(e)||Cr(e)),ds=e=>{if(lu(e))return!0;if(Array.isArray(e))return e.some(ds);if(e&&typeof e=="object"){for(const t in e)if(ds(e[t]))return!0}return!1},hs=async(e,t,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")e.append(t,String(n));else if(n instanceof Response)e.append(t,Rt([await n.blob()],Xt(n)));else if(As(n))e.append(t,Rt([await new Response(pr(n)).blob()],Xt(n)));else if(Cr(n))e.append(t,n,Xt(n));else if(Array.isArray(n))await Promise.all(n.map(s=>hs(e,t+"[]",s)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([s,o])=>hs(e,`${t}[${s}]`,o)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}},Rr=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",uu=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&Rr(e),cu=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function";async function du(e,t,n){if(Sr(),e=await e,uu(e))return e instanceof File?e:Rt([await e.arrayBuffer()],e.name);if(cu(e)){const o=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),Rt(await ps(o),t,n)}const s=await ps(e);if(t||(t=Xt(e)),!(n!=null&&n.type)){const o=s.find(r=>typeof r=="object"&&"type"in r&&r.type);typeof o=="string"&&(n={...n,type:o})}return Rt(s,t,n)}async function ps(e){var n;let t=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(Rr(e))t.push(e instanceof Blob?e:await e.arrayBuffer());else if(As(e))for await(const s of e)t.push(...await ps(s));else{const s=(n=e==null?void 0:e.constructor)==null?void 0:n.name;throw new Error(`Unexpected data type: ${typeof e}${s?`; constructor: ${s}`:""}${hu(e)}`)}return t}function hu(e){return typeof e!="object"||e===null?"":`; props: [${Object.getOwnPropertyNames(e).map(t=>`"${t}"`).join(", ")}]`}class O{constructor(t){this._client=t}}function Ir(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Co=Object.freeze(Object.create(null)),pu=(e=Ir)=>function(t,...n){if(t.length===1)return t[0];let s=!1;const o=[],r=t.reduce((c,f,p)=>{var h;/[?#]/.test(f)&&(s=!0);const d=n[p];let u=(s?encodeURIComponent:e)(""+d);return p!==n.length&&(d==null||typeof d=="object"&&d.toString===((h=Object.getPrototypeOf(Object.getPrototypeOf(d.hasOwnProperty??Co)??Co))==null?void 0:h.toString))&&(u=d+"",o.push({start:c.length+f.length,length:u.length,error:`Value of type ${Object.prototype.toString.call(d).slice(8,-1)} is not a valid path parameter`})),c+f+(p===n.length?"":u)},""),a=r.split(/[?#]/,1)[0],i=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let l;for(;(l=i.exec(a))!==null;)o.push({start:l.index,length:l[0].length,error:`Value "${l[0]}" can't be safely passed as a path parameter`});if(o.sort((c,f)=>c.start-f.start),o.length>0){let c=0;const f=o.reduce((p,d)=>{const u=" ".repeat(d.start-c),h="^".repeat(d.length);return c=d.start+d.length,p+u+h},"");throw new $(`Path parameters result in path with invalid segments:
${o.map(p=>p.error).join(`
`)}
${r}
${f}`)}return r},b=pu(Ir);let kr=class extends O{list(e,t={},n){return this._client.getAPIList(b`/chat/completions/${e}/messages`,ee,{query:t,...n})}};function gn(e){return e!==void 0&&"function"in e&&e.function!==void 0}function Ms(e){return(e==null?void 0:e.$brand)==="auto-parseable-response-format"}function Ft(e){return(e==null?void 0:e.$brand)==="auto-parseable-tool"}function fu(e,t){return!t||!Ar(t)?{...e,choices:e.choices.map(n=>(Mr(n.message.tool_calls),{...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:Ps(e,t)}function Ps(e,t){const n=e.choices.map(s=>{var o;if(s.finish_reason==="length")throw new ur;if(s.finish_reason==="content_filter")throw new cr;return Mr(s.message.tool_calls),{...s,message:{...s.message,...s.message.tool_calls?{tool_calls:((o=s.message.tool_calls)==null?void 0:o.map(r=>mu(t,r)))??void 0}:void 0,parsed:s.message.content&&!s.message.refusal?gu(t,s.message.content):null}}});return{...e,choices:n}}function gu(e,t){var n,s;return((n=e.response_format)==null?void 0:n.type)!=="json_schema"?null:((s=e.response_format)==null?void 0:s.type)==="json_schema"?"$parseRaw"in e.response_format?e.response_format.$parseRaw(t):JSON.parse(t):null}function mu(e,t){var s;const n=(s=e.tools)==null?void 0:s.find(o=>{var r;return gn(o)&&((r=o.function)==null?void 0:r.name)===t.function.name});return{...t,function:{...t.function,parsed_arguments:Ft(n)?n.$parseRaw(t.function.arguments):n!=null&&n.function.strict?JSON.parse(t.function.arguments):null}}}function yu(e,t){var s;if(!e||!("tools"in e)||!e.tools)return!1;const n=(s=e.tools)==null?void 0:s.find(o=>{var r;return gn(o)&&((r=o.function)==null?void 0:r.name)===t.function.name});return gn(n)&&(Ft(n)||(n==null?void 0:n.function.strict)||!1)}function Ar(e){var t;return Ms(e.response_format)?!0:((t=e.tools)==null?void 0:t.some(n=>Ft(n)||n.type==="function"&&n.function.strict===!0))??!1}function Mr(e){for(const t of e||[])if(t.type!=="function")throw new $(`Currently only \`function\` tool calls are supported; Received \`${t.type}\``)}function bu(e){for(const t of e??[]){if(t.type!=="function")throw new $(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(t.function.strict!==!0)throw new $(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}const mn=e=>(e==null?void 0:e.role)==="assistant",Pr=e=>(e==null?void 0:e.role)==="tool";var fs,Jt,Qt,yt,bt,Yt,wt,Fe,vt,yn,bn,nt,Or;class Os{constructor(){fs.add(this),this.controller=new AbortController,Jt.set(this,void 0),Qt.set(this,()=>{}),yt.set(this,()=>{}),bt.set(this,void 0),Yt.set(this,()=>{}),wt.set(this,()=>{}),Fe.set(this,{}),vt.set(this,!1),yn.set(this,!1),bn.set(this,!1),nt.set(this,!1),D(this,Jt,new Promise((t,n)=>{D(this,Qt,t,"f"),D(this,yt,n,"f")})),D(this,bt,new Promise((t,n)=>{D(this,Yt,t,"f"),D(this,wt,n,"f")})),g(this,Jt,"f").catch(()=>{}),g(this,bt,"f").catch(()=>{})}_run(t){setTimeout(()=>{t().then(()=>{this._emitFinal(),this._emit("end")},g(this,fs,"m",Or).bind(this))},0)}_connected(){this.ended||(g(this,Qt,"f").call(this),this._emit("connect"))}get ended(){return g(this,vt,"f")}get errored(){return g(this,yn,"f")}get aborted(){return g(this,bn,"f")}abort(){this.controller.abort()}on(t,n){return(g(this,Fe,"f")[t]||(g(this,Fe,"f")[t]=[])).push({listener:n}),this}off(t,n){const s=g(this,Fe,"f")[t];if(!s)return this;const o=s.findIndex(r=>r.listener===n);return o>=0&&s.splice(o,1),this}once(t,n){return(g(this,Fe,"f")[t]||(g(this,Fe,"f")[t]=[])).push({listener:n,once:!0}),this}emitted(t){return new Promise((n,s)=>{D(this,nt,!0),t!=="error"&&this.once("error",s),this.once(t,n)})}async done(){D(this,nt,!0),await g(this,bt,"f")}_emit(t,...n){if(g(this,vt,"f"))return;t==="end"&&(D(this,vt,!0),g(this,Yt,"f").call(this));const s=g(this,Fe,"f")[t];if(s&&(g(this,Fe,"f")[t]=s.filter(o=>!o.once),s.forEach(({listener:o})=>o(...n))),t==="abort"){const o=n[0];!g(this,nt,"f")&&!(s!=null&&s.length)&&Promise.reject(o),g(this,yt,"f").call(this,o),g(this,wt,"f").call(this,o),this._emit("end");return}if(t==="error"){const o=n[0];!g(this,nt,"f")&&!(s!=null&&s.length)&&Promise.reject(o),g(this,yt,"f").call(this,o),g(this,wt,"f").call(this,o),this._emit("end")}}_emitFinal(){}}Jt=new WeakMap,Qt=new WeakMap,yt=new WeakMap,bt=new WeakMap,Yt=new WeakMap,wt=new WeakMap,Fe=new WeakMap,vt=new WeakMap,yn=new WeakMap,bn=new WeakMap,nt=new WeakMap,fs=new WeakSet,Or=function(e){if(D(this,yn,!0),e instanceof Error&&e.name==="AbortError"&&(e=new _e),e instanceof _e)return D(this,bn,!0),this._emit("abort",e);if(e instanceof $)return this._emit("error",e);if(e instanceof Error){const t=new $(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new $(String(e)))};function wu(e){return typeof e.parse=="function"}var pe,gs,wn,ms,ys,bs,$r,Fr;const vu=10;class Er extends Os{constructor(){super(...arguments),pe.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(t){var s;this._chatCompletions.push(t),this._emit("chatCompletion",t);const n=(s=t.choices[0])==null?void 0:s.message;return n&&this._addMessage(n),t}_addMessage(t,n=!0){if("content"in t||(t.content=null),this.messages.push(t),n){if(this._emit("message",t),Pr(t)&&t.content)this._emit("functionToolCallResult",t.content);else if(mn(t)&&t.tool_calls)for(const s of t.tool_calls)s.type==="function"&&this._emit("functionToolCall",s.function)}}async finalChatCompletion(){await this.done();const t=this._chatCompletions[this._chatCompletions.length-1];if(!t)throw new $("stream ended without producing a ChatCompletion");return t}async finalContent(){return await this.done(),g(this,pe,"m",gs).call(this)}async finalMessage(){return await this.done(),g(this,pe,"m",wn).call(this)}async finalFunctionToolCall(){return await this.done(),g(this,pe,"m",ms).call(this)}async finalFunctionToolCallResult(){return await this.done(),g(this,pe,"m",ys).call(this)}async totalUsage(){return await this.done(),g(this,pe,"m",bs).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const t=this._chatCompletions[this._chatCompletions.length-1];t&&this._emit("finalChatCompletion",t);const n=g(this,pe,"m",wn).call(this);n&&this._emit("finalMessage",n);const s=g(this,pe,"m",gs).call(this);s&&this._emit("finalContent",s);const o=g(this,pe,"m",ms).call(this);o&&this._emit("finalFunctionToolCall",o);const r=g(this,pe,"m",ys).call(this);r!=null&&this._emit("finalFunctionToolCallResult",r),this._chatCompletions.some(a=>a.usage)&&this._emit("totalUsage",g(this,pe,"m",bs).call(this))}async _createChatCompletion(t,n,s){const o=s==null?void 0:s.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort())),g(this,pe,"m",$r).call(this,n);const r=await t.chat.completions.create({...n,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Ps(r,n))}async _runChatCompletion(t,n,s){for(const o of n.messages)this._addMessage(o,!1);return await this._createChatCompletion(t,n,s)}async _runTools(t,n,s){var u,h,m;const o="tool",{tool_choice:r="auto",stream:a,...i}=n,l=typeof r!="string"&&r.type==="function"&&((u=r==null?void 0:r.function)==null?void 0:u.name),{maxChatCompletions:c=vu}=s||{},f=n.tools.map(y=>{if(Ft(y)){if(!y.$callback)throw new $("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:y.$callback,name:y.function.name,description:y.function.description||"",parameters:y.function.parameters,parse:y.$parseRaw,strict:!0}}}return y}),p={};for(const y of f)y.type==="function"&&(p[y.function.name||y.function.function.name]=y.function);const d="tools"in n?f.map(y=>y.type==="function"?{type:"function",function:{name:y.function.name||y.function.function.name,parameters:y.function.parameters,description:y.function.description,strict:y.function.strict}}:y):void 0;for(const y of n.messages)this._addMessage(y,!1);for(let y=0;y<c;++y){const C=(h=(await this._createChatCompletion(t,{...i,tool_choice:r,tools:d,messages:[...this.messages]},s)).choices[0])==null?void 0:h.message;if(!C)throw new $("missing message in ChatCompletion response");if(!((m=C.tool_calls)!=null&&m.length))return;for(const S of C.tool_calls){if(S.type!=="function")continue;const R=S.id,{name:V,arguments:z}=S.function,q=p[V];if(q){if(l&&l!==V){const N=`Invalid tool_call: ${JSON.stringify(V)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:o,tool_call_id:R,content:N});continue}}else{const N=`Invalid tool_call: ${JSON.stringify(V)}. Available options are: ${Object.keys(p).map(oe=>JSON.stringify(oe)).join(", ")}. Please try again`;this._addMessage({role:o,tool_call_id:R,content:N});continue}let K;try{K=wu(q)?await q.parse(z):z}catch(N){const oe=N instanceof Error?N.message:String(N);this._addMessage({role:o,tool_call_id:R,content:oe});continue}const G=await q.function(K,this),he=g(this,pe,"m",Fr).call(this,G);if(this._addMessage({role:o,tool_call_id:R,content:he}),l)return}}}}pe=new WeakSet,gs=function(){return g(this,pe,"m",wn).call(this).content??null},wn=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(mn(t))return{...t,content:t.content??null,refusal:t.refusal??null}}throw new $("stream ended without producing a ChatCompletionMessage with role=assistant")},ms=function(){var e,t;for(let n=this.messages.length-1;n>=0;n--){const s=this.messages[n];if(mn(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(t=s.tool_calls.filter(o=>o.type==="function").at(-1))==null?void 0:t.function}},ys=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(Pr(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>{var s;return n.role==="assistant"&&((s=n.tool_calls)==null?void 0:s.some(o=>o.type==="function"&&o.id===t.tool_call_id))}))return t.content}},bs=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},$r=function(e){if(e.n!=null&&e.n>1)throw new $("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Fr=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class $s extends Er{static runTools(t,n,s){const o=new $s,r={...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"runTools"}};return o._run(()=>o._runTools(t,n,r)),o}_addMessage(t,n=!0){super._addMessage(t,n),mn(t)&&t.content&&this._emit("content",t.content)}}const Vr=1,Dr=2,Lr=4,Tr=8,jr=16,qr=32,Nr=64,Br=128,Hr=256,zr=Br|Hr,Ur=jr|qr|zr|Nr,Gr=Vr|Dr|Ur,Wr=Lr|Tr,_u=Gr|Wr,re={STR:Vr,NUM:Dr,ARR:Lr,OBJ:Tr,NULL:jr,BOOL:qr,NAN:Nr,INFINITY:Br,MINUS_INFINITY:Hr,INF:zr,SPECIAL:Ur,ATOM:Gr,COLLECTION:Wr,ALL:_u};class Su extends Error{}class xu extends Error{}function Cu(e,t=re.ALL){if(typeof e!="string")throw new TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw new Error(`${e} is empty`);return Ru(e.trim(),t)}const Ru=(e,t)=>{const n=e.length;let s=0;const o=d=>{throw new Su(`${d} at position ${s}`)},r=d=>{throw new xu(`${d} at position ${s}`)},a=()=>(p(),s>=n&&o("Unexpected end of input"),e[s]==='"'?i():e[s]==="{"?l():e[s]==="["?c():e.substring(s,s+4)==="null"||re.NULL&t&&n-s<4&&"null".startsWith(e.substring(s))?(s+=4,null):e.substring(s,s+4)==="true"||re.BOOL&t&&n-s<4&&"true".startsWith(e.substring(s))?(s+=4,!0):e.substring(s,s+5)==="false"||re.BOOL&t&&n-s<5&&"false".startsWith(e.substring(s))?(s+=5,!1):e.substring(s,s+8)==="Infinity"||re.INFINITY&t&&n-s<8&&"Infinity".startsWith(e.substring(s))?(s+=8,1/0):e.substring(s,s+9)==="-Infinity"||re.MINUS_INFINITY&t&&1<n-s&&n-s<9&&"-Infinity".startsWith(e.substring(s))?(s+=9,-1/0):e.substring(s,s+3)==="NaN"||re.NAN&t&&n-s<3&&"NaN".startsWith(e.substring(s))?(s+=3,NaN):f()),i=()=>{const d=s;let u=!1;for(s++;s<n&&(e[s]!=='"'||u&&e[s-1]==="\\");)u=e[s]==="\\"?!u:!1,s++;if(e.charAt(s)=='"')try{return JSON.parse(e.substring(d,++s-Number(u)))}catch(h){r(String(h))}else if(re.STR&t)try{return JSON.parse(e.substring(d,s-Number(u))+'"')}catch{return JSON.parse(e.substring(d,e.lastIndexOf("\\"))+'"')}o("Unterminated string literal")},l=()=>{s++,p();const d={};try{for(;e[s]!=="}";){if(p(),s>=n&&re.OBJ&t)return d;const u=i();p(),s++;try{const h=a();Object.defineProperty(d,u,{value:h,writable:!0,enumerable:!0,configurable:!0})}catch(h){if(re.OBJ&t)return d;throw h}p(),e[s]===","&&s++}}catch{if(re.OBJ&t)return d;o("Expected '}' at end of object")}return s++,d},c=()=>{s++;const d=[];try{for(;e[s]!=="]";)d.push(a()),p(),e[s]===","&&s++}catch{if(re.ARR&t)return d;o("Expected ']' at end of array")}return s++,d},f=()=>{if(s===0){e==="-"&&re.NUM&t&&o("Not sure what '-' is");try{return JSON.parse(e)}catch(u){if(re.NUM&t)try{return e[e.length-1]==="."?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch{}r(String(u))}}const d=s;for(e[s]==="-"&&s++;e[s]&&!",]}".includes(e[s]);)s++;s==n&&!(re.NUM&t)&&o("Unterminated number literal");try{return JSON.parse(e.substring(d,s))}catch{e.substring(d,s)==="-"&&re.NUM&t&&o("Not sure what '-' is");try{return JSON.parse(e.substring(d,e.lastIndexOf("e")))}catch(u){r(String(u))}}},p=()=>{for(;s<n&&` 
\r	`.includes(e[s]);)s++};return a()},Ro=e=>Cu(e,re.ALL^re.NUM);var te,$e,Ye,Le,Jn,Ht,Qn,Yn,Zn,zt,es,Io;class Pt extends Er{constructor(t){super(),te.add(this),$e.set(this,void 0),Ye.set(this,void 0),Le.set(this,void 0),D(this,$e,t),D(this,Ye,[])}get currentChatCompletionSnapshot(){return g(this,Le,"f")}static fromReadableStream(t){const n=new Pt(null);return n._run(()=>n._fromReadableStream(t)),n}static createChatCompletion(t,n,s){const o=new Pt(n);return o._run(()=>o._runChatCompletion(t,{...n,stream:!0},{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createChatCompletion(t,n,s){var a;super._createChatCompletion;const o=s==null?void 0:s.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort())),g(this,te,"m",Jn).call(this);const r=await t.chat.completions.create({...n,stream:!0},{...s,signal:this.controller.signal});this._connected();for await(const i of r)g(this,te,"m",Qn).call(this,i);if((a=r.controller.signal)!=null&&a.aborted)throw new _e;return this._addChatCompletion(g(this,te,"m",zt).call(this))}async _fromReadableStream(t,n){var a;const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),g(this,te,"m",Jn).call(this),this._connected();const o=Me.fromReadableStream(t,this.controller);let r;for await(const i of o)r&&r!==i.id&&this._addChatCompletion(g(this,te,"m",zt).call(this)),g(this,te,"m",Qn).call(this,i),r=i.id;if((a=o.controller.signal)!=null&&a.aborted)throw new _e;return this._addChatCompletion(g(this,te,"m",zt).call(this))}[($e=new WeakMap,Ye=new WeakMap,Le=new WeakMap,te=new WeakSet,Jn=function(){this.ended||D(this,Le,void 0)},Ht=function(t){let n=g(this,Ye,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},g(this,Ye,"f")[t.index]=n,n)},Qn=function(t){var s,o,r,a,i,l,c,f,p,d,u,h,m,y,C;if(this.ended)return;const n=g(this,te,"m",Io).call(this,t);this._emit("chunk",t,n);for(const S of t.choices){const R=n.choices[S.index];S.delta.content!=null&&((s=R.message)==null?void 0:s.role)==="assistant"&&((o=R.message)!=null&&o.content)&&(this._emit("content",S.delta.content,R.message.content),this._emit("content.delta",{delta:S.delta.content,snapshot:R.message.content,parsed:R.message.parsed})),S.delta.refusal!=null&&((r=R.message)==null?void 0:r.role)==="assistant"&&((a=R.message)!=null&&a.refusal)&&this._emit("refusal.delta",{delta:S.delta.refusal,snapshot:R.message.refusal}),((i=S.logprobs)==null?void 0:i.content)!=null&&((l=R.message)==null?void 0:l.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(c=S.logprobs)==null?void 0:c.content,snapshot:((f=R.logprobs)==null?void 0:f.content)??[]}),((p=S.logprobs)==null?void 0:p.refusal)!=null&&((d=R.message)==null?void 0:d.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(u=S.logprobs)==null?void 0:u.refusal,snapshot:((h=R.logprobs)==null?void 0:h.refusal)??[]});const V=g(this,te,"m",Ht).call(this,R);R.finish_reason&&(g(this,te,"m",Zn).call(this,R),V.current_tool_call_index!=null&&g(this,te,"m",Yn).call(this,R,V.current_tool_call_index));for(const z of S.delta.tool_calls??[])V.current_tool_call_index!==z.index&&(g(this,te,"m",Zn).call(this,R),V.current_tool_call_index!=null&&g(this,te,"m",Yn).call(this,R,V.current_tool_call_index)),V.current_tool_call_index=z.index;for(const z of S.delta.tool_calls??[]){const q=(m=R.message.tool_calls)==null?void 0:m[z.index];q!=null&&q.type&&((q==null?void 0:q.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(y=q.function)==null?void 0:y.name,index:z.index,arguments:q.function.arguments,parsed_arguments:q.function.parsed_arguments,arguments_delta:((C=z.function)==null?void 0:C.arguments)??""}):q==null||q.type)}}},Yn=function(t,n){var o,r,a;if(g(this,te,"m",Ht).call(this,t).done_tool_calls.has(n))return;const s=(o=t.message.tool_calls)==null?void 0:o[n];if(!s)throw new Error("no tool call snapshot");if(!s.type)throw new Error("tool call snapshot missing `type`");if(s.type==="function"){const i=(a=(r=g(this,$e,"f"))==null?void 0:r.tools)==null?void 0:a.find(l=>gn(l)&&l.function.name===s.function.name);this._emit("tool_calls.function.arguments.done",{name:s.function.name,index:n,arguments:s.function.arguments,parsed_arguments:Ft(i)?i.$parseRaw(s.function.arguments):i!=null&&i.function.strict?JSON.parse(s.function.arguments):null})}else s.type},Zn=function(t){var s,o;const n=g(this,te,"m",Ht).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const r=g(this,te,"m",es).call(this);this._emit("content.done",{content:t.message.content,parsed:r?r.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(s=t.logprobs)!=null&&s.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(o=t.logprobs)!=null&&o.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},zt=function(){if(this.ended)throw new $("stream has ended, this shouldn't happen");const t=g(this,Le,"f");if(!t)throw new $("request ended without sending any chunks");return D(this,Le,void 0),D(this,Ye,[]),Iu(t,g(this,$e,"f"))},es=function(){var n;const t=(n=g(this,$e,"f"))==null?void 0:n.response_format;return Ms(t)?t:null},Io=function(t){var n,s,o,r;let a=g(this,Le,"f");const{choices:i,...l}=t;a?Object.assign(a,l):a=D(this,Le,{...l,choices:[]});for(const{delta:c,finish_reason:f,index:p,logprobs:d=null,...u}of t.choices){let h=a.choices[p];if(h||(h=a.choices[p]={finish_reason:f,index:p,message:{},logprobs:d,...u}),d)if(!h.logprobs)h.logprobs=Object.assign({},d);else{const{content:z,refusal:q,...K}=d;Object.assign(h.logprobs,K),z&&((n=h.logprobs).content??(n.content=[]),h.logprobs.content.push(...z)),q&&((s=h.logprobs).refusal??(s.refusal=[]),h.logprobs.refusal.push(...q))}if(f&&(h.finish_reason=f,g(this,$e,"f")&&Ar(g(this,$e,"f")))){if(f==="length")throw new ur;if(f==="content_filter")throw new cr}if(Object.assign(h,u),!c)continue;const{content:m,refusal:y,function_call:C,role:S,tool_calls:R,...V}=c;if(Object.assign(h.message,V),y&&(h.message.refusal=(h.message.refusal||"")+y),S&&(h.message.role=S),C&&(h.message.function_call?(C.name&&(h.message.function_call.name=C.name),C.arguments&&((o=h.message.function_call).arguments??(o.arguments=""),h.message.function_call.arguments+=C.arguments)):h.message.function_call=C),m&&(h.message.content=(h.message.content||"")+m,!h.message.refusal&&g(this,te,"m",es).call(this)&&(h.message.parsed=Ro(h.message.content))),R){h.message.tool_calls||(h.message.tool_calls=[]);for(const{index:z,id:q,type:K,function:G,...he}of R){const N=(r=h.message.tool_calls)[z]??(r[z]={});Object.assign(N,he),q&&(N.id=q),K&&(N.type=K),G&&(N.function??(N.function={name:G.name??"",arguments:""})),G!=null&&G.name&&(N.function.name=G.name),G!=null&&G.arguments&&(N.function.arguments+=G.arguments,yu(g(this,$e,"f"),N)&&(N.function.parsed_arguments=Ro(N.function.arguments)))}}}return a},Symbol.asyncIterator)](){const t=[],n=[];let s=!1;return this.on("chunk",o=>{const r=n.shift();r?r.resolve(o):t.push(o)}),this.on("end",()=>{s=!0;for(const o of n)o.resolve(void 0);n.length=0}),this.on("abort",o=>{s=!0;for(const r of n)r.reject(o);n.length=0}),this.on("error",o=>{s=!0;for(const r of n)r.reject(o);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((o,r)=>n.push({resolve:o,reject:r})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Me(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Iu(e,t){const{id:n,choices:s,created:o,model:r,system_fingerprint:a,...i}=e,l={...i,id:n,choices:s.map(({message:c,finish_reason:f,index:p,logprobs:d,...u})=>{if(!f)throw new $(`missing finish_reason for choice ${p}`);const{content:h=null,function_call:m,tool_calls:y,...C}=c,S=c.role;if(!S)throw new $(`missing role for choice ${p}`);if(m){const{arguments:R,name:V}=m;if(R==null)throw new $(`missing function_call.arguments for choice ${p}`);if(!V)throw new $(`missing function_call.name for choice ${p}`);return{...u,message:{content:h,function_call:{arguments:R,name:V},role:S,refusal:c.refusal??null},finish_reason:f,index:p,logprobs:d}}return y?{...u,index:p,finish_reason:f,logprobs:d,message:{...C,role:S,content:h,refusal:c.refusal??null,tool_calls:y.map((R,V)=>{const{function:z,type:q,id:K,...G}=R,{arguments:he,name:N,...oe}=z||{};if(K==null)throw new $(`missing choices[${p}].tool_calls[${V}].id
${Ut(e)}`);if(q==null)throw new $(`missing choices[${p}].tool_calls[${V}].type
${Ut(e)}`);if(N==null)throw new $(`missing choices[${p}].tool_calls[${V}].function.name
${Ut(e)}`);if(he==null)throw new $(`missing choices[${p}].tool_calls[${V}].function.arguments
${Ut(e)}`);return{...G,id:K,type:q,function:{...oe,name:N,arguments:he}}})}}:{...u,message:{...C,content:h,role:S,refusal:c.refusal??null},finish_reason:f,index:p,logprobs:d}}),created:o,model:r,object:"chat.completion",...a?{system_fingerprint:a}:{}};return fu(l,t)}function Ut(e){return JSON.stringify(e)}class vn extends Pt{static fromReadableStream(t){const n=new vn(null);return n._run(()=>n._fromReadableStream(t)),n}static runTools(t,n,s){const o=new vn(n),r={...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"runTools"}};return o._run(()=>o._runTools(t,n,r)),o}}let Fs=class extends O{constructor(){super(...arguments),this.messages=new kr(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(b`/chat/completions/${e}`,t)}update(e,t,n){return this._client.post(b`/chat/completions/${e}`,{body:t,...n})}list(e={},t){return this._client.getAPIList("/chat/completions",ee,{query:e,...t})}delete(e,t){return this._client.delete(b`/chat/completions/${e}`,t)}parse(e,t){return bu(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(n=>Ps(n,e))}runTools(e,t){return e.stream?vn.runTools(this._client,e,t):$s.runTools(this._client,e,t)}stream(e,t){return Pt.createChatCompletion(this._client,e,t)}};Fs.Messages=kr;class Es extends O{constructor(){super(...arguments),this.completions=new Fs(this._client)}}Es.Completions=Fs;const Kr=Symbol("brand.privateNullableHeaders");function*ku(e){if(!e)return;if(Kr in e){const{values:s,nulls:o}=e;yield*s.entries();for(const r of o)yield[r,null];return}let t=!1,n;e instanceof Headers?n=e.entries():uo(e)?n=e:(t=!0,n=Object.entries(e??{}));for(let s of n){const o=s[0];if(typeof o!="string")throw new TypeError("expected header name to be a string");const r=uo(s[1])?s[1]:[s[1]];let a=!1;for(const i of r)i!==void 0&&(t&&!a&&(a=!0,yield[o,null]),yield[o,i])}}const k=e=>{const t=new Headers,n=new Set;for(const s of e){const o=new Set;for(const[r,a]of ku(s)){const i=r.toLowerCase();o.has(i)||(t.delete(r),o.add(i)),a===null?(t.delete(r),n.add(i)):(t.append(r,a),n.delete(i))}}return{[Kr]:!0,values:t,nulls:n}};class Xr extends O{create(t,n){return this._client.post("/audio/speech",{body:t,...n,headers:k([{Accept:"application/octet-stream"},n==null?void 0:n.headers]),__binaryResponse:!0})}}class Jr extends O{create(t,n){return this._client.post("/audio/transcriptions",Xe({body:t,...n,stream:t.stream??!1,__metadata:{model:t.model}},this._client))}}class Qr extends O{create(t,n){return this._client.post("/audio/translations",Xe({body:t,...n,__metadata:{model:t.model}},this._client))}}class Et extends O{constructor(){super(...arguments),this.transcriptions=new Jr(this._client),this.translations=new Qr(this._client),this.speech=new Xr(this._client)}}Et.Transcriptions=Jr;Et.Translations=Qr;Et.Speech=Xr;class Yr extends O{create(t,n){return this._client.post("/batches",{body:t,...n})}retrieve(t,n){return this._client.get(b`/batches/${t}`,n)}list(t={},n){return this._client.getAPIList("/batches",ee,{query:t,...n})}cancel(t,n){return this._client.post(b`/batches/${t}/cancel`,n)}}class Zr extends O{create(t,n){return this._client.post("/assistants",{body:t,...n,headers:k([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(t,n){return this._client.get(b`/assistants/${t}`,{...n,headers:k([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(t,n,s){return this._client.post(b`/assistants/${t}`,{body:n,...s,headers:k([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}list(t={},n){return this._client.getAPIList("/assistants",ee,{query:t,...n,headers:k([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(t,n){return this._client.delete(b`/assistants/${t}`,{...n,headers:k([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}let ea=class extends O{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:k([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])})}};class ta extends O{create(t,n){return this._client.post("/realtime/transcription_sessions",{body:t,...n,headers:k([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}let kn=class extends O{constructor(){super(...arguments),this.sessions=new ea(this._client),this.transcriptionSessions=new ta(this._client)}};kn.Sessions=ea;kn.TranscriptionSessions=ta;class na extends O{create(t,n){return this._client.post("/chatkit/sessions",{body:t,...n,headers:k([{"OpenAI-Beta":"chatkit_beta=v1"},n==null?void 0:n.headers])})}cancel(t,n){return this._client.post(b`/chatkit/sessions/${t}/cancel`,{...n,headers:k([{"OpenAI-Beta":"chatkit_beta=v1"},n==null?void 0:n.headers])})}}let sa=class extends O{retrieve(e,t){return this._client.get(b`/chatkit/threads/${e}`,{...t,headers:k([{"OpenAI-Beta":"chatkit_beta=v1"},t==null?void 0:t.headers])})}list(e={},t){return this._client.getAPIList("/chatkit/threads",fn,{query:e,...t,headers:k([{"OpenAI-Beta":"chatkit_beta=v1"},t==null?void 0:t.headers])})}delete(e,t){return this._client.delete(b`/chatkit/threads/${e}`,{...t,headers:k([{"OpenAI-Beta":"chatkit_beta=v1"},t==null?void 0:t.headers])})}listItems(e,t={},n){return this._client.getAPIList(b`/chatkit/threads/${e}/items`,fn,{query:t,...n,headers:k([{"OpenAI-Beta":"chatkit_beta=v1"},n==null?void 0:n.headers])})}};class An extends O{constructor(){super(...arguments),this.sessions=new na(this._client),this.threads=new sa(this._client)}}An.Sessions=na;An.Threads=sa;class oa extends O{create(t,n,s){return this._client.post(b`/threads/${t}/messages`,{body:n,...s,headers:k([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}retrieve(t,n,s){const{thread_id:o}=n;return this._client.get(b`/threads/${o}/messages/${t}`,{...s,headers:k([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}update(t,n,s){const{thread_id:o,...r}=n;return this._client.post(b`/threads/${o}/messages/${t}`,{body:r,...s,headers:k([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}list(t,n={},s){return this._client.getAPIList(b`/threads/${t}/messages`,ee,{query:n,...s,headers:k([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}delete(t,n,s){const{thread_id:o}=n;return this._client.delete(b`/threads/${o}/messages/${t}`,{...s,headers:k([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}class ra extends O{retrieve(t,n,s){const{thread_id:o,run_id:r,...a}=n;return this._client.get(b`/threads/${o}/runs/${r}/steps/${t}`,{query:a,...s,headers:k([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}list(t,n,s){const{thread_id:o,...r}=n;return this._client.getAPIList(b`/threads/${o}/runs/${t}/steps`,ee,{query:r,...s,headers:k([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}const Au=e=>{if(typeof Buffer<"u"){const t=Buffer.from(e,"base64");return Array.from(new Float32Array(t.buffer,t.byteOffset,t.length/Float32Array.BYTES_PER_ELEMENT))}else{const t=atob(e),n=t.length,s=new Uint8Array(n);for(let o=0;o<n;o++)s[o]=t.charCodeAt(o);return Array.from(new Float32Array(s.buffer))}},Ze=e=>{var t,n,s,o;if(typeof globalThis.process<"u")return((t=Ln==null?void 0:Ln[e])==null?void 0:t.trim())??void 0;if(typeof globalThis.Deno<"u")return(o=(s=(n=globalThis.Deno.env)==null?void 0:n.get)==null?void 0:s.call(n,e))==null?void 0:o.trim()};var le,We,ws,ke,Zt,xe,Ke,ot,Ge,_n,we,en,tn,It,_t,St,ko,Ao,Mo,Po,Oo,$o,Fo;class kt extends Os{constructor(){super(...arguments),le.add(this),ws.set(this,[]),ke.set(this,{}),Zt.set(this,{}),xe.set(this,void 0),Ke.set(this,void 0),ot.set(this,void 0),Ge.set(this,void 0),_n.set(this,void 0),we.set(this,void 0),en.set(this,void 0),tn.set(this,void 0),It.set(this,void 0)}[(ws=new WeakMap,ke=new WeakMap,Zt=new WeakMap,xe=new WeakMap,Ke=new WeakMap,ot=new WeakMap,Ge=new WeakMap,_n=new WeakMap,we=new WeakMap,en=new WeakMap,tn=new WeakMap,It=new WeakMap,le=new WeakSet,Symbol.asyncIterator)](){const t=[],n=[];let s=!1;return this.on("event",o=>{const r=n.shift();r?r.resolve(o):t.push(o)}),this.on("end",()=>{s=!0;for(const o of n)o.resolve(void 0);n.length=0}),this.on("abort",o=>{s=!0;for(const r of n)r.reject(o);n.length=0}),this.on("error",o=>{s=!0;for(const r of n)r.reject(o);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((o,r)=>n.push({resolve:o,reject:r})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(t){const n=new We;return n._run(()=>n._fromReadableStream(t)),n}async _fromReadableStream(t,n){var r;const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),this._connected();const o=Me.fromReadableStream(t,this.controller);for await(const a of o)g(this,le,"m",_t).call(this,a);if((r=o.controller.signal)!=null&&r.aborted)throw new _e;return this._addRun(g(this,le,"m",St).call(this))}toReadableStream(){return new Me(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(t,n,s,o){const r=new We;return r._run(()=>r._runToolAssistantStream(t,n,s,{...o,headers:{...o==null?void 0:o.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createToolAssistantStream(t,n,s,o){var l;const r=o==null?void 0:o.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort()));const a={...s,stream:!0},i=await t.submitToolOutputs(n,a,{...o,signal:this.controller.signal});this._connected();for await(const c of i)g(this,le,"m",_t).call(this,c);if((l=i.controller.signal)!=null&&l.aborted)throw new _e;return this._addRun(g(this,le,"m",St).call(this))}static createThreadAssistantStream(t,n,s){const o=new We;return o._run(()=>o._threadAssistantStream(t,n,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),o}static createAssistantStream(t,n,s,o){const r=new We;return r._run(()=>r._runAssistantStream(t,n,s,{...o,headers:{...o==null?void 0:o.headers,"X-Stainless-Helper-Method":"stream"}})),r}currentEvent(){return g(this,en,"f")}currentRun(){return g(this,tn,"f")}currentMessageSnapshot(){return g(this,xe,"f")}currentRunStepSnapshot(){return g(this,It,"f")}async finalRunSteps(){return await this.done(),Object.values(g(this,ke,"f"))}async finalMessages(){return await this.done(),Object.values(g(this,Zt,"f"))}async finalRun(){if(await this.done(),!g(this,Ke,"f"))throw Error("Final run was not received.");return g(this,Ke,"f")}async _createThreadAssistantStream(t,n,s){var i;const o=s==null?void 0:s.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const r={...n,stream:!0},a=await t.createAndRun(r,{...s,signal:this.controller.signal});this._connected();for await(const l of a)g(this,le,"m",_t).call(this,l);if((i=a.controller.signal)!=null&&i.aborted)throw new _e;return this._addRun(g(this,le,"m",St).call(this))}async _createAssistantStream(t,n,s,o){var l;const r=o==null?void 0:o.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort()));const a={...s,stream:!0},i=await t.create(n,a,{...o,signal:this.controller.signal});this._connected();for await(const c of i)g(this,le,"m",_t).call(this,c);if((l=i.controller.signal)!=null&&l.aborted)throw new _e;return this._addRun(g(this,le,"m",St).call(this))}static accumulateDelta(t,n){for(const[s,o]of Object.entries(n)){if(!t.hasOwnProperty(s)){t[s]=o;continue}let r=t[s];if(r==null){t[s]=o;continue}if(s==="index"||s==="type"){t[s]=o;continue}if(typeof r=="string"&&typeof o=="string")r+=o;else if(typeof r=="number"&&typeof o=="number")r+=o;else if(Wn(r)&&Wn(o))r=this.accumulateDelta(r,o);else if(Array.isArray(r)&&Array.isArray(o)){if(r.every(a=>typeof a=="string"||typeof a=="number")){r.push(...o);continue}for(const a of o){if(!Wn(a))throw new Error(`Expected array delta entry to be an object but got: ${a}`);const i=a.index;if(i==null)throw console.error(a),new Error("Expected array delta entry to have an `index` property");if(typeof i!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${i}`);const l=r[i];l==null?r.push(a):r[i]=this.accumulateDelta(l,a)}continue}else throw Error(`Unhandled record type: ${s}, deltaValue: ${o}, accValue: ${r}`);t[s]=r}return t}_addRun(t){return t}async _threadAssistantStream(t,n,s){return await this._createThreadAssistantStream(n,t,s)}async _runAssistantStream(t,n,s,o){return await this._createAssistantStream(n,t,s,o)}async _runToolAssistantStream(t,n,s,o){return await this._createToolAssistantStream(n,t,s,o)}}We=kt,_t=function(e){if(!this.ended)switch(D(this,en,e),g(this,le,"m",Mo).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":g(this,le,"m",Fo).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":g(this,le,"m",Ao).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":g(this,le,"m",ko).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},St=function(){if(this.ended)throw new $("stream has ended, this shouldn't happen");if(!g(this,Ke,"f"))throw Error("Final run has not been received");return g(this,Ke,"f")},ko=function(e){const[t,n]=g(this,le,"m",Oo).call(this,e,g(this,xe,"f"));D(this,xe,t),g(this,Zt,"f")[t.id]=t;for(const s of n){const o=t.content[s.index];(o==null?void 0:o.type)=="text"&&this._emit("textCreated",o.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let o=s.text,r=t.content[s.index];if(r&&r.type=="text")this._emit("textDelta",o,r.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=g(this,ot,"f")){if(g(this,Ge,"f"))switch(g(this,Ge,"f").type){case"text":this._emit("textDone",g(this,Ge,"f").text,g(this,xe,"f"));break;case"image_file":this._emit("imageFileDone",g(this,Ge,"f").image_file,g(this,xe,"f"));break}D(this,ot,s.index)}D(this,Ge,t.content[s.index])}break;case"thread.message.completed":case"thread.message.incomplete":if(g(this,ot,"f")!==void 0){const s=e.data.content[g(this,ot,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,g(this,xe,"f"));break;case"text":this._emit("textDone",s.text,g(this,xe,"f"));break}}g(this,xe,"f")&&this._emit("messageDone",e.data),D(this,xe,void 0)}},Ao=function(e){const t=g(this,le,"m",Po).call(this,e);switch(D(this,It,t),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const s of n.step_details.tool_calls)s.index==g(this,_n,"f")?this._emit("toolCallDelta",s,t.step_details.tool_calls[s.index]):(g(this,we,"f")&&this._emit("toolCallDone",g(this,we,"f")),D(this,_n,s.index),D(this,we,t.step_details.tool_calls[s.index]),g(this,we,"f")&&this._emit("toolCallCreated",g(this,we,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":D(this,It,void 0),e.data.step_details.type=="tool_calls"&&g(this,we,"f")&&(this._emit("toolCallDone",g(this,we,"f")),D(this,we,void 0)),this._emit("runStepDone",e.data,t);break}},Mo=function(e){g(this,ws,"f").push(e),this._emit("event",e)},Po=function(e){switch(e.event){case"thread.run.step.created":return g(this,ke,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=g(this,ke,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const s=We.accumulateDelta(t,n.delta);g(this,ke,"f")[e.data.id]=s}return g(this,ke,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":g(this,ke,"f")[e.data.id]=e.data;break}if(g(this,ke,"f")[e.data.id])return g(this,ke,"f")[e.data.id];throw new Error("No snapshot available")},Oo=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const o of s.delta.content)if(o.index in t.content){let r=t.content[o.index];t.content[o.index]=g(this,le,"m",$o).call(this,o,r)}else t.content[o.index]=o,n.push(o);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},$o=function(e,t){return We.accumulateDelta(t,e)},Fo=function(e){switch(D(this,tn,e.data),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":D(this,Ke,e.data),g(this,we,"f")&&(this._emit("toolCallDone",g(this,we,"f")),D(this,we,void 0));break}};let Vs=class extends O{constructor(){super(...arguments),this.steps=new ra(this._client)}create(e,t,n){const{include:s,...o}=t;return this._client.post(b`/threads/${e}/runs`,{query:{include:s},body:o,...n,headers:k([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers]),stream:t.stream??!1})}retrieve(e,t,n){const{thread_id:s}=t;return this._client.get(b`/threads/${s}/runs/${e}`,{...n,headers:k([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,t,n){const{thread_id:s,...o}=t;return this._client.post(b`/threads/${s}/runs/${e}`,{body:o,...n,headers:k([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}list(e,t={},n){return this._client.getAPIList(b`/threads/${e}/runs`,ee,{query:t,...n,headers:k([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}cancel(e,t,n){const{thread_id:s}=t;return this._client.post(b`/threads/${s}/runs/${e}/cancel`,{...n,headers:k([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}async createAndPoll(e,t,n){const s=await this.create(e,t,n);return await this.poll(s.id,{thread_id:e},n)}createAndStream(e,t,n){return kt.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){var o;const s=k([n==null?void 0:n.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((o=n==null?void 0:n.pollIntervalMs)==null?void 0:o.toString())??void 0}]);for(;;){const{data:r,response:a}=await this.retrieve(e,t,{...n,headers:{...n==null?void 0:n.headers,...s}}).withResponse();switch(r.status){case"queued":case"in_progress":case"cancelling":let i=5e3;if(n!=null&&n.pollIntervalMs)i=n.pollIntervalMs;else{const l=a.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(i=c)}}await $t(i);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return r}}}stream(e,t,n){return kt.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n){const{thread_id:s,...o}=t;return this._client.post(b`/threads/${s}/runs/${e}/submit_tool_outputs`,{body:o,...n,headers:k([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers]),stream:t.stream??!1})}async submitToolOutputsAndPoll(e,t,n){const s=await this.submitToolOutputs(e,t,n);return await this.poll(s.id,t,n)}submitToolOutputsStream(e,t,n){return kt.createToolAssistantStream(e,this._client.beta.threads.runs,t,n)}};Vs.Steps=ra;class Mn extends O{constructor(){super(...arguments),this.runs=new Vs(this._client),this.messages=new oa(this._client)}create(t={},n){return this._client.post("/threads",{body:t,...n,headers:k([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(t,n){return this._client.get(b`/threads/${t}`,{...n,headers:k([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(t,n,s){return this._client.post(b`/threads/${t}`,{body:n,...s,headers:k([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}delete(t,n){return this._client.delete(b`/threads/${t}`,{...n,headers:k([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}createAndRun(t,n){return this._client.post("/threads/runs",{body:t,...n,headers:k([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers]),stream:t.stream??!1})}async createAndRunPoll(t,n){const s=await this.createAndRun(t,n);return await this.runs.poll(s.id,{thread_id:s.thread_id},n)}createAndRunStream(t,n){return kt.createThreadAssistantStream(t,this._client.beta.threads,n)}}Mn.Runs=Vs;Mn.Messages=oa;class at extends O{constructor(){super(...arguments),this.realtime=new kn(this._client),this.chatkit=new An(this._client),this.assistants=new Zr(this._client),this.threads=new Mn(this._client)}}at.Realtime=kn;at.ChatKit=An;at.Assistants=Zr;at.Threads=Mn;class aa extends O{create(t,n){return this._client.post("/completions",{body:t,...n,stream:t.stream??!1})}}class ia extends O{retrieve(t,n,s){const{container_id:o}=n;return this._client.get(b`/containers/${o}/files/${t}/content`,{...s,headers:k([{Accept:"application/binary"},s==null?void 0:s.headers]),__binaryResponse:!0})}}let Ds=class extends O{constructor(){super(...arguments),this.content=new ia(this._client)}create(e,t,n){return this._client.post(b`/containers/${e}/files`,Xe({body:t,...n},this._client))}retrieve(e,t,n){const{container_id:s}=t;return this._client.get(b`/containers/${s}/files/${e}`,n)}list(e,t={},n){return this._client.getAPIList(b`/containers/${e}/files`,ee,{query:t,...n})}delete(e,t,n){const{container_id:s}=t;return this._client.delete(b`/containers/${s}/files/${e}`,{...n,headers:k([{Accept:"*/*"},n==null?void 0:n.headers])})}};Ds.Content=ia;class Ls extends O{constructor(){super(...arguments),this.files=new Ds(this._client)}create(t,n){return this._client.post("/containers",{body:t,...n})}retrieve(t,n){return this._client.get(b`/containers/${t}`,n)}list(t={},n){return this._client.getAPIList("/containers",ee,{query:t,...n})}delete(t,n){return this._client.delete(b`/containers/${t}`,{...n,headers:k([{Accept:"*/*"},n==null?void 0:n.headers])})}}Ls.Files=Ds;class la extends O{create(t,n,s){const{include:o,...r}=n;return this._client.post(b`/conversations/${t}/items`,{query:{include:o},body:r,...s})}retrieve(t,n,s){const{conversation_id:o,...r}=n;return this._client.get(b`/conversations/${o}/items/${t}`,{query:r,...s})}list(t,n={},s){return this._client.getAPIList(b`/conversations/${t}/items`,fn,{query:n,...s})}delete(t,n,s){const{conversation_id:o}=n;return this._client.delete(b`/conversations/${o}/items/${t}`,s)}}class Ts extends O{constructor(){super(...arguments),this.items=new la(this._client)}create(t={},n){return this._client.post("/conversations",{body:t,...n})}retrieve(t,n){return this._client.get(b`/conversations/${t}`,n)}update(t,n,s){return this._client.post(b`/conversations/${t}`,{body:n,...s})}delete(t,n){return this._client.delete(b`/conversations/${t}`,n)}}Ts.Items=la;class ua extends O{create(t,n){const s=!!t.encoding_format;let o=s?t.encoding_format:"base64";s&&ie(this._client).debug("embeddings/user defined encoding_format:",t.encoding_format);const r=this._client.post("/embeddings",{body:{...t,encoding_format:o},...n});return s?r:(ie(this._client).debug("embeddings/decoding base64 embeddings from base64"),r._thenUnwrap(a=>(a&&a.data&&a.data.forEach(i=>{const l=i.embedding;i.embedding=Au(l)}),a)))}}class ca extends O{retrieve(t,n,s){const{eval_id:o,run_id:r}=n;return this._client.get(b`/evals/${o}/runs/${r}/output_items/${t}`,s)}list(t,n,s){const{eval_id:o,...r}=n;return this._client.getAPIList(b`/evals/${o}/runs/${t}/output_items`,ee,{query:r,...s})}}class js extends O{constructor(){super(...arguments),this.outputItems=new ca(this._client)}create(t,n,s){return this._client.post(b`/evals/${t}/runs`,{body:n,...s})}retrieve(t,n,s){const{eval_id:o}=n;return this._client.get(b`/evals/${o}/runs/${t}`,s)}list(t,n={},s){return this._client.getAPIList(b`/evals/${t}/runs`,ee,{query:n,...s})}delete(t,n,s){const{eval_id:o}=n;return this._client.delete(b`/evals/${o}/runs/${t}`,s)}cancel(t,n,s){const{eval_id:o}=n;return this._client.post(b`/evals/${o}/runs/${t}`,s)}}js.OutputItems=ca;class qs extends O{constructor(){super(...arguments),this.runs=new js(this._client)}create(t,n){return this._client.post("/evals",{body:t,...n})}retrieve(t,n){return this._client.get(b`/evals/${t}`,n)}update(t,n,s){return this._client.post(b`/evals/${t}`,{body:n,...s})}list(t={},n){return this._client.getAPIList("/evals",ee,{query:t,...n})}delete(t,n){return this._client.delete(b`/evals/${t}`,n)}}qs.Runs=js;let da=class extends O{create(e,t){return this._client.post("/files",Xe({body:e,...t},this._client))}retrieve(e,t){return this._client.get(b`/files/${e}`,t)}list(e={},t){return this._client.getAPIList("/files",ee,{query:e,...t})}delete(e,t){return this._client.delete(b`/files/${e}`,t)}content(e,t){return this._client.get(b`/files/${e}/content`,{...t,headers:k([{Accept:"application/binary"},t==null?void 0:t.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:n=1800*1e3}={}){const s=new Set(["processed","error","deleted"]),o=Date.now();let r=await this.retrieve(e);for(;!r.status||!s.has(r.status);)if(await $t(t),r=await this.retrieve(e),Date.now()-o>n)throw new Rs({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return r}};class ha extends O{}let pa=class extends O{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...t})}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...t})}};class Ns extends O{constructor(){super(...arguments),this.graders=new pa(this._client)}}Ns.Graders=pa;class fa extends O{create(t,n,s){return this._client.getAPIList(b`/fine_tuning/checkpoints/${t}/permissions`,In,{body:n,method:"post",...s})}retrieve(t,n={},s){return this._client.get(b`/fine_tuning/checkpoints/${t}/permissions`,{query:n,...s})}delete(t,n,s){const{fine_tuned_model_checkpoint:o}=n;return this._client.delete(b`/fine_tuning/checkpoints/${o}/permissions/${t}`,s)}}let Bs=class extends O{constructor(){super(...arguments),this.permissions=new fa(this._client)}};Bs.Permissions=fa;class ga extends O{list(t,n={},s){return this._client.getAPIList(b`/fine_tuning/jobs/${t}/checkpoints`,ee,{query:n,...s})}}class Hs extends O{constructor(){super(...arguments),this.checkpoints=new ga(this._client)}create(t,n){return this._client.post("/fine_tuning/jobs",{body:t,...n})}retrieve(t,n){return this._client.get(b`/fine_tuning/jobs/${t}`,n)}list(t={},n){return this._client.getAPIList("/fine_tuning/jobs",ee,{query:t,...n})}cancel(t,n){return this._client.post(b`/fine_tuning/jobs/${t}/cancel`,n)}listEvents(t,n={},s){return this._client.getAPIList(b`/fine_tuning/jobs/${t}/events`,ee,{query:n,...s})}pause(t,n){return this._client.post(b`/fine_tuning/jobs/${t}/pause`,n)}resume(t,n){return this._client.post(b`/fine_tuning/jobs/${t}/resume`,n)}}Hs.Checkpoints=ga;class it extends O{constructor(){super(...arguments),this.methods=new ha(this._client),this.jobs=new Hs(this._client),this.checkpoints=new Bs(this._client),this.alpha=new Ns(this._client)}}it.Methods=ha;it.Jobs=Hs;it.Checkpoints=Bs;it.Alpha=Ns;class ma extends O{}class zs extends O{constructor(){super(...arguments),this.graderModels=new ma(this._client)}}zs.GraderModels=ma;class ya extends O{createVariation(t,n){return this._client.post("/images/variations",Xe({body:t,...n},this._client))}edit(t,n){return this._client.post("/images/edits",Xe({body:t,...n,stream:t.stream??!1},this._client))}generate(t,n){return this._client.post("/images/generations",{body:t,...n,stream:t.stream??!1})}}class ba extends O{retrieve(t,n){return this._client.get(b`/models/${t}`,n)}list(t){return this._client.getAPIList("/models",In,t)}delete(t,n){return this._client.delete(b`/models/${t}`,n)}}class wa extends O{create(t,n){return this._client.post("/moderations",{body:t,...n})}}class va extends O{accept(t,n,s){return this._client.post(b`/realtime/calls/${t}/accept`,{body:n,...s,headers:k([{Accept:"*/*"},s==null?void 0:s.headers])})}hangup(t,n){return this._client.post(b`/realtime/calls/${t}/hangup`,{...n,headers:k([{Accept:"*/*"},n==null?void 0:n.headers])})}refer(t,n,s){return this._client.post(b`/realtime/calls/${t}/refer`,{body:n,...s,headers:k([{Accept:"*/*"},s==null?void 0:s.headers])})}reject(t,n={},s){return this._client.post(b`/realtime/calls/${t}/reject`,{body:n,...s,headers:k([{Accept:"*/*"},s==null?void 0:s.headers])})}}class _a extends O{create(t,n){return this._client.post("/realtime/client_secrets",{body:t,...n})}}class Pn extends O{constructor(){super(...arguments),this.clientSecrets=new _a(this._client),this.calls=new va(this._client)}}Pn.ClientSecrets=_a;Pn.Calls=va;function Mu(e,t){return!t||!Ou(t)?{...e,output_parsed:null,output:e.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(s=>({...s,parsed:null}))}:n)}:Sa(e,t)}function Sa(e,t){const n=e.output.map(o=>{if(o.type==="function_call")return{...o,parsed_arguments:Eu(t,o)};if(o.type==="message"){const r=o.content.map(a=>a.type==="output_text"?{...a,parsed:Pu(t,a.text)}:a);return{...o,content:r}}return o}),s=Object.assign({},e,{output:n});return Object.getOwnPropertyDescriptor(e,"output_text")||vs(s),Object.defineProperty(s,"output_parsed",{enumerable:!0,get(){for(const o of s.output)if(o.type==="message"){for(const r of o.content)if(r.type==="output_text"&&r.parsed!==null)return r.parsed}return null}}),s}function Pu(e,t){var n,s,o,r;return((s=(n=e.text)==null?void 0:n.format)==null?void 0:s.type)!=="json_schema"?null:"$parseRaw"in((o=e.text)==null?void 0:o.format)?((r=e.text)==null?void 0:r.format).$parseRaw(t):JSON.parse(t)}function Ou(e){var t;return!!Ms((t=e.text)==null?void 0:t.format)}function $u(e){return(e==null?void 0:e.$brand)==="auto-parseable-tool"}function Fu(e,t){return e.find(n=>n.type==="function"&&n.name===t)}function Eu(e,t){const n=Fu(e.tools??[],t.name);return{...t,...t,parsed_arguments:$u(n)?n.$parseRaw(t.arguments):n!=null&&n.strict?JSON.parse(t.arguments):null}}function vs(e){const t=[];for(const n of e.output)if(n.type==="message")for(const s of n.content)s.type==="output_text"&&t.push(s.text);e.output_text=t.join("")}var et,Gt,Te,Wt,Eo,Vo,Do,Lo;class Us extends Os{constructor(t){super(),et.add(this),Gt.set(this,void 0),Te.set(this,void 0),Wt.set(this,void 0),D(this,Gt,t)}static createResponse(t,n,s){const o=new Us(n);return o._run(()=>o._createOrRetrieveResponse(t,n,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createOrRetrieveResponse(t,n,s){var i;const o=s==null?void 0:s.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort())),g(this,et,"m",Eo).call(this);let r,a=null;"response_id"in n?(r=await t.responses.retrieve(n.response_id,{stream:!0},{...s,signal:this.controller.signal,stream:!0}),a=n.starting_after??null):r=await t.responses.create({...n,stream:!0},{...s,signal:this.controller.signal}),this._connected();for await(const l of r)g(this,et,"m",Vo).call(this,l,a);if((i=r.controller.signal)!=null&&i.aborted)throw new _e;return g(this,et,"m",Do).call(this)}[(Gt=new WeakMap,Te=new WeakMap,Wt=new WeakMap,et=new WeakSet,Eo=function(){this.ended||D(this,Te,void 0)},Vo=function(t,n){if(this.ended)return;const s=(r,a)=>{(n==null||a.sequence_number>n)&&this._emit(r,a)},o=g(this,et,"m",Lo).call(this,t);switch(s("event",t),t.type){case"response.output_text.delta":{const r=o.output[t.output_index];if(!r)throw new $(`missing output at index ${t.output_index}`);if(r.type==="message"){const a=r.content[t.content_index];if(!a)throw new $(`missing content at index ${t.content_index}`);if(a.type!=="output_text")throw new $(`expected content to be 'output_text', got ${a.type}`);s("response.output_text.delta",{...t,snapshot:a.text})}break}case"response.function_call_arguments.delta":{const r=o.output[t.output_index];if(!r)throw new $(`missing output at index ${t.output_index}`);r.type==="function_call"&&s("response.function_call_arguments.delta",{...t,snapshot:r.arguments});break}default:s(t.type,t);break}},Do=function(){if(this.ended)throw new $("stream has ended, this shouldn't happen");const t=g(this,Te,"f");if(!t)throw new $("request ended without sending any events");D(this,Te,void 0);const n=Vu(t,g(this,Gt,"f"));return D(this,Wt,n),n},Lo=function(t){var s;let n=g(this,Te,"f");if(!n){if(t.type!=="response.created")throw new $(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return n=D(this,Te,t.response),n}switch(t.type){case"response.output_item.added":{n.output.push(t.item);break}case"response.content_part.added":{const o=n.output[t.output_index];if(!o)throw new $(`missing output at index ${t.output_index}`);const r=o.type,a=t.part;r==="message"&&a.type!=="reasoning_text"?o.content.push(a):r==="reasoning"&&a.type==="reasoning_text"&&(o.content||(o.content=[]),o.content.push(a));break}case"response.output_text.delta":{const o=n.output[t.output_index];if(!o)throw new $(`missing output at index ${t.output_index}`);if(o.type==="message"){const r=o.content[t.content_index];if(!r)throw new $(`missing content at index ${t.content_index}`);if(r.type!=="output_text")throw new $(`expected content to be 'output_text', got ${r.type}`);r.text+=t.delta}break}case"response.function_call_arguments.delta":{const o=n.output[t.output_index];if(!o)throw new $(`missing output at index ${t.output_index}`);o.type==="function_call"&&(o.arguments+=t.delta);break}case"response.reasoning_text.delta":{const o=n.output[t.output_index];if(!o)throw new $(`missing output at index ${t.output_index}`);if(o.type==="reasoning"){const r=(s=o.content)==null?void 0:s[t.content_index];if(!r)throw new $(`missing content at index ${t.content_index}`);if(r.type!=="reasoning_text")throw new $(`expected content to be 'reasoning_text', got ${r.type}`);r.text+=t.delta}break}case"response.completed":{D(this,Te,t.response);break}}return n},Symbol.asyncIterator)](){const t=[],n=[];let s=!1;return this.on("event",o=>{const r=n.shift();r?r.resolve(o):t.push(o)}),this.on("end",()=>{s=!0;for(const o of n)o.resolve(void 0);n.length=0}),this.on("abort",o=>{s=!0;for(const r of n)r.reject(o);n.length=0}),this.on("error",o=>{s=!0;for(const r of n)r.reject(o);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((o,r)=>n.push({resolve:o,reject:r})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const t=g(this,Wt,"f");if(!t)throw new $("stream ended without producing a ChatCompletion");return t}}function Vu(e,t){return Mu(e,t)}class xa extends O{list(t,n={},s){return this._client.getAPIList(b`/responses/${t}/input_items`,ee,{query:n,...s})}}class Ca extends O{count(t={},n){return this._client.post("/responses/input_tokens",{body:t,...n})}}class On extends O{constructor(){super(...arguments),this.inputItems=new xa(this._client),this.inputTokens=new Ca(this._client)}create(t,n){return this._client.post("/responses",{body:t,...n,stream:t.stream??!1})._thenUnwrap(s=>("object"in s&&s.object==="response"&&vs(s),s))}retrieve(t,n={},s){return this._client.get(b`/responses/${t}`,{query:n,...s,stream:(n==null?void 0:n.stream)??!1})._thenUnwrap(o=>("object"in o&&o.object==="response"&&vs(o),o))}delete(t,n){return this._client.delete(b`/responses/${t}`,{...n,headers:k([{Accept:"*/*"},n==null?void 0:n.headers])})}parse(t,n){return this._client.responses.create(t,n)._thenUnwrap(s=>Sa(s,t))}stream(t,n){return Us.createResponse(this._client,t,n)}cancel(t,n){return this._client.post(b`/responses/${t}/cancel`,n)}}On.InputItems=xa;On.InputTokens=Ca;class Ra extends O{create(t,n,s){return this._client.post(b`/uploads/${t}/parts`,Xe({body:n,...s},this._client))}}class Gs extends O{constructor(){super(...arguments),this.parts=new Ra(this._client)}create(t,n){return this._client.post("/uploads",{body:t,...n})}cancel(t,n){return this._client.post(b`/uploads/${t}/cancel`,n)}complete(t,n,s){return this._client.post(b`/uploads/${t}/complete`,{body:n,...s})}}Gs.Parts=Ra;const Du=async e=>{const t=await Promise.allSettled(e),n=t.filter(o=>o.status==="rejected");if(n.length){for(const o of n)console.error(o.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const s=[];for(const o of t)o.status==="fulfilled"&&s.push(o.value);return s};class Ia extends O{create(t,n,s){return this._client.post(b`/vector_stores/${t}/file_batches`,{body:n,...s,headers:k([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}retrieve(t,n,s){const{vector_store_id:o}=n;return this._client.get(b`/vector_stores/${o}/file_batches/${t}`,{...s,headers:k([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}cancel(t,n,s){const{vector_store_id:o}=n;return this._client.post(b`/vector_stores/${o}/file_batches/${t}/cancel`,{...s,headers:k([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}async createAndPoll(t,n,s){const o=await this.create(t,n);return await this.poll(t,o.id,s)}listFiles(t,n,s){const{vector_store_id:o,...r}=n;return this._client.getAPIList(b`/vector_stores/${o}/file_batches/${t}/files`,ee,{query:r,...s,headers:k([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}async poll(t,n,s){var r;const o=k([s==null?void 0:s.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((r=s==null?void 0:s.pollIntervalMs)==null?void 0:r.toString())??void 0}]);for(;;){const{data:a,response:i}=await this.retrieve(n,{vector_store_id:t},{...s,headers:o}).withResponse();switch(a.status){case"in_progress":let l=5e3;if(s!=null&&s.pollIntervalMs)l=s.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const f=parseInt(c);isNaN(f)||(l=f)}}await $t(l);break;case"failed":case"cancelled":case"completed":return a}}}async uploadAndPoll(t,{files:n,fileIds:s=[]},o){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const r=(o==null?void 0:o.maxConcurrency)??5,a=Math.min(r,n.length),i=this._client,l=n.values(),c=[...s];async function f(d){for(let u of d){const h=await i.files.create({file:u,purpose:"assistants"},o);c.push(h.id)}}const p=Array(a).fill(l).map(f);return await Du(p),await this.createAndPoll(t,{file_ids:c})}}class ka extends O{create(t,n,s){return this._client.post(b`/vector_stores/${t}/files`,{body:n,...s,headers:k([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}retrieve(t,n,s){const{vector_store_id:o}=n;return this._client.get(b`/vector_stores/${o}/files/${t}`,{...s,headers:k([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}update(t,n,s){const{vector_store_id:o,...r}=n;return this._client.post(b`/vector_stores/${o}/files/${t}`,{body:r,...s,headers:k([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}list(t,n={},s){return this._client.getAPIList(b`/vector_stores/${t}/files`,ee,{query:n,...s,headers:k([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}delete(t,n,s){const{vector_store_id:o}=n;return this._client.delete(b`/vector_stores/${o}/files/${t}`,{...s,headers:k([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}async createAndPoll(t,n,s){const o=await this.create(t,n,s);return await this.poll(t,o.id,s)}async poll(t,n,s){var r;const o=k([s==null?void 0:s.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((r=s==null?void 0:s.pollIntervalMs)==null?void 0:r.toString())??void 0}]);for(;;){const a=await this.retrieve(n,{vector_store_id:t},{...s,headers:o}).withResponse(),i=a.data;switch(i.status){case"in_progress":let l=5e3;if(s!=null&&s.pollIntervalMs)l=s.pollIntervalMs;else{const c=a.response.headers.get("openai-poll-after-ms");if(c){const f=parseInt(c);isNaN(f)||(l=f)}}await $t(l);break;case"failed":case"completed":return i}}}async upload(t,n,s){const o=await this._client.files.create({file:n,purpose:"assistants"},s);return this.create(t,{file_id:o.id},s)}async uploadAndPoll(t,n,s){const o=await this.upload(t,n,s);return await this.poll(t,o.id,s)}content(t,n,s){const{vector_store_id:o}=n;return this._client.getAPIList(b`/vector_stores/${o}/files/${t}/content`,In,{...s,headers:k([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}class $n extends O{constructor(){super(...arguments),this.files=new ka(this._client),this.fileBatches=new Ia(this._client)}create(t,n){return this._client.post("/vector_stores",{body:t,...n,headers:k([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(t,n){return this._client.get(b`/vector_stores/${t}`,{...n,headers:k([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(t,n,s){return this._client.post(b`/vector_stores/${t}`,{body:n,...s,headers:k([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}list(t={},n){return this._client.getAPIList("/vector_stores",ee,{query:t,...n,headers:k([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(t,n){return this._client.delete(b`/vector_stores/${t}`,{...n,headers:k([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}search(t,n,s){return this._client.getAPIList(b`/vector_stores/${t}/search`,In,{body:n,method:"post",...s,headers:k([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}$n.Files=ka;$n.FileBatches=Ia;class Aa extends O{create(t,n){return this._client.post("/videos",So({body:t,...n},this._client))}retrieve(t,n){return this._client.get(b`/videos/${t}`,n)}list(t={},n){return this._client.getAPIList("/videos",fn,{query:t,...n})}delete(t,n){return this._client.delete(b`/videos/${t}`,n)}downloadContent(t,n={},s){return this._client.get(b`/videos/${t}/content`,{query:n,...s,headers:k([{Accept:"application/binary"},s==null?void 0:s.headers]),__binaryResponse:!0})}remix(t,n,s){return this._client.post(b`/videos/${t}/remix`,So({body:n,...s},this._client))}}var st,Ma,nn;class Pa extends O{constructor(){super(...arguments),st.add(this)}async unwrap(t,n,s=this._client.webhookSecret,o=300){return await this.verifySignature(t,n,s,o),JSON.parse(t)}async verifySignature(t,n,s=this._client.webhookSecret,o=300){if(typeof crypto>"u"||typeof crypto.subtle.importKey!="function"||typeof crypto.subtle.verify!="function")throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");g(this,st,"m",Ma).call(this,s);const r=k([n]).values,a=g(this,st,"m",nn).call(this,r,"webhook-signature"),i=g(this,st,"m",nn).call(this,r,"webhook-timestamp"),l=g(this,st,"m",nn).call(this,r,"webhook-id"),c=parseInt(i,10);if(isNaN(c))throw new ft("Invalid webhook timestamp format");const f=Math.floor(Date.now()/1e3);if(f-c>o)throw new ft("Webhook timestamp is too old");if(c>f+o)throw new ft("Webhook timestamp is too new");const p=a.split(" ").map(m=>m.startsWith("v1,")?m.substring(3):m),d=s.startsWith("whsec_")?Buffer.from(s.replace("whsec_",""),"base64"):Buffer.from(s,"utf-8"),u=l?`${l}.${i}.${t}`:`${i}.${t}`,h=await crypto.subtle.importKey("raw",d,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(const m of p)try{const y=Buffer.from(m,"base64");if(await crypto.subtle.verify("HMAC",h,y,new TextEncoder().encode(u)))return}catch{continue}throw new ft("The given webhook signature does not match the expected signature")}}st=new WeakSet,Ma=function(e){if(typeof e!="string"||e.length===0)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},nn=function(e,t){if(!e)throw new Error("Headers are required");const n=e.get(t);if(n==null)throw new Error(`Missing required header: ${t}`);return n};var _s,Ws,sn,Oa;class B{constructor({baseURL:t=Ze("OPENAI_BASE_URL"),apiKey:n=Ze("OPENAI_API_KEY"),organization:s=Ze("OPENAI_ORG_ID")??null,project:o=Ze("OPENAI_PROJECT_ID")??null,webhookSecret:r=Ze("OPENAI_WEBHOOK_SECRET")??null,...a}={}){if(_s.add(this),sn.set(this,void 0),this.completions=new aa(this),this.chat=new Es(this),this.embeddings=new ua(this),this.files=new da(this),this.images=new ya(this),this.audio=new Et(this),this.moderations=new wa(this),this.models=new ba(this),this.fineTuning=new it(this),this.graders=new zs(this),this.vectorStores=new $n(this),this.webhooks=new Pa(this),this.beta=new at(this),this.batches=new Yr(this),this.uploads=new Gs(this),this.responses=new On(this),this.realtime=new Pn(this),this.conversations=new Ts(this),this.evals=new qs(this),this.containers=new Ls(this),this.videos=new Aa(this),n===void 0)throw new $("Missing credentials. Please pass an `apiKey`, or set the `OPENAI_API_KEY` environment variable.");const i={apiKey:n,organization:s,project:o,webhookSecret:r,...a,baseURL:t||"https://api.openai.com/v1"};if(!i.dangerouslyAllowBrowser&&Tl())throw new $(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=i.baseURL,this.timeout=i.timeout??Ws.DEFAULT_TIMEOUT,this.logger=i.logger??console;const l="warn";this.logLevel=l,this.logLevel=vo(i.logLevel,"ClientOptions.logLevel",this)??vo(Ze("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??l,this.fetchOptions=i.fetchOptions,this.maxRetries=i.maxRetries??2,this.fetch=i.fetch??Hl(),D(this,sn,Ul),this._options=i,this.apiKey=typeof n=="string"?n:"Missing Key",this.organization=s,this.project=o,this.webhookSecret=r}withOptions(t){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...t})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:n}){}async authHeaders(t){return k([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(t){return Ql(t,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${tt}`}defaultIdempotencyKey(){return`stainless-node-retry-${er()}`}makeStatusError(t,n,s,o){return ce.generate(t,n,s,o)}async _callApiKey(){const t=this._options.apiKey;if(typeof t!="function")return!1;let n;try{n=await t()}catch(s){throw s instanceof $?s:new $(`Failed to get token from 'apiKey' function: ${s.message}`,{cause:s})}if(typeof n!="string"||!n)throw new $(`Expected 'apiKey' function argument to return a string but it returned ${n}`);return this.apiKey=n,!0}buildURL(t,n,s){const o=!g(this,_s,"m",Oa).call(this)&&s||this.baseURL,r=Fl(t)?new URL(t):new URL(o+(o.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),a=this.defaultQuery();return El(a)||(n={...a,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}async prepareOptions(t){await this._callApiKey()}async prepareRequest(t,{url:n,options:s}){}get(t,n){return this.methodRequest("get",t,n)}post(t,n){return this.methodRequest("post",t,n)}patch(t,n){return this.methodRequest("patch",t,n)}put(t,n){return this.methodRequest("put",t,n)}delete(t,n){return this.methodRequest("delete",t,n)}methodRequest(t,n,s){return this.request(Promise.resolve(s).then(o=>({method:t,path:n,...o})))}request(t,n=null){return new Rn(this,this.makeRequest(t,n,void 0))}async makeRequest(t,n,s){var C,S;const o=await t,r=o.maxRetries??this.maxRetries;n==null&&(n=r),await this.prepareOptions(o);const{req:a,url:i,timeout:l}=await this.buildRequest(o,{retryCount:r-n});await this.prepareRequest(a,{url:i,options:o});const c="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),f=s===void 0?"":`, retryOf: ${s}`,p=Date.now();if(ie(this).debug(`[${c}] sending request`,ze({retryOfRequestLogID:s,method:o.method,url:i,options:o,headers:a.headers})),(C=o.signal)==null?void 0:C.aborted)throw new _e;const d=new AbortController,u=await this.fetchWithTimeout(i,a,l,d).catch(us),h=Date.now();if(u instanceof globalThis.Error){const R=`retrying, ${n} attempts remaining`;if((S=o.signal)!=null&&S.aborted)throw new _e;const V=ls(u)||/timed? ?out/i.test(String(u)+("cause"in u?String(u.cause):""));if(n)return ie(this).info(`[${c}] connection ${V?"timed out":"failed"} - ${R}`),ie(this).debug(`[${c}] connection ${V?"timed out":"failed"} (${R})`,ze({retryOfRequestLogID:s,url:i,durationMs:h-p,message:u.message})),this.retryRequest(o,n,s??c);throw ie(this).info(`[${c}] connection ${V?"timed out":"failed"} - error; no more retries left`),ie(this).debug(`[${c}] connection ${V?"timed out":"failed"} (error; no more retries left)`,ze({retryOfRequestLogID:s,url:i,durationMs:h-p,message:u.message})),V?new Rs:new xn({cause:u})}const m=[...u.headers.entries()].filter(([R])=>R==="x-request-id").map(([R,V])=>", "+R+": "+JSON.stringify(V)).join(""),y=`[${c}${f}${m}] ${a.method} ${i} ${u.ok?"succeeded":"failed"} with status ${u.status} in ${h-p}ms`;if(!u.ok){const R=await this.shouldRetry(u);if(n&&R){const G=`retrying, ${n} attempts remaining`;return await zl(u.body),ie(this).info(`${y} - ${G}`),ie(this).debug(`[${c}] response error (${G})`,ze({retryOfRequestLogID:s,url:u.url,status:u.status,headers:u.headers,durationMs:h-p})),this.retryRequest(o,n,s??c,u.headers)}const V=R?"error; no more retries left":"error; not retryable";ie(this).info(`${y} - ${V}`);const z=await u.text().catch(G=>us(G).message),q=Ll(z),K=q?void 0:z;throw ie(this).debug(`[${c}] response error (${V})`,ze({retryOfRequestLogID:s,url:u.url,status:u.status,headers:u.headers,message:K,durationMs:Date.now()-p})),this.makeStatusError(u.status,q,K,u.headers)}return ie(this).info(y),ie(this).debug(`[${c}] response start`,ze({retryOfRequestLogID:s,url:u.url,status:u.status,headers:u.headers,durationMs:h-p})),{response:u,options:o,controller:d,requestLogID:c,retryOfRequestLogID:s,startTime:p}}getAPIList(t,n,s){return this.requestAPIList(n,{method:"get",path:t,...s})}requestAPIList(t,n){const s=this.makeRequest(n,null,void 0);return new au(this,s,t)}async fetchWithTimeout(t,n,s,o){const{signal:r,method:a,...i}=n||{};r&&r.addEventListener("abort",()=>o.abort());const l=setTimeout(()=>o.abort(),s),c=globalThis.ReadableStream&&i.body instanceof globalThis.ReadableStream||typeof i.body=="object"&&i.body!==null&&Symbol.asyncIterator in i.body,f={signal:o.signal,...c?{duplex:"half"}:{},method:"GET",...i};a&&(f.method=a.toUpperCase());try{return await this.fetch.call(void 0,t,f)}finally{clearTimeout(l)}}async shouldRetry(t){const n=t.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,n,s,o){let r;const a=o==null?void 0:o.get("retry-after-ms");if(a){const l=parseFloat(a);Number.isNaN(l)||(r=l)}const i=o==null?void 0:o.get("retry-after");if(i&&!r){const l=parseFloat(i);Number.isNaN(l)?r=Date.parse(i)-Date.now():r=l*1e3}if(!(r&&0<=r&&r<60*1e3)){const l=t.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(n,l)}return await $t(r),this.makeRequest(t,n-1,s)}calculateDefaultRetryTimeoutMillis(t,n){const s=n-t,o=Math.min(.5*Math.pow(2,s),8),r=1-Math.random()*.25;return o*r*1e3}async buildRequest(t,{retryCount:n=0}={}){const s={...t},{method:o,path:r,query:a,defaultBaseURL:i}=s,l=this.buildURL(r,a,i);"timeout"in s&&Dl("timeout",s.timeout),s.timeout=s.timeout??this.timeout;const{bodyHeaders:c,body:f}=this.buildBody({options:s}),p=await this.buildHeaders({options:t,method:o,bodyHeaders:c,retryCount:n});return{req:{method:o,headers:p,...s.signal&&{signal:s.signal},...globalThis.ReadableStream&&f instanceof globalThis.ReadableStream&&{duplex:"half"},...f&&{body:f},...this.fetchOptions??{},...s.fetchOptions??{}},url:l,timeout:s.timeout}}async buildHeaders({options:t,method:n,bodyHeaders:s,retryCount:o}){let r={};this.idempotencyHeader&&n!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),r[this.idempotencyHeader]=t.idempotencyKey);const a=k([r,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(o),...t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{},...Bl(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(t),this._options.defaultHeaders,s,t.headers]);return this.validateHeaders(a),a.values}buildBody({options:{body:t,headers:n}}){if(!t)return{bodyHeaders:void 0,body:void 0};const s=k([n]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||typeof t=="string"&&s.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:typeof t=="object"&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&typeof t.next=="function")?{bodyHeaders:void 0,body:pr(t)}:g(this,sn,"f").call(this,{body:t,headers:s})}}Ws=B,sn=new WeakMap,_s=new WeakSet,Oa=function(){return this.baseURL!=="https://api.openai.com/v1"};B.OpenAI=Ws;B.DEFAULT_TIMEOUT=6e5;B.OpenAIError=$;B.APIError=ce;B.APIConnectionError=xn;B.APIConnectionTimeoutError=Rs;B.APIUserAbortError=_e;B.NotFoundError=or;B.ConflictError=rr;B.RateLimitError=ir;B.BadRequestError=tr;B.AuthenticationError=nr;B.InternalServerError=lr;B.PermissionDeniedError=sr;B.UnprocessableEntityError=ar;B.InvalidWebhookSignatureError=ft;B.toFile=du;B.Completions=aa;B.Chat=Es;B.Embeddings=ua;B.Files=da;B.Images=ya;B.Audio=Et;B.Moderations=wa;B.Models=ba;B.FineTuning=it;B.Graders=zs;B.VectorStores=$n;B.Webhooks=Pa;B.Beta=at;B.Batches=Yr;B.Uploads=Gs;B.Responses=On;B.Realtime=Pn;B.Conversations=Ts;B.Evals=qs;B.Containers=Ls;B.Videos=Aa;const Lu=Be({__name:"filter-operator",props:Je({options:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=ge(e,"modelValue");return(n,s)=>(w(),P(Bo,null,{default:v(()=>[x(qo,{"as-child":""},{default:v(()=>[x(Ae,{variant:"outline",size:"sm"},{default:v(()=>{var o;return[ae(U((o=e.options.find(r=>r.value===t.value))==null?void 0:o.label),1)]}),_:1})]),_:1}),x(No,{align:"start"},{default:v(()=>[x(xi,{modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=o=>t.value=o)},{default:v(()=>[(w(!0),H(X,null,ue(e.options,o=>(w(),P(Ci,{key:o.value,value:o.value},{default:v(()=>[ae(U(o.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}))}}),ts=Be({inheritAttrs:!1,__name:"filter-input",props:Je({class:{},prefix:{},suffix:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=ge(e,"modelValue");return(n,s)=>(w(),P(zo,{class:rt(A(ns)("h-8 w-fit",e.class))},{default:v(()=>[e.prefix?(w(),P(on,{key:0,align:"inline-start"},{default:v(()=>[(w(),P(Ee(e.prefix)))]),_:1})):W("",!0),x(Ho,Kt({modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=o=>t.value=o)},n.$attrs),null,16,["modelValue"]),e.suffix?(w(),P(on,{key:1,align:"inline-end"},{default:v(()=>[(w(),P(Ee(e.suffix)))]),_:1})):W("",!0)]),_:1},8,["class"]))}}),Tu={key:0,class:"[&>*:not([class*='bg-'])]:bg-background *:ring-background flex items-center -space-x-0.5 *:ring-1 [&>*:not([class*='rounded-'])]:rounded-full"},ju=Be({__name:"filter-select-options-popover",props:Je({definition:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const{t}=Ot(),n=ge(e,"modelValue"),s=se(()=>e.definition.type==="multiselect"),o=se(()=>n.value===void 0?[]:Array.isArray(n.value)?n.value:[n.value]),r=se(()=>e.definition.options.filter(f=>o.value.includes(f.value))),a=se(()=>e.definition.hideValueIcon?[]:r.value.filter(f=>f.icon)),i=se(()=>e.definition.options.filter(f=>!o.value.includes(f.value)));function l(f){s.value?n.value=o.value.filter(p=>p!==f):n.value=void 0}function c(f){s.value?n.value=[...o.value,f]:n.value=f}return(f,p)=>(w(),P(hn,null,{default:v(()=>[x(rn,{"as-child":""},{default:v(()=>[x(Ae,{variant:"outline",size:"sm"},{default:v(()=>{var d;return[a.value.length?(w(),H("div",Tu,[(w(!0),H(X,null,ue(a.value.slice(0,3),u=>(w(),P(Ee(u.icon),{key:String(u.value)}))),128))])):W("",!0),Z("span",null,[r.value.length===1?(w(),H(X,{key:0},[ae(U((d=r.value[0])==null?void 0:d.label),1)],64)):(w(),H(X,{key:1},[ae(U(A(t)("filters.selected",{count:r.value.length})),1)],64))])]}),_:1})]),_:1}),x(an,{align:"start",class:"w-[200px] p-0"},{default:v(()=>[x(ln,null,{default:v(()=>[x(un,{placeholder:e.definition.label},null,8,["placeholder"]),x(cn,null,{default:v(()=>[x(dn,null,{default:v(()=>[ae(U(A(t)("filters.noResults")),1)]),_:1}),r.value.length?(w(),P(At,{key:0},{default:v(()=>[(w(!0),H(X,null,ue(r.value,d=>(w(),P(Mt,{key:String(d.value),value:d.label,onSelect:()=>l(d.value)},{default:v(()=>[d.icon?(w(),P(Ee(d.icon),{key:0})):W("",!0),Z("span",null,U(d.label),1),x(A(jo),{class:"ml-auto"})]),_:2},1032,["value","onSelect"]))),128))]),_:1})):W("",!0),r.value.length&&i.value.length?(w(),P(Ii,{key:1})):W("",!0),i.value.length?(w(),P(At,{key:2},{default:v(()=>[(w(!0),H(X,null,ue(i.value,d=>(w(),P(Mt,{key:String(d.value),value:d.label,onSelect:()=>c(d.value)},{default:v(()=>[d.icon?(w(),P(Ee(d.icon),{key:0})):W("",!0),Z("span",null,U(d.label),1)]),_:2},1032,["value","onSelect"]))),128))]),_:1})):W("",!0)]),_:1})]),_:1})]),_:1})]),_:1}))}}),qu={key:0,class:"flex h-8 items-center justify-center rounded-md border px-3"},Nu={class:"flex h-8 items-center justify-center border px-3 text-sm font-medium"},Bu=Be({__name:"filter-value-selector",props:Je({definition:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const{t}=Ot(),n=ge(e,"modelValue"),s=se(()=>Array.isArray(n.value)?n.value[0]:n.value),o=se(()=>s.value!==void 0?String(s.value):""),r=se(()=>Array.isArray(n.value)?[String(n.value[0]??""),String(n.value[1]??"")]:["",""]);return(a,i)=>e.definition.type==="boolean"?(w(),H("div",qu,[x(Ri,{"model-value":!!s.value,"onUpdate:modelValue":i[0]||(i[0]=l=>n.value=l)},null,8,["model-value"])])):e.definition.type==="select"||e.definition.type==="multiselect"?(w(),P(ju,{key:1,modelValue:n.value,"onUpdate:modelValue":i[1]||(i[1]=l=>n.value=l),definition:e.definition},null,8,["modelValue","definition"])):e.definition.type==="inputrange"?(w(),H(X,{key:2},[x(ts,Kt(e.definition.inputAttributes,{type:e.definition.inputType,prefix:e.definition.prefix,suffix:e.definition.suffix,placeholder:A(t)("filters.range.min"),"model-value":r.value[0],"onUpdate:modelValue":i[2]||(i[2]=l=>n.value=[l??"",r.value[1]])}),null,16,["type","prefix","suffix","placeholder","model-value"]),Z("div",Nu,U(A(t)("filters.range.to")),1),x(ts,Kt(e.definition.inputAttributes,{type:e.definition.inputType,prefix:e.definition.prefix,suffix:e.definition.suffix,placeholder:A(t)("filters.range.max"),"model-value":r.value[1],"onUpdate:modelValue":i[3]||(i[3]=l=>n.value=[r.value[0],l??""])}),null,16,["type","prefix","suffix","placeholder","model-value"])],64)):e.definition.type==="input"?(w(),P(ts,Kt({key:3},e.definition.inputAttributes,{type:e.definition.inputType,prefix:e.definition.prefix,suffix:e.definition.suffix,"model-value":o.value,"onUpdate:modelValue":i[4]||(i[4]=l=>n.value=l)}),null,16,["type","prefix","suffix","model-value"])):W("",!0)}}),Hu={class:"flex flex-wrap gap-2"},zu={class:"sr-only"},Uu={class:"sr-only"},Gu=Be({__name:"filters",props:Je({definitions:{}},{filters:{required:!0},filtersModifiers:{}}),emits:["update:filters"],setup(e){const{t}=Ot(),n=ge(e,"filters"),s=Ua({}),o=xt(!1),r=se(()=>e.definitions.reduce((u,h)=>(u[h.key]=h,u),{})),a=se(()=>{const u=new Set(n.value.map(h=>h.field).filter(h=>{var m;return!((m=r.value[h])!=null&&m.enableMultipleInstances)}));return e.definitions.filter(h=>h.enableMultipleInstances||!u.has(h.key))}),i=u=>{if(!u.pinned)return!1;const h=r.value[u.field];return(h==null?void 0:h.type)!=="select"&&(h==null?void 0:h.type)!=="multiselect"?!1:u.value===void 0||u.value===null?!0:Array.isArray(u.value)?u.value.length===0:!1},l=(u,h)=>{n.value=n.value.map(m=>m.id!==u?m:{...m,...h})},c=u=>{n.value=n.value.filter(h=>h.id!==u)},f=(u,h)=>{var C;const m=r.value[u.field],y=m.type==="multiselect";l(u.id,{operator:u.operator||((C=m.operators[0])==null?void 0:C.value),value:y?[h]:h}),s[u.id]=!1},p=u=>{var h;if(u.pinned){const m=((h=r.value[u.field])==null?void 0:h.type)==="multiselect";l(u.id,{value:m?[]:void 0})}else c(u.id)},d=u=>{var y,C;let h;u.type==="select"?h=(y=u.options[0])==null?void 0:y.value:u.type==="multiselect"&&(h=u.options[0]?[u.options[0].value]:[]);const m={id:crypto.randomUUID(),field:u.key,operator:((C=u.operators[0])==null?void 0:C.value)??"",value:h};n.value=[...n.value,m],o.value=!1};return(u,h)=>(w(),H("div",Hu,[(w(!0),H(X,null,ue(n.value,m=>(w(),H(X,{key:m.id},[r.value[m.field]&&i(m)?(w(),P(hn,{key:0,open:s[m.id],"onUpdate:open":y=>s[m.id]=y},{default:v(()=>[x(rn,{"as-child":""},{default:v(()=>[x(Ae,{variant:"outline",size:"sm"},{default:v(()=>[r.value[m.field].icon?(w(),P(Ee(r.value[m.field].icon),{key:0})):W("",!0),Z("span",null,U(r.value[m.field].label),1)]),_:2},1024)]),_:2},1024),x(an,{align:"start",class:"w-[200px] p-0"},{default:v(()=>[x(ln,null,{default:v(()=>[x(un,{placeholder:r.value[m.field].label},null,8,["placeholder"]),x(cn,null,{default:v(()=>[x(dn,null,{default:v(()=>[ae(U(A(t)("filters.noResults")),1)]),_:1}),x(At,null,{default:v(()=>[(w(!0),H(X,null,ue(r.value[m.field].options,y=>(w(),P(Mt,{key:String(y.value),value:y.label,onSelect:()=>f(m,y.value)},{default:v(()=>[y.icon?(w(),P(Ee(y.icon),{key:0})):W("",!0),Z("span",null,U(y.label),1)]),_:2},1032,["value","onSelect"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["open","onUpdate:open"])):r.value[m.field]?(w(),P(Si,{key:1},{default:v(()=>[x(bi,{class:"bg-background gap-1.5 px-3 has-[>svg]:px-2.5"},{default:v(()=>[r.value[m.field].icon?(w(),P(Ee(r.value[m.field].icon),{key:0})):W("",!0),Z("span",null,U(r.value[m.field].label),1)]),_:2},1024),r.value[m.field].operators.length?(w(),P(Lu,{key:0,"model-value":m.operator,options:r.value[m.field].operators,"onUpdate:modelValue":y=>l(m.id,{operator:y})},null,8,["model-value","options","onUpdate:modelValue"])):W("",!0),m.hideValue?W("",!0):(w(),P(Bu,{key:1,definition:r.value[m.field],"model-value":m.value,"onUpdate:modelValue":y=>l(m.id,{value:y})},null,8,["definition","model-value","onUpdate:modelValue"])),x(wi,null,{default:v(()=>[x(vi,{"as-child":""},{default:v(()=>[x(Ae,{variant:"outline",size:"icon-sm",onClick:y=>p(m)},{default:v(()=>[x(A(Ga)),Z("span",zu,U(m.pinned?A(t)("filters.clearFilter"):A(t)("filters.removeFilter")),1)]),_:2},1032,["onClick"])]),_:2},1024),x(_i,null,{default:v(()=>[ae(U(m.pinned?A(t)("filters.clearFilter"):A(t)("filters.removeFilter")),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)):W("",!0)],64))),128)),a.value.length?(w(),P(hn,{key:0,open:o.value,"onUpdate:open":h[0]||(h[0]=m=>o.value=m)},{default:v(()=>[x(rn,{"as-child":""},{default:v(()=>[x(Ae,{variant:"outline",size:"icon-sm"},{default:v(()=>[x(A(qi)),Z("span",Uu,U(A(t)("filters.addFilter")),1)]),_:1})]),_:1}),x(an,{align:"start",class:"w-[200px] p-0"},{default:v(()=>[x(ln,null,{default:v(()=>[x(un,{placeholder:A(t)("filters.filterPlaceholder")},null,8,["placeholder"]),x(cn,null,{default:v(()=>[x(dn,null,{default:v(()=>[ae(U(A(t)("filters.noResults")),1)]),_:1}),x(At,null,{default:v(()=>[(w(!0),H(X,null,ue(a.value,m=>(w(),P(Mt,{key:m.key,value:m.label,onSelect:()=>d(m)},{default:v(()=>[m.icon?(w(),P(Ee(m.icon),{key:0})):W("",!0),Z("span",null,U(m.label),1)]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])):W("",!0)]))}}),Wu={class:"flex w-full flex-col gap-3 self-stretch"},Ku={class:"flex flex-wrap justify-between gap-2"},Xu={class:"flex flex-wrap items-center gap-2"},Ju={class:"flex flex-wrap items-center gap-2"},Qu={key:0,class:"bg-muted flex flex-wrap items-center justify-between gap-2 rounded-lg p-1"},Yu={class:"flex flex-wrap items-center gap-2"},Zu={class:"flex flex-wrap items-center gap-2"},ec={key:1,"data-slot":"frame",class:"bg-muted relative flex flex-col rounded-lg"},tc={"data-slot":"frame-panel",class:"relative bg-clip-padding p-1 dark:bg-clip-border"},nc={key:0,class:"flex items-center justify-between gap-2"},sc={class:"min-w-0 flex-1"},oc={key:0,class:"flex items-center justify-between px-4 pt-1 pb-2"},rc={key:0,class:"flex items-center gap-2"},ac={class:"text-muted-foreground shrink-0 text-sm"},ic={class:"flex items-center gap-2"},lc={class:"text-muted-foreground shrink-0 text-sm"},uc={key:0,class:"dark fixed bottom-6 left-1/2 z-50 -translate-x-1/2"},cc={class:"bg-background text-foreground flex flex-wrap items-center justify-center gap-2 rounded-lg p-2 shadow-lg"},mc=Be({__name:"data-table",props:Je({data:{},columns:{},meta:{},loading:{type:Boolean},paginationOptions:{},globalFilterOptions:{},columnFiltersOptions:{},persist:{type:Boolean},persistKey:{}},{columnFilters:{required:!1},columnFiltersModifiers:{},columnVisibility:{required:!1},columnVisibilityModifiers:{},globalFilter:{required:!1},globalFilterModifiers:{},pagination:{required:!1},paginationModifiers:{},rowSelection:{required:!1},rowSelectionModifiers:{},sorting:{required:!1},sortingModifiers:{}}),emits:["update:columnFilters","update:columnVisibility","update:globalFilter","update:pagination","update:rowSelection","update:sorting"],setup(e){const{t}=Ot(),n=Pi(),s=$i(),o="row-selection",r="column-visibility",a=e,i=se(()=>{var E;if(!d.value||!((E=a.paginationOptions)!=null&&E.rowCount))return"";const{pageIndex:_,pageSize:M}=d.value,F=a.paginationOptions.rowCount,I=J.getRowModel().rows.length>0,Q=I?_*M+1:0,L=I?Math.min((_+1)*M,F):0;return t("dataTable.pageInfo",{start:Q,end:L,total:F})}),l=se(()=>{var _;return((_=a.paginationOptions)==null?void 0:_.pageSizeOptions)??[10,20,30,40,50]}),c=ge(e,"columnFilters"),f=ge(e,"columnVisibility"),p=ge(e,"globalFilter"),d=ge(e,"pagination"),u=ge(e,"rowSelection"),h=ge(e,"sorting"),m=xt(p.value??""),y=xt(!1),C=xt(!1),S=a.persist&&a.persistKey?Ea(`mk-datatable-${a.persistKey}`,{}):null;function R(_,M){const F=new Set(M.map(I=>"id"in I?I.id:"accessorKey"in I?I.accessorKey:void 0).filter(Boolean));return Object.fromEntries(Object.entries(_).filter(([I])=>F.has(I)))}function V(_,M){const F=new Set(M.map(I=>I.key));return _.filter(I=>F.has(I.field))}Va(()=>{var M,F;if(!(S!=null&&S.value))return;const _=S.value;if(_.columnVisibility&&f.value!==void 0){const I=R(_.columnVisibility,a.columns);f.value={...I,...f.value}}_.columnFilters&&((M=c.value)==null?void 0:M.length)===0&&((F=a.columnFiltersOptions)!=null&&F.filterDefs)&&(c.value=V(_.columnFilters,a.columnFiltersOptions.filterDefs))}),ht([f,c],([_,M])=>{S&&(S.value={columnVisibility:_,columnFilters:M})},{deep:!0});function z(_){return async(M,F)=>{const I=await _(),Q=new Headers(F==null?void 0:F.headers);return Q.set("X-Proxy-Authorization",`Bearer ${I}`),fetch(M,{...F,headers:Q})}}const q=se(()=>{if(!n.value)return null;const{apiKey:_,getAccessToken:M}=n.value,F=Ai(s.value),I=M?z(M):void 0;return new B({apiKey:_,baseURL:F,dangerouslyAllowBrowser:!0,fetch:I})}),K=se(()=>!!q.value);function G(_){const M={},F=(I,Q)=>Q?`${I} Hint: ${Q}`:I;for(const I of _){const Q=I.operators.map(E=>E.value),L=I.operators.map(E=>`"${E.value}" (${E.label})`).join(", ");switch(I.type){case"select":M[I.key]={type:["object","null"],description:F(`Filter by ${I.label}. Values: ${I.options.map(E=>E.label).join(", ")}. Operators: ${L}.`,I.aiHint),properties:{operator:{type:"string",enum:Q},value:{type:"string",enum:I.options.map(E=>String(E.value))}},required:["operator","value"],additionalProperties:!1};break;case"multiselect":M[I.key]={type:["object","null"],description:F(`Filter by ${I.label}. Values: ${I.options.map(E=>E.label).join(", ")}. Operators: ${L}.`,I.aiHint),properties:{operator:{type:"string",enum:Q},value:{type:"array",items:{type:"string",enum:I.options.map(E=>String(E.value))}}},required:["operator","value"],additionalProperties:!1};break;case"boolean":M[I.key]={type:["object","null"],description:F(`Filter by ${I.label}. Operators: ${L}.`,I.aiHint),properties:{operator:{type:"string",enum:Q},value:{type:"boolean"}},required:["operator","value"],additionalProperties:!1};break;case"input":M[I.key]={type:["object","null"],description:F(`Filter by ${I.label}. Operators: ${L}.`,I.aiHint),properties:{operator:{type:"string",enum:Q},value:{type:"string"}},required:["operator","value"],additionalProperties:!1};break;case"inputrange":M[I.key]={type:["object","null"],description:F(`Filter by ${I.label} range. Operators: ${L}.`,I.aiHint),properties:{operator:{type:"string",enum:Q},value:{type:"object",properties:{min:{type:["string","null"]},max:{type:["string","null"]}},required:["min","max"],additionalProperties:!1}},required:["operator","value"],additionalProperties:!1};break}}return{type:"object",properties:M,required:Object.keys(M),additionalProperties:!1}}async function he(_){var M,F,I;if(!((M=a.columnFiltersOptions)!=null&&M.filterDefs)||!c.value||!q.value)return!1;C.value=!0;try{const Q=a.columnFiltersOptions.filterDefs,L=G(Q),E=(I=(F=(await q.value.chat.completions.create({model:"gpt-4.1-nano",messages:[{role:"system",content:'You are a filter assistant. Extract filter values and operators from user queries. Choose the appropriate operator based on query semantics (e.g., "not" implies negation operators like "is_not" or "is_not_any_of"). Only set filters explicitly mentioned. Set null for filters not mentioned.'},{role:"user",content:_}],response_format:{type:"json_schema",json_schema:{name:"filters",schema:L,strict:!0}}})).choices[0])==null?void 0:F.message)==null?void 0:I.content;if(!E)return!1;const Re=JSON.parse(E),Pe=[];for(const[He,Y]of Object.entries(Re)){if(!Y)continue;const{operator:Oe,value:Se}=Y;Se==null||Se===""||Array.isArray(Se)&&Se.length===0||Pe.push({id:crypto.randomUUID(),field:He,operator:Oe,value:Se})}return Pe.length===0?!1:(c.value=Pe,!0)}catch(Q){return console.error("AI filter processing failed:",Q),!1}finally{C.value=!1}}async function N(){y.value&&m.value.trim()&&await he(m.value)&&(m.value="")}ht(p,_=>{_!==m.value&&(m.value=_??"")}),Da(m,_=>{y.value||(p.value=_)},{debounce:()=>{var _;return((_=a.globalFilterOptions)==null?void 0:_.debounce)??300}}),ht(p,()=>{d.value&&(d.value={...d.value,pageIndex:0})}),ht(c,()=>{d.value&&(d.value={...d.value,pageIndex:0})},{deep:!0});const oe=Ni(),lt=se(()=>u.value===void 0?null:oe.display({id:o,header:({table:_})=>me(no,{modelValue:_.getIsAllRowsSelected()||_.getIsSomeRowsSelected()&&"indeterminate","onUpdate:modelValue":()=>{_.toggleAllRowsSelected(!(_.getIsSomeRowsSelected()||_.getIsAllRowsSelected()))}}),cell:({row:_})=>me(no,{modelValue:_.getIsSelected(),disabled:!_.getCanSelect(),"onUpdate:modelValue":M=>_.toggleSelected(!!M)}),meta:{title:"Row selection",class:{th:"w-8 min-w-8 max-w-8",td:"w-8 min-w-8 max-w-8"}},enableHiding:!1})),Qe=se(()=>f.value===void 0?null:oe.display({id:r,header:()=>me(Bo,()=>[me(qo,{asChild:!0},()=>me(Ae,{variant:"outline",size:"icon-sm",class:"before:bg-background relative before:absolute before:-inset-px before:-z-10 before:rounded-md"},()=>[me(ji),me("span",{class:"sr-only"},t("dataTable.columns.label"))])),me(No,{align:"end",class:"w-64"},()=>{const _=J.getAllColumns().filter(F=>{var I;return F.id!==o&&F.id!==r&&((I=F.columnDef.meta)==null?void 0:I.title)}),M=_.every(F=>F.getIsVisible());return[me("div",{class:"flex items-center justify-between px-2 py-1.5"},[me(Wa,{class:"p-0"},()=>t("dataTable.columns.label")),me(Ae,{variant:"secondary",size:"xs",onClick:()=>{const F={};_.forEach(I=>{I.getCanHide()&&(F[I.id]=!M)}),J.setColumnVisibility(F)}},()=>t(M?"dataTable.columns.hideAll":"dataTable.columns.showAll"))]),..._.map(F=>me(Ka,{key:F.id,modelValue:F.getIsVisible(),disabled:!F.getCanHide(),"onUpdate:modelValue":I=>F.toggleVisibility(!!I),onSelect:I=>I.preventDefault()},()=>{var I;return((I=F.columnDef.meta)==null?void 0:I.title)??""}))]})]),meta:{title:"Column visibility",class:{th:"sticky right-0 w-8 max-w-8 min-w-8 p-0 align-top",td:"w-8 max-w-8 min-w-8"}},enableHiding:!1})),Fn=se(()=>{const _=[...a.columns];return lt.value&&_.unshift(lt.value),Qe.value&&_.push(Qe.value),_}),J=Ol({get data(){return a.data},get columns(){return Fn.value},getCoreRowModel:Al(),manualFiltering:!0,manualPagination:!0,manualSorting:!0,state:{get columnVisibility(){return f.value},get globalFilter(){return p.value},get pagination(){return d.value},get rowSelection(){return u.value},get sorting(){return h.value}},get rowCount(){var _;return(_=a.paginationOptions)==null?void 0:_.rowCount},onColumnVisibilityChange:_=>ut(_,f),onGlobalFilterChange:_=>ut(_,p),onPaginationChange:_=>ut(_,d),onRowSelectionChange:_=>ut(_,u),onSortingChange:_=>ut(_,h)});function ut(_,M){M.value=typeof _=="function"?_(M.value):_}function De(_,M){return typeof _=="function"?_(M):_}const $a=()=>{const _=J.getState().pagination.pageIndex,M=J.getPageCount(),F=[],I=_>2,Q=_<M-3;if(M<=7)return Array.from({length:M},(L,E)=>E);F.push(0),I&&F.push("ellipsis-start");for(let L=Math.max(1,_-1);L<=Math.min(M-2,_+1);L++)F.push(L);return Q&&F.push("ellipsis-end"),M>1&&F.push(M-1),F};return(_,M)=>{var F,I,Q;return w(),H("div",Wu,[Z("div",Ku,[Z("div",Xu,[p.value!==void 0?(w(),P(zo,{key:0},{default:v(()=>{var L,E;return[x(Ho,{modelValue:m.value,"onUpdate:modelValue":M[0]||(M[0]=Re=>m.value=Re),class:"w-72",placeholder:y.value?((L=a.globalFilterOptions)==null?void 0:L.aiSearchPlaceholder)??A(t)("dataTable.aiSearch.placeholder"):A(t)("dataTable.search"),disabled:C.value,onKeydown:La(N,["enter"])},null,8,["modelValue","placeholder","disabled"]),x(on,null,{default:v(()=>[C.value?(w(),P(A(Xa),{key:0,class:"animate-spin"})):y.value?(w(),P(A(ro),{key:1})):(w(),P(A(Ta),{key:2}))]),_:1}),(E=e.columnFiltersOptions)!=null&&E.filterDefs&&K.value?(w(),P(on,{key:0,align:"inline-end"},{default:v(()=>[x(Ja,{variant:y.value?"default":"secondary",disabled:C.value,onClick:M[1]||(M[1]=Re=>y.value=!y.value)},{default:v(()=>[x(A(ro)),ae(" "+U(A(t)("dataTable.aiSearch.toggle")),1)]),_:1},8,["variant","disabled"])]),_:1})):W("",!0)]}),_:1})):W("",!0)]),Z("div",Ju,[Ue(_.$slots,"toolbar")])]),(F=e.columnFiltersOptions)!=null&&F.filterDefs&&c.value!==void 0?(w(),H("div",Qu,[Z("div",Yu,[Ue(_.$slots,"filter-bar-start"),x(Gu,{filters:c.value,"onUpdate:filters":M[2]||(M[2]=L=>c.value=L),definitions:e.columnFiltersOptions.filterDefs},null,8,["filters","definitions"])]),Z("div",Zu,[Ue(_.$slots,"filter-bar-end")])])):W("",!0),e.loading||(I=A(J).getRowModel().rows)!=null&&I.length?(w(),H("div",ec,[Z("div",tc,[x(ei,null,{default:v(()=>[x(Qa,{class:"in-data-[slot=frame]:**:[th]:h-8 in-data-[slot=frame]:**:[th]:pb-1 *:[tr]:*:[th]:border-transparent *:[tr]:*:[th]:first:border-s *:[tr]:*:[th]:last:border-e"},{default:v(()=>[(w(!0),H(X,null,ue(A(J).getHeaderGroups(),L=>(w(),P(Vn,{key:L.id},{default:v(()=>[(w(!0),H(X,null,ue(L.headers,E=>{var Re,Pe,He,Y;return w(),P(Ya,{key:E.id,colspan:E.colSpan>1?E.colSpan:void 0,rowspan:E.rowSpan>1?E.rowSpan:void 0,class:rt(De((Pe=(Re=E.column.columnDef.meta)==null?void 0:Re.class)==null?void 0:Pe.th,E)),style:En(De((Y=(He=E.column.columnDef.meta)==null?void 0:He.style)==null?void 0:Y.th,E))},{default:v(()=>[E.isPlaceholder?W("",!0):(w(),H(X,{key:0},[h.value!==void 0&&E.column.getCanSort()?(w(),P(Ae,{key:0,size:"sm",variant:"ghost",class:"group -ml-2.5",onClick:Oe=>{var Se;return(Se=E.column.getToggleSortingHandler())==null?void 0:Se(Oe)}},{default:v(()=>{var Oe;return[ae(U(((Oe=E.column.columnDef.meta)==null?void 0:Oe.title)??"")+" ",1),E.column.getIsSorted()==="asc"?(w(),P(A(Di),{key:0,class:"size-3.5"})):E.column.getIsSorted()==="desc"?(w(),P(A(Fi),{key:1,class:"size-3.5"})):(w(),P(A(Ei),{key:2,class:"size-3.5 opacity-0 transition-opacity group-hover:opacity-100"}))]}),_:2},1032,["onClick"])):(w(),P(A(Gn),{key:1,render:E.column.columnDef.header,props:E.getContext()},null,8,["render","props"]))],64))]),_:2},1032,["colspan","rowspan","class","style"])}),128))]),_:2},1024))),128))]),_:1}),x(Za,{class:"in-data-[slot=frame]:*:[tr]:data-[state=selected]:*:[td]:bg-[color-mix(in_srgb,white_95%,var(--color-primary))]"},{default:v(()=>[e.loading?(w(),H(X,{key:0},ue(3,L=>x(Vn,{key:L},{default:v(()=>[(w(!0),H(X,null,ue(A(J).getVisibleLeafColumns(),E=>(w(),P(so,{key:E.id},{default:v(()=>[E.id!==o&&E.id!==r?(w(),P(Dn,{key:0,class:"h-6 w-full"})):W("",!0)]),_:2},1024))),128))]),_:1})),64)):(w(!0),H(X,{key:1},ue(A(J).getRowModel().rows,L=>{var E,Re,Pe,He;return w(),P(Vn,{key:L.id,class:rt(["group",De((Re=(E=A(J).options.meta)==null?void 0:E.class)==null?void 0:Re.tr,L)]),style:En(De((He=(Pe=A(J).options.meta)==null?void 0:Pe.style)==null?void 0:He.tr,L)),"data-state":L.getIsSelected()&&"selected"},{default:v(()=>[(w(!0),H(X,null,ue(L.getVisibleCells(),Y=>{var Oe,Se,Ks,Xs,Js,Qs,Ys,Zs;return w(),P(so,{key:Y.id,class:rt(De((Se=(Oe=Y.column.columnDef.meta)==null?void 0:Oe.class)==null?void 0:Se.td,Y)),style:En(De((Xs=(Ks=Y.column.columnDef.meta)==null?void 0:Ks.style)==null?void 0:Xs.td,Y)),colspan:De((Qs=(Js=Y.column.columnDef.meta)==null?void 0:Js.colspan)==null?void 0:Qs.td,Y),rowspan:De((Zs=(Ys=Y.column.columnDef.meta)==null?void 0:Ys.rowspan)==null?void 0:Zs.td,Y)},{default:v(()=>{var eo;return[(eo=Y.column.columnDef.meta)!=null&&eo.onOpen?(w(),H("div",nc,[Z("div",sc,[x(A(Gn),{render:Y.column.columnDef.cell,props:Y.getContext()},null,8,["render","props"])]),x(Ae,{size:"sm",variant:"outline",class:"opacity-0 transition-opacity group-hover:opacity-100",onClick:ja(pc=>{var to;return(to=Y.column.columnDef.meta)==null?void 0:to.onOpen(Y.row)},["stop"])},{default:v(()=>[x(A(Vi)),ae(" "+U(A(t)("dataTable.open")),1)]),_:1},8,["onClick"])])):(w(),P(A(Gn),{key:1,render:Y.column.columnDef.cell,props:Y.getContext()},null,8,["render","props"]))]}),_:2},1032,["class","style","colspan","rowspan"])}),128))]),_:2},1032,["class","style","data-state"])}),128))]),_:1})]),_:1})]),d.value!==void 0&&((Q=e.paginationOptions)==null?void 0:Q.rowCount)!==void 0?(w(),H("footer",oc,[l.value.length>0?(w(),H("div",rc,[Z("span",ac,U(A(t)("dataTable.itemsPerPage")),1),x(ri,{disabled:e.loading,"model-value":A(J).getState().pagination.pageSize.toString(),"onUpdate:modelValue":M[3]||(M[3]=L=>L&&A(J).setPageSize(Number(L)))},{default:v(()=>[x(ti,{class:"bg-background"},{default:v(()=>[x(ni)]),_:1}),x(si,null,{default:v(()=>[(w(!0),H(X,null,ue(l.value,L=>(w(),P(oi,{key:L,value:L.toString()},{default:v(()=>[ae(U(L),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["disabled","model-value"])])):W("",!0),Z("div",ic,[Z("span",lc,[e.loading?(w(),P(Dn,{key:0,class:"h-5 w-24"})):(w(),H(X,{key:1},[ae(U(i.value),1)],64))]),x(di,null,{default:v(()=>[x(ai,null,{default:v(()=>[x(Vt,null,{default:v(()=>[x(ii,{class:"size-9 p-0 *:[span]:sr-only",disabled:e.loading||!A(J).getCanPreviousPage(),onClick:M[4]||(M[4]=L=>A(J).previousPage())},null,8,["disabled"])]),_:1}),e.loading?(w(),H(X,{key:0},ue(3,L=>x(Vt,{key:L},{default:v(()=>[x(Dn,{class:"size-9"})]),_:1})),64)):(w(!0),H(X,{key:1},ue($a(),L=>(w(),P(Vt,{key:L},{default:v(()=>[typeof L=="number"?(w(),P(li,{key:0,"is-active":A(J).getState().pagination.pageIndex===L,onClick:E=>A(J).setPageIndex(L)},{default:v(()=>[ae(U(L+1),1)]),_:2},1032,["is-active","onClick"])):(w(),P(ui,{key:1}))]),_:2},1024))),128)),x(Vt,null,{default:v(()=>[x(ci,{class:"size-9 p-0 *:[span]:sr-only",disabled:e.loading||!A(J).getCanNextPage(),onClick:M[5]||(M[5]=L=>A(J).nextPage())},null,8,["disabled"])]),_:1})]),_:1})]),_:1})])])):W("",!0)])):Ue(_.$slots,"empty-state",{key:2},()=>[x(mi,{class:"border"},{default:v(()=>[x(hi,null,{default:v(()=>[x(pi,{variant:"icon"},{default:v(()=>[x(A(Li))]),_:1}),x(fi,null,{default:v(()=>[ae(U(A(t)("dataTable.empty.title")),1)]),_:1}),x(gi,null,{default:v(()=>[ae(U(A(t)("dataTable.empty.description")),1)]),_:1})]),_:1})]),_:1})]),(w(),P(Na,{to:"body"},[x(qa,{"enter-active-class":"animate-in slide-in-from-bottom-2 fade-in-0 zoom-in-95","leave-active-class":"animate-out fade-out-0 zoom-out-95"},{default:v(()=>[u.value!==void 0&&Object.keys(u.value).length?(w(),H("div",uc,[Z("div",cc,[Ue(_.$slots,"batch-action-bar")])])):W("",!0)]),_:3})]))])}}}),dc={key:0,class:"truncate"},hc={key:1,class:"text-muted-foreground"},yc=Be({__name:"select-menu",props:Je({items:{},placeholder:{},disabled:{type:Boolean},multiple:{type:Boolean},loading:{type:Boolean},searchInput:{type:Boolean,default:!0},labelKey:{default:"label"},valueKey:{},ignoreFilter:{type:Boolean},class:{}},{modelValue:{type:[String,Number,Object,null,Boolean,Array]},modelModifiers:{},searchTerm:{default:""},searchTermModifiers:{},open:{type:Boolean,default:!1},openModifiers:{}}),emits:["update:modelValue","update:searchTerm","update:open"],setup(e){const{t}=Ot(),n=ge(e,"modelValue"),s=ge(e,"searchTerm"),o=ge(e,"open");function r(d){return typeof d=="object"&&d!==null}function a(d){return r(d)?String(oo(d,e.labelKey)??d.label??d.value??""):String(d)}function i(d){return r(d)?e.valueKey?oo(d,e.valueKey):d.value??a(d):d}function l(d){return(e.items??[]).find(u=>{const h=i(u);return e.valueKey?Dt(h,d,e.valueKey):h===d})}function c(d){const u=n.value;if(u==null)return!1;const h=i(d);return e.multiple&&Array.isArray(u)?e.valueKey?u.some(m=>Dt(m,h,e.valueKey)):u.includes(h):e.valueKey?Dt(u,h,e.valueKey):u===h}function f(d){const u=i(d);if(e.multiple){const h=Array.isArray(n.value)?[...n.value]:[],m=e.valueKey?h.findIndex(y=>Dt(y,u,e.valueKey)):h.indexOf(u);m>=0?h.splice(m,1):h.push(u),n.value=h}else n.value=u,o.value=!1}const p=se(()=>{const d=n.value;if(d===void 0)return"";if(e.multiple&&Array.isArray(d))return d.length===0?"":d.map(h=>l(h)?a(l(h)):void 0).filter(Boolean).join(", ");const u=l(d);return u?a(u):""});return(d,u)=>(w(),P(hn,{open:o.value,"onUpdate:open":u[1]||(u[1]=h=>o.value=h)},{default:v(()=>[x(rn,{"as-child":""},{default:v(()=>[x(Ae,{variant:"outline",role:"combobox","aria-expanded":o.value,disabled:e.disabled,class:rt(A(ns)("w-full justify-between",e.class))},{default:v(()=>[p.value?(w(),H("span",dc,U(p.value),1)):(w(),H("span",hc,U(e.placeholder??A(t)("selectMenu.placeholder")),1)),e.loading?(w(),P(yi,{key:3})):(w(),P(A(Ti),{key:2,class:"opacity-50"}))]),_:1},8,["aria-expanded","disabled","class"])]),_:1}),x(an,{class:"w-[--reka-popover-trigger-width] p-0"},{default:v(()=>[x(ln,{"ignore-filter":e.ignoreFilter},{default:v(()=>[e.searchInput?(w(),P(un,{key:0,modelValue:s.value,"onUpdate:modelValue":u[0]||(u[0]=h=>s.value=h),placeholder:A(t)("selectMenu.search"),class:"h-9"},null,8,["modelValue","placeholder"])):W("",!0),x(cn,null,{default:v(()=>[x(dn,null,{default:v(()=>[Ue(d.$slots,"empty",{searchTerm:s.value},()=>[ae(U(s.value?A(t)("selectMenu.empty.noResults"):A(t)("selectMenu.empty.noItems")),1)])]),_:3}),x(At,null,{default:v(()=>[(w(!0),H(X,null,ue(e.items,(h,m)=>(w(),P(Mt,{key:m,value:a(h),disabled:r(h)&&h.disabled===!0,onSelect:y=>f(h)},{default:v(()=>[Ue(d.$slots,"item",{item:h,index:m},()=>[ae(U(a(h))+" ",1),x(A(jo),{class:rt(A(ns)("ml-auto",c(h)?"opacity-100":"opacity-0"))},null,8,["class"])])]),_:2},1032,["value","disabled","onSelect"]))),128))]),_:3})]),_:3})]),_:3},8,["ignore-filter"])]),_:3})]),_:3},8,["open"]))}});export{yc as $,mc as R};
