import{e as m,o as p,F as Y,i as ae,n as I,h as r,_ as re,r as h,c as M,H as L,g as w,t as k,l as U,z as te,B as fe,I as _,w as z,J as se,K as f,L as V,m as B,G as me,u as ve,M as xe,k as he,p as R,d as be,j as K}from"./index-HNz1us-X.js";import{u as we}from"./opportunities-CZX_mc_B.js";import{u as Ce,_ as $e}from"./ReassignUserModal-CuLCytMO.js";import{_ as qe}from"./PageHeader-CWgBBom2.js";import{y as Se}from"./components-BRQB_lDP.js";import{g as j,a as W,b as ie}from"./formatters-Br5TsDxy.js";import{u as Ie,_ as ke,a as le}from"./useTaskShell-D6zjr6sp.js";import"./ModalShell-D1HAXo86.js";const Te={class:"flex bg-gray-100 p-1 rounded-lg w-fit"},De=["onClick"],ne={__name:"ViewToggle",props:{view:{type:String,required:!0},options:{type:Array,required:!0,validator:g=>g.every(C=>C.value&&C.icon&&C.label)}},emits:["update:view"],setup(g){return(C,$)=>(p(),m("div",Te,[(p(!0),m(Y,null,ae(g.options,c=>(p(),m("button",{key:c.value,onClick:x=>C.$emit("update:view",c.value),class:I(["p-1.5 rounded-md transition-all duration-200",g.view===c.value?"bg-white shadow-sm text-gray-900":"text-gray-400 hover:text-gray-600"])},[r("i",{class:I([c.icon,"text-base"])},null,2)],10,De))),128))]))}},Ae={class:"bg-white border-r border-gray-200 flex flex-col shrink-0 w-full lg:w-80 h-full"},Me={class:"px-4 md:px-8 py-4 md:py-6 border-b border-gray-100 bg-gray-50/50 shrink-0"},Fe={class:"flex items-center justify-between gap-3"},Ne={class:"flex items-center gap-3"},Oe={class:"page-header-title"},Ve={key:0,class:"hidden lg:flex"},Be={class:"px-5 py-3"},Le={class:"relative"},_e=["placeholder"],Ue=["onClick"],He={key:0,class:"absolute right-2 top-10 w-36 bg-white border border-gray-200 rounded-lg shadow-lg z-50 overflow-hidden"},je={class:"space-y-3"},Ee={class:"space-y-2"},Re={class:"flex items-start gap-3"},Ke={class:"flex-1 min-w-0"},ze={class:"flex items-center justify-between gap-2 mb-0.5"},Pe={class:"font-bold text-gray-900 text-sm leading-tight truncate"},We={class:"text-right shrink-0"},Ye={class:"flex items-center gap-2 mt-1"},Qe={class:"text-gray-600 text-xs truncate flex-1 min-w-0"},Ge=["onClick"],Je={class:"space-y-2"},Xe={class:"flex items-center justify-between gap-3"},Ze={class:"flex items-center gap-1.5 flex-wrap"},et={__name:"TasksList",props:{title:{type:String,required:!0},items:{type:Array,required:!0},selectedId:{type:[Number,String],default:null},selectedClass:{type:[String,Function],default:"bg-white border-2 border-blue-500 shadow-md"},unselectedClass:{type:String,default:"bg-white border border-gray-200 hover:border-blue-300"},searchPlaceholder:{type:String,default:"Search..."},showMenu:{type:Boolean,default:!0},openMenuId:{type:[Number,String],default:null},getName:{type:Function,required:!0},getInitials:{type:Function,required:!0},getVehicleInfo:{type:Function,required:!0},avatarClass:{type:Function,default:()=>"bg-orange-100 text-orange-600"},typeFilter:{type:String,default:"all"},showTypeFilter:{type:Boolean,default:!1},showMobileClose:{type:Boolean,default:!1},viewMode:{type:String,default:"card"}},emits:["select","menu-click","menu-close","filter-change","sort-change","close","view-change"],setup(g,{emit:C}){const $={mounted(o,y){o.clickOutsideEvent=d=>{o===d.target||o.contains(d.target)||y.value()},document.addEventListener("click",o.clickOutsideEvent)},unmounted(o){document.removeEventListener("click",o.clickOutsideEvent)}},c=g,x=h("");h("none");const T=M(()=>{let o=c.items;if(c.typeFilter&&c.typeFilter!=="all"&&(o=o.filter(y=>y.type===c.typeFilter)),x.value){const y=x.value.toLowerCase();o=o.filter(d=>{const b=c.getName(d).toLowerCase(),F=c.getVehicleInfo(d).toLowerCase();return b.includes(y)||F.includes(y)})}return o}),D=o=>{const y=o.compositeId||`${o.type||"task"}-${o.id}`||o.id;return c.selectedId===y},v=h(null),S=h(null);return L(()=>c.selectedId,async o=>{o&&S.value&&(await se(),S.value.scrollIntoView({behavior:"smooth",block:"nearest"}))},{immediate:!0}),L(T,async()=>{c.selectedId&&S.value&&(await se(),setTimeout(()=>{S.value&&S.value.scrollIntoView({behavior:"smooth",block:"nearest"})},100))},{immediate:!0}),(o,y)=>(p(),m("div",Ae,[r("div",Me,[r("div",Fe,[r("div",Ne,[g.showMobileClose?(p(),m("button",{key:0,onClick:y[0]||(y[0]=d=>o.$emit("close")),class:"lg:hidden w-8 h-8 flex items-center justify-center text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"},[...y[3]||(y[3]=[r("i",{class:"fa-solid fa-xmark text-lg"},null,-1)])])):w("",!0),r("h2",Oe,k(g.title),1)]),g.viewMode?(p(),m("div",Ve,[U(ne,{view:g.viewMode,options:[{value:"card",icon:"fa-solid fa-list",label:"Cards"},{value:"table",icon:"fa-solid fa-table",label:"Table"}],"onUpdate:view":y[1]||(y[1]=d=>o.$emit("view-change",d))},null,8,["view"])])):w("",!0)])]),r("div",Be,[r("div",Le,[y[4]||(y[4]=r("i",{class:"fa-solid fa-magnifying-glass absolute left-3 top-2.5 text-gray-400 text-sm"},null,-1)),te(r("input",{"onUpdate:modelValue":y[2]||(y[2]=d=>x.value=d),type:"text",placeholder:g.searchPlaceholder,class:"w-full bg-gray-50 border border-gray-200 rounded-lg pl-9 pr-3 py-2 text-sm"},null,8,_e),[[fe,x.value]])])]),r("div",{ref_key:"scrollContainer",ref:v,class:"flex-1 overflow-y-auto px-4 space-y-4 pb-4 scrollbar-hide"},[(p(!0),m(Y,null,ae(T.value,d=>(p(),m("div",{key:d.id,ref_for:!0,ref:b=>{D(d)&&(S.value=b)},onClick:b=>o.$emit("select",d.compositeId||`${d.type||"task"}-${d.id}`||d.id),class:I(["rounded-lg px-4 py-3 cursor-pointer transition-all relative group",D(d)?typeof g.selectedClass=="function"?g.selectedClass(d):g.selectedClass:typeof g.unselectedClass=="function"?g.unselectedClass(d):g.unselectedClass])},[g.openMenuId===d.id&&g.showMenu?te((p(),m("div",He,[_(o.$slots,"menu",{item:d},void 0,!0)])),[[$,()=>o.$emit("menu-close")]]):w("",!0),r("div",je,[r("div",Ee,[r("div",Re,[r("div",{class:I(["w-9 h-9 rounded-full flex items-center justify-center text-xs font-bold shrink-0",g.avatarClass(d)])},k(g.getInitials(d)),3),r("div",Ke,[r("div",ze,[r("div",Pe,k(g.getName(d)),1),r("div",We,[_(o.$slots,"meta",{item:d},void 0,!0)])]),r("div",Ye,[r("div",Qe,k(g.getVehicleInfo(d)),1),_(o.$slots,"vehicle-type",{item:d},void 0,!0)])]),g.showMenu?(p(),m("button",{key:0,onClick:z(b=>o.$emit("menu-click",d.id),["stop"]),class:"w-7 h-7 flex items-center justify-center rounded-md hover:bg-gray-100 text-gray-500 hover:text-gray-700 transition-colors shrink-0"},[...y[5]||(y[5]=[r("i",{class:"fa-solid fa-ellipsis-vertical text-sm"},null,-1)])],8,Ge)):w("",!0)])]),y[6]||(y[6]=r("div",{class:"border-t border-gray-100"},null,-1)),r("div",Je,[r("div",Xe,[_(o.$slots,"owner",{item:d},void 0,!0),_(o.$slots,"dates",{item:d},void 0,!0)]),r("div",Ze,[_(o.$slots,"badges",{item:d},void 0,!0)])])])],10,Ue))),128))],512)]))}},tt=re(et,[["__scopeId","data-v-cb3e7f88"]]),st={class:"page-container flex-1 flex flex-col overflow-hidden w-full min-w-0"},lt={class:"flex-1 flex flex-col overflow-hidden p-4 md:p-8"},at={class:"table-wrapper flex-1 w-full"},rt={__name:"TasksTableView",props:{tasks:{type:Array,required:!0},currentTaskId:{type:String,default:null},typeFilter:{type:String,default:"all"},sortOption:{type:String,default:"recent-first"},showTypeFilter:{type:Boolean,default:!0},showMobileClose:{type:Boolean,default:!1},openMenuId:{type:[Number,String],default:null},searchPlaceholder:{type:String,default:"Search tasks..."},getVehicleType:{type:Function,required:!0},getVehicleTypeBadgeClass:{type:Function,required:!0},getOwnerInfo:{type:Function,required:!0},getStageBadgeClass:{type:Function,required:!0},viewMode:{type:String,default:"table"}},emits:["select","menu-click","menu-close","filter-change","sort-change","reassign","close","view-change"],setup(g,{emit:C}){const $=g,c=C;h("");const x=h({pageIndex:0,pageSize:10}),T=h(""),D=h([]),v=h({type:$.typeFilter!=="all"?$.typeFilter:void 0});h({}),L(()=>$.typeFilter,a=>{a==="all"?v.value.type=void 0:v.value.type=a},{immediate:!0}),L(()=>v.value.type,a=>{c("filter-change",a||"all")}),L(D,a=>{if(a.length>0){const l=a[0];l.id==="nextActionDue"&&l.desc===!1?c("sort-change","urgent-first"):c("sort-change","recent-first")}});const S=M(()=>$.tasks),o=a=>a.type==="lead"?a.requestedCar?`${a.requestedCar.brand} ${a.requestedCar.model}`:"No vehicle specified":a.vehicle?`${a.vehicle.brand} ${a.vehicle.model}`:"No vehicle specified",y=a=>{if(!a)return"Not set";const l=new Date,i=new Date(a),O=new Date(l.getFullYear(),l.getMonth(),l.getDate()),E=new Date(i.getFullYear(),i.getMonth(),i.getDate())-O,q=Math.ceil(E/(1e3*60*60*24));return q===0?"Today":q===1?"Tomorrow":q===-1?"Yesterday":q>1&&q<=7?`In ${q} days`:q<-1&&q>=-7?`${Math.abs(q)} days ago`:W(a)},d=M(()=>[{accessorKey:"customer",header:"Customer",meta:{title:"Customer",onOpen:a=>b(a.original)},cell:({row:a})=>{const l=a.original;return f("div",{class:"flex items-center gap-2 md:gap-3"},[f("div",{class:`w-9 h-9 rounded-full flex items-center justify-center text-xs font-bold shrink-0 ${l.type==="lead"?"bg-orange-100 text-orange-600":"bg-purple-100 text-purple-600"}`},l.customer.initials),f("div",{class:"min-w-0"},[f("div",{class:"text-sm font-semibold text-gray-900 truncate max-w-[120px] md:max-w-none"},l.customer.name),f("div",{class:"text-xs text-gray-500 truncate hidden sm:block"},l.customer.email)])])}},{accessorKey:"vehicle",header:"Vehicle",meta:{title:"Vehicle"},cell:({row:a})=>{const l=a.original,i=$.getVehicleType(l);return f("div",{class:"flex items-center gap-2"},[f("div",{class:"min-w-0"},[f("div",{class:"text-sm font-medium text-gray-900 truncate max-w-[120px]"},o(l)),i?f("div",{class:"flex items-center gap-1 mt-0.5"},[f("span",{class:`text-[10px] font-medium px-1.5 py-0.5 rounded-md ${$.getVehicleTypeBadgeClass(i)}`},i.label)]):null])])}},{accessorKey:"type",header:"Type",meta:{title:"Type"},enableColumnFilter:!0,filterFn:(a,l,i)=>!i||i==="all"?!0:a.original.type===i,cell:({row:a})=>{const l=a.original,i=l.type==="lead"?"bg-blue-50 text-blue-700":"bg-purple-50 text-purple-700";return f("span",{class:`inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold ${i}`},l.type==="lead"?"Lead":"Opportunity")}},{accessorKey:"stage",header:"Stage/Status",meta:{title:"Stage/Status"},cell:({row:a})=>{const l=a.original,i=l.type==="lead"?l.status:l.stage,O=$.getStageBadgeClass(i);return f("div",{class:"flex flex-col gap-1"},[f("span",{class:`inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold ${O}`},i),l.type==="lead"&&l.priority==="Hot"?f("span",{class:"inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-semibold bg-red-50 text-red-700 w-fit"},[f("i",{class:"fa-solid fa-fire text-[9px]"}),"Hot"]):null])}},{accessorKey:"nextActionDue",header:"Next Action",meta:{title:"Next Action"},cell:({row:a})=>{const l=a.original;if(!l.nextActionDue)return"-";const i=j(l.nextActionDue);return f("div",{class:"text-sm"},[f("div",{class:`font-medium mb-0.5 ${i.textClass}`},W(l.nextActionDue)),f("div",{class:`text-xs flex items-center gap-1 ${i.textClass}`},[i.icon?f("i",{class:`fa-solid ${i.icon} text-[10px]`}):null,f("span",y(l.nextActionDue))])])}},{accessorKey:"owner",header:"Owner",meta:{title:"Owner"},cell:({row:a})=>{const l=a.original,i=$.getOwnerInfo(l);return f("div",{class:"flex items-center gap-2"},[f("div",{class:"w-6 h-6 rounded-full bg-gray-100 flex items-center justify-center text-[10px] font-bold text-gray-600 shrink-0"},i.initials),f("span",{class:"text-sm text-gray-600 truncate max-w-[80px]"},i.name)])}},{accessorKey:"value",header:"Value",meta:{title:"Value"},cell:({row:a})=>{const l=a.original;return l.type==="opportunity"?f("div",{class:"text-sm font-semibold text-gray-900"},`€${ie(l.value)}`):f("div",{class:"text-gray-400"},"-")}},{id:"actions",header:"",meta:{title:"Actions"},cell:({row:a})=>{const l=a.original;return f("button",{class:"text-gray-400 hover:text-gray-600",onClick:i=>{i.stopPropagation(),c("menu-click",l.id)}},[f("i",{class:"fa-solid fa-ellipsis-vertical"})])}}]),b=a=>{c("select",a.compositeId)},F=M(()=>({class:{tr:"cursor-pointer hover:bg-gray-50 transition-colors"}}));return(a,l)=>(p(),m("div",st,[U(qe,{title:"Tasks",subtitle:"Manage your leads and opportunities"},{actions:V(()=>[U(ne,{view:g.viewMode,options:[{value:"card",icon:"fa-solid fa-list",label:"Cards"},{value:"table",icon:"fa-solid fa-table",label:"Table"}],"onUpdate:view":l[0]||(l[0]=i=>a.$emit("view-change",i))},null,8,["view"])]),_:1}),r("div",lt,[r("div",at,[U(B(Se),{data:S.value,columns:d.value,meta:F.value,pagination:x.value,"onUpdate:pagination":l[1]||(l[1]=i=>x.value=i),globalFilter:T.value,"onUpdate:globalFilter":l[2]||(l[2]=i=>T.value=i),sorting:D.value,"onUpdate:sorting":l[3]||(l[3]=i=>D.value=i),columnFilters:v.value,"onUpdate:columnFilters":l[4]||(l[4]=i=>v.value=i),paginationOptions:{rowCount:S.value.length},globalFilterOptions:{debounce:300}},null,8,["data","columns","meta","pagination","globalFilter","sorting","columnFilters","paginationOptions"])])])]))}},it={class:"h-full flex flex-col lg:flex-row overflow-hidden bg-gray-50"},nt={key:0,class:"bg-red-50 text-red-700 text-[10px] font-semibold uppercase px-2 py-0.5 rounded-md flex items-center gap-1"},ot={class:"bg-gray-100 text-gray-700 text-[10px] font-medium px-2 py-0.5 rounded-md"},dt={key:0,class:"text-right"},ut={class:"text-sm font-semibold text-gray-900"},ct={key:0,class:"flex items-center gap-1.5"},pt={class:"text-xs text-gray-600 truncate"},gt={class:"text-xs font-medium leading-tight"},yt=["onClick"],ft=["onClick"],mt=["onClick"],vt={key:2,class:"flex-1 flex flex-col overflow-hidden"},xt={class:"lg:hidden fixed bottom-6 right-4 flex flex-col gap-3 z-30"},ht=["title"],bt={key:0,class:"flex-1 flex items-center justify-center"},wt={__name:"Tasks",setup(g){const C=xe(),$=be(),c=me(),x=we(),T=ve(),D=Ce(),v=h(localStorage.getItem("tasksViewMode")||"table");L(v,t=>{localStorage.setItem("tasksViewMode",t)});const S=t=>{if(!t)return"No deadline";const s=j(t);return s.type==="overdue"?"OVERDUE":s.type==="today"||s.type==="urgent"?s.relativeTime:W(t)},o=t=>{const s=t.type==="lead"?t.requestedCar:t.vehicle;return!s||!s.type?null:{New:{type:"new",label:"New"},"New 0km":{type:"0km",label:"New 0km"},Used:{type:"used",label:"Used"},Demo:{type:"demo",label:"Demo"}}[s.type]||{type:s.type.toLowerCase(),label:s.type}},y=t=>t?{new:"bg-green-50 text-green-700","0km":"bg-blue-50 text-blue-700",used:"bg-orange-50 text-orange-700",demo:"bg-purple-50 text-purple-700"}[t.type]||"bg-gray-50 text-gray-700":"",d=t=>{if(!t||!t.assignee)return{name:"Unassigned",initials:"?"};const s=t.assigneeInitials||t.assignee.split(" ").map(n=>n[0]).join("");return{name:t.assignee,initials:s}},b=h("all"),F=h("none"),a=h(null),l=h(!1),i=h(!1),O=h(null),N=M(()=>{const s=c.leads.filter(e=>!e.isDisqualified).map(e=>({...e,type:"lead",compositeId:`lead-${e.id}`})),n=x.opportunities.map(e=>({...e,type:"opportunity",compositeId:`opportunity-${e.id}`}));let u=[];return T.isOperator()?u=s:T.isSalesman()?u=n:u=[...s,...n],u}),E=M(()=>{let t=N.value;if(b.value!=="all"&&(t=t.filter(s=>s.type===b.value)),F.value==="urgent-first")t=[...t].sort((s,n)=>{if(s.priority==="Hot"&&n.priority!=="Hot")return-1;if(s.priority!=="Hot"&&n.priority==="Hot")return 1;const u=new Date(s.lastActivity||s.createdAt||0);return new Date(n.lastActivity||n.createdAt||0)-u});else if(F.value==="assigned-to-me"){const s=T.currentUser.name;t=t.filter(n=>n.assignee===s),t=[...t].sort((n,u)=>{const e=new Date(n.lastActivity||n.createdAt||0);return new Date(u.lastActivity||u.createdAt||0)-e})}else if(F.value==="assigned-to-my-team"){const s=T.currentUser;let n=[];s.role==="manager"?n=D.users.map(u=>u.name):s.role==="salesman"?n=D.users.filter(u=>u.role==="salesman").map(u=>u.name):s.role==="operator"&&(n=D.users.filter(u=>u.role==="operator").map(u=>u.name)),t=t.filter(u=>n.includes(u.assignee)),t=[...t].sort((u,e)=>{const H=new Date(u.lastActivity||u.createdAt||0);return new Date(e.lastActivity||e.createdAt||0)-H})}else t=[...t].sort((s,n)=>{const u=new Date(s.lastActivity||s.createdAt||0);return new Date(n.lastActivity||n.createdAt||0)-u});return t}),q=M(()=>{const t=N.value.some(n=>n.type==="lead"),s=N.value.some(n=>n.type==="opportunity");return t&&s}),A=M(()=>{const t=parseInt(C.params.id),s=C.query.type;if(s)return N.value.find(e=>e.id===t&&e.type===s)||null;const u=(b.value!=="all"?N.value.filter(e=>e.type===b.value):N.value).find(e=>e.id===t);return u||N.value.find(e=>e.id===t)||null});M(()=>A.value?A.value.type==="lead"?c.currentLeadActivities:x.currentOpportunityActivities:[]);const P=Ie(A),oe=P.managementWidget,de=P.storeAdapter,ue=P.addNewConfig,ce=M(()=>t=>t.type==="lead"?"bg-white border border-gray-200 hover:border-blue-300":"bg-white border border-gray-200 hover:border-purple-300");he(()=>{c.loadLeads(),x.loadOpportunities();const t=C.params.id;t&&Q(t)}),L(()=>C.params.id,t=>{t&&Q(t)}),L(A,t=>{t&&(t.type==="lead"?c.loadLeadById(t.id):x.loadOpportunityById(t.id))},{immediate:!0});const Q=t=>{const s=parseInt(t),n=N.value.find(u=>u.id===s);n&&(n.type==="lead"?c.loadLeadById(s):x.loadOpportunityById(s))},G=t=>{const[s,n]=t.split("-");$.push({path:`/tasks/${n}`,query:{type:s}}),l.value=!1},J=t=>{a.value=a.value===t?null:t},X=t=>{O.value=t,i.value=!0,a.value=null},Z=t=>{F.value=t},pe=async t=>{if(!O.value)return;const s=O.value,n=t.name;s.type==="lead"?await c.modifyLead(s.id,{assignee:n,assigneeType:t.type,teamId:t.type==="team"?t.id:null}):s.type==="opportunity"&&await x.updateOpportunity(s.id,{assignee:n,assigneeType:t.type,teamId:t.type==="team"?t.id:null}),i.value=!1,O.value=null},ge=async t=>{a.value=null,t.type==="lead"?await c.modifyLead(t.id,{priority:"Hot"}):t.type==="opportunity"&&await x.modifyOpportunity(t.id,{priority:"Hot"})},ye=async t=>{a.value=null,t.type==="lead"?await c.modifyLead(t.id,{priority:"Normal"}):t.type==="opportunity"&&await x.modifyOpportunity(t.id,{priority:"Normal"})},ee=t=>({Open:"bg-blue-50 text-blue-700","Open Opportunities":"bg-blue-50 text-blue-700","Open opportunity":"bg-blue-50 text-blue-700",Qualified:"bg-purple-50 text-purple-700","In Negotiation":"bg-orange-50 text-orange-700","Opportunity in negotiation":"bg-orange-50 text-orange-700",Registration:"bg-indigo-50 text-indigo-700",Closed:"bg-gray-100 text-gray-700","Closed opportunity":"bg-gray-100 text-gray-700","Closed Lost":"bg-red-50 text-red-700",Won:"bg-green-50 text-green-700",Lost:"bg-red-50 text-red-700",Valid:"bg-green-50 text-green-700","Not valid":"bg-red-50 text-red-700","To be validated":"bg-yellow-50 text-yellow-700","Not interested":"bg-gray-100 text-gray-700"})[t]||"bg-gray-100 text-gray-700";return(t,s)=>{var n,u;return p(),m("div",it,[v.value==="card"?(p(),m("div",{key:0,class:I(["lg:relative lg:block",l.value?"fixed inset-0 z-[60] md:relative md:z-auto":"hidden lg:block"])},[U(tt,{title:"Tasks",items:E.value,"selected-id":(n=A.value)==null?void 0:n.compositeId,"type-filter":b.value,"view-mode":v.value,"selected-class":e=>e.type==="lead"?"bg-white border-2 border-blue-500 shadow-md":"bg-white border-2 border-purple-500 shadow-md","unselected-class":ce.value,"open-menu-id":a.value,getName:e=>e.customer.name,getInitials:e=>e.customer.initials,getVehicleInfo:e=>e.type==="lead"?e.requestedCar?`${e.requestedCar.brand} ${e.requestedCar.model}`:"No vehicle specified":e.vehicle?`${e.vehicle.brand} ${e.vehicle.model}`:"No vehicle specified",avatarClass:e=>e.type==="lead"?"bg-orange-100 text-orange-600":"bg-purple-100 text-purple-600","show-mobile-close":!0,onSelect:G,onMenuClick:J,onMenuClose:s[0]||(s[0]=e=>a.value=null),onClose:s[1]||(s[1]=e=>l.value=!1),"show-type-filter":q.value,onFilterChange:s[2]||(s[2]=e=>b.value=e),onSortChange:Z,onViewChange:s[3]||(s[3]=e=>v.value=e)},{badges:V(({item:e})=>[r("span",{class:I(["text-[10px] font-semibold uppercase px-2 py-0.5 rounded-md",e.type==="lead"?"bg-blue-50 text-blue-700":"bg-purple-50 text-purple-700"])},k(e.type==="lead"?"Lead":"Opportunity"),3),e.type==="lead"?(p(),m(Y,{key:0},[e.priority==="Hot"?(p(),m("span",nt,[...s[11]||(s[11]=[r("i",{class:"fa-solid fa-fire text-[9px]"},null,-1),K(" Hot ",-1)])])):w("",!0),r("span",ot,k(e.status),1)],64)):(p(),m("span",{key:1,class:I(["text-[10px] font-semibold uppercase px-2 py-0.5 rounded-md",ee(e.stage)])},k(e.stage),3))]),meta:V(({item:e})=>[e.type==="opportunity"?(p(),m("div",dt,[r("div",ut,"€"+k(B(ie)(e.value)),1)])):w("",!0)]),"vehicle-type":V(({item:e})=>[o(e)?(p(),m("span",{key:0,class:I(["text-[10px] font-medium px-1.5 py-0.5 rounded-md shrink-0",y(o(e))])},k(o(e).label),3)):w("",!0)]),owner:V(({item:e})=>[e.assignee?(p(),m("div",ct,[s[12]||(s[12]=r("i",{class:"fa-solid fa-user text-[10px] text-gray-400"},null,-1)),r("span",pt,k(e.assignee),1)])):w("",!0)]),dates:V(({item:e})=>[e.type==="lead"&&e.nextActionDue?(p(),m("div",{key:0,class:I(["flex items-center gap-1.5",B(j)(e.nextActionDue).textClass])},[B(j)(e.nextActionDue).type!=="overdue"?(p(),m("i",{key:0,class:I(["text-[10px]",B(j)(e.nextActionDue).iconClass])},null,2)):w("",!0),r("span",gt,k(S(e.nextActionDue)),1)],2)):w("",!0)]),menu:V(({item:e})=>[r("button",{onClick:z(H=>X(e),["stop"]),class:"w-full text-left px-3 py-2 text-xs text-slate-700 hover:bg-gray-50 flex items-center gap-2"},[...s[13]||(s[13]=[r("i",{class:"fa-solid fa-share text-gray-400"},null,-1),K(" Reassign ",-1)])],8,yt),e.priority!=="Hot"?(p(),m("button",{key:0,onClick:z(H=>ge(e),["stop"]),class:"w-full text-left px-3 py-2 text-xs text-slate-700 hover:bg-gray-50 flex items-center gap-2"},[...s[14]||(s[14]=[r("i",{class:"fa-solid fa-fire text-orange-500"},null,-1),K(" Mark as hot ",-1)])],8,ft)):(p(),m("button",{key:1,onClick:z(H=>ye(e),["stop"]),class:"w-full text-left px-3 py-2 text-xs text-slate-700 hover:bg-gray-50 flex items-center gap-2"},[...s[15]||(s[15]=[r("i",{class:"fa-regular fa-snowflake text-gray-400"},null,-1),K(" Unmark as hot ",-1)])],8,mt))]),_:1},8,["items","selected-id","type-filter","view-mode","selected-class","unselected-class","open-menu-id","getName","getInitials","getVehicleInfo","avatarClass","show-type-filter"])],2)):w("",!0),v.value==="table"?(p(),R(rt,{key:1,tasks:E.value,"current-task-id":(u=A.value)==null?void 0:u.compositeId,"type-filter":b.value,"sort-option":F.value,"show-type-filter":q.value,"show-mobile-close":!0,"open-menu-id":a.value,"get-vehicle-type":o,"get-vehicle-type-badge-class":y,"get-owner-info":d,"get-stage-badge-class":ee,"view-mode":v.value,onSelect:G,onMenuClick:J,onMenuClose:s[4]||(s[4]=e=>a.value=null),onFilterChange:s[5]||(s[5]=e=>b.value=e),onSortChange:Z,onReassign:X,onClose:s[6]||(s[6]=e=>l.value=!1),onViewChange:s[7]||(s[7]=e=>v.value=e)},null,8,["tasks","current-task-id","type-filter","sort-option","show-type-filter","open-menu-id","view-mode"])):w("",!0),v.value==="card"?(p(),m("div",vt,[r("div",xt,[r("button",{onClick:s[8]||(s[8]=e=>v.value=v.value==="card"?"table":"card"),class:"w-14 h-14 bg-gray-700 text-white rounded-full shadow-lg flex items-center justify-center hover:bg-gray-800 transition-all hover:scale-110",title:v.value==="card"?"Switch to Table":"Switch to Cards"},[r("i",{class:I(v.value==="card"?"fa-solid fa-table text-lg":"fa-solid fa-list text-lg")},null,2)],8,ht),r("button",{onClick:s[9]||(s[9]=e=>l.value=!l.value),class:"w-14 h-14 bg-blue-600 text-white rounded-full shadow-lg flex items-center justify-center hover:bg-blue-700 transition-all hover:scale-110",title:"Tasks"},[...s[16]||(s[16]=[r("i",{class:"fa-solid fa-list text-lg"},null,-1)])])]),!A.value&&v.value==="card"?(p(),m("div",bt,[...s[17]||(s[17]=[r("div",{class:"text-center"},[r("i",{class:"fa-solid fa-tasks text-6xl text-gray-300 mb-4"}),r("p",{class:"text-gray-500"},"Select a task to view details")],-1)])])):A.value&&v.value==="card"?(p(),R(ke,{key:1,task:A.value,type:A.value.type,"management-widget":B(oe),"store-adapter":B(de),"add-new-config":B(ue)},{"pinned-extra":V(({task:e})=>[e.type==="lead"&&e.requestedCar?(p(),R(le,{key:0,brand:e.requestedCar.brand,model:e.requestedCar.model,year:e.requestedCar.year,image:e.requestedCar.image||"",price:e.requestedCar.price||null,"request-message":e.requestedCar.requestMessage||"","request-type":e.requestedCar.requestType||"",source:e.source||"",dealership:e.requestedCar.dealership||"",registration:e.requestedCar.registration||"",kilometers:e.requestedCar.kilometers||null,"fuel-type":e.requestedCar.fuelType||"","gear-type":e.requestedCar.gearType||"",vin:e.requestedCar.vin||"","stock-days":e.requestedCar.stockDays!==void 0?e.requestedCar.stockDays:null,channel:e.requestedCar.channel||"Email","ad-campaign":e.requestedCar.adCampaign||"","expected-purchase-date":e.requestedCar.expectedPurchaseDate||"","fiscal-entity":e.requestedCar.fiscalEntity||"","source-details":e.requestedCar.sourceDetails||"","ad-medium":e.requestedCar.adMedium||"","ad-source":e.requestedCar.adSource||"",label:"Requested Car"},null,8,["brand","model","year","image","price","request-message","request-type","source","dealership","registration","kilometers","fuel-type","gear-type","vin","stock-days","channel","ad-campaign","expected-purchase-date","fiscal-entity","source-details","ad-medium","ad-source"])):w("",!0),e.type==="opportunity"&&e.vehicle?(p(),R(le,{key:1,brand:e.vehicle.brand,model:e.vehicle.model,year:e.vehicle.year,image:e.vehicle.image||"",price:e.vehicle.price||null,"request-message":e.vehicle.requestMessage||"","request-type":e.vehicle.requestType||"",source:e.source||"",dealership:e.vehicle.dealership||"",registration:e.vehicle.registration||"",kilometers:e.vehicle.kilometers||null,"fuel-type":e.vehicle.fuelType||"","gear-type":e.vehicle.gearType||"",vin:e.vehicle.vin||"","stock-days":e.vehicle.stockDays!==void 0?e.vehicle.stockDays:null,channel:e.vehicle.channel||"Email","ad-campaign":e.vehicle.adCampaign||"","expected-purchase-date":e.vehicle.expectedPurchaseDate||"","fiscal-entity":e.vehicle.fiscalEntity||"","source-details":e.vehicle.sourceDetails||"","ad-medium":e.vehicle.adMedium||"","ad-source":e.vehicle.adSource||"",label:"Vehicle"},null,8,["brand","model","year","image","price","request-message","request-type","source","dealership","registration","kilometers","fuel-type","gear-type","vin","stock-days","channel","ad-campaign","expected-purchase-date","fiscal-entity","source-details","ad-medium","ad-source"])):w("",!0)]),_:1},8,["task","type","management-widget","store-adapter","add-new-config"])):w("",!0)])):w("",!0),U($e,{show:i.value,onClose:s[10]||(s[10]=e=>i.value=!1),onConfirm:pe},null,8,["show"])])}}},Mt=re(wt,[["__scopeId","data-v-8117b7bf"]]);export{Mt as default};
