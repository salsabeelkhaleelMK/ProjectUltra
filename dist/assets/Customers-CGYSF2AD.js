import{r as x,B as de,c as f,p as pe,o as h,z as B,e as i,d as N,A as g,C as y,m as M,q as E,u as me,y as ge,V as ye,l as xe,G as s,F as ve,i as be,h as fe,U as he,n as Ae,t as Ce,g as ke,k as Ne}from"./index-Baowk8yV.js";import{_ as we}from"./PageHeader-K4h7Nky0.js";import{Q as Se,i as De}from"./index-C1tcDFBl.js";import{_ as Oe}from"./ModalShell-DcQqocRS.js";import{y as $e}from"./components-j1JUk8PC.js";import{u as Ke}from"./opportunities-DeYk_9MS.js";import{u as Te}from"./customers-Bn0ILupF.js";import{g as Z,b as _,c as ee}from"./formatters-E4EQSCf9.js";import"./index-Ct-3v9pQ-DjTMGHGd.js";import"./toggle-group-item.vue_vue_type_script_setup_true_lang-Csij51_o-N-LQGDgb.js";const qe={class:"space-y-4"},Le={key:0},Ue={key:1},Ve={key:2},Ie={key:3},Fe=["placeholder"],Re={__name:"AddCustomerModal",props:{show:{type:Boolean,default:!1},activeTab:{type:String,required:!0},initialData:{type:Object,default:()=>({})}},emits:["close","save"],setup(A,{emit:O}){const d=A,w=O,n=x({customerName:"",email:"",phone:"",company:"",vehicle:"",value:"",reason:""});de(()=>d.show,c=>{c&&(n.value={customerName:d.initialData.customerName||"",email:d.initialData.email||"",phone:d.initialData.phone||"",company:d.initialData.company||"",vehicle:d.initialData.vehicle||"",value:d.initialData.value||"",reason:d.initialData.reason||""})});const S=f(()=>({contacts:"Add New Contact","open-leads":"Add New Lead","open-opportunities":"Add New Opportunity","in-negotiation":"Add Opportunity in Negotiation",won:"Add Won Opportunity",lost:"Add Lost Opportunity"})[d.activeTab]||"Add New Item"),C=f(()=>({contacts:"Contact","open-leads":"Lead","open-opportunities":"Opportunity","in-negotiation":"Opportunity",won:"Won Opportunity",lost:"Lost Opportunity"})[d.activeTab]||"Item"),j=()=>{w("save",{...n.value}),n.value={customerName:"",email:"",phone:"",company:"",vehicle:"",value:"",reason:""}};return(c,l)=>(h(),pe(Oe,{show:A.show,title:S.value,subtitle:"Fill in the details below",size:"md",onClose:l[13]||(l[13]=r=>c.$emit("close")),onCancel:l[14]||(l[14]=r=>c.$emit("close"))},{actions:B(()=>[M(E(Se),{label:`Create ${C.value}`,variant:"primary",size:"small",class:"rounded-sm",onClick:j},null,8,["label"])]),default:B(()=>[i("div",qe,[A.activeTab==="contacts"?(h(),N("div",Le,[l[15]||(l[15]=i("label",{class:"block label-upper mb-2"},"Contact Name",-1)),g(i("input",{"onUpdate:modelValue":l[0]||(l[0]=r=>n.value.customerName=r),type:"text",placeholder:"Enter contact name...",class:"input"},null,512),[[y,n.value.customerName]]),l[16]||(l[16]=i("label",{class:"block label-upper mb-2 mt-4"},"Email",-1)),g(i("input",{"onUpdate:modelValue":l[1]||(l[1]=r=>n.value.email=r),type:"email",placeholder:"contact@example.com",class:"input"},null,512),[[y,n.value.email]]),l[17]||(l[17]=i("label",{class:"block label-upper mb-2 mt-4"},"Phone",-1)),g(i("input",{"onUpdate:modelValue":l[2]||(l[2]=r=>n.value.phone=r),type:"tel",placeholder:"+49...",class:"input"},null,512),[[y,n.value.phone]]),l[18]||(l[18]=i("label",{class:"block label-upper mb-2 mt-4"},"Company (optional)",-1)),g(i("input",{"onUpdate:modelValue":l[3]||(l[3]=r=>n.value.company=r),type:"text",placeholder:"Company name...",class:"input"},null,512),[[y,n.value.company]])])):A.activeTab==="open-leads"?(h(),N("div",Ue,[l[19]||(l[19]=i("label",{class:"block label-upper mb-2"},"Customer Name",-1)),g(i("input",{"onUpdate:modelValue":l[4]||(l[4]=r=>n.value.customerName=r),type:"text",placeholder:"Enter customer name...",class:"input"},null,512),[[y,n.value.customerName]]),l[20]||(l[20]=i("label",{class:"block label-upper mb-2 mt-4"},"Email",-1)),g(i("input",{"onUpdate:modelValue":l[5]||(l[5]=r=>n.value.email=r),type:"email",placeholder:"customer@example.com",class:"input"},null,512),[[y,n.value.email]]),l[21]||(l[21]=i("label",{class:"block label-upper mb-2 mt-4"},"Requested Vehicle",-1)),g(i("input",{"onUpdate:modelValue":l[6]||(l[6]=r=>n.value.vehicle=r),type:"text",placeholder:"e.g., Volkswagen ID.4",class:"input"},null,512),[[y,n.value.vehicle]])])):A.activeTab==="open-opportunities"||A.activeTab==="in-negotiation"?(h(),N("div",Ve,[l[22]||(l[22]=i("label",{class:"block label-upper mb-2"},"Customer Name",-1)),g(i("input",{"onUpdate:modelValue":l[7]||(l[7]=r=>n.value.customerName=r),type:"text",placeholder:"Enter customer name...",class:"input"},null,512),[[y,n.value.customerName]]),l[23]||(l[23]=i("label",{class:"block label-upper mb-2 mt-4"},"Vehicle",-1)),g(i("input",{"onUpdate:modelValue":l[8]||(l[8]=r=>n.value.vehicle=r),type:"text",placeholder:"e.g., Porsche Taycan",class:"input"},null,512),[[y,n.value.vehicle]]),l[24]||(l[24]=i("label",{class:"block label-upper mb-2 mt-4"},"Opportunity Value",-1)),g(i("input",{"onUpdate:modelValue":l[9]||(l[9]=r=>n.value.value=r),type:"number",placeholder:"0",class:"input"},null,512),[[y,n.value.value]])])):(h(),N("div",Ie,[l[25]||(l[25]=i("label",{class:"block label-upper mb-2"},"Customer Name",-1)),g(i("input",{"onUpdate:modelValue":l[10]||(l[10]=r=>n.value.customerName=r),type:"text",placeholder:"Enter customer name...",class:"input"},null,512),[[y,n.value.customerName]]),l[26]||(l[26]=i("label",{class:"block label-upper mb-2 mt-4"},"Vehicle",-1)),g(i("input",{"onUpdate:modelValue":l[11]||(l[11]=r=>n.value.vehicle=r),type:"text",placeholder:"Vehicle model",class:"input"},null,512),[[y,n.value.vehicle]]),l[27]||(l[27]=i("label",{class:"block label-upper mb-2 mt-4"},"Reason",-1)),g(i("textarea",{"onUpdate:modelValue":l[12]||(l[12]=r=>n.value.reason=r),rows:"3",placeholder:`Reason for ${A.activeTab==="won"?"win":"loss"}...`,class:"input resize-none"},null,8,Fe),[[y,n.value.reason]])]))])]),_:1},8,["show","title"]))}},Me={class:"page-container"},We={class:"p-4 md:p-8"},Be={class:"flex items-center gap-3 mb-6 overflow-x-auto pb-2 scrollbar-hide"},Ee=["onClick"],je={class:"text-sm font-medium text-foreground whitespace-nowrap"},ze={class:"table-wrapper w-full"},tt={__name:"Customers",setup(A){const O=fe();he();const d=me(),w=ge(),n=Ke(),S=Te(),C=f(()=>{const e=w.leads.filter(m=>!m.isDisqualified),a=n.opportunities.filter(m=>m.stage!=="Closed Won"&&m.stage!=="Closed Lost"),o=n.opportunities.filter(m=>m.stage==="In Negotiation"||m.stage==="In negotiation"),p=n.opportunities.filter(m=>m.stage==="Closed Won"),b=n.opportunities.filter(m=>m.stage==="Closed Lost");return{contacts:S.totalCustomers,openLeads:e.length,openOpportunities:a.length-o.length,inNegotiation:o.length,won:p.length,lost:b.length}}),c=x(d.isOperator()?"open-leads":d.isManager()||d.isSalesman()?"in-negotiation":"contacts");x("");const l=x(!1),r=x(!1),z=x("all"),$=x({status:"",priority:"",source:""}),Q=x({pageIndex:0,pageSize:10}),P=x(""),H=x([]),G=x([]);x({});const te=f(()=>c.value==="contacts"?[{key:"source",label:"Source",type:"select",operators:[{value:"eq",label:"is"},{value:"ne",label:"is not"}],options:[{value:"Marketing",label:"Marketing"},{value:"Referral",label:"Referral"},{value:"Direct",label:"Direct"}]},{key:"company",label:"Has Company",type:"boolean",operators:[{value:"exists",label:"exists"},{value:"notExists",label:"does not exist"}]}]:[{key:"status",label:"Status",type:"multiselect",operators:[{value:"in",label:"is any of"},{value:"notIn",label:"is none of"}],options:[{value:"Valid",label:"Valid"},{value:"Not valid",label:"Not valid"},{value:"Qualified",label:"Qualified"},{value:"Not interested",label:"Not interested"}]},{key:"priority",label:"Priority",type:"select",operators:[{value:"eq",label:"is"},{value:"ne",label:"is not"}],options:[{value:"Hot",label:"Hot"},{value:"Normal",label:"Normal"}]},{key:"source",label:"Source",type:"select",operators:[{value:"eq",label:"is"},{value:"ne",label:"is not"}],options:[{value:"Marketing",label:"Marketing"},{value:"Referral",label:"Referral"},{value:"Direct",label:"Direct"}]}]),J=x({customerName:"",email:"",phone:"",company:"",vehicle:"",value:"",reason:""}),ae=f(()=>{const e=[{key:"contacts",label:"Customers",count:C.value.contacts,borderColor:"border-t-purple-600",badgeColor:"bg-purple-600 text-white"},{key:"open-leads",label:"Open Leads",count:C.value.openLeads,borderColor:"border-t-blue-600",badgeColor:"bg-blue-600 text-white"},{key:"open-opportunities",label:"Open opportunities",count:C.value.openOpportunities,borderColor:"border-t-orange-500",badgeColor:"bg-orange-500 text-white"},{key:"in-negotiation",label:"In negotiation",count:C.value.inNegotiation,borderColor:"border-t-blue-500",badgeColor:"bg-blue-500 text-white"},{key:"won",label:"Won",count:C.value.won,borderColor:"border-t-green-500",badgeColor:"bg-green-500 text-white"},{key:"lost",label:"Lost",count:C.value.lost,borderColor:"border-t-red-500",badgeColor:"bg-red-500 text-white"}];return d.isOperator()?e.filter(a=>a.key==="contacts"||a.key==="open-leads"):d.isSalesman()?e.filter(a=>a.key!=="open-leads"):e}),se=()=>{J.value={customerName:"",email:"",phone:"",company:"",vehicle:"",value:"",reason:""},l.value=!1},le=f(()=>{let e=S.customers;z.value==="contacts"?e=S.contacts:z.value==="accounts"&&(e=S.accounts);const a=t=>{if(!t)return"N/A";const u=t.split(",");return u.length>1&&u[u.length-1].trim().replace(/^\d+\s*/,"").trim()||t},o=e.map(t=>({id:`customer-${t.id}`,stageKey:"contacts",customer:t.name,accountType:t.company&&t.company!==""?"Account":"Contact",telephone:t.phone,location:a(t.address),createdAt:D(t.createdAt),name:t.name,accountOwner:t.source||"N/A",updatedAt:D(t.lastContact||t.createdAt),lastActivity:D(t.lastContact),openOpportunities:n.opportunities.filter(u=>u.customerId===t.id&&u.stage!=="Closed Won"&&u.stage!=="Closed Lost").length,wonOpportunities:n.opportunities.filter(u=>u.customerId===t.id&&u.stage==="Closed Won").length,initials:t.initials||t.name.slice(0,2).toUpperCase(),type:t.company&&t.company!==""?"account":"contact",customerId:t.id}));let p=w.leads;r.value?p=w.leads.filter(t=>t.isDisqualified===!0):p=w.leads.filter(t=>!t.isDisqualified);const b=p.map(t=>{var u,v,k,K,T,q,L,U,V,I,F,R;return{id:`lead-${t.id}`,stageKey:"open-leads",customer:((u=t.customer)==null?void 0:u.name)||"Unknown",email:((v=t.customer)==null?void 0:v.email)||"",initials:((k=t.customer)==null?void 0:k.initials)||((T=(K=t.customer)==null?void 0:K.name)==null?void 0:T.slice(0,2).toUpperCase())||"?",nextAction:ee(t.nextActionDue)||"No due date",nextActionFull:_(t.nextActionDue),deadlineStatus:Z(t.nextActionDue),car:`${((q=t.requestedCar)==null?void 0:q.brand)||""} ${((L=t.requestedCar)==null?void 0:L.model)||""}`.trim()||"N/A",carStatus:((U=t.requestedCar)==null?void 0:U.stockDays)!==void 0&&((V=t.requestedCar)==null?void 0:V.stockDays)!==null?"In Stock":"Out of Stock",carStatusClass:((I=t.requestedCar)==null?void 0:I.stockDays)!==void 0&&((F=t.requestedCar)==null?void 0:F.stockDays)!==null?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700",requestType:((R=t.requestedCar)==null?void 0:R.requestType)||"Quotation",source:t.source||"Marketing",assignee:t.assignee,assigneeInitials:t.assignee?t.assignee.slice(0,2).toUpperCase():"NA",createdAt:D(t.createdAt),lastActivity:D(t.lastActivity),status:t.status,statusClass:oe(t.status),priority:t.priority||"Normal"}}),m=t=>{const u=ye.filter(v=>v.opportunityId===t&&v.type==="appointment").sort((v,k)=>new Date(k.timestamp)-new Date(v.timestamp));return u.length>0?u[0].timestamp:null},ce=n.opportunities.map(t=>{var k,K,T,q,L,U,V,I,F,R,Y;let u="open-opportunities";t.stage==="In Negotiation"||t.stage==="In negotiation"?u="in-negotiation":t.stage==="Closed Won"?u="won":t.stage==="Closed Lost"&&(u="lost");const v=m(t.id);return{id:`opp-${t.id}`,stageKey:u,customer:((k=t.customer)==null?void 0:k.name)||"Unknown",email:((K=t.customer)==null?void 0:K.email)||"",initials:((T=t.customer)==null?void 0:T.initials)||((L=(q=t.customer)==null?void 0:q.name)==null?void 0:L.slice(0,2).toUpperCase())||"?",nextAction:ee(t.expectedCloseDate)||"No due date",nextActionFull:_(t.expectedCloseDate),deadlineStatus:Z(t.expectedCloseDate),car:`${((U=t.vehicle)==null?void 0:U.brand)||""} ${((V=t.vehicle)==null?void 0:V.model)||""}`.trim()||"N/A",carStatus:((I=t.vehicle)==null?void 0:I.stockDays)!==void 0&&((F=t.vehicle)==null?void 0:F.stockDays)!==null?"In Stock":"Out of Stock",carStatusClass:((R=t.vehicle)==null?void 0:R.stockDays)!==void 0&&((Y=t.vehicle)==null?void 0:Y.stockDays)!==null?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700",requestType:t.requestType||"Opportunity",source:t.source||"Marketing",assignee:t.assignee,assigneeInitials:t.assignee?t.assignee.slice(0,2).toUpperCase():"NA",createdAt:D(t.createdAt),lastAppointment:v?D(v):"N/A",status:t.stage,statusClass:u==="in-negotiation"?"bg-orange-100 text-orange-700":u==="won"?"bg-green-100 text-green-700":u==="lost"?"bg-red-100 text-red-700":"bg-purple-100 text-purple-700",priority:t.priority||"Normal"}});return[...o,...b,...ce]}),X=f(()=>{let e=le.value.filter(a=>a.stageKey===c.value);return $.value.status&&(e=e.filter(a=>a.status===$.value.status)),$.value.priority&&(e=e.filter(a=>a.priority===$.value.priority)),$.value.source&&(e=e.filter(a=>a.source===$.value.source)),e}),ne=e=>{c.value=e},oe=e=>({Valid:"bg-green-100 text-green-700","Not valid":"bg-red-100 text-red-700",Qualified:"bg-gray-100 text-gray-700","Not interested":"bg-red-100 text-red-700",Open:"bg-blue-100 text-blue-700"})[e]||"bg-gray-100 text-gray-700",D=e=>e?new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}):"-",ie=(e,a)=>{if(!a||!e)return"gray";const p={contacts:"gray","open-leads":"blue","open-opportunities":"blue","in-negotiation":"blue",won:"green",lost:"red"}[e]||"gray";return["blue","green","red","gray"].includes(p)?p:"gray"};xe(async()=>{await S.loadCustomers(),await w.loadLeads(),await n.loadOpportunities()});const W=e=>{if(e.stageKey==="contacts"){const o=e.customerId||e.id.split("-")[1];O.push({path:`/customer/${o}`,query:{type:"contact"}});return}const a=e.id.match(/-(\d+)$/);if(c.value==="open-leads"&&e.id.startsWith("lead-")){const o=a?a[1]:e.id.replace("lead-","");O.push({path:`/customer/${o}`,query:{stage:"lead"}})}else if(e.id.startsWith("opp-")){const o=a?a[1]:e.id.replace("opp-","");O.push({path:`/customer/${o}`,query:{stage:"opportunity"}})}else if(e.stageKey==="won"||e.stageKey==="lost"){const o=a?a[1]:e.id.replace("opp-","");O.push({path:`/customer/${o}`,query:{stage:"opportunity"}})}},re=f(()=>({class:{tr:"cursor-pointer hover:bg-gray-50 transition-colors"}})),ue=f(()=>c.value==="contacts"?[{accessorKey:"customer",header:"Customer",meta:{title:"Customer",onOpen:e=>W(e.original)},cell:({row:e})=>{const a=e.original;return s("div",{class:"flex items-center gap-2 md:gap-3"},[s("div",{class:"w-9 h-9 rounded-full flex items-center justify-center text-xs font-bold shrink-0 bg-blue-100 text-blue-600"},a.initials),s("div",{class:"min-w-0"},[s("div",{class:"text-sm font-semibold text-gray-900 truncate max-w-[120px] md:max-w-none"},a.customer)])])}},{accessorKey:"accountType",header:"Account type",meta:{title:"Account type"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.accountType||"N/A")},{accessorKey:"telephone",header:"Telephone",meta:{title:"Telephone"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.telephone||"N/A")},{accessorKey:"location",header:"Location",meta:{title:"Location"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600 truncate max-w-[150px]"},e.original.location||"N/A")},{accessorKey:"createdAt",header:"Created at",meta:{title:"Created at"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.createdAt||"N/A")},{accessorKey:"accountOwner",header:"Account owner",meta:{title:"Account owner"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.type==="account"&&e.original.accountOwner||"N/A")},{accessorKey:"updatedAt",header:"Updated at",meta:{title:"Updated at"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.type==="account"&&e.original.updatedAt||"N/A")},{accessorKey:"lastActivity",header:"Last activity",meta:{title:"Last activity"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.type==="account"&&e.original.lastActivity||"N/A")},{accessorKey:"openOpportunities",header:"Open opportunities",meta:{title:"Open opportunities"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.type==="account"?String(e.original.openOpportunities||0):"N/A")},{accessorKey:"wonOpportunities",header:"Won opportunities",meta:{title:"Won opportunities"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.type==="account"?String(e.original.wonOpportunities||0):"N/A")},{id:"actions",header:"",meta:{title:"Actions"},cell:()=>s("button",{class:"text-gray-400 hover:text-gray-600"},[s("i",{class:"fa-solid fa-ellipsis-vertical"})])}]:c.value==="open-leads"?[{accessorKey:"customer",header:"Customer",meta:{title:"Customer",onOpen:e=>W(e.original)},cell:({row:e})=>{const a=e.original;return s("div",{class:"flex items-center gap-2 md:gap-3"},[s("div",{class:"w-9 h-9 rounded-full flex items-center justify-center text-xs font-bold shrink-0 bg-orange-100 text-orange-600"},a.initials),s("div",{class:"min-w-0"},[s("div",{class:"text-sm font-semibold text-gray-900 truncate"},a.customer),s("div",{class:"text-xs text-gray-500 truncate hidden sm:block"},a.email)])])}},{accessorKey:"nextAction",header:"Next action due",meta:{title:"Next action due"},cell:({row:e})=>{var o,p,b;const a=e.original;return a.nextActionFull?s("div",{class:"text-sm"},[s("div",{class:`font-medium mb-0.5 ${((o=a.deadlineStatus)==null?void 0:o.textClass)||"text-gray-600"}`},a.nextActionFull),s("div",{class:`text-xs flex items-center gap-1 ${((p=a.deadlineStatus)==null?void 0:p.textClass)||"text-gray-500"}`},[(b=a.deadlineStatus)!=null&&b.icon?s("i",{class:`fa-solid ${a.deadlineStatus.icon} text-[10px]`}):null,s("span",a.nextAction)])]):"-"}},{accessorKey:"car",header:"Requested car",meta:{title:"Requested car"},cell:({row:e})=>s("div",{class:"flex items-center gap-2"},[s("i",{class:"fa-brands fa-volkswagen text-gray-400 text-sm"}),s("span",{class:"text-sm font-medium text-gray-900 truncate max-w-[120px]"},e.original.car||"N/A")])},{accessorKey:"carStatus",header:"Car status",meta:{title:"Car status"},cell:({row:e})=>s("span",{class:`inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold ${e.original.carStatusClass}`},e.original.carStatus)},{accessorKey:"requestType",header:"Request type",meta:{title:"Request type"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.requestType||"N/A")},{accessorKey:"source",header:"Source",meta:{title:"Source"},cell:({row:e})=>s("span",{class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-gray-100 text-gray-700"},e.original.source||"N/A")},{accessorKey:"assignee",header:"Assignee",meta:{title:"Assignee"},cell:({row:e})=>s("div",{class:"flex items-center gap-2"},[s("div",{class:"w-6 h-6 rounded-full bg-gray-100 flex items-center justify-center text-[10px] font-bold text-gray-600 shrink-0"},e.original.assigneeInitials),s("span",{class:"text-sm text-gray-600 truncate max-w-[80px] hidden md:inline"},e.original.assignee||"N/A")])},{accessorKey:"createdAt",header:"Created at",meta:{title:"Created at"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.createdAt||"N/A")},{accessorKey:"lastActivity",header:"Last activity",meta:{title:"Last activity"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.lastActivity||"N/A")},{accessorKey:"status",header:"Status",meta:{title:"Status"},cell:({row:e})=>s("span",{class:`inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold ${e.original.statusClass}`},e.original.status)},{id:"actions",header:"",meta:{title:"Actions"},cell:()=>s("button",{class:"text-gray-400 hover:text-gray-600"},[s("i",{class:"fa-solid fa-ellipsis-vertical"})])}]:[{accessorKey:"customer",header:"Customer",meta:{title:"Customer",onOpen:e=>W(e.original)},cell:({row:e})=>{const a=e.original;return s("div",{class:"flex items-center gap-2 md:gap-3"},[s("div",{class:"w-9 h-9 rounded-full flex items-center justify-center text-xs font-bold shrink-0 bg-purple-100 text-purple-600"},a.initials),s("div",{class:"min-w-0"},[s("div",{class:"text-sm font-semibold text-gray-900 truncate"},a.customer),s("div",{class:"text-xs text-gray-500 truncate hidden sm:block"},a.email)])])}},{accessorKey:"nextAction",header:"Next action due",meta:{title:"Next action due"},cell:({row:e})=>{var o,p,b;const a=e.original;return a.nextActionFull?s("div",{class:"text-sm"},[s("div",{class:`font-medium mb-0.5 ${((o=a.deadlineStatus)==null?void 0:o.textClass)||"text-gray-600"}`},a.nextActionFull),s("div",{class:`text-xs flex items-center gap-1 ${((p=a.deadlineStatus)==null?void 0:p.textClass)||"text-gray-500"}`},[(b=a.deadlineStatus)!=null&&b.icon?s("i",{class:`fa-solid ${a.deadlineStatus.icon} text-[10px]`}):null,s("span",a.nextAction)])]):"-"}},{accessorKey:"car",header:"Offered car",meta:{title:"Offered car"},cell:({row:e})=>s("div",{class:"flex items-center gap-2"},[s("i",{class:"fa-brands fa-volkswagen text-gray-400 text-sm"}),s("span",{class:"text-sm font-medium text-gray-900 truncate max-w-[120px]"},e.original.car||"N/A")])},{accessorKey:"carStatus",header:"Car status",meta:{title:"Car status"},cell:({row:e})=>s("span",{class:`inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold ${e.original.carStatusClass}`},e.original.carStatus)},{accessorKey:"requestType",header:"Request type",meta:{title:"Request type"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.requestType||"N/A")},{accessorKey:"source",header:"Source",meta:{title:"Source"},cell:({row:e})=>s("span",{class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-gray-100 text-gray-700"},e.original.source||"N/A")},{accessorKey:"assignee",header:"Assignee",meta:{title:"Assignee"},cell:({row:e})=>s("div",{class:"flex items-center gap-2"},[s("div",{class:"w-6 h-6 rounded-full bg-gray-100 flex items-center justify-center text-[10px] font-bold text-gray-600 shrink-0"},e.original.assigneeInitials),s("span",{class:"text-sm text-gray-600 truncate max-w-[80px] hidden md:inline"},e.original.assignee||"N/A")])},{accessorKey:"createdAt",header:"Created at",meta:{title:"Created at"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.createdAt||"N/A")},{accessorKey:"lastAppointment",header:"Last appointment",meta:{title:"Last appointment"},cell:({row:e})=>s("span",{class:"text-sm text-gray-600"},e.original.lastAppointment||"N/A")},{accessorKey:"status",header:"Status",meta:{title:"Status"},cell:({row:e})=>s("span",{class:`inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold ${e.original.statusClass}`},e.original.status)},{id:"actions",header:"",meta:{title:"Actions"},cell:()=>s("button",{class:"text-gray-400 hover:text-gray-600"},[s("i",{class:"fa-solid fa-ellipsis-vertical"})])}]);return(e,a)=>(h(),N("div",Me,[M(we,{title:"Customers",subtitle:"Manage contacts, accounts, leads and opportunities"}),i("div",We,[i("div",Be,[(h(!0),N(ve,null,be(ae.value,o=>(h(),N("button",{key:o.key,onClick:p=>ne(o.key),class:Ae(["flex items-center justify-between gap-3 px-4 py-3 bg-white border border-border rounded-lg cursor-pointer hover:shadow-sm transition-all shrink-0 min-w-[160px] border-t-4",c.value===o.key?o.borderColor:"border-t-border"])},[i("span",je,Ce(o.label),1),M(E(De),{text:String(o.count),size:"small",theme:ie(o.key,c.value===o.key)},null,8,["text","theme"])],10,Ee))),128))]),i("div",ze,[M(E($e),{data:X.value,columns:ue.value,meta:re.value,onRowClick:W,columnFiltersOptions:{filterDefs:te.value},pagination:Q.value,"onUpdate:pagination":a[1]||(a[1]=o=>Q.value=o),globalFilter:P.value,"onUpdate:globalFilter":a[2]||(a[2]=o=>P.value=o),sorting:H.value,"onUpdate:sorting":a[3]||(a[3]=o=>H.value=o),columnFilters:G.value,"onUpdate:columnFilters":a[4]||(a[4]=o=>G.value=o),paginationOptions:{rowCount:X.value.length},globalFilterOptions:{debounce:300}},{toolbar:B(()=>[c.value==="contacts"||c.value==="open-leads"||c.value==="open-opportunities"?(h(),N("button",{key:0,onClick:a[0]||(a[0]=o=>l.value=!0),class:"btn-primary-lg"},[...a[6]||(a[6]=[i("i",{class:"fa-solid fa-plus"},null,-1),Ne(" Add new ",-1)])])):ke("",!0)]),"empty-state":B(()=>[...a[7]||(a[7]=[i("div",{class:"empty-state"},[i("i",{class:"fa-solid fa-inbox empty-state-icon"}),i("p",{class:"empty-state-text"},"No records found")],-1)])]),_:1},8,["data","columns","meta","columnFiltersOptions","pagination","globalFilter","sorting","columnFilters","paginationOptions"])])]),M(Re,{show:l.value,"active-tab":c.value,"initial-data":J.value,onClose:a[5]||(a[5]=o=>l.value=!1),onSave:se},null,8,["show","active-tab","initial-data"])]))}};export{tt as default};
